
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Cameron Presley">
      
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="category/net/">
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16+insiders-4.53.16">
    
    
      
        <title>Index - The Software Mentor</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.1caf78d2.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/page.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-ZE0MGVG7RJ"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-ZE0MGVG7RJ",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-ZE0MGVG7RJ",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="The Software Mentor" class="md-header__button md-logo" aria-label="The Software Mentor" data-md-component="logo">
      
  <img src="../assets/images/favicon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            The Software Mentor
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Index
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="deep-purple"  aria-hidden="true"  type="radio" name="__palette" id="__palette_1">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  About Me

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
  
  Articles

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../courses/" class="md-tabs__link">
        
  
  
    
  
  Training Course

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../level-up/" class="md-tabs__link">
        
  
  
    
  
  Level Up Resources

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../presentations/" class="md-tabs__link">
        
  
  
    
  
  Presentations

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../speaking-schedule/" class="md-tabs__link">
        
  
  
    
  
  Speaking Schedule

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../story/" class="md-tabs__link">
        
  
  
    
  
  Story

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../resume/" class="md-tabs__link">
        
  
  
    
  
  Resume

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="The Software Mentor" class="md-nav__button md-logo" aria-label="The Software Mentor" data-md-component="logo">
      
  <img src="../assets/images/favicon.png" alt="logo">

    </a>
    The Software Mentor
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    About Me
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Articles
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Articles
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
    
      
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Index
  

    
  </span>
  
  

      </a>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Archive
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Archive
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="archive/2025/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2025
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="archive/2024/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2024
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="archive/2023/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2023
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="archive/2020/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2020
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="archive/2018/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2018
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="archive/2015/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2015
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="archive/2014/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2014
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="archive/2013/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2013
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Categories
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Categories
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="category/net/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    .NET
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="category/aws/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AWS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="category/basics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Basics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="category/c/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    C#
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="category/career/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Career
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="category/coaching-corner/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Coaching Corner
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="category/debugging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Debugging
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="category/functional-programming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Functional Programming
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="category/interviewing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Interviewing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="category/leadership/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Leadership
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="category/learning-through-example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Learning Through Example
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="category/process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Process
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="category/solid/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SOLID
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="category/today-i-learned/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Today I Learned
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="category/tooling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tooling
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="category/typescript/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    TypeScript
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../courses/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Training Course
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../level-up/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Level Up Resources
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../presentations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Presentations
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../speaking-schedule/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Speaking Schedule
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../story/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Story
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../resume/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Resume
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
                
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" hidden>
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
  <div class="md-content" data-md-component="content">
    <div class="md-content__inner">
      <header class="md-typeset">
        
      </header>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/cameronpresley.png" alt="Cameron Presley">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2025-12-01 00:00:00+00:00">Dec 1, 2025</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="category/net/" class="md-meta__link">.NET</a>, 
              <a href="category/functional-programming/" class="md-meta__link">Functional Programming</a></li>
        
        
          
          <li class="md-meta__item">
            
              8 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="reducing-bugs-by-using-the-model-view-update-pattern"><a class="toclink" href="2025/12/01/reducing-bugs-by-using-the-model-view-update-pattern/">Reducing Bugs by Using the Model View Update Pattern</a></h2>
<p><em>Note: This article is part of the <a href="https://csadvent.christmas/">2025 C# Advent Calendar</a>, so after you're done reading this, keep an eye out for the other cool articles coming out this month!</em></p>
<p>For those who've followed me for a bit, you know that I'm a big believer that functional programming is a great way of approaching problems.</p>
<p>One thing I've mentioned in my <a href="../presentations/#learning-functional-programming-through-construction-first-principles">recent presentations</a> is that we can take introductory concepts (pure functions, immutability, composition) and build <em>real world software</em> with them.</p>
<p>In this post, I'm going to show you a pattern that I've recently ported to C#, the <a href="https://guide.elm-lang.org/architecture/">Model View Update, also known as The Elm Architecture</a>.</p>
<h3 id="inspiration-of-the-pattern"><a class="toclink" href="2025/12/01/reducing-bugs-by-using-the-model-view-update-pattern/#inspiration-of-the-pattern">Inspiration of the Pattern</a></h3>
<p>Back in 2017, I came across a new functional language called <a href="https://elm-lang.org/">Elm</a> that took a different approach for web development. At a high level, Elm argues that you can think of an application as four pieces.</p>
<ol>
<li>The <em>Model</em> - What data are we presenting to the user?</li>
<li>The <em>View</em> - How should we format the model?</li>
</ol>
<p>At this point, this seems very similar to other MV* patterns (<a href="https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller">Model View Controller</a>, <a href="https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93presenter">Model View Presenter</a>, or <a href="https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93viewmodel">Model View ViewModel</a>). </p>
<p>The next two parts is what sets this pattern apart from the others.</p>
<ol>
<li>The <em>Command</em> - What things can the user do on the screen (button clicks, entering text, etc...)</li>
<li>The <em>Update</em> function - Given a <em>Model</em> and a <em>Command</em>, what does the new model look like?</li>
</ol>
<p>To me, this is an interesting concept because when the user makes changes, the model is being directly manipulated (generally through two-way binding) and then you had to make sure that you didn't put your business rules directly in the UI code. (For those who come from WinForms, how many times did you find business code in the code-behind?).</p>
<p>With this approach, however, we've narrowed down what the UI can do (it can render a model and return a command, but can't directly manipulate the model). </p>
<p>If you think that this approach isn't solid, you might be surprised to know that Elm inspired the creation of the following libraries in the JavaScript ecosystem:</p>
<ul>
<li><a href="https://ngrx.io/">ngrx</a> (Angular state management system)</li>
<li><a href="https://redux.js.org/">redux</a> (React state management system)</li>
</ul>
<p>I've recently been using this pattern for console applications and have been pleasantly surprised how well it's working out.</p>
<p>In this post, I'll walk you through how we can use this pattern to build out the "Hello World" equivalent application, manipulating a counter.</p>
<h3 id="implementing-the-pattern"><a class="toclink" href="2025/12/01/reducing-bugs-by-using-the-model-view-update-pattern/#implementing-the-pattern">Implementing the Pattern</a></h3>
<h4 id="defining-the-command"><a class="toclink" href="2025/12/01/reducing-bugs-by-using-the-model-view-update-pattern/#defining-the-command">Defining the Command</a></h4>
<p>Before we can model the <code>Command</code>, we need to think about what commands we want to support. In our example, let's say that we want the user to be able to do the following:</p>
<ul>
<li>Increment the counter by 2</li>
<li>Decrement the counter by 1</li>
<li>Reset the counter to 0</li>
<li>Quit the application</li>
</ul>
<p>In the Elm version (and it's equivalent TypeScript definition), a <code>Command</code> looks something like this:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="nx">tag</span><span class="o">:</span><span class="s1">&#39;increment&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="o">:</span><span class="kt">2</span><span class="p">}</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="nx">tag</span><span class="o">:</span><span class="s1">&#39;decrement&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="o">:</span><span class="kt">1</span><span class="p">}</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="nx">tag</span><span class="o">:</span><span class="s1">&#39;reset&#39;</span><span class="p">}</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="nx">tag</span><span class="o">:</span><span class="s1">&#39;quit&#39;</span><span class="p">};</span>
</code></pre></div></td></tr></table></div>
<p>This takes advantage of algebraic data type  known as a <a href="2023/04/30/better-domain-modeling-with-discriminated-unions/">sum type</a>, where the <code>Command</code> type has one of three different constructors (one called <code>increment</code>, another called <code>decrement</code>, one called <code>reset</code>, and finally, <code>quit</code>). </p>
<p>Even though C# doesn't have sum types (at least <a href="https://github.com/dotnet/csharplang/issues/9662">not yet</a>), we can mimic this behavior using an abstract class.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1">1</a></span>
<span class="normal"><a href="#__codelineno-1-2">2</a></span>
<span class="normal"><a href="#__codelineno-1-3">3</a></span>
<span class="normal"><a href="#__codelineno-1-4">4</a></span>
<span class="normal"><a href="#__codelineno-1-5">5</a></span>
<span class="normal"><a href="#__codelineno-1-6">6</a></span>
<span class="normal"><a href="#__codelineno-1-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="c1">// Abstract command that uses a string to</span>
<a id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="c1">// denote which command it is</span>
<a id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="c1">// (useful for casting later)</span>
<a id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="k">public</span><span class="w"> </span><span class="k">abstract</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">Command</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">T</span><span class="p">:</span><span class="n">Enum</span>
<a id="__codelineno-1-5" name="__codelineno-1-5"></a><span class="p">{</span>
<a id="__codelineno-1-6" name="__codelineno-1-6"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">abstract</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="n">Tag</span><span class="w"> </span><span class="p">{</span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-1-7" name="__codelineno-1-7"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h4 id="defining-commands-for-counter"><a class="toclink" href="2025/12/01/reducing-bugs-by-using-the-model-view-update-pattern/#defining-commands-for-counter">Defining Commands for Counter</a></h4>
<p>With the <code>Command</code> class defined, let's start implementing the various commands our program can have.</p>
<p>First, we'll define an <code>enum</code> to keep track of the types of <code>Commands</code>. We could omit this and just use strings, but the value of the <code>enum</code> is that we can have C# generate the cases (though we still have to have a default case given the nature of enums).</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-2-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-2-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-2-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-2-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-2-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-2-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-2-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-2-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-2-10">10</a></span>
<span class="normal"><a href="#__codelineno-2-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="c1">// Enum to help with exhaustive matching later</span>
<a id="__codelineno-2-2" name="__codelineno-2-2"></a><span class="c1">// on</span>
<a id="__codelineno-2-3" name="__codelineno-2-3"></a>
<a id="__codelineno-2-4" name="__codelineno-2-4"></a><span class="k">public</span><span class="w"> </span><span class="k">enum</span><span class="w"> </span><span class="n">CommandType</span>
<a id="__codelineno-2-5" name="__codelineno-2-5"></a><span class="p">{</span>
<a id="__codelineno-2-6" name="__codelineno-2-6"></a><span class="w">  </span><span class="n">Increment</span><span class="p">,</span>
<a id="__codelineno-2-7" name="__codelineno-2-7"></a><span class="w">  </span><span class="n">Decrement</span><span class="p">,</span>
<a id="__codelineno-2-8" name="__codelineno-2-8"></a><span class="w">  </span><span class="n">Reset</span><span class="p">,</span>
<a id="__codelineno-2-9" name="__codelineno-2-9"></a><span class="w">  </span><span class="n">Quit</span><span class="p">,</span>
<a id="__codelineno-2-10" name="__codelineno-2-10"></a><span class="w">  </span><span class="n">Unknown</span>
<a id="__codelineno-2-11" name="__codelineno-2-11"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>With the enum defined, we can start define the commands, some of which will have more information included (see the <em>IncrementCommand</em> and <em>DecrementCommand</em>).</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-3-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-3-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-3-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-3-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-3-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-3-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-3-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-3-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-3-10">10</a></span>
<span class="normal"><a href="#__codelineno-3-11">11</a></span>
<span class="normal"><a href="#__codelineno-3-12">12</a></span>
<span class="normal"><a href="#__codelineno-3-13">13</a></span>
<span class="normal"><a href="#__codelineno-3-14">14</a></span>
<span class="normal"><a href="#__codelineno-3-15">15</a></span>
<span class="normal"><a href="#__codelineno-3-16">16</a></span>
<span class="normal"><a href="#__codelineno-3-17">17</a></span>
<span class="normal"><a href="#__codelineno-3-18">18</a></span>
<span class="normal"><a href="#__codelineno-3-19">19</a></span>
<span class="normal"><a href="#__codelineno-3-20">20</a></span>
<span class="normal"><a href="#__codelineno-3-21">21</a></span>
<span class="normal"><a href="#__codelineno-3-22">22</a></span>
<span class="normal"><a href="#__codelineno-3-23">23</a></span>
<span class="normal"><a href="#__codelineno-3-24">24</a></span>
<span class="normal"><a href="#__codelineno-3-25">25</a></span>
<span class="normal"><a href="#__codelineno-3-26">26</a></span>
<span class="normal"><a href="#__codelineno-3-27">27</a></span>
<span class="normal"><a href="#__codelineno-3-28">28</a></span>
<span class="normal"><a href="#__codelineno-3-29">29</a></span>
<span class="normal"><a href="#__codelineno-3-30">30</a></span>
<span class="normal"><a href="#__codelineno-3-31">31</a></span>
<span class="normal"><a href="#__codelineno-3-32">32</a></span>
<span class="normal"><a href="#__codelineno-3-33">33</a></span>
<span class="normal"><a href="#__codelineno-3-34">34</a></span>
<span class="normal"><a href="#__codelineno-3-35">35</a></span>
<span class="normal"><a href="#__codelineno-3-36">36</a></span>
<span class="normal"><a href="#__codelineno-3-37">37</a></span>
<span class="normal"><a href="#__codelineno-3-38">38</a></span>
<span class="normal"><a href="#__codelineno-3-39">39</a></span>
<span class="normal"><a href="#__codelineno-3-40">40</a></span>
<span class="normal"><a href="#__codelineno-3-41">41</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">IncrementCommand</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Command</span><span class="o">&lt;</span><span class="n">CommandType</span><span class="o">&gt;</span>
<a id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="p">{</span>
<a id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="n">CommandType</span><span class="w"> </span><span class="n">Tag</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">CommandType</span><span class="p">.</span><span class="n">Increment</span><span class="p">;</span>
<a id="__codelineno-3-4" name="__codelineno-3-4"></a>
<a id="__codelineno-3-5" name="__codelineno-3-5"></a><span class="w">  </span><span class="c1">// Since some of the commands will have custom values and others not, </span>
<a id="__codelineno-3-6" name="__codelineno-3-6"></a><span class="w">  </span><span class="c1">// we can inject those values through the constructor</span>
<a id="__codelineno-3-7" name="__codelineno-3-7"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">Value</span><span class="w"> </span><span class="p">{</span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">init</span><span class="p">;}</span>
<a id="__codelineno-3-8" name="__codelineno-3-8"></a>
<a id="__codelineno-3-9" name="__codelineno-3-9"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="nf">IncrementCommand</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="k">value</span><span class="p">)</span>
<a id="__codelineno-3-10" name="__codelineno-3-10"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-3-11" name="__codelineno-3-11"></a><span class="w">    </span><span class="n">Value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">value</span><span class="p">;</span>
<a id="__codelineno-3-12" name="__codelineno-3-12"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-3-13" name="__codelineno-3-13"></a><span class="p">}</span>
<a id="__codelineno-3-14" name="__codelineno-3-14"></a>
<a id="__codelineno-3-15" name="__codelineno-3-15"></a><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">DecrementCommand</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Command</span><span class="o">&lt;</span><span class="n">CommandType</span><span class="o">&gt;</span>
<a id="__codelineno-3-16" name="__codelineno-3-16"></a><span class="p">{</span>
<a id="__codelineno-3-17" name="__codelineno-3-17"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="n">CommandType</span><span class="w"> </span><span class="n">Tag</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">CommandType</span><span class="p">.</span><span class="n">Decrement</span><span class="p">;</span>
<a id="__codelineno-3-18" name="__codelineno-3-18"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">Value</span><span class="w"> </span><span class="p">{</span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">init</span><span class="p">;}</span>
<a id="__codelineno-3-19" name="__codelineno-3-19"></a>
<a id="__codelineno-3-20" name="__codelineno-3-20"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="nf">DecrementCommand</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="k">value</span><span class="p">)</span>
<a id="__codelineno-3-21" name="__codelineno-3-21"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-3-22" name="__codelineno-3-22"></a><span class="w">    </span><span class="n">Value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">value</span><span class="p">;</span>
<a id="__codelineno-3-23" name="__codelineno-3-23"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-3-24" name="__codelineno-3-24"></a><span class="p">}</span>
<a id="__codelineno-3-25" name="__codelineno-3-25"></a>
<a id="__codelineno-3-26" name="__codelineno-3-26"></a><span class="c1">// In other cases, we don&#39;t need</span>
<a id="__codelineno-3-27" name="__codelineno-3-27"></a><span class="c1">// any other info, so we can inherit and implement the Tag property</span>
<a id="__codelineno-3-28" name="__codelineno-3-28"></a><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">ResetCommand</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Command</span><span class="o">&lt;</span><span class="n">CommandType</span><span class="o">&gt;</span>
<a id="__codelineno-3-29" name="__codelineno-3-29"></a><span class="p">{</span>
<a id="__codelineno-3-30" name="__codelineno-3-30"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="n">CommandType</span><span class="w"> </span><span class="n">Tag</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">CommandType</span><span class="p">.</span><span class="n">Reset</span><span class="p">;</span>
<a id="__codelineno-3-31" name="__codelineno-3-31"></a><span class="p">}</span>
<a id="__codelineno-3-32" name="__codelineno-3-32"></a>
<a id="__codelineno-3-33" name="__codelineno-3-33"></a><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">QuitCommand</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Command</span><span class="o">&lt;</span><span class="n">CommandType</span><span class="o">&gt;</span>
<a id="__codelineno-3-34" name="__codelineno-3-34"></a><span class="p">{</span>
<a id="__codelineno-3-35" name="__codelineno-3-35"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="n">CommandType</span><span class="w"> </span><span class="n">Tag</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">CommandType</span><span class="p">.</span><span class="n">Quit</span><span class="p">;</span>
<a id="__codelineno-3-36" name="__codelineno-3-36"></a><span class="p">}</span>
<a id="__codelineno-3-37" name="__codelineno-3-37"></a>
<a id="__codelineno-3-38" name="__codelineno-3-38"></a><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">UnknownCommand</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Command</span><span class="o">&lt;</span><span class="n">CommandType</span><span class="o">&gt;</span>
<a id="__codelineno-3-39" name="__codelineno-3-39"></a><span class="p">{</span>
<a id="__codelineno-3-40" name="__codelineno-3-40"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="n">CommandType</span><span class="w"> </span><span class="n">Tag</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">CommandType</span><span class="p">.</span><span class="n">Unknown</span><span class="p">;</span>
<a id="__codelineno-3-41" name="__codelineno-3-41"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h4 id="implementing-the-update-function"><a class="toclink" href="2025/12/01/reducing-bugs-by-using-the-model-view-update-pattern/#implementing-the-update-function">Implementing the Update Function</a></h4>
<p>Now that we have our various commands created, we can start building out the <code>Update</code> function. </p>
<p>From our earlier description, we know that our <code>Update</code> function has to take in our model (a number) and a <code>Command</code> and then has to return a new model (a number).</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-4-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-4-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-4-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-4-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-4-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-4-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-4-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-4-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-4-10">10</a></span>
<span class="normal"><a href="#__codelineno-4-11">11</a></span>
<span class="normal"><a href="#__codelineno-4-12">12</a></span>
<span class="normal"><a href="#__codelineno-4-13">13</a></span>
<span class="normal"><a href="#__codelineno-4-14">14</a></span>
<span class="normal"><a href="#__codelineno-4-15">15</a></span>
<span class="normal"><a href="#__codelineno-4-16">16</a></span>
<span class="normal"><a href="#__codelineno-4-17">17</a></span>
<span class="normal"><a href="#__codelineno-4-18">18</a></span>
<span class="normal"><a href="#__codelineno-4-19">19</a></span>
<span class="normal"><a href="#__codelineno-4-20">20</a></span>
<span class="normal"><a href="#__codelineno-4-21">21</a></span>
<span class="normal"><a href="#__codelineno-4-22">22</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="c1">// This example is a static method, but let&#39;s say that the rules were more complicated, </span>
<a id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="c1">// we could inject those into a class and make this method non-static.</span>
<a id="__codelineno-4-3" name="__codelineno-4-3"></a>
<a id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">Update</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">number</span><span class="p">,</span><span class="w"> </span><span class="n">Command</span><span class="o">&lt;</span><span class="n">CommandType</span><span class="o">&gt;</span><span class="w"> </span><span class="n">c</span><span class="p">)</span>
<a id="__codelineno-4-5" name="__codelineno-4-5"></a><span class="p">{</span>
<a id="__codelineno-4-6" name="__codelineno-4-6"></a><span class="w">  </span><span class="c1">// I&#39;m leveraging the new switch syntax, </span>
<a id="__codelineno-4-7" name="__codelineno-4-7"></a><span class="w">  </span><span class="c1">// but you can use the original syntax</span>
<a id="__codelineno-4-8" name="__codelineno-4-8"></a><span class="w">  </span><span class="c1">// without issues</span>
<a id="__codelineno-4-9" name="__codelineno-4-9"></a>
<a id="__codelineno-4-10" name="__codelineno-4-10"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">tag</span><span class="w"> </span><span class="k">switch</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-4-11" name="__codelineno-4-11"></a><span class="w">    </span><span class="n">CommandType</span><span class="p">.</span><span class="n">Increment</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">IncrementCommand</span><span class="p">)</span><span class="n">c</span><span class="p">).</span><span class="n">Value</span><span class="p">,</span>
<a id="__codelineno-4-12" name="__codelineno-4-12"></a><span class="w">    </span><span class="n">CommandType</span><span class="p">.</span><span class="n">Decrement</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">((</span><span class="n">DecrementCommand</span><span class="p">)</span><span class="n">c</span><span class="p">).</span><span class="n">Value</span><span class="p">,</span>
<a id="__codelineno-4-13" name="__codelineno-4-13"></a><span class="w">    </span><span class="n">CommandType</span><span class="p">.</span><span class="n">Reset</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-4-14" name="__codelineno-4-14"></a><span class="w">    </span><span class="c1">// In the case we&#39;re told to quit or we</span>
<a id="__codelineno-4-15" name="__codelineno-4-15"></a><span class="w">    </span><span class="c1">// get an unknown command, we&#39;ll return</span>
<a id="__codelineno-4-16" name="__codelineno-4-16"></a><span class="w">    </span><span class="c1">// the model back</span>
<a id="__codelineno-4-17" name="__codelineno-4-17"></a><span class="w">    </span><span class="n">CommandType</span><span class="p">.</span><span class="n">Quit</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">number</span><span class="p">,</span>
<a id="__codelineno-4-18" name="__codelineno-4-18"></a><span class="w">    </span><span class="n">CommandType</span><span class="p">.</span><span class="n">Unknown</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">number</span><span class="p">,</span>
<a id="__codelineno-4-19" name="__codelineno-4-19"></a><span class="w">    </span><span class="c1">// Since C# doesn&#39;t have exhaustive matching, we still require the default case here</span>
<a id="__codelineno-4-20" name="__codelineno-4-20"></a><span class="w">    </span><span class="n">_</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">number</span>
<a id="__codelineno-4-21" name="__codelineno-4-21"></a><span class="w">  </span><span class="p">};</span>
<a id="__codelineno-4-22" name="__codelineno-4-22"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h4 id="implementing-the-view-function"><a class="toclink" href="2025/12/01/reducing-bugs-by-using-the-model-view-update-pattern/#implementing-the-view-function">Implementing the View Function</a></h4>
<p>At this point, we could go ahead and start writing tests to verify that our model is being updated given the command, but our users are going to be interacting with the application, so let's build that out next.</p>
<p>From before, we know that the <code>View</code> function takes in the model (a number) and it will return a <code>Command</code>. Given that we need to interact with the user, this is an <a href="https://en.wikipedia.org/wiki/Pure_function#Impure_functions">impure function</a> by design, so we shouldn't put our business rules in here.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-5-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-5-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-5-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-5-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-5-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-5-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-5-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-5-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-5-10">10</a></span>
<span class="normal"><a href="#__codelineno-5-11">11</a></span>
<span class="normal"><a href="#__codelineno-5-12">12</a></span>
<span class="normal"><a href="#__codelineno-5-13">13</a></span>
<span class="normal"><a href="#__codelineno-5-14">14</a></span>
<span class="normal"><a href="#__codelineno-5-15">15</a></span>
<span class="normal"><a href="#__codelineno-5-16">16</a></span>
<span class="normal"><a href="#__codelineno-5-17">17</a></span>
<span class="normal"><a href="#__codelineno-5-18">18</a></span>
<span class="normal"><a href="#__codelineno-5-19">19</a></span>
<span class="normal"><a href="#__codelineno-5-20">20</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">Command</span><span class="o">&lt;</span><span class="n">CommandType</span><span class="o">&gt;</span><span class="w"> </span><span class="n">View</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">model</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="w">  </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">$&quot;Counter: {model}&quot;</span><span class="p">);</span>
<a id="__codelineno-5-3" name="__codelineno-5-3"></a><span class="w">  </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;(I)ncrement, (D)ecrement, (R)eset, or (Q)uit&quot;</span><span class="p">);</span>
<a id="__codelineno-5-4" name="__codelineno-5-4"></a>
<a id="__codelineno-5-5" name="__codelineno-5-5"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nf">ConvertStringToCommand</span><span class="p">(</span><span class="n">Console</span><span class="p">.</span><span class="n">ReadLine</span><span class="p">());</span>
<a id="__codelineno-5-6" name="__codelineno-5-6"></a><span class="p">}</span>
<a id="__codelineno-5-7" name="__codelineno-5-7"></a>
<a id="__codelineno-5-8" name="__codelineno-5-8"></a><span class="c1">// Even though this is called by the View</span>
<a id="__codelineno-5-9" name="__codelineno-5-9"></a><span class="c1">// function, this is a Pure function</span>
<a id="__codelineno-5-10" name="__codelineno-5-10"></a><span class="c1">// because it only depends upon a string</span>
<a id="__codelineno-5-11" name="__codelineno-5-11"></a><span class="c1">// for its logic</span>
<a id="__codelineno-5-12" name="__codelineno-5-12"></a><span class="k">private</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">Command</span><span class="o">&lt;</span><span class="n">CommandType</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ConvertStringToCommand</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-5-13" name="__codelineno-5-13"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">s</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">).</span><span class="n">Trim</span><span class="p">().</span><span class="n">ToLower</span><span class="p">()</span><span class="w"> </span><span class="k">switch</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-5-14" name="__codelineno-5-14"></a><span class="w">    </span><span class="s">&quot;i&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IncrementCommand</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="c1">// will increment by 2</span>
<a id="__codelineno-5-15" name="__codelineno-5-15"></a><span class="w">    </span><span class="s">&quot;d&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DecrementCommand</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="c1">// will decrement by 1</span>
<a id="__codelineno-5-16" name="__codelineno-5-16"></a><span class="w">    </span><span class="s">&quot;r&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ResetCommand</span><span class="p">(),</span>
<a id="__codelineno-5-17" name="__codelineno-5-17"></a><span class="w">    </span><span class="s">&quot;q&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">QuitCommand</span><span class="p">(),</span>
<a id="__codelineno-5-18" name="__codelineno-5-18"></a><span class="w">    </span><span class="n">_</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">UnknownCommand</span><span class="p">()</span>
<a id="__codelineno-5-19" name="__codelineno-5-19"></a><span class="w">  </span><span class="p">};</span>
<a id="__codelineno-5-20" name="__codelineno-5-20"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h4 id="wiring-everything-together"><a class="toclink" href="2025/12/01/reducing-bugs-by-using-the-model-view-update-pattern/#wiring-everything-together">Wiring Everything Together</a></h4>
<p>Now that we have our Model (a number), the <code>View</code> function, an <code>Update</code> function, and our list of <code>Command</code>s, we can wire everything together.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-6-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-6-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-6-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-6-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-6-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-6-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-6-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-6-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-6-10">10</a></span>
<span class="normal"><a href="#__codelineno-6-11">11</a></span>
<span class="normal"><a href="#__codelineno-6-12">12</a></span>
<span class="normal"><a href="#__codelineno-6-13">13</a></span>
<span class="normal"><a href="#__codelineno-6-14">14</a></span>
<span class="normal"><a href="#__codelineno-6-15">15</a></span>
<span class="normal"><a href="#__codelineno-6-16">16</a></span>
<span class="normal"><a href="#__codelineno-6-17">17</a></span>
<span class="normal"><a href="#__codelineno-6-18">18</a></span>
<span class="normal"><a href="#__codelineno-6-19">19</a></span>
<span class="normal"><a href="#__codelineno-6-20">20</a></span>
<span class="normal"><a href="#__codelineno-6-21">21</a></span>
<span class="normal"><a href="#__codelineno-6-22">22</a></span>
<span class="normal"><a href="#__codelineno-6-23">23</a></span>
<span class="normal"><a href="#__codelineno-6-24">24</a></span>
<span class="normal"><a href="#__codelineno-6-25">25</a></span>
<span class="normal"><a href="#__codelineno-6-26">26</a></span>
<span class="normal"><a href="#__codelineno-6-27">27</a></span>
<span class="normal"><a href="#__codelineno-6-28">28</a></span>
<span class="normal"><a href="#__codelineno-6-29">29</a></span>
<span class="normal"><a href="#__codelineno-6-30">30</a></span>
<span class="normal"><a href="#__codelineno-6-31">31</a></span>
<span class="normal"><a href="#__codelineno-6-32">32</a></span>
<span class="normal"><a href="#__codelineno-6-33">33</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">Framework</span>
<a id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="p">{</span>
<a id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="n">Run</span><span class="o">&lt;</span><span class="n">TModel</span><span class="p">,</span><span class="w"> </span><span class="n">TCommandType</span><span class="o">&gt;</span><span class="p">(</span>
<a id="__codelineno-6-4" name="__codelineno-6-4"></a><span class="w">      </span><span class="n">Func</span><span class="o">&lt;</span><span class="n">TModel</span><span class="p">,</span><span class="w"> </span><span class="n">Command</span><span class="o">&lt;</span><span class="n">TCommandType</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">view</span><span class="p">,</span>
<a id="__codelineno-6-5" name="__codelineno-6-5"></a><span class="w">      </span><span class="n">Func</span><span class="o">&lt;</span><span class="n">TModel</span><span class="p">,</span><span class="w"> </span><span class="n">Command</span><span class="o">&lt;</span><span class="n">TCommandType</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">TModel</span><span class="o">&gt;</span><span class="w"> </span><span class="n">update</span><span class="p">,</span>
<a id="__codelineno-6-6" name="__codelineno-6-6"></a><span class="w">      </span><span class="n">TModel</span><span class="w"> </span><span class="n">model</span><span class="p">)</span>
<a id="__codelineno-6-7" name="__codelineno-6-7"></a><span class="w">  </span><span class="k">where</span><span class="w"> </span><span class="n">TCommandType</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Enum</span>
<a id="__codelineno-6-8" name="__codelineno-6-8"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-6-9" name="__codelineno-6-9"></a><span class="w">    </span><span class="c1">// We need the Enum to have a Quit option</span>
<a id="__codelineno-6-10" name="__codelineno-6-10"></a><span class="w">    </span><span class="c1">// defined, otherwise, we won&#39;t know when</span>
<a id="__codelineno-6-11" name="__codelineno-6-11"></a><span class="w">    </span><span class="c1">// to quit the application.</span>
<a id="__codelineno-6-12" name="__codelineno-6-12"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">Enum</span><span class="p">.</span><span class="n">IsDefined</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">TCommandType</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;Quit&quot;</span><span class="p">))</span>
<a id="__codelineno-6-13" name="__codelineno-6-13"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-6-14" name="__codelineno-6-14"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">InvalidOperationException</span><span class="p">(</span><span class="s">&quot;Command must have a Quit option&quot;</span><span class="p">);</span>
<a id="__codelineno-6-15" name="__codelineno-6-15"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-6-16" name="__codelineno-6-16"></a><span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">quitCommand</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Enum</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">TCommandType</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;Quit&quot;</span><span class="p">);</span>
<a id="__codelineno-6-17" name="__codelineno-6-17"></a>
<a id="__codelineno-6-18" name="__codelineno-6-18"></a><span class="w">    </span><span class="c1">// Getting our initial state</span>
<a id="__codelineno-6-19" name="__codelineno-6-19"></a><span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">currentModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">model</span><span class="p">;</span>
<a id="__codelineno-6-20" name="__codelineno-6-20"></a><span class="w">    </span><span class="n">Command</span><span class="o">&lt;</span><span class="n">TCommandType</span><span class="o">&gt;</span><span class="w"> </span><span class="n">command</span><span class="p">;</span>
<a id="__codelineno-6-21" name="__codelineno-6-21"></a>
<a id="__codelineno-6-22" name="__codelineno-6-22"></a><span class="w">    </span><span class="c1">// While command isn&#39;t Quit</span>
<a id="__codelineno-6-23" name="__codelineno-6-23"></a><span class="w">    </span><span class="k">do</span>
<a id="__codelineno-6-24" name="__codelineno-6-24"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-6-25" name="__codelineno-6-25"></a><span class="w">      </span><span class="c1">// Clear the screen</span>
<a id="__codelineno-6-26" name="__codelineno-6-26"></a><span class="w">      </span><span class="n">Console</span><span class="p">.</span><span class="n">Clear</span><span class="p">();</span>
<a id="__codelineno-6-27" name="__codelineno-6-27"></a><span class="w">      </span><span class="c1">// Get the command from when we render the view</span>
<a id="__codelineno-6-28" name="__codelineno-6-28"></a><span class="w">      </span><span class="n">command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">view</span><span class="p">(</span><span class="n">currentModel</span><span class="p">);</span>
<a id="__codelineno-6-29" name="__codelineno-6-29"></a><span class="w">      </span><span class="c1">// Get the new model from update</span>
<a id="__codelineno-6-30" name="__codelineno-6-30"></a><span class="w">      </span><span class="n">currentModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">update</span><span class="p">(</span><span class="n">currentModel</span><span class="p">,</span><span class="w"> </span><span class="n">command</span><span class="p">);</span>
<a id="__codelineno-6-31" name="__codelineno-6-31"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">command</span><span class="p">.</span><span class="n">Tag</span><span class="p">.</span><span class="n">Equals</span><span class="p">(</span><span class="n">quitCommand</span><span class="p">));</span>
<a id="__codelineno-6-32" name="__codelineno-6-32"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-6-33" name="__codelineno-6-33"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h3 id="final-version"><a class="toclink" href="2025/12/01/reducing-bugs-by-using-the-model-view-update-pattern/#final-version">Final Version</a></h3>
<p>With the <code>Framework.Run</code> function defined, we can invoke it via our <code>Program.cs</code> file.</p>
<p>You can find the working version below (or you can <a href="https://github.com/cameronpresley/csharp-elm-example">clone a copy from GitHub</a>)</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Program.cs</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-7-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-7-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-7-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-7-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-7-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-7-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-7-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-7-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-7-10">10</a></span>
<span class="normal"><a href="#__codelineno-7-11">11</a></span>
<span class="normal"><a href="#__codelineno-7-12">12</a></span>
<span class="normal"><a href="#__codelineno-7-13">13</a></span>
<span class="normal"><a href="#__codelineno-7-14">14</a></span>
<span class="normal"><a href="#__codelineno-7-15">15</a></span>
<span class="normal"><a href="#__codelineno-7-16">16</a></span>
<span class="normal"><a href="#__codelineno-7-17">17</a></span>
<span class="normal"><a href="#__codelineno-7-18">18</a></span>
<span class="normal"><a href="#__codelineno-7-19">19</a></span>
<span class="normal"><a href="#__codelineno-7-20">20</a></span>
<span class="normal"><a href="#__codelineno-7-21">21</a></span>
<span class="normal"><a href="#__codelineno-7-22">22</a></span>
<span class="normal"><a href="#__codelineno-7-23">23</a></span>
<span class="normal"><a href="#__codelineno-7-24">24</a></span>
<span class="normal"><a href="#__codelineno-7-25">25</a></span>
<span class="normal"><a href="#__codelineno-7-26">26</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="k">internal</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">Program</span>
<a id="__codelineno-7-2" name="__codelineno-7-2"></a><span class="p">{</span>
<a id="__codelineno-7-3" name="__codelineno-7-3"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span>
<a id="__codelineno-7-4" name="__codelineno-7-4"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-7-5" name="__codelineno-7-5"></a><span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">startCounter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="__codelineno-7-6" name="__codelineno-7-6"></a><span class="w">    </span><span class="n">Framework</span><span class="p">.</span><span class="n">Run</span><span class="p">(</span><span class="n">View</span><span class="p">,</span><span class="w"> </span><span class="n">CounterRules</span><span class="p">.</span><span class="n">Update</span><span class="p">,</span><span class="w"> </span><span class="n">startCounter</span><span class="p">);</span>
<a id="__codelineno-7-7" name="__codelineno-7-7"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-7-8" name="__codelineno-7-8"></a>
<a id="__codelineno-7-9" name="__codelineno-7-9"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">Command</span><span class="o">&lt;</span><span class="n">CommandType</span><span class="o">&gt;</span><span class="w"> </span><span class="n">View</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">model</span><span class="p">)</span>
<a id="__codelineno-7-10" name="__codelineno-7-10"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-7-11" name="__codelineno-7-11"></a><span class="w">    </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;Counter: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">model</span><span class="p">);</span>
<a id="__codelineno-7-12" name="__codelineno-7-12"></a><span class="w">    </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;Please enter a command:&quot;</span><span class="p">);</span>
<a id="__codelineno-7-13" name="__codelineno-7-13"></a><span class="w">    </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;(I)ncrement, (D)ecrement, (R)eset, (Q)uit&quot;</span><span class="p">);</span>
<a id="__codelineno-7-14" name="__codelineno-7-14"></a><span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Console</span><span class="p">.</span><span class="n">ReadLine</span><span class="p">()</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
<a id="__codelineno-7-15" name="__codelineno-7-15"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">ConvertStringToCommand</span><span class="p">(</span><span class="n">input</span><span class="p">);</span>
<a id="__codelineno-7-16" name="__codelineno-7-16"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-7-17" name="__codelineno-7-17"></a>
<a id="__codelineno-7-18" name="__codelineno-7-18"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">Command</span><span class="o">&lt;</span><span class="n">CommandType</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ConvertStringToCommand</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">s</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">).</span><span class="n">ToLower</span><span class="p">().</span><span class="n">Trim</span><span class="p">()</span><span class="w"> </span><span class="k">switch</span>
<a id="__codelineno-7-19" name="__codelineno-7-19"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-7-20" name="__codelineno-7-20"></a><span class="w">    </span><span class="s">&quot;i&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IncrementCommand</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
<a id="__codelineno-7-21" name="__codelineno-7-21"></a><span class="w">    </span><span class="s">&quot;d&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DecrementCommand</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-7-22" name="__codelineno-7-22"></a><span class="w">    </span><span class="s">&quot;r&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ResetCommand</span><span class="p">(),</span>
<a id="__codelineno-7-23" name="__codelineno-7-23"></a><span class="w">    </span><span class="s">&quot;q&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">QuitCommand</span><span class="p">(),</span>
<a id="__codelineno-7-24" name="__codelineno-7-24"></a><span class="w">    </span><span class="n">_</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">UnknownCommand</span><span class="p">(),</span>
<a id="__codelineno-7-25" name="__codelineno-7-25"></a><span class="w">  </span><span class="p">};</span>
<a id="__codelineno-7-26" name="__codelineno-7-26"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">CounterRules.cs</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-8-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-8-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-8-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-8-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-8-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-8-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-8-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-8-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-8-10">10</a></span>
<span class="normal"><a href="#__codelineno-8-11">11</a></span>
<span class="normal"><a href="#__codelineno-8-12">12</a></span>
<span class="normal"><a href="#__codelineno-8-13">13</a></span>
<span class="normal"><a href="#__codelineno-8-14">14</a></span>
<span class="normal"><a href="#__codelineno-8-15">15</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">CounterRules</span>
<a id="__codelineno-8-2" name="__codelineno-8-2"></a><span class="p">{</span>
<a id="__codelineno-8-3" name="__codelineno-8-3"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">Update</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">model</span><span class="p">,</span><span class="w"> </span><span class="n">Command</span><span class="o">&lt;</span><span class="n">CommandType</span><span class="o">&gt;</span><span class="w"> </span><span class="n">c</span><span class="p">)</span>
<a id="__codelineno-8-4" name="__codelineno-8-4"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-8-5" name="__codelineno-8-5"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">Tag</span><span class="w"> </span><span class="k">switch</span>
<a id="__codelineno-8-6" name="__codelineno-8-6"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-8-7" name="__codelineno-8-7"></a><span class="w">      </span><span class="n">CommandType</span><span class="p">.</span><span class="n">Increment</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">IncrementCommand</span><span class="p">)</span><span class="o">!</span><span class="p">.</span><span class="n">Value</span><span class="p">,</span>
<a id="__codelineno-8-8" name="__codelineno-8-8"></a><span class="w">      </span><span class="n">CommandType</span><span class="p">.</span><span class="n">Decrement</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">DecrementCommand</span><span class="p">)</span><span class="o">!</span><span class="p">.</span><span class="n">Value</span><span class="p">,</span>
<a id="__codelineno-8-9" name="__codelineno-8-9"></a><span class="w">      </span><span class="n">CommandType</span><span class="p">.</span><span class="n">Reset</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-8-10" name="__codelineno-8-10"></a><span class="w">      </span><span class="n">CommandType</span><span class="p">.</span><span class="n">Quit</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">model</span><span class="p">,</span>
<a id="__codelineno-8-11" name="__codelineno-8-11"></a><span class="w">      </span><span class="n">CommandType</span><span class="p">.</span><span class="n">Unknown</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">model</span><span class="p">,</span>
<a id="__codelineno-8-12" name="__codelineno-8-12"></a><span class="w">      </span><span class="n">_</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">model</span>
<a id="__codelineno-8-13" name="__codelineno-8-13"></a><span class="w">    </span><span class="p">};</span>
<a id="__codelineno-8-14" name="__codelineno-8-14"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-8-15" name="__codelineno-8-15"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Commands.cs</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-9-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-9-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-9-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-9-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-9-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-9-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-9-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-9-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-9-10">10</a></span>
<span class="normal"><a href="#__codelineno-9-11">11</a></span>
<span class="normal"><a href="#__codelineno-9-12">12</a></span>
<span class="normal"><a href="#__codelineno-9-13">13</a></span>
<span class="normal"><a href="#__codelineno-9-14">14</a></span>
<span class="normal"><a href="#__codelineno-9-15">15</a></span>
<span class="normal"><a href="#__codelineno-9-16">16</a></span>
<span class="normal"><a href="#__codelineno-9-17">17</a></span>
<span class="normal"><a href="#__codelineno-9-18">18</a></span>
<span class="normal"><a href="#__codelineno-9-19">19</a></span>
<span class="normal"><a href="#__codelineno-9-20">20</a></span>
<span class="normal"><a href="#__codelineno-9-21">21</a></span>
<span class="normal"><a href="#__codelineno-9-22">22</a></span>
<span class="normal"><a href="#__codelineno-9-23">23</a></span>
<span class="normal"><a href="#__codelineno-9-24">24</a></span>
<span class="normal"><a href="#__codelineno-9-25">25</a></span>
<span class="normal"><a href="#__codelineno-9-26">26</a></span>
<span class="normal"><a href="#__codelineno-9-27">27</a></span>
<span class="normal"><a href="#__codelineno-9-28">28</a></span>
<span class="normal"><a href="#__codelineno-9-29">29</a></span>
<span class="normal"><a href="#__codelineno-9-30">30</a></span>
<span class="normal"><a href="#__codelineno-9-31">31</a></span>
<span class="normal"><a href="#__codelineno-9-32">32</a></span>
<span class="normal"><a href="#__codelineno-9-33">33</a></span>
<span class="normal"><a href="#__codelineno-9-34">34</a></span>
<span class="normal"><a href="#__codelineno-9-35">35</a></span>
<span class="normal"><a href="#__codelineno-9-36">36</a></span>
<span class="normal"><a href="#__codelineno-9-37">37</a></span>
<span class="normal"><a href="#__codelineno-9-38">38</a></span>
<span class="normal"><a href="#__codelineno-9-39">39</a></span>
<span class="normal"><a href="#__codelineno-9-40">40</a></span>
<span class="normal"><a href="#__codelineno-9-41">41</a></span>
<span class="normal"><a href="#__codelineno-9-42">42</a></span>
<span class="normal"><a href="#__codelineno-9-43">43</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="k">public</span><span class="w"> </span><span class="k">enum</span><span class="w"> </span><span class="n">CommandType</span>
<a id="__codelineno-9-2" name="__codelineno-9-2"></a><span class="p">{</span>
<a id="__codelineno-9-3" name="__codelineno-9-3"></a><span class="w">  </span><span class="n">Increment</span><span class="p">,</span>
<a id="__codelineno-9-4" name="__codelineno-9-4"></a><span class="w">  </span><span class="n">Decrement</span><span class="p">,</span>
<a id="__codelineno-9-5" name="__codelineno-9-5"></a><span class="w">  </span><span class="n">Reset</span><span class="p">,</span>
<a id="__codelineno-9-6" name="__codelineno-9-6"></a><span class="w">  </span><span class="n">Quit</span><span class="p">,</span>
<a id="__codelineno-9-7" name="__codelineno-9-7"></a><span class="w">  </span><span class="n">Unknown</span>
<a id="__codelineno-9-8" name="__codelineno-9-8"></a><span class="p">}</span>
<a id="__codelineno-9-9" name="__codelineno-9-9"></a>
<a id="__codelineno-9-10" name="__codelineno-9-10"></a><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">IncrementCommand</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Command</span><span class="o">&lt;</span><span class="n">CommandType</span><span class="o">&gt;</span>
<a id="__codelineno-9-11" name="__codelineno-9-11"></a><span class="p">{</span>
<a id="__codelineno-9-12" name="__codelineno-9-12"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="n">CommandType</span><span class="w"> </span><span class="n">Tag</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">CommandType</span><span class="p">.</span><span class="n">Increment</span><span class="p">;</span>
<a id="__codelineno-9-13" name="__codelineno-9-13"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">Value</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">init</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-9-14" name="__codelineno-9-14"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="nf">IncrementCommand</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="k">value</span><span class="p">)</span>
<a id="__codelineno-9-15" name="__codelineno-9-15"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-9-16" name="__codelineno-9-16"></a><span class="w">    </span><span class="n">Value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">value</span><span class="p">;</span>
<a id="__codelineno-9-17" name="__codelineno-9-17"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-9-18" name="__codelineno-9-18"></a><span class="p">}</span>
<a id="__codelineno-9-19" name="__codelineno-9-19"></a>
<a id="__codelineno-9-20" name="__codelineno-9-20"></a><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">DecrementCommand</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Command</span><span class="o">&lt;</span><span class="n">CommandType</span><span class="o">&gt;</span>
<a id="__codelineno-9-21" name="__codelineno-9-21"></a><span class="p">{</span>
<a id="__codelineno-9-22" name="__codelineno-9-22"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="n">CommandType</span><span class="w"> </span><span class="n">Tag</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">CommandType</span><span class="p">.</span><span class="n">Decrement</span><span class="p">;</span>
<a id="__codelineno-9-23" name="__codelineno-9-23"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">Value</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">init</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-9-24" name="__codelineno-9-24"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="nf">DecrementCommand</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="k">value</span><span class="p">)</span>
<a id="__codelineno-9-25" name="__codelineno-9-25"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-9-26" name="__codelineno-9-26"></a><span class="w">    </span><span class="n">Value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">value</span><span class="p">;</span>
<a id="__codelineno-9-27" name="__codelineno-9-27"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-9-28" name="__codelineno-9-28"></a><span class="p">}</span>
<a id="__codelineno-9-29" name="__codelineno-9-29"></a>
<a id="__codelineno-9-30" name="__codelineno-9-30"></a><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">ResetCommand</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Command</span><span class="o">&lt;</span><span class="n">CommandType</span><span class="o">&gt;</span>
<a id="__codelineno-9-31" name="__codelineno-9-31"></a><span class="p">{</span>
<a id="__codelineno-9-32" name="__codelineno-9-32"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="n">CommandType</span><span class="w"> </span><span class="n">Tag</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">CommandType</span><span class="p">.</span><span class="n">Reset</span><span class="p">;</span>
<a id="__codelineno-9-33" name="__codelineno-9-33"></a><span class="p">}</span>
<a id="__codelineno-9-34" name="__codelineno-9-34"></a>
<a id="__codelineno-9-35" name="__codelineno-9-35"></a><span class="k">public</span><span class="w"> </span><span class="k">sealed</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">QuitCommand</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Command</span><span class="o">&lt;</span><span class="n">CommandType</span><span class="o">&gt;</span>
<a id="__codelineno-9-36" name="__codelineno-9-36"></a><span class="p">{</span>
<a id="__codelineno-9-37" name="__codelineno-9-37"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="n">CommandType</span><span class="w"> </span><span class="n">Tag</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">CommandType</span><span class="p">.</span><span class="n">Quit</span><span class="p">;</span>
<a id="__codelineno-9-38" name="__codelineno-9-38"></a><span class="p">}</span>
<a id="__codelineno-9-39" name="__codelineno-9-39"></a>
<a id="__codelineno-9-40" name="__codelineno-9-40"></a><span class="k">public</span><span class="w"> </span><span class="k">sealed</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">UnknownCommand</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Command</span><span class="o">&lt;</span><span class="n">CommandType</span><span class="o">&gt;</span>
<a id="__codelineno-9-41" name="__codelineno-9-41"></a><span class="p">{</span>
<a id="__codelineno-9-42" name="__codelineno-9-42"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="n">CommandType</span><span class="w"> </span><span class="n">Tag</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">CommandType</span><span class="p">.</span><span class="n">Unknown</span><span class="p">;</span>
<a id="__codelineno-9-43" name="__codelineno-9-43"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Framework.cs</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-10-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-10-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-10-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-10-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-10-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-10-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-10-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-10-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-10-10">10</a></span>
<span class="normal"><a href="#__codelineno-10-11">11</a></span>
<span class="normal"><a href="#__codelineno-10-12">12</a></span>
<span class="normal"><a href="#__codelineno-10-13">13</a></span>
<span class="normal"><a href="#__codelineno-10-14">14</a></span>
<span class="normal"><a href="#__codelineno-10-15">15</a></span>
<span class="normal"><a href="#__codelineno-10-16">16</a></span>
<span class="normal"><a href="#__codelineno-10-17">17</a></span>
<span class="normal"><a href="#__codelineno-10-18">18</a></span>
<span class="normal"><a href="#__codelineno-10-19">19</a></span>
<span class="normal"><a href="#__codelineno-10-20">20</a></span>
<span class="normal"><a href="#__codelineno-10-21">21</a></span>
<span class="normal"><a href="#__codelineno-10-22">22</a></span>
<span class="normal"><a href="#__codelineno-10-23">23</a></span>
<span class="normal"><a href="#__codelineno-10-24">24</a></span>
<span class="normal"><a href="#__codelineno-10-25">25</a></span>
<span class="normal"><a href="#__codelineno-10-26">26</a></span>
<span class="normal"><a href="#__codelineno-10-27">27</a></span>
<span class="normal"><a href="#__codelineno-10-28">28</a></span>
<span class="normal"><a href="#__codelineno-10-29">29</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="k">public</span><span class="w"> </span><span class="k">abstract</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">Command</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Enum</span>
<a id="__codelineno-10-2" name="__codelineno-10-2"></a><span class="p">{</span>
<a id="__codelineno-10-3" name="__codelineno-10-3"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">abstract</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="n">Tag</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-10-4" name="__codelineno-10-4"></a><span class="p">}</span>
<a id="__codelineno-10-5" name="__codelineno-10-5"></a>
<a id="__codelineno-10-6" name="__codelineno-10-6"></a><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">Framework</span>
<a id="__codelineno-10-7" name="__codelineno-10-7"></a><span class="p">{</span>
<a id="__codelineno-10-8" name="__codelineno-10-8"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="n">Run</span><span class="o">&lt;</span><span class="n">TModel</span><span class="p">,</span><span class="w"> </span><span class="n">TCommandType</span><span class="o">&gt;</span><span class="p">(</span>
<a id="__codelineno-10-9" name="__codelineno-10-9"></a><span class="w">      </span><span class="n">Func</span><span class="o">&lt;</span><span class="n">TModel</span><span class="p">,</span><span class="w"> </span><span class="n">Command</span><span class="o">&lt;</span><span class="n">TCommandType</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">view</span><span class="p">,</span>
<a id="__codelineno-10-10" name="__codelineno-10-10"></a><span class="w">      </span><span class="n">Func</span><span class="o">&lt;</span><span class="n">TModel</span><span class="p">,</span><span class="w"> </span><span class="n">Command</span><span class="o">&lt;</span><span class="n">TCommandType</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">TModel</span><span class="o">&gt;</span><span class="w"> </span><span class="n">update</span><span class="p">,</span>
<a id="__codelineno-10-11" name="__codelineno-10-11"></a><span class="w">      </span><span class="n">TModel</span><span class="w"> </span><span class="n">model</span><span class="p">)</span>
<a id="__codelineno-10-12" name="__codelineno-10-12"></a><span class="w">  </span><span class="k">where</span><span class="w"> </span><span class="n">TCommandType</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Enum</span>
<a id="__codelineno-10-13" name="__codelineno-10-13"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-10-14" name="__codelineno-10-14"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">Enum</span><span class="p">.</span><span class="n">IsDefined</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">TCommandType</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;Quit&quot;</span><span class="p">))</span>
<a id="__codelineno-10-15" name="__codelineno-10-15"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-10-16" name="__codelineno-10-16"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">InvalidOperationException</span><span class="p">(</span><span class="s">&quot;Command must have a Quit option&quot;</span><span class="p">);</span>
<a id="__codelineno-10-17" name="__codelineno-10-17"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-10-18" name="__codelineno-10-18"></a><span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">quitCommand</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Enum</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">TCommandType</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;Quit&quot;</span><span class="p">);</span>
<a id="__codelineno-10-19" name="__codelineno-10-19"></a><span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">currentModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">model</span><span class="p">;</span>
<a id="__codelineno-10-20" name="__codelineno-10-20"></a><span class="w">    </span><span class="n">Console</span><span class="p">.</span><span class="n">Clear</span><span class="p">();</span>
<a id="__codelineno-10-21" name="__codelineno-10-21"></a><span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">view</span><span class="p">(</span><span class="n">currentModel</span><span class="p">);</span>
<a id="__codelineno-10-22" name="__codelineno-10-22"></a><span class="w">    </span><span class="k">do</span>
<a id="__codelineno-10-23" name="__codelineno-10-23"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-10-24" name="__codelineno-10-24"></a><span class="w">      </span><span class="n">currentModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">update</span><span class="p">(</span><span class="n">currentModel</span><span class="p">,</span><span class="w"> </span><span class="n">command</span><span class="p">);</span>
<a id="__codelineno-10-25" name="__codelineno-10-25"></a><span class="w">      </span><span class="n">Console</span><span class="p">.</span><span class="n">Clear</span><span class="p">();</span>
<a id="__codelineno-10-26" name="__codelineno-10-26"></a><span class="w">      </span><span class="n">command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">view</span><span class="p">(</span><span class="n">currentModel</span><span class="p">);</span>
<a id="__codelineno-10-27" name="__codelineno-10-27"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">command</span><span class="p">.</span><span class="n">Tag</span><span class="p">.</span><span class="n">Equals</span><span class="p">(</span><span class="n">quitCommand</span><span class="p">));</span>
<a id="__codelineno-10-28" name="__codelineno-10-28"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-10-29" name="__codelineno-10-29"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h3 id="conclusion"><a class="toclink" href="2025/12/01/reducing-bugs-by-using-the-model-view-update-pattern/#conclusion">Conclusion</a></h3>
<p>In this post, we built out a basic application using the Model View Update pattern that was first introduced by the Elm language. We also implemented a basic sum type, <code>Command</code>, using an abstract class that was then constrained to particular <code>CommandTypes</code>.</p>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/cameronpresley.png" alt="Cameron Presley">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2025-08-12 00:00:00+00:00">Aug 12, 2025</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="category/typescript/" class="md-meta__link">TypeScript</a>, 
              <a href="category/debugging/" class="md-meta__link">Debugging</a></li>
        
        
          
          <li class="md-meta__item">
            
              6 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="testing-non-deterministic-code-debugging-shuffle-with-property-based-testing"><a class="toclink" href="2025/08/12/testing-non-deterministic-code---debugging-shuffle-with-property-based-testing/">Testing Non Deterministic Code - Debugging Shuffle with Property Based Testing</a></h2>
<h3 id="background"><a class="toclink" href="2025/08/12/testing-non-deterministic-code---debugging-shuffle-with-property-based-testing/#background">Background</a></h3>
<p>Now that I've gotten a handle on my work situation, I've been focusing my time to complete work on my <a href="../courses/#learn-functional-typescript-by-building-blackjack">upcoming Functional Blackjack course</a>. I've gotten the business rules implemented so I've been playing some games to make sure everything is working the way I'd expect.</p>
<p>For example, here's what the UI looks like for when the game is dealt out.</p>
<p><img alt="Console output of a game of blackjack with a dealer and four players" src="https://softwarementorblog.blob.core.windows.net/images/shuffle-property-based-testing/working-setup.png" /></p>
<p>So far, so good. However, every now then, I'd see error messages like this one where I'd be trying to calculate the score of a null card.</p>
<p><img alt="Console output of a function failing because an object was null" src="https://softwarementorblog.blob.core.windows.net/images/shuffle-property-based-testing/busted-rank.png" /></p>
<p>Doing some digging, I discovered that when I was creating my player, they could have a null card!</p>
<p><img alt="Console output of a player object with a hand array property where one of the elements is null" src="https://softwarementorblog.blob.core.windows.net/images/shuffle-property-based-testing/busted-player-setup.png" /></p>
<p>What could be happening? I'm leveraging functional programming techniques (immutable data structures, pure functions for business rules). Given that it doesn't happen all the time, it must be in some of my side-effect code. Combine that thought with the fact the game would break upon start, I had an idea of what might be the cause.</p>
<h3 id="identifying-possible-problem"><a class="toclink" href="2025/08/12/testing-non-deterministic-code---debugging-shuffle-with-property-based-testing/#identifying-possible-problem">Identifying Possible Problem</a></h3>
<p>In order to create a player, we need to have an id (some arbitrary number) and two cards. These cards are coming from the deck, so let's take a deeper look at how that's being created.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-0-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-0-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-0-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="c1">// Deck type</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">Deck</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="w">  </span><span class="nx">tag</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;deck&quot;</span><span class="p">;</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="w">  </span><span class="nx">value</span><span class="o">:</span><span class="w"> </span><span class="kt">Card</span><span class="p">[];</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="p">};</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">create</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nx">Deck</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">cards</span><span class="o">:</span><span class="w"> </span><span class="kt">Card</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">r</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">getRanks</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">s</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">getSuits</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="w">      </span><span class="c1">// build up the card type</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">card</span><span class="o">:</span><span class="kt">Card</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="nx">rank</span><span class="o">:</span><span class="kt">r</span><span class="p">,</span><span class="w"> </span><span class="nx">suit</span><span class="o">:</span><span class="kt">s</span><span class="p">};</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="w">      </span><span class="c1">// add it to the list</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="w">      </span><span class="nx">cards</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">card</span><span class="p">);</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="w">  </span><span class="c1">// return the deck shuffled</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">tag</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;deck&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="o">:</span><span class="w"> </span><span class="kt">shuffle</span><span class="p">(</span><span class="nx">cards</span><span class="p">)</span><span class="w"> </span><span class="p">};</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>So far, so good. the first section is building all possible combinations of <code>Rank</code>/<code>Suit</code> to model the deck. The only thing that is suspect is the <code>shuffle</code> function, so let's take a look at it.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1">1</a></span>
<span class="normal"><a href="#__codelineno-1-2">2</a></span>
<span class="normal"><a href="#__codelineno-1-3">3</a></span>
<span class="normal"><a href="#__codelineno-1-4">4</a></span>
<span class="normal"><a href="#__codelineno-1-5">5</a></span>
<span class="normal"><a href="#__codelineno-1-6">6</a></span>
<span class="normal"><a href="#__codelineno-1-7">7</a></span>
<span class="normal"><a href="#__codelineno-1-8">8</a></span>
<span class="normal"><a href="#__codelineno-1-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="c1">// Implementation of Fisher-Yates algorithm (see https://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle#Modern_method)</span>
<a id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">shuffle</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">ts</span><span class="o">:</span><span class="w"> </span><span class="kt">T</span><span class="p">[])</span><span class="o">:</span><span class="w"> </span><span class="nx">T</span><span class="p">[]</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[...</span><span class="nx">ts</span><span class="p">];</span>
<a id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">copy</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">-</span><span class="mf">1</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">--</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-1-5" name="__codelineno-1-5"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">i</span><span class="p">);</span>
<a id="__codelineno-1-6" name="__codelineno-1-6"></a><span class="w">    </span><span class="p">[</span><span class="nx">copy</span><span class="p">[</span><span class="nx">j</span><span class="p">],</span><span class="w"> </span><span class="nx">copy</span><span class="p">[</span><span class="nx">i</span><span class="p">]]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="nx">copy</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span><span class="w"> </span><span class="nx">copy</span><span class="p">[</span><span class="nx">j</span><span class="p">]];</span>
<a id="__codelineno-1-7" name="__codelineno-1-7"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-1-8" name="__codelineno-1-8"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">copy</span><span class="p">;</span>
<a id="__codelineno-1-9" name="__codelineno-1-9"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Hmm, I don't see anything obviously wrong, however, I've got a hunch this is the problem because it's leveraging <code>Math.random()</code> which would explain why sometimes it works and sometimes it doesn't. Since <code>Math.random()</code> looks at the system clock, this isn't a pure function, so <code>shuffle</code> can't be a pure function (which makes sense, if <code>shuffle</code> always gave the same output for the same input, then we'd clean house, right :) )</p>
<p>My first instinct is to write some unit tests on this function. But how would you unit test <code>shuffle</code>? You could write a test case easily enough for an empty list and a list of one item, however, things get messy once you try to work around <code>Math.random</code>.</p>
<p>Let's try a different approach, using a <a href="https://en.wikipedia.org/wiki/Software_testing#Property_testing">property testing</a> approach.</p>
<h3 id="verifying-the-problem-using-property-based-testing"><a class="toclink" href="2025/08/12/testing-non-deterministic-code---debugging-shuffle-with-property-based-testing/#verifying-the-problem-using-property-based-testing">Verifying the Problem Using Property Based Testing</a></h3>
<p>Instead of thinking in concrete terms (given this specific input, I should get this specific output), let's think about what properties a properly shuffled array would have.</p>
<ol>
<li>Should maintain length (i.e. if we shuffle an array of 10 elements, we should have 10 elements back)</li>
<li>Should contain all original items (i.e. if we shuffle the numbers 1-10, then we shouldn't have an 11 or null in the array)</li>
</ol>
<h4 id="implementing-maintains-length-property"><a class="toclink" href="2025/08/12/testing-non-deterministic-code---debugging-shuffle-with-property-based-testing/#implementing-maintains-length-property">Implementing Maintains Length Property</a></h4>
<p>Using the <a href="https://www.npmjs.com/package/fast-check">fast-check library</a>, we can start modeling the first property:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-2-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-2-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-2-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-2-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-2-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-2-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-2-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-2-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-2-10">10</a></span>
<span class="normal"><a href="#__codelineno-2-11">11</a></span>
<span class="normal"><a href="#__codelineno-2-12">12</a></span>
<span class="normal"><a href="#__codelineno-2-13">13</a></span>
<span class="normal"><a href="#__codelineno-2-14">14</a></span>
<span class="normal"><a href="#__codelineno-2-15">15</a></span>
<span class="normal"><a href="#__codelineno-2-16">16</a></span>
<span class="normal"><a href="#__codelineno-2-17">17</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="k">import</span><span class="w"> </span><span class="nx">fc</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;fast-check&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// brining in the fast-check library</span>
<a id="__codelineno-2-2" name="__codelineno-2-2"></a>
<a id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="nx">describe</span><span class="p">(</span><span class="s2">&quot;shuffle&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-2-4" name="__codelineno-2-4"></a><span class="w">    </span><span class="nx">it</span><span class="p">(</span><span class="s2">&quot;should maintain length&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-2-5" name="__codelineno-2-5"></a>
<a id="__codelineno-2-6" name="__codelineno-2-6"></a><span class="w">      </span><span class="c1">// Fast Check assert</span>
<a id="__codelineno-2-7" name="__codelineno-2-7"></a><span class="w">      </span><span class="nx">fc</span><span class="p">.</span><span class="nx">assert</span><span class="p">(</span>
<a id="__codelineno-2-8" name="__codelineno-2-8"></a><span class="w">        </span><span class="c1">// that for any array of any elements, </span>
<a id="__codelineno-2-9" name="__codelineno-2-9"></a><span class="w">        </span><span class="nx">fc</span><span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="nx">fc</span><span class="p">.</span><span class="nx">array</span><span class="p">(</span><span class="nx">fc</span><span class="p">.</span><span class="nx">anything</span><span class="p">()),</span><span class="w"> </span><span class="p">(</span><span class="nx">elements</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">[])</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-2-10" name="__codelineno-2-10"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">shuffle</span><span class="p">(</span><span class="nx">elements</span><span class="p">);</span>
<a id="__codelineno-2-11" name="__codelineno-2-11"></a>
<a id="__codelineno-2-12" name="__codelineno-2-12"></a><span class="w">          </span><span class="c1">// the length of the shuffled result should be the same length as elements</span>
<a id="__codelineno-2-13" name="__codelineno-2-13"></a><span class="w">          </span><span class="nx">expect</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">length</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="nx">elements</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
<a id="__codelineno-2-14" name="__codelineno-2-14"></a><span class="w">        </span><span class="p">})</span>
<a id="__codelineno-2-15" name="__codelineno-2-15"></a><span class="w">      </span><span class="p">);</span>
<a id="__codelineno-2-16" name="__codelineno-2-16"></a><span class="w">    </span><span class="p">});</span>
<a id="__codelineno-2-17" name="__codelineno-2-17"></a><span class="p">});</span>
</code></pre></div></td></tr></table></div>
<p>Seems simple enough, let's see what we get:</p>
<p><img alt="Failing test where when given the example of an array with a single element of an empty array, it fails" src="https://softwarementorblog.blob.core.windows.net/images/shuffle-property-based-testing/failed-maintain-length-test.png" /></p>
<p>Whelp, that was easy enough, let's tweak our shuffle function to make that property pass:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">1</a></span>
<span class="normal"><a href="#__codelineno-3-2">2</a></span>
<span class="normal"><a href="#__codelineno-3-3">3</a></span>
<span class="normal"><a href="#__codelineno-3-4">4</a></span>
<span class="normal"><a href="#__codelineno-3-5">5</a></span>
<span class="normal"><a href="#__codelineno-3-6">6</a></span>
<span class="normal"><a href="#__codelineno-3-7">7</a></span>
<span class="normal"><a href="#__codelineno-3-8">8</a></span>
<span class="normal"><a href="#__codelineno-3-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">shuffle</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">ts</span><span class="o">:</span><span class="w"> </span><span class="kt">T</span><span class="p">[])</span><span class="o">:</span><span class="w"> </span><span class="nx">T</span><span class="p">[]</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[...</span><span class="nx">ts</span><span class="p">];</span>
<a id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="w">  </span><span class="c1">// note that we tweaked i to start from length-1 instead of length</span>
<a id="__codelineno-3-4" name="__codelineno-3-4"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">copy</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">-</span><span class="mf">1</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">--</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-3-5" name="__codelineno-3-5"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">i</span><span class="p">);</span>
<a id="__codelineno-3-6" name="__codelineno-3-6"></a><span class="w">    </span><span class="p">[</span><span class="nx">copy</span><span class="p">[</span><span class="nx">j</span><span class="p">],</span><span class="w"> </span><span class="nx">copy</span><span class="p">[</span><span class="nx">i</span><span class="p">]]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="nx">copy</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span><span class="w"> </span><span class="nx">copy</span><span class="p">[</span><span class="nx">j</span><span class="p">]];</span>
<a id="__codelineno-3-7" name="__codelineno-3-7"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-3-8" name="__codelineno-3-8"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">copy</span><span class="p">;</span>
<a id="__codelineno-3-9" name="__codelineno-3-9"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Running the test suite again, we get a passing run, hooray!</p>
<h4 id="implementing-must-have-all-original-items-property"><a class="toclink" href="2025/08/12/testing-non-deterministic-code---debugging-shuffle-with-property-based-testing/#implementing-must-have-all-original-items-property">Implementing Must Have All Original Items Property</a></h4>
<p>With the first property written up, let's take a shot at writing the second property. For this test, we need to keep track of the original elements before they were shuffled up. </p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-4-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-4-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-4-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-4-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-4-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-4-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-4-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-4-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-4-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="nx">it</span><span class="p">(</span><span class="s2">&quot;should have all original elements&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="w">  </span><span class="nx">fc</span><span class="p">.</span><span class="nx">assert</span><span class="p">(</span>
<a id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="w">    </span><span class="nx">fc</span><span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="nx">fc</span><span class="p">.</span><span class="nx">array</span><span class="p">(</span><span class="nx">fc</span><span class="p">.</span><span class="nx">anything</span><span class="p">()),</span><span class="w"> </span><span class="p">(</span><span class="nx">elements</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">[])</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="w">      </span><span class="c1">// keeping the items in array called original</span>
<a id="__codelineno-4-5" name="__codelineno-4-5"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">original</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[...</span><span class="nx">elements</span><span class="p">];</span>
<a id="__codelineno-4-6" name="__codelineno-4-6"></a>
<a id="__codelineno-4-7" name="__codelineno-4-7"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">shuffle</span><span class="p">(</span><span class="nx">elements</span><span class="p">);</span>
<a id="__codelineno-4-8" name="__codelineno-4-8"></a><span class="w">    </span><span class="p">})</span>
<a id="__codelineno-4-9" name="__codelineno-4-9"></a><span class="w">  </span><span class="p">);</span>
<a id="__codelineno-4-10" name="__codelineno-4-10"></a><span class="p">});</span>
</code></pre></div></td></tr></table></div>
<p>Next, we need to go through each element of <code>result</code> and remove it from the <code>original</code> array. If we find an item that can't be removed, we should fail the test. Otherwise, we can remove it from <code>original</code>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-5-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-5-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-5-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-5-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-5-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-5-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-5-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-5-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-5-10">10</a></span>
<span class="normal"><a href="#__codelineno-5-11">11</a></span>
<span class="normal"><a href="#__codelineno-5-12">12</a></span>
<span class="normal"><a href="#__codelineno-5-13">13</a></span>
<span class="normal"><a href="#__codelineno-5-14">14</a></span>
<span class="normal"><a href="#__codelineno-5-15">15</a></span>
<span class="normal"><a href="#__codelineno-5-16">16</a></span>
<span class="normal"><a href="#__codelineno-5-17">17</a></span>
<span class="normal"><a href="#__codelineno-5-18">18</a></span>
<span class="normal"><a href="#__codelineno-5-19">19</a></span>
<span class="normal"><a href="#__codelineno-5-20">20</a></span>
<span class="normal"><a href="#__codelineno-5-21">21</a></span>
<span class="normal"><a href="#__codelineno-5-22">22</a></span>
<span class="normal"><a href="#__codelineno-5-23">23</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="nx">it</span><span class="p">(</span><span class="s2">&quot;should have all original elements&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="w">  </span><span class="nx">fc</span><span class="p">.</span><span class="nx">assert</span><span class="p">(</span>
<a id="__codelineno-5-3" name="__codelineno-5-3"></a><span class="w">    </span><span class="nx">fc</span><span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="nx">fc</span><span class="p">.</span><span class="nx">array</span><span class="p">(</span><span class="nx">fc</span><span class="p">.</span><span class="nx">anything</span><span class="p">()),</span><span class="w"> </span><span class="p">(</span><span class="nx">elements</span><span class="o">:</span><span class="w"> </span><span class="kt">any</span><span class="p">[])</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-5-4" name="__codelineno-5-4"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">original</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[...</span><span class="nx">elements</span><span class="p">];</span>
<a id="__codelineno-5-5" name="__codelineno-5-5"></a>
<a id="__codelineno-5-6" name="__codelineno-5-6"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">shuffle</span><span class="p">(</span><span class="nx">elements</span><span class="p">);</span>
<a id="__codelineno-5-7" name="__codelineno-5-7"></a>
<a id="__codelineno-5-8" name="__codelineno-5-8"></a><span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">result</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-5-9" name="__codelineno-5-9"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">foundIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">original</span><span class="p">.</span><span class="nx">findIndex</span><span class="p">((</span><span class="nx">y</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">y</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">x</span><span class="p">);</span>
<a id="__codelineno-5-10" name="__codelineno-5-10"></a><span class="w">        </span><span class="c1">// If we found the item</span>
<a id="__codelineno-5-11" name="__codelineno-5-11"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">foundIndex</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="o">-</span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-5-12" name="__codelineno-5-12"></a><span class="w">          </span><span class="c1">// let&#39;s remove it</span>
<a id="__codelineno-5-13" name="__codelineno-5-13"></a><span class="w">          </span><span class="nx">original</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">foundIndex</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">);</span>
<a id="__codelineno-5-14" name="__codelineno-5-14"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-5-15" name="__codelineno-5-15"></a><span class="w">          </span><span class="c1">// otherwise we found an item that shouldn&#39;t have been there, </span>
<a id="__codelineno-5-16" name="__codelineno-5-16"></a><span class="w">          </span><span class="c1">// so let&#39;s log the failure and fail the test</span>
<a id="__codelineno-5-17" name="__codelineno-5-17"></a><span class="w">          </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;couldn&#39;t find &quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;in original list&quot;</span><span class="p">);</span>
<a id="__codelineno-5-18" name="__codelineno-5-18"></a><span class="w">          </span><span class="nx">expect</span><span class="p">(</span><span class="kc">true</span><span class="p">).</span><span class="nx">toBeFalsy</span><span class="p">();</span>
<a id="__codelineno-5-19" name="__codelineno-5-19"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-5-20" name="__codelineno-5-20"></a><span class="w">      </span><span class="p">}</span>
<a id="__codelineno-5-21" name="__codelineno-5-21"></a><span class="w">    </span><span class="p">})</span>
<a id="__codelineno-5-22" name="__codelineno-5-22"></a><span class="w">  </span><span class="p">);</span>
<a id="__codelineno-5-23" name="__codelineno-5-23"></a><span class="p">});</span>
</code></pre></div></td></tr></table></div>
<p><em>Note: Astute readers might have noticed we're not asserting that the original array is empty after the for loop. Since we have the test that verifies that we're maintaining length, that check is not needed here.</em></p>
<p>Running the test suite, it looks like everything is passing. So to make sure that our test would catch issues, let's inject a bug into the shuffle algorithm!</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-6-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-6-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-6-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-6-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-6-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-6-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-6-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-6-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-6-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">shuffle</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">ts</span><span class="o">:</span><span class="w"> </span><span class="kt">T</span><span class="p">[])</span><span class="o">:</span><span class="w"> </span><span class="nx">T</span><span class="p">[]</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[...</span><span class="nx">ts</span><span class="p">];</span>
<a id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">copy</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">-</span><span class="mf">1</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">--</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-4" name="__codelineno-6-4"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">i</span><span class="p">);</span>
<a id="__codelineno-6-5" name="__codelineno-6-5"></a><span class="w">    </span><span class="p">[</span><span class="nx">copy</span><span class="p">[</span><span class="nx">k</span><span class="p">],</span><span class="w"> </span><span class="nx">copy</span><span class="p">[</span><span class="nx">i</span><span class="p">]]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="nx">copy</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span><span class="w"> </span><span class="nx">copy</span><span class="p">[</span><span class="nx">k</span><span class="p">]];</span>
<a id="__codelineno-6-6" name="__codelineno-6-6"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-6-7" name="__codelineno-6-7"></a><span class="w">  </span><span class="c1">// casting 2 as any makes TypeScript cool with this code</span>
<a id="__codelineno-6-8" name="__codelineno-6-8"></a><span class="w">  </span><span class="nx">copy</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="mf">2</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">any</span><span class="p">);</span>
<a id="__codelineno-6-9" name="__codelineno-6-9"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">copy</span><span class="p">;</span>
<a id="__codelineno-6-10" name="__codelineno-6-10"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>If we run the test now, we get the following:</p>
<p><img alt="console log message stating that 2 was not in the original list" src="https://softwarementorblog.blob.core.windows.net/images/shuffle-property-based-testing/failed-original-items-with-two.png" /></p>
<p>Based on the tests and the code change that we made, I'm feeling confident that my bug was found and has been solved.</p>
<h3 id="wrapping-up"><a class="toclink" href="2025/08/12/testing-non-deterministic-code---debugging-shuffle-with-property-based-testing/#wrapping-up">Wrapping Up</a></h3>
<p>In this post, we looked at an issue I was dealing with in my codebase (a mysterious introduction of null). From there, we were able to narrow down to a possible culprit, the <em>shuffle</em> function as it's not a pure function. Using <a href="https://www.npmjs.com/package/fast-check">fast check</a> and property testing principals we were able to derive two properties that shuffle should follow and then encode that logic.</p>
<p>The next time you find yourself needing to write tests and are struggling with good inputs, try thinking about properties instead!</p>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/cameronpresley.png" alt="Cameron Presley">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2025-08-05 00:00:00+00:00">Aug 5, 2025</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="category/typescript/" class="md-meta__link">TypeScript</a></li>
        
        
          
          <li class="md-meta__item">
            
              10 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="running-single-file-typescript-in-59-with-ts-node-and-tsx"><a class="toclink" href="2025/08/05/running-single-file-typescript-in-59-with-ts-node-and-tsx/">Running Single File TypeScript in 5.9 with ts-node and tsx</a></h2>
<p>On July 31, 2025, Microsoft released the next version of TypeScript, v5.9 (<a href="https://devblogs.microsoft.com/typescript/announcing-typescript-5-9/">click here for full release notes</a>)</p>
<p>One of the changes that caught my attention is what the default <code>tsconfig.json</code> looks like when you leverage <code>npx tsc --init</code>.</p>
<p>Before 5.9, when you ran <code>npx tsc --init</code>, you would get a default <code>tsconfig.json</code> that had <em>all</em> the options outlined with most of them commented, but you could see what their default values would be.</p>
<h3 id="what-changed"><a class="toclink" href="2025/08/05/running-single-file-typescript-in-59-with-ts-node-and-tsx/#what-changed">What Changed?</a></h3>
<p>In this release, two changes were made to the <code>tsconfig.json</code></p>
<ul>
<li>Instead of all the options being shown, now a subset of commonly tweaked settings are generated.</li>
<li>There's now a section of <em>recommended</em> settings that have values set.</li>
</ul>
<p><strong>Before</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">  1</a></span>
<span class="normal"><a href="#__codelineno-0-2">  2</a></span>
<span class="normal"><a href="#__codelineno-0-3">  3</a></span>
<span class="normal"><a href="#__codelineno-0-4">  4</a></span>
<span class="normal"><a href="#__codelineno-0-5">  5</a></span>
<span class="normal"><a href="#__codelineno-0-6">  6</a></span>
<span class="normal"><a href="#__codelineno-0-7">  7</a></span>
<span class="normal"><a href="#__codelineno-0-8">  8</a></span>
<span class="normal"><a href="#__codelineno-0-9">  9</a></span>
<span class="normal"><a href="#__codelineno-0-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-0-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-0-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-0-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-0-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-0-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-0-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-0-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-0-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-0-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-0-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-0-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-0-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-0-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-0-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-0-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-0-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-0-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-0-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-0-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-0-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-0-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="p">{</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="w">  </span><span class="nt">&quot;compilerOptions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="w">    </span><span class="cm">/* Visit https://aka.ms/tsconfig to read more about this file */</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="w">    </span><span class="cm">/* Projects */</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="w">    </span><span class="c1">// &quot;incremental&quot;: true,                              /* Save .tsbuildinfo files to allow for incremental compilation of projects. */</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="w">    </span><span class="c1">// &quot;composite&quot;: true,                                /* Enable constraints that allow a TypeScript project to be used with project references. */</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="w">    </span><span class="c1">// &quot;tsBuildInfoFile&quot;: &quot;./.tsbuildinfo&quot;,              /* Specify the path to .tsbuildinfo incremental compilation file. */</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="w">    </span><span class="c1">// &quot;disableSourceOfProjectReferenceRedirect&quot;: true,  /* Disable preferring source files instead of declaration files when referencing composite projects. */</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="w">    </span><span class="c1">// &quot;disableSolutionSearching&quot;: true,                 /* Opt a project out of multi-project reference checking when editing. */</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="w">    </span><span class="c1">// &quot;disableReferencedProjectLoad&quot;: true,             /* Reduce the number of projects loaded automatically by TypeScript. */</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="w">    </span><span class="cm">/* Language and Environment */</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="w">    </span><span class="nt">&quot;target&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;es2016&quot;</span><span class="p">,</span><span class="w">                                  </span><span class="cm">/* Set the JavaScript language version for emitted JavaScript and include compatible library declarations. */</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="w">    </span><span class="c1">// &quot;lib&quot;: [],                                        /* Specify a set of bundled library declaration files that describe the target runtime environment. */</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="w">    </span><span class="c1">// &quot;jsx&quot;: &quot;preserve&quot;,                                /* Specify what JSX code is generated. */</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="w">    </span><span class="c1">// &quot;libReplacement&quot;: true,                           /* Enable lib replacement. */</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="w">    </span><span class="c1">// &quot;experimentalDecorators&quot;: true,                   /* Enable experimental support for legacy experimental decorators. */</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="w">    </span><span class="c1">// &quot;emitDecoratorMetadata&quot;: true,                    /* Emit design-type metadata for decorated declarations in source files. */</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="w">    </span><span class="c1">// &quot;jsxFactory&quot;: &quot;&quot;,                                 /* Specify the JSX factory function used when targeting React JSX emit, e.g. &#39;React.createElement&#39; or &#39;h&#39;. */</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="w">    </span><span class="c1">// &quot;jsxFragmentFactory&quot;: &quot;&quot;,                         /* Specify the JSX Fragment reference used for fragments when targeting React JSX emit e.g. &#39;React.Fragment&#39; or &#39;Fragment&#39;. */</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="w">    </span><span class="c1">// &quot;jsxImportSource&quot;: &quot;&quot;,                            /* Specify module specifier used to import the JSX factory functions when using &#39;jsx: react-jsx*&#39;. */</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="w">    </span><span class="c1">// &quot;reactNamespace&quot;: &quot;&quot;,                             /* Specify the object invoked for &#39;createElement&#39;. This only applies when targeting &#39;react&#39; JSX emit. */</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="w">    </span><span class="c1">// &quot;noLib&quot;: true,                                    /* Disable including any library files, including the default lib.d.ts. */</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="w">    </span><span class="c1">// &quot;useDefineForClassFields&quot;: true,                  /* Emit ECMAScript-standard-compliant class fields. */</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="w">    </span><span class="c1">// &quot;moduleDetection&quot;: &quot;auto&quot;,                        /* Control what method is used to detect module-format JS files. */</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="w">    </span><span class="cm">/* Modules */</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;commonjs&quot;</span><span class="p">,</span><span class="w">                                </span><span class="cm">/* Specify what module code is generated. */</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="w">    </span><span class="c1">// &quot;rootDir&quot;: &quot;./&quot;,                                  /* Specify the root folder within your source files. */</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="w">    </span><span class="c1">// &quot;moduleResolution&quot;: &quot;node10&quot;,                     /* Specify how TypeScript looks up a file from a given module specifier. */</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="w">    </span><span class="c1">// &quot;baseUrl&quot;: &quot;./&quot;,                                  /* Specify the base directory to resolve non-relative module names. */</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="w">    </span><span class="c1">// &quot;paths&quot;: {},                                      /* Specify a set of entries that re-map imports to additional lookup locations. */</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="w">    </span><span class="c1">// &quot;rootDirs&quot;: [],                                   /* Allow multiple folders to be treated as one when resolving modules. */</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="w">    </span><span class="c1">// &quot;typeRoots&quot;: [],                                  /* Specify multiple folders that act like &#39;./node_modules/@types&#39;. */</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="w">    </span><span class="c1">// &quot;types&quot;: [],                                      /* Specify type package names to be included without being referenced in a source file. */</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="w">    </span><span class="c1">// &quot;allowUmdGlobalAccess&quot;: true,                     /* Allow accessing UMD globals from modules. */</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="w">    </span><span class="c1">// &quot;moduleSuffixes&quot;: [],                             /* List of file name suffixes to search when resolving a module. */</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="w">    </span><span class="c1">// &quot;allowImportingTsExtensions&quot;: true,               /* Allow imports to include TypeScript file extensions. Requires &#39;--moduleResolution bundler&#39; and either &#39;--noEmit&#39; or &#39;--emitDeclarationOnly&#39; to be set. */</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="w">    </span><span class="c1">// &quot;rewriteRelativeImportExtensions&quot;: true,          /* Rewrite &#39;.ts&#39;, &#39;.tsx&#39;, &#39;.mts&#39;, and &#39;.cts&#39; file extensions in relative import paths to their JavaScript equivalent in output files. */</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="w">    </span><span class="c1">// &quot;resolvePackageJsonExports&quot;: true,                /* Use the package.json &#39;exports&#39; field when resolving package imports. */</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="w">    </span><span class="c1">// &quot;resolvePackageJsonImports&quot;: true,                /* Use the package.json &#39;imports&#39; field when resolving imports. */</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="w">    </span><span class="c1">// &quot;customConditions&quot;: [],                           /* Conditions to set in addition to the resolver-specific defaults when resolving imports. */</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="w">    </span><span class="c1">// &quot;noUncheckedSideEffectImports&quot;: true,             /* Check side effect imports. */</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="w">    </span><span class="c1">// &quot;resolveJsonModule&quot;: true,                        /* Enable importing .json files. */</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="w">    </span><span class="c1">// &quot;allowArbitraryExtensions&quot;: true,                 /* Enable importing files with any extension, provided a declaration file is present. */</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="w">    </span><span class="c1">// &quot;noResolve&quot;: true,                                /* Disallow &#39;import&#39;s, &#39;require&#39;s or &#39;&lt;reference&gt;&#39;s from expanding the number of files TypeScript should add to a project. */</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="w">    </span><span class="cm">/* JavaScript Support */</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="w">    </span><span class="c1">// &quot;allowJs&quot;: true,                                  /* Allow JavaScript files to be a part of your program. Use the &#39;checkJS&#39; option to get errors from these files. */</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="w">    </span><span class="c1">// &quot;checkJs&quot;: true,                                  /* Enable error reporting in type-checked JavaScript files. */</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="w">    </span><span class="c1">// &quot;maxNodeModuleJsDepth&quot;: 1,                        /* Specify the maximum folder depth used for checking JavaScript files from &#39;node_modules&#39;. Only applicable with &#39;allowJs&#39;. */</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="w">    </span><span class="cm">/* Emit */</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="w">    </span><span class="c1">// &quot;declaration&quot;: true,                              /* Generate .d.ts files from TypeScript and JavaScript files in your project. */</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="w">    </span><span class="c1">// &quot;declarationMap&quot;: true,                           /* Create sourcemaps for d.ts files. */</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="w">    </span><span class="c1">// &quot;emitDeclarationOnly&quot;: true,                      /* Only output d.ts files and not JavaScript files. */</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="w">    </span><span class="c1">// &quot;sourceMap&quot;: true,                                /* Create source map files for emitted JavaScript files. */</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="w">    </span><span class="c1">// &quot;inlineSourceMap&quot;: true,                          /* Include sourcemap files inside the emitted JavaScript. */</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="w">    </span><span class="c1">// &quot;noEmit&quot;: true,                                   /* Disable emitting files from a compilation. */</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="w">    </span><span class="c1">// &quot;outFile&quot;: &quot;./&quot;,                                  /* Specify a file that bundles all outputs into one JavaScript file. If &#39;declaration&#39; is true, also designates a file that bundles all .d.ts output. */</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="w">    </span><span class="c1">// &quot;outDir&quot;: &quot;./&quot;,                                   /* Specify an output folder for all emitted files. */</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="w">    </span><span class="c1">// &quot;removeComments&quot;: true,                           /* Disable emitting comments. */</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="w">    </span><span class="c1">// &quot;importHelpers&quot;: true,                            /* Allow importing helper functions from tslib once per project, instead of including them per-file. */</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="w">    </span><span class="c1">// &quot;downlevelIteration&quot;: true,                       /* Emit more compliant, but verbose and less performant JavaScript for iteration. */</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="w">    </span><span class="c1">// &quot;sourceRoot&quot;: &quot;&quot;,                                 /* Specify the root path for debuggers to find the reference source code. */</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="w">    </span><span class="c1">// &quot;mapRoot&quot;: &quot;&quot;,                                    /* Specify the location where debugger should locate map files instead of generated locations. */</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="w">    </span><span class="c1">// &quot;inlineSources&quot;: true,                            /* Include source code in the sourcemaps inside the emitted JavaScript. */</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="w">    </span><span class="c1">// &quot;emitBOM&quot;: true,                                  /* Emit a UTF-8 Byte Order Mark (BOM) in the beginning of output files. */</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="w">    </span><span class="c1">// &quot;newLine&quot;: &quot;crlf&quot;,                                /* Set the newline character for emitting files. */</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="w">    </span><span class="c1">// &quot;stripInternal&quot;: true,                            /* Disable emitting declarations that have &#39;@internal&#39; in their JSDoc comments. */</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="w">    </span><span class="c1">// &quot;noEmitHelpers&quot;: true,                            /* Disable generating custom helper functions like &#39;__extends&#39; in compiled output. */</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="w">    </span><span class="c1">// &quot;noEmitOnError&quot;: true,                            /* Disable emitting files if any type checking errors are reported. */</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="w">    </span><span class="c1">// &quot;preserveConstEnums&quot;: true,                       /* Disable erasing &#39;const enum&#39; declarations in generated code. */</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="w">    </span><span class="c1">// &quot;declarationDir&quot;: &quot;./&quot;,                           /* Specify the output directory for generated declaration files. */</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="w">    </span><span class="cm">/* Interop Constraints */</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="w">    </span><span class="c1">// &quot;isolatedModules&quot;: true,                          /* Ensure that each file can be safely transpiled without relying on other imports. */</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="w">    </span><span class="c1">// &quot;verbatimModuleSyntax&quot;: true,                     /* Do not transform or elide any imports or exports not marked as type-only, ensuring they are written in the output file&#39;s format based on the &#39;module&#39; setting. */</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="w">    </span><span class="c1">// &quot;isolatedDeclarations&quot;: true,                     /* Require sufficient annotation on exports so other tools can trivially generate declaration files. */</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="w">    </span><span class="c1">// &quot;erasableSyntaxOnly&quot;: true,                       /* Do not allow runtime constructs that are not part of ECMAScript. */</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="w">    </span><span class="c1">// &quot;allowSyntheticDefaultImports&quot;: true,             /* Allow &#39;import x from y&#39; when a module doesn&#39;t have a default export. */</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="w">    </span><span class="nt">&quot;esModuleInterop&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">                             </span><span class="cm">/* Emit additional JavaScript to ease support for importing CommonJS modules. This enables &#39;allowSyntheticDefaultImports&#39; for type compatibility. */</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="w">    </span><span class="c1">// &quot;preserveSymlinks&quot;: true,                         /* Disable resolving symlinks to their realpath. This correlates to the same flag in node. */</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="w">    </span><span class="nt">&quot;forceConsistentCasingInFileNames&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">            </span><span class="cm">/* Ensure that casing is correct in imports. */</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="w">    </span><span class="cm">/* Type Checking */</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="w">    </span><span class="nt">&quot;strict&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">                                      </span><span class="cm">/* Enable all strict type-checking options. */</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="w">    </span><span class="c1">// &quot;noImplicitAny&quot;: true,                            /* Enable error reporting for expressions and declarations with an implied &#39;any&#39; type. */</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="w">    </span><span class="c1">// &quot;strictNullChecks&quot;: true,                         /* When type checking, take into account &#39;null&#39; and &#39;undefined&#39;. */</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="w">    </span><span class="c1">// &quot;strictFunctionTypes&quot;: true,                      /* When assigning functions, check to ensure parameters and the return values are subtype-compatible. */</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="w">    </span><span class="c1">// &quot;strictBindCallApply&quot;: true,                      /* Check that the arguments for &#39;bind&#39;, &#39;call&#39;, and &#39;apply&#39; methods match the original function. */</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="w">    </span><span class="c1">// &quot;strictPropertyInitialization&quot;: true,             /* Check for class properties that are declared but not set in the constructor. */</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="w">    </span><span class="c1">// &quot;strictBuiltinIteratorReturn&quot;: true,              /* Built-in iterators are instantiated with a &#39;TReturn&#39; type of &#39;undefined&#39; instead of &#39;any&#39;. */</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="w">    </span><span class="c1">// &quot;noImplicitThis&quot;: true,                           /* Enable error reporting when &#39;this&#39; is given the type &#39;any&#39;. */</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="w">    </span><span class="c1">// &quot;useUnknownInCatchVariables&quot;: true,               /* Default catch clause variables as &#39;unknown&#39; instead of &#39;any&#39;. */</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="w">    </span><span class="c1">// &quot;alwaysStrict&quot;: true,                             /* Ensure &#39;use strict&#39; is always emitted. */</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="w">    </span><span class="c1">// &quot;noUnusedLocals&quot;: true,                           /* Enable error reporting when local variables aren&#39;t read. */</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="w">    </span><span class="c1">// &quot;noUnusedParameters&quot;: true,                       /* Raise an error when a function parameter isn&#39;t read. */</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="w">    </span><span class="c1">// &quot;exactOptionalPropertyTypes&quot;: true,               /* Interpret optional property types as written, rather than adding &#39;undefined&#39;. */</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="w">    </span><span class="c1">// &quot;noImplicitReturns&quot;: true,                        /* Enable error reporting for codepaths that do not explicitly return in a function. */</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="w">    </span><span class="c1">// &quot;noFallthroughCasesInSwitch&quot;: true,               /* Enable error reporting for fallthrough cases in switch statements. */</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="w">    </span><span class="c1">// &quot;noUncheckedIndexedAccess&quot;: true,                 /* Add &#39;undefined&#39; to a type when accessed using an index. */</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="w">    </span><span class="c1">// &quot;noImplicitOverride&quot;: true,                       /* Ensure overriding members in derived classes are marked with an override modifier. */</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="w">    </span><span class="c1">// &quot;noPropertyAccessFromIndexSignature&quot;: true,       /* Enforces using indexed accessors for keys declared using an indexed type. */</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="w">    </span><span class="c1">// &quot;allowUnusedLabels&quot;: true,                        /* Disable error reporting for unused labels. */</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="w">    </span><span class="c1">// &quot;allowUnreachableCode&quot;: true,                     /* Disable error reporting for unreachable code. */</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="w">    </span><span class="cm">/* Completeness */</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="w">    </span><span class="c1">// &quot;skipDefaultLibCheck&quot;: true,                      /* Skip type checking .d.ts files that are included with TypeScript. */</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="w">    </span><span class="nt">&quot;skipLibCheck&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">                                 </span><span class="cm">/* Skip type checking all .d.ts files. */</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p><strong>After</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-1-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-1-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-1-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-1-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-1-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-1-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-1-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-1-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-1-10">10</a></span>
<span class="normal"><a href="#__codelineno-1-11">11</a></span>
<span class="normal"><a href="#__codelineno-1-12">12</a></span>
<span class="normal"><a href="#__codelineno-1-13">13</a></span>
<span class="normal"><a href="#__codelineno-1-14">14</a></span>
<span class="normal"><a href="#__codelineno-1-15">15</a></span>
<span class="normal"><a href="#__codelineno-1-16">16</a></span>
<span class="normal"><a href="#__codelineno-1-17">17</a></span>
<span class="normal"><a href="#__codelineno-1-18">18</a></span>
<span class="normal"><a href="#__codelineno-1-19">19</a></span>
<span class="normal"><a href="#__codelineno-1-20">20</a></span>
<span class="normal"><a href="#__codelineno-1-21">21</a></span>
<span class="normal"><a href="#__codelineno-1-22">22</a></span>
<span class="normal"><a href="#__codelineno-1-23">23</a></span>
<span class="normal"><a href="#__codelineno-1-24">24</a></span>
<span class="normal"><a href="#__codelineno-1-25">25</a></span>
<span class="normal"><a href="#__codelineno-1-26">26</a></span>
<span class="normal"><a href="#__codelineno-1-27">27</a></span>
<span class="normal"><a href="#__codelineno-1-28">28</a></span>
<span class="normal"><a href="#__codelineno-1-29">29</a></span>
<span class="normal"><a href="#__codelineno-1-30">30</a></span>
<span class="normal"><a href="#__codelineno-1-31">31</a></span>
<span class="normal"><a href="#__codelineno-1-32">32</a></span>
<span class="normal"><a href="#__codelineno-1-33">33</a></span>
<span class="normal"><a href="#__codelineno-1-34">34</a></span>
<span class="normal"><a href="#__codelineno-1-35">35</a></span>
<span class="normal"><a href="#__codelineno-1-36">36</a></span>
<span class="normal"><a href="#__codelineno-1-37">37</a></span>
<span class="normal"><a href="#__codelineno-1-38">38</a></span>
<span class="normal"><a href="#__codelineno-1-39">39</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="p">{</span>
<a id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="w">  </span><span class="c1">// Visit https://aka.ms/tsconfig to read more about this file</span>
<a id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="w">  </span><span class="nt">&quot;compilerOptions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="w">    </span><span class="c1">// File Layout</span>
<a id="__codelineno-1-5" name="__codelineno-1-5"></a><span class="w">    </span><span class="c1">// &quot;rootDir&quot;: &quot;./src&quot;,</span>
<a id="__codelineno-1-6" name="__codelineno-1-6"></a><span class="w">    </span><span class="c1">// &quot;outDir&quot;: &quot;./dist&quot;,</span>
<a id="__codelineno-1-7" name="__codelineno-1-7"></a><span class="w">    </span><span class="c1">// Environment Settings</span>
<a id="__codelineno-1-8" name="__codelineno-1-8"></a><span class="w">    </span><span class="c1">// See also https://aka.ms/tsconfig/module</span>
<a id="__codelineno-1-9" name="__codelineno-1-9"></a><span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;nodenext&quot;</span><span class="p">,</span>
<a id="__codelineno-1-10" name="__codelineno-1-10"></a><span class="w">    </span><span class="nt">&quot;target&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;esnext&quot;</span><span class="p">,</span>
<a id="__codelineno-1-11" name="__codelineno-1-11"></a><span class="w">    </span><span class="nt">&quot;types&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span>
<a id="__codelineno-1-12" name="__codelineno-1-12"></a><span class="w">    </span><span class="c1">// For nodejs:</span>
<a id="__codelineno-1-13" name="__codelineno-1-13"></a><span class="w">    </span><span class="c1">// &quot;lib&quot;: [&quot;esnext&quot;],</span>
<a id="__codelineno-1-14" name="__codelineno-1-14"></a><span class="w">    </span><span class="c1">// &quot;types&quot;: [&quot;node&quot;],</span>
<a id="__codelineno-1-15" name="__codelineno-1-15"></a><span class="w">    </span><span class="c1">// and npm install -D @types/node</span>
<a id="__codelineno-1-16" name="__codelineno-1-16"></a><span class="w">    </span><span class="c1">// Other Outputs</span>
<a id="__codelineno-1-17" name="__codelineno-1-17"></a><span class="w">    </span><span class="nt">&quot;sourceMap&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<a id="__codelineno-1-18" name="__codelineno-1-18"></a><span class="w">    </span><span class="nt">&quot;declaration&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<a id="__codelineno-1-19" name="__codelineno-1-19"></a><span class="w">    </span><span class="nt">&quot;declarationMap&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<a id="__codelineno-1-20" name="__codelineno-1-20"></a><span class="w">    </span><span class="c1">// Stricter Typechecking Options</span>
<a id="__codelineno-1-21" name="__codelineno-1-21"></a><span class="w">    </span><span class="nt">&quot;noUncheckedIndexedAccess&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<a id="__codelineno-1-22" name="__codelineno-1-22"></a><span class="w">    </span><span class="nt">&quot;exactOptionalPropertyTypes&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<a id="__codelineno-1-23" name="__codelineno-1-23"></a><span class="w">    </span><span class="c1">// Style Options</span>
<a id="__codelineno-1-24" name="__codelineno-1-24"></a><span class="w">    </span><span class="c1">// &quot;noImplicitReturns&quot;: true,</span>
<a id="__codelineno-1-25" name="__codelineno-1-25"></a><span class="w">    </span><span class="c1">// &quot;noImplicitOverride&quot;: true,</span>
<a id="__codelineno-1-26" name="__codelineno-1-26"></a><span class="w">    </span><span class="c1">// &quot;noUnusedLocals&quot;: true,</span>
<a id="__codelineno-1-27" name="__codelineno-1-27"></a><span class="w">    </span><span class="c1">// &quot;noUnusedParameters&quot;: true,</span>
<a id="__codelineno-1-28" name="__codelineno-1-28"></a><span class="w">    </span><span class="c1">// &quot;noFallthroughCasesInSwitch&quot;: true,</span>
<a id="__codelineno-1-29" name="__codelineno-1-29"></a><span class="w">    </span><span class="c1">// &quot;noPropertyAccessFromIndexSignature&quot;: true,</span>
<a id="__codelineno-1-30" name="__codelineno-1-30"></a><span class="w">    </span><span class="c1">// Recommended Options</span>
<a id="__codelineno-1-31" name="__codelineno-1-31"></a><span class="w">    </span><span class="nt">&quot;strict&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<a id="__codelineno-1-32" name="__codelineno-1-32"></a><span class="w">    </span><span class="nt">&quot;jsx&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;react-jsx&quot;</span><span class="p">,</span>
<a id="__codelineno-1-33" name="__codelineno-1-33"></a><span class="w">    </span><span class="c1">// &quot;verbatimModuleSyntax&quot;: true,</span>
<a id="__codelineno-1-34" name="__codelineno-1-34"></a><span class="w">    </span><span class="nt">&quot;isolatedModules&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<a id="__codelineno-1-35" name="__codelineno-1-35"></a><span class="w">    </span><span class="nt">&quot;noUncheckedSideEffectImports&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<a id="__codelineno-1-36" name="__codelineno-1-36"></a><span class="w">    </span><span class="nt">&quot;moduleDetection&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;force&quot;</span><span class="p">,</span>
<a id="__codelineno-1-37" name="__codelineno-1-37"></a><span class="w">    </span><span class="nt">&quot;skipLibCheck&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<a id="__codelineno-1-38" name="__codelineno-1-38"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-1-39" name="__codelineno-1-39"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>I'm still working through my thoughts on these changes. On one hand, I like the fact that the tsconfig.json is much smaller now and that you can use VS Code to get intellisense on the other options. On the other, if you don't know what you're looking for, it was nice to just see what the options were (with their default values).</p>
<h3 id="exports-not-working"><a class="toclink" href="2025/08/05/running-single-file-typescript-in-59-with-ts-node-and-tsx/#exports-not-working">Exports Not Working</a></h3>
<p>After setting up a <a href="2025/07/10/creating-a-node-project-with-typescript-and-jest-from-scratch/">new test application</a>, I tried running my app with <code>ts-node</code>, but got an error with one of my exports.</p>
<p><img alt="Error stating that you can't have a top level export when using CommonJS when you have 'verbatimModuleSyntax' set to true" src="https://softwarementorblog.blob.core.windows.net/images/typescript-59/image-1.png" /></p>
<p>Huh, I'm not familiar with that setting, let's <a href="https://www.typescriptlang.org/tsconfig/#verbatimModuleSyntax">look into it</a>.</p>
<p>At a high level, this setting makes sure that you're not accidentally mixing CommonJS syntax (i.e. using <code>require</code> to access dependencies) with ESModule syntax (i.e. using <code>import</code> to access dependencies).</p>
<h3 id="finding-the-root-cause"><a class="toclink" href="2025/08/05/running-single-file-typescript-in-59-with-ts-node-and-tsx/#finding-the-root-cause">Finding the Root Cause</a></h3>
<p>Weird, I'm not aware that I'm using CommonJS syntax anywhere, so I wonder where that's coming from. Doing some digging, I find out that there's a <code>type</code> setting you can specify for <code>package.json</code> with the following docs:</p>
<p><img alt="Help text from package.json that states if you don't have a type set, the default is commonjs" src="https://softwarementorblog.blob.core.windows.net/images/typescript-59/image-2.png" /></p>
<p>Ah, yeah, that will do it. So the issue is that by default, when you generate a package.json file, it doesn't create a <code>type</code> setting, so by default, it will be CommonJS.</p>
<p>However, with TypeScript 5.9, the default configuration is assuming ESModule and with the <code>verbatimModuleSyntax</code> being set to true, this breaks our initial set-up scripts.</p>
<h3 id="migrating-to-esmodule"><a class="toclink" href="2025/08/05/running-single-file-typescript-in-59-with-ts-node-and-tsx/#migrating-to-esmodule">Migrating to ESModule</a></h3>
<p>Given the docs, the first thing I tried was to set the <code>type</code> setting in the package.json to <code>module</code>.</p>
<p>This fixed my import and now my index file looks like this</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1">1</a></span>
<span class="normal"><a href="#__codelineno-2-2">2</a></span>
<span class="normal"><a href="#__codelineno-2-3">3</a></span>
<span class="normal"><a href="#__codelineno-2-4">4</a></span>
<span class="normal"><a href="#__codelineno-2-5">5</a></span>
<span class="normal"><a href="#__codelineno-2-6">6</a></span>
<span class="normal"><a href="#__codelineno-2-7">7</a></span>
<span class="normal"><a href="#__codelineno-2-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="c1">// I wasn&#39;t expecting to see an import from `other.js`, but </span>
<a id="__codelineno-2-2" name="__codelineno-2-2"></a><span class="c1">// it seems like this is expected behavior (see https://nodejs.org/api/esm.html#mandatory-file-extensions)</span>
<a id="__codelineno-2-3" name="__codelineno-2-3"></a>
<a id="__codelineno-2-4" name="__codelineno-2-4"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;./other.js&quot;</span><span class="p">;</span>
<a id="__codelineno-2-5" name="__codelineno-2-5"></a>
<a id="__codelineno-2-6" name="__codelineno-2-6"></a><span class="kd">const</span><span class="w"> </span><span class="nx">sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">add</span><span class="p">(</span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">);</span>
<a id="__codelineno-2-7" name="__codelineno-2-7"></a>
<a id="__codelineno-2-8" name="__codelineno-2-8"></a><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">sum</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<p>At this point, I figured I was in a good spot, so I tried <code>npx ts-node src/index.ts</code> again.</p>
<p>However, I was greeted with the following:</p>
<p><img alt="Error message from ts-node stating that it doesn't recognize ts files" src="https://softwarementorblog.blob.core.windows.net/images/typescript-59/image-3.png" /></p>
<h3 id="fighting-with-ts-node"><a class="toclink" href="2025/08/05/running-single-file-typescript-in-59-with-ts-node-and-tsx/#fighting-with-ts-node">Fighting with ts-node</a></h3>
<p>What in the world? I've never seen that error before, but doing some <a href="https://github.com/TypeStrong/ts-node?tab=readme-ov-file#commonjs-vs-native-ecmascript-modules">more digging into ts-node</a>, it turns out that the issue is that ts-node doesn't know how to load ESModules by default, so you need to get an ESM specific loader to work. The docs mention a few different ways to work around that, so I started trying them out.</p>
<p>No dice, even with trying all of that (and even some help with AI), I still wasn't able to get the TypeScript file to load. </p>
<p>At the end of the day, if I wanted to stick with <code>ts-node</code>, I had to make the following changes.</p>
<ul>
<li>Update the <code>package.json</code> to have a type of <code>commonjs</code></li>
<li>Update the <code>tsconfig.json</code> to set <code>verbatimModuleSyntax</code> to be false</li>
<li>Update the import in <code>index</code> to be <code>import {add} from "./other"</code></li>
</ul>
<p>This works, however, CommonJS is an old way of setting up files and I don't like that I had to turn off the <code>verbatimModuleSyntax</code> setting.</p>
<h3 id="an-alternative-solution-with-tsx"><a class="toclink" href="2025/08/05/running-single-file-typescript-in-59-with-ts-node-and-tsx/#an-alternative-solution-with-tsx">An Alternative Solution with tsx</a></h3>
<p>Doing more digging, I found an alternative tool to <code>ts-node</code>, <code>[tsx](https://tsx.is/)</code> which purports having a simpler configuration and better support for ESM. This package has been around for a while now, has good support, and is actively maintained, so let's give that a whirl.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a>npm<span class="w"> </span>install<span class="w"> </span>--save-dev<span class="w"> </span>tsx
</code></pre></div></td></tr></table></div>
<p>After installing <code>tsx</code>, I changed my <code>package.json</code> back to having a type of <code>module</code> and set <code>verbatimModuleSyntax</code> back to its default setting of true.</p>
<p>Let's try to run the file</p>
<p><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1">1</a></span>
<span class="normal"><a href="#__codelineno-4-2">2</a></span>
<span class="normal"><a href="#__codelineno-4-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a>npx<span class="w"> </span>tsx<span class="w"> </span>src/index.ts
<a id="__codelineno-4-2" name="__codelineno-4-2"></a>
<a id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="m">5</span>
</code></pre></div></td></tr></table></div>
Hooray! I've never been happier to see basic addition working.</p>
<h3 id="wrapping-up"><a class="toclink" href="2025/08/05/running-single-file-typescript-in-59-with-ts-node-and-tsx/#wrapping-up">Wrapping Up</a></h3>
<p>I've been a big proponent of ts-node for a long-time now due to its easy-to-setup nature and how well it played with TypeScript out of the box. However, with the latest changes to TypeScript, I highly recommend using <code>tsx</code> over <code>ts-node</code> as it just seems to work without having to mess with a bunch of other settings. With the friction I ran into and the direction TypeScript is going, I'll be curious to see how ts-node evolves over time.</p>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/cameronpresley.png" alt="Cameron Presley">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2025-07-15 00:00:00+00:00">Jul 15, 2025</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="category/typescript/" class="md-meta__link">TypeScript</a></li>
        
        
          
          <li class="md-meta__item">
            
              5 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="creating-a-node-tool-with-typescript-and-jest-from-scratch"><a class="toclink" href="2025/07/15/creating-a-node-tool-with-typescript-and-jest-from-scratch/">Creating a Node Tool With TypeScript and Jest From Scratch</a></h2>
<p>In a <a href="2025/07/10/creating-a-node-project-with-typescript-and-jest-from-scratch/">previous post</a>, I showed how to create a Node project from scratch. This is a great basis to start building other types of projects, so in this post, I'm going to show you how to build a tool that you can install via <a href="https://www.npmjs.com/">npm</a>.</p>
<p>One of my favorite tools to use is <a href="https://www.npmjs.com/package/gitignore">gitignore</a>, useful for generating a stock <code>.gitignore</code> file for all sorts of projects.</p>
<p>Let's get started!</p>
<p><em>Note: Do you prefer learning via video? You can find <a href="https://youtu.be/Cm8T8N1pfnw">a version of this article on YouTube</a></em></p>
<p>At a high level, we'll be doing the following</p>
<ol>
<li><a href="2025/07/15/creating-a-node-tool-with-typescript-and-jest-from-scratch/#step-1-setting-the-foundation">Setting the Foundation</a></li>
<li><a href="2025/07/15/creating-a-node-tool-with-typescript-and-jest-from-scratch/#step-2-compiling-typescript-to-javascript">Update our project to compiler TypeScript to JavaScript</a></li>
<li><a href="2025/07/15/creating-a-node-tool-with-typescript-and-jest-from-scratch/#step-3-updating-jest-to-run-the-right-files">Update our testing workflow</a></li>
<li><a href="2025/07/15/creating-a-node-tool-with-typescript-and-jest-from-scratch/#step-4-setting-up-the-executable">Set up our executable</a></li>
</ol>
<h3 id="step-0-dependencies"><a class="toclink" href="2025/07/15/creating-a-node-tool-with-typescript-and-jest-from-scratch/#step-0-dependencies">Step 0 - Dependencies</a></h3>
<p>For this project, the only tool you'll need is the Long Term Support (LTS) version of Node (as of this post, that's v22, but these instructions should hold regardless). If you're working with different Node applications, then I <em>highly</em> recommend using a tool to help you juggle the different versions of Node you might need (Your options are <a href="https://github.com/nvm-sh/nvm">nvm</a> if you're on Mac/Linux or <a href="https://github.com/coreybutler/nvm-windows">Node Version Manager for Windows</a> if you're on Windows).</p>
<h3 id="step-1-setting-the-foundation"><a class="toclink" href="2025/07/15/creating-a-node-tool-with-typescript-and-jest-from-scratch/#step-1-setting-the-foundation">Step 1 - Setting The Foundation</a></h3>
<p>The vast majority of work we need was created as part of <a href="2025/07/10/creating-a-node-project-with-typescript-and-jest-from-scratch/">build a basic node project</a>, so make sure to complete the steps there first before proceeding!</p>
<h3 id="step-2-compiling-typescript-to-javascript"><a class="toclink" href="2025/07/15/creating-a-node-tool-with-typescript-and-jest-from-scratch/#step-2-compiling-typescript-to-javascript">Step 2 - Compiling TypeScript to JavaScript</a></h3>
<p>In order for another application to use our library, we need to make sure we're shipping JavaScript, not TypeScript. To make that happen, we're going to be using the TypeScript compiler, <code>tsc</code> to help us out.</p>
<h4 id="telling-typescript-where-to-find-files"><a class="toclink" href="2025/07/15/creating-a-node-tool-with-typescript-and-jest-from-scratch/#telling-typescript-where-to-find-files">Telling TypeScript Where To Find Files</a></h4>
<p>When we <a href="2025/07/10/creating-a-node-project-with-typescript-and-jest-from-scratch/#setting-up-typescript">first setup TypeScript</a>, we created a basic <code>tsconfig.json</code> file and kept the defaults. However, in order to publish a library, we need to set two more <code>compilerOptions</code> in the file.</p>
<p>First, we need to set the <code>outDir</code> property so that our compiled code all goes into a single directory. If we don't do this, our JavaScript files be next to our TypeScript files and that creates a mess.</p>
<p>Second, we need to set the <code>rootDir</code> property so that the TypeScript compiler knows where to search for our code.</p>
<p>Let's go ahead and make those changes in the <code>tsconfig.json</code> file.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span>
<span class="normal"><a href="#__codelineno-0-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="c1">// existing code</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="nt">&quot;compilerOptions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="w">  </span><span class="c1">// existing code</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="w">  </span><span class="nt">&quot;outDir&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;dist&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// This tells the TypeScript compiler where to put the compiled code at</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="w">  </span><span class="nt">&quot;rootDir&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;src&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// This tells the TypeScript compiler where to search for TypeScript code to compile</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="p">}</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="c1">// existing code</span>
</code></pre></div></td></tr></table></div>
<h4 id="adding-a-build-script"><a class="toclink" href="2025/07/15/creating-a-node-tool-with-typescript-and-jest-from-scratch/#adding-a-build-script">Adding a build script</a></h4>
<p>Now that we've told TypeScript which files to compile and where to put those files, we can update our <code>package.json</code> file with a build script that will invoke the TypeScript compiler, <code>tsc</code> when ran:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1">1</a></span>
<span class="normal"><a href="#__codelineno-1-2">2</a></span>
<span class="normal"><a href="#__codelineno-1-3">3</a></span>
<span class="normal"><a href="#__codelineno-1-4">4</a></span>
<span class="normal"><a href="#__codelineno-1-5">5</a></span>
<span class="normal"><a href="#__codelineno-1-6">6</a></span>
<span class="normal"><a href="#__codelineno-1-7">7</a></span>
<span class="normal"><a href="#__codelineno-1-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="p">{</span>
<a id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="w">  </span><span class="c1">// existing code</span>
<a id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="w">  </span><span class="nt">&quot;script&quot;</span><span class="p">:{</span>
<a id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="w">    </span><span class="nt">&quot;build&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;tsc&quot;</span>
<a id="__codelineno-1-5" name="__codelineno-1-5"></a><span class="w">    </span><span class="c1">// existing scripts</span>
<a id="__codelineno-1-6" name="__codelineno-1-6"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-1-7" name="__codelineno-1-7"></a><span class="w">  </span><span class="c1">// existing code</span>
<a id="__codelineno-1-8" name="__codelineno-1-8"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>With this script in place, we can run <code>npm run build</code> from the command line and we'll see that a <code>dist</code> folder was created with some JavaScript files inside.</p>
<h4 id="improving-the-build-with-rimraf"><a class="toclink" href="2025/07/15/creating-a-node-tool-with-typescript-and-jest-from-scratch/#improving-the-build-with-rimraf">Improving the Build with Rimraf</a></h4>
<p>Now that we have compilation happening, we need a way to make sure our <code>dist</code> folder is cleaned out before a new compilation as this helps make sure that we don't have old files hanging around. This will also simulate our Continuous Integration pipeline when we start working on that.</p>
<p>We could update our build script with something like <code>rm -rf dist</code>, but that's a Linux command, which most likely won't work on Windows. So let's add a new library, <a href="https://www.npmjs.com/package/rimraf">rimraf</a>, that handles removing files in an OS agnostic way.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a>npm<span class="w"> </span>install<span class="w"> </span>--save-dev<span class="w"> </span>rimraf
</code></pre></div></td></tr></table></div>
<p>After installing, we can update our build script to be the following.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">1</a></span>
<span class="normal"><a href="#__codelineno-3-2">2</a></span>
<span class="normal"><a href="#__codelineno-3-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="p">{</span>
<a id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="w">  </span><span class="nt">&quot;build&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;rimraf dist &amp;&amp; tsc&quot;</span>
<a id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Now, when we run <code>npm run build</code>, we'll see that the <code>dist</code> folder is removed and then recreated.</p>
<h3 id="step-3-updating-jest-to-run-the-right-files"><a class="toclink" href="2025/07/15/creating-a-node-tool-with-typescript-and-jest-from-scratch/#step-3-updating-jest-to-run-the-right-files">Step 3 - Updating Jest to Run the Right Files</a></h3>
<p>At this point, we have our TypeScript being compiled into JavaScript, so we're close to being ready to publish our tool. As a sanity check, let's go ahead and run our test suite from <a href="2025/07/15/creating-a-node-tool-with-typescript-and-jest-from-scratch/#step-1-setting-the-foundation">step 1</a></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a>npm<span class="w"> </span>run<span class="w"> </span><span class="nb">test</span>
</code></pre></div></td></tr></table></div>
<p><img alt="Image of jest tests running and it's found two files: index.spec.ts and index.spec.js" src="https://softwarementorblog.blob.core.windows.net/images/multiple-jest-tests.png" /></p>
<p>Uh oh, it looks like <code>jest</code> is not only running the tests in the <code>src</code> folder, but also in the <code>dist</code> folder. We'll need to tweak our <code>jest.config.js</code> file to ignore the dist folder.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1">1</a></span>
<span class="normal"><a href="#__codelineno-5-2">2</a></span>
<span class="normal"><a href="#__codelineno-5-3">3</a></span>
<span class="normal"><a href="#__codelineno-5-4">4</a></span>
<span class="normal"><a href="#__codelineno-5-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="c1">// existing code</span>
<a id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-5-3" name="__codelineno-5-3"></a><span class="w">  </span><span class="c1">//existing code</span>
<a id="__codelineno-5-4" name="__codelineno-5-4"></a><span class="p">},</span>
<a id="__codelineno-5-5" name="__codelineno-5-5"></a><span class="nx">testPathIgnorePatterns</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;dist/&#39;</span><span class="p">]</span><span class="w"> </span><span class="c1">// this will ignore any matches in the dist folder</span>
</code></pre></div></td></tr></table></div>
<p>If we run our test command again, we'll only see the index.spec.ts file in the listing.</p>
<p><img alt="Image of jest tests running and it's found one file: index.spec.ts" src="https://softwarementorblog.blob.core.windows.net/images/single-jest-test.png" /></p>
<h3 id="step-4-setting-up-the-executable"><a class="toclink" href="2025/07/15/creating-a-node-tool-with-typescript-and-jest-from-scratch/#step-4-setting-up-the-executable">Step 4 - Setting up the executable</a></h3>
<h4 id="adding-bin-to-packagejson"><a class="toclink" href="2025/07/15/creating-a-node-tool-with-typescript-and-jest-from-scratch/#adding-bin-to-packagejson">Adding Bin to Package.json</a></h4>
<p>Now, it's time to tell <code>npm</code> which file to execute as part of the tool. </p>
<p>First, we need to update our <code>package.json</code> file to include a new property <a href="https://docs.npmjs.com/cli/v11/configuring-npm/package-json#bin">bin</a>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1">1</a></span>
<span class="normal"><a href="#__codelineno-6-2">2</a></span>
<span class="normal"><a href="#__codelineno-6-3">3</a></span>
<span class="normal"><a href="#__codelineno-6-4">4</a></span>
<span class="normal"><a href="#__codelineno-6-5">5</a></span>
<span class="normal"><a href="#__codelineno-6-6">6</a></span>
<span class="normal"><a href="#__codelineno-6-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="p">{</span>
<a id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="w">  </span><span class="c1">// existing code</span>
<a id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="w">  </span><span class="nt">&quot;main&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;index.js&quot;</span><span class="p">,</span>
<a id="__codelineno-6-4" name="__codelineno-6-4"></a><span class="w">  </span><span class="nt">&quot;bin&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-5" name="__codelineno-6-5"></a><span class="w">    </span><span class="nt">&quot;nameOfExecutable&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;dist/index.js&quot;</span>
<a id="__codelineno-6-6" name="__codelineno-6-6"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-6-7" name="__codelineno-6-7"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>So if we wanted the name of our tool to be <code>greet</code>, then we would update the "nameOfExecutable" to be <code>greet</code>.</p>
<h4 id="updating-index-with-shebang"><a class="toclink" href="2025/07/15/creating-a-node-tool-with-typescript-and-jest-from-scratch/#updating-index-with-shebang">Updating Index With Shebang</a></h4>
<p>If we tried to run our tool now, we'd see that nothing would happen, but the file would be opened in a text editor.</p>
<p>It turns out, that if we don't add a <em>[shebang]</em>(https://en.wikipedia.org/wiki/Shebang_(Unix)) to the file, then Node doesn't know that it should execute this file. </p>
<p>So let's update our <code>index.ts</code> file</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1">1</a></span>
<span class="normal"><a href="#__codelineno-7-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="ch">#!/usr/bin/env node</span>
<a id="__codelineno-7-2" name="__codelineno-7-2"></a><span class="c1">// rest of the file</span>
</code></pre></div></td></tr></table></div>
<h3 id="step-5-building-the-tool"><a class="toclink" href="2025/07/15/creating-a-node-tool-with-typescript-and-jest-from-scratch/#step-5-building-the-tool">Step 5 - Building the Tool</a></h3>
<p>With this final step, we're in a good place to build our tool and try it out.</p>
<p>To create the package, we need to run two commands:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1">1</a></span>
<span class="normal"><a href="#__codelineno-8-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a>npm<span class="w"> </span>run<span class="w"> </span>build<span class="w"> </span><span class="c1"># This creates a clean folder with our code to deploy</span>
<a id="__codelineno-8-2" name="__codelineno-8-2"></a>npm<span class="w"> </span>pack<span class="w"> </span><span class="c1"># This creates a tarball that has our code, which we can execute via npx</span>
</code></pre></div></td></tr></table></div>
<h3 id="next-steps"><a class="toclink" href="2025/07/15/creating-a-node-tool-with-typescript-and-jest-from-scratch/#next-steps">Next Steps</a></h3>
<p>With this final step done, we have a great foundation for building out our tool! For example, you could build your own version of [gitignore], maybe a command line interface that wraps around a favorite tool of yours, the sky's the limit!</p>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/cameronpresley.png" alt="Cameron Presley">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2025-07-10 00:00:00+00:00">Jul 10, 2025</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="category/typescript/" class="md-meta__link">TypeScript</a></li>
        
        
          
          <li class="md-meta__item">
            
              6 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="creating-a-node-project-with-typescript-and-jest-from-scratch"><a class="toclink" href="2025/07/10/creating-a-node-project-with-typescript-and-jest-from-scratch/">Creating a Node Project With TypeScript and Jest From Scratch</a></h2>
<p>When teaching engineers about Node, I like to start with the bare bone basics and build from there. Though there is value in using tools to auto-scaffold a project (<a href="https://vite.dev/">Vite</a> for React applications, for example), there's also value in understanding how everything hangs together.</p>
<p>In this post, I'm going to show you how to create a Node project from scratch that has TypeScript configured, Jest configured, and a basic test suite in place.</p>
<p>Let's get started!</p>
<p><em>Note: Do you prefer learning via video? You can find <a href="https://youtu.be/mphKoDUiZVg?si=jJt1ZN-qZURXysgd">this article on YouTube</a></em></p>
<h3 id="step-0-dependencies"><a class="toclink" href="2025/07/10/creating-a-node-project-with-typescript-and-jest-from-scratch/#step-0-dependencies">Step 0 - Dependencies</a></h3>
<p>For this project, the only tool you'll need is the Long Term Support (LTS) version of Node (as of this post, that's v22, but these instructions should hold regardless). If you're working with different Node applications, then I <em>highly</em> recommend using a tool to help you juggle the different versions of Node you might need (Your options are <a href="https://github.com/nvm-sh/nvm">nvm</a> if you're on Mac/Linux or <a href="https://github.com/coreybutler/nvm-windows">Node Version Manager for Windows</a> if you're on Windows).</p>
<h3 id="step-1-creating-the-directory-layout"><a class="toclink" href="2025/07/10/creating-a-node-project-with-typescript-and-jest-from-scratch/#step-1-creating-the-directory-layout">Step 1 - Creating the Directory Layout</a></h3>
<p>A standard project will have a layout like the following:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span>
<span class="normal"><a href="#__codelineno-0-6">6</a></span>
<span class="normal"><a href="#__codelineno-0-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a>projectName
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>    \__src # source code for project is here
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>        \__ index.ts
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>        \__ index.spec.ts
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>    \__ package.json
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>    \__ package.lock.json
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>    \__ README.md
</code></pre></div></td></tr></table></div>
<p>So let's go ahead and create that. You can do this manually or by running the following in your favorite terminal.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1">1</a></span>
<span class="normal"><a href="#__codelineno-1-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a>mkdir<span class="w"> </span>&lt;projectName&gt;<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>projectName
<a id="__codelineno-1-2" name="__codelineno-1-2"></a>mkdir<span class="w"> </span>src
</code></pre></div></td></tr></table></div>
<h3 id="step-2-setting-up-node"><a class="toclink" href="2025/07/10/creating-a-node-project-with-typescript-and-jest-from-scratch/#step-2-setting-up-node">Step 2 - Setting up Node</a></h3>
<p>With the structure in the right place, let's go ahead and create a Node application. The hallmark sign of a Node app is the <code>package.json</code> file as this has three main piece of info.</p>
<ol>
<li>What's the name of the application and who created it</li>
<li>What scripts can I execute?</li>
<li>What tools does it need to run?</li>
</ol>
<p>You can always manually create a <code>package.json</code> file, however, you can generate a standard one by using <code>npm init --yes</code>. </p>
<p><em>Tip: By specifying the <code>--yes</code> flag, this will generate a file with default settings that you can tweak as needed.</em></p>
<h3 id="step-3-setting-up-typescript"><a class="toclink" href="2025/07/10/creating-a-node-project-with-typescript-and-jest-from-scratch/#step-3-setting-up-typescript">Step 3 - Setting up TypeScript</a></h3>
<p>At this point, we have an application, but there's no code or functionality. Given that we're going to be using TypeScript, we'll need to install some libraries.</p>
<h4 id="installing-libraries"><a class="toclink" href="2025/07/10/creating-a-node-project-with-typescript-and-jest-from-scratch/#installing-libraries">Installing Libraries</a></h4>
<p>In the project folder, we're going to install both <code>typescript</code> and a way to execute it, <code>ts-node</code>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a>npm<span class="w"> </span>install<span class="w"> </span>--save-dev<span class="w"> </span>typescript<span class="w"> </span>ts-node
</code></pre></div></td></tr></table></div>
<p><em>Note: With Node v24, you can execute TypeScript natively, but there are some <a href="https://nodejs.org/api/typescript.html#type-stripping">limitations</a>. For me, I still like using ts-node for running the application locally.</em></p>
<h4 id="setting-up-typescript"><a class="toclink" href="2025/07/10/creating-a-node-project-with-typescript-and-jest-from-scratch/#setting-up-typescript">Setting up TypeScript</a></h4>
<p>Once the libraries have been installed, we need to create a <code>tsconfig.json</code> file. This essentially tells TypeScript how to compile our TypeScript to JavaScript and how much error checking we want during our compilation.</p>
<p>You can always create this file manually, but luckily, <code>tsc</code> (the TypeScript compiler) can generate this for you.</p>
<p>In the project folder, we can run the following</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a>npx<span class="w"> </span>tsc<span class="w"> </span>--init
</code></pre></div></td></tr></table></div>
<h4 id="writing-our-first-typescript-file"><a class="toclink" href="2025/07/10/creating-a-node-project-with-typescript-and-jest-from-scratch/#writing-our-first-typescript-file">Writing Our First TypeScript File</a></h4>
<p>At this point, we have TypeScript configured, but we still don't have any code. This is when I'll write a simple <code>index.ts</code> file that leverages TypeScript and then try to run it with <code>ts-node</code>.</p>
<p>In the <code>src</code> folder, let's create an <code>index.ts</code> file write the following code. </p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1">1</a></span>
<span class="normal"><a href="#__codelineno-4-2">2</a></span>
<span class="normal"><a href="#__codelineno-4-3">3</a></span>
<span class="normal"><a href="#__codelineno-4-4">4</a></span>
<span class="normal"><a href="#__codelineno-4-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">add</span><span class="p">(</span><span class="nx">a</span><span class="o">:</span><span class="kt">number</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="o">:</span><span class="kt">number</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">a</span><span class="o">+</span><span class="nx">b</span><span class="p">;</span>
<a id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="p">}</span>
<a id="__codelineno-4-4" name="__codelineno-4-4"></a>
<a id="__codelineno-4-5" name="__codelineno-4-5"></a><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;add(2,2) =&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">add</span><span class="p">(</span><span class="mf">2</span><span class="p">,</span><span class="mf">2</span><span class="p">));</span>
</code></pre></div></td></tr></table></div>
<p>This uses TypeScript features (notice the type annotations), which if we try to run this with <code>node</code>, we'll get an error.</p>
<h4 id="using-ts-node-to-run-file"><a class="toclink" href="2025/07/10/creating-a-node-project-with-typescript-and-jest-from-scratch/#using-ts-node-to-run-file">Using ts-node To Run File</a></h4>
<p>Let's make sure everything is working by using <code>ts-node</code>.</p>
<p>Back in the terminal, run the following:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a>npx<span class="w"> </span>ts-node<span class="w"> </span>src/index.ts
</code></pre></div></td></tr></table></div>
<p>If everything works correctly, you should see the following in the terminal window.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a>add<span class="o">(</span><span class="m">2</span>,2<span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span>
</code></pre></div></td></tr></table></div>
<h4 id="adding-our-first-npm-script"><a class="toclink" href="2025/07/10/creating-a-node-project-with-typescript-and-jest-from-scratch/#adding-our-first-npm-script">Adding Our First NPM Script</a></h4>
<p>We're able to run our file, but as you could imagine, it's going to get annoying to always type out <code>npx ts-node src/index.ts</code>. Also, this kills discoverability as you have to document this somewhere (like a README.md) or it'll become a thing that someone "just needs to know".</p>
<p>Let's improve this by adding a script to our <code>package.json</code> file.</p>
<p>Back in <a href="2025/07/10/creating-a-node-project-with-typescript-and-jest-from-scratch/#step-2-setting-up-node">setting up node</a>, I mentioned that one of the cool things about <code>package.json</code> is that you can define custom scripts.</p>
<p>A common script to have defined is <code>start</code>, so let's update our <code>package.json</code> with that script.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1">1</a></span>
<span class="normal"><a href="#__codelineno-7-2">2</a></span>
<span class="normal"><a href="#__codelineno-7-3">3</a></span>
<span class="normal"><a href="#__codelineno-7-4">4</a></span>
<span class="normal"><a href="#__codelineno-7-5">5</a></span>
<span class="normal"><a href="#__codelineno-7-6">6</a></span>
<span class="normal"><a href="#__codelineno-7-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="p">{</span>
<a id="__codelineno-7-2" name="__codelineno-7-2"></a><span class="w">  </span><span class="c1">// some code here</span>
<a id="__codelineno-7-3" name="__codelineno-7-3"></a><span class="w">  </span><span class="s2">&quot;scripts: {</span>
<a id="__codelineno-7-4" name="__codelineno-7-4"></a><span class="s2">    &quot;</span><span class="err">s</span><span class="kc">tart</span><span class="s2">&quot;: &quot;</span><span class="kc">ts</span><span class="mi">-</span><span class="kc">n</span><span class="err">ode</span><span class="w"> </span><span class="err">src/i</span><span class="kc">n</span><span class="err">dex.</span><span class="kc">ts</span><span class="err">&quot;</span>
<a id="__codelineno-7-5" name="__codelineno-7-5"></a><span class="err">    // other scripts here</span>
<a id="__codelineno-7-6" name="__codelineno-7-6"></a><span class="err">  },</span>
<a id="__codelineno-7-7" name="__codelineno-7-7"></a><span class="err">}</span>
</code></pre></div></td></tr></table></div>
<p>With this change, let's head back to our terminal and try it out.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a>npm<span class="w"> </span>run<span class="w"> </span>start
</code></pre></div></td></tr></table></div>
<p>If everything was setup correctly, we should see the same output as before.</p>
<h3 id="step-4-setting-up-jest"><a class="toclink" href="2025/07/10/creating-a-node-project-with-typescript-and-jest-from-scratch/#step-4-setting-up-jest">Step 4 - Setting up Jest</a></h3>
<p>At this junction, we can execute TypeScript and made life easier by defining a <code>start</code> script. The next step is that we need to set up our testing framework.</p>
<p>While there are quite a few options out there, a common one is <a href="https://jestjs.io/">jest</a> so that's what we'll be using in this article.</p>
<p>Since jest is a <em>JavaScript</em> testing library and our code is in TypeScript, we'll need a way to translate our TypeScript to JavaScript. The jest docs mention a few ways of doing this (using a tool like Babel for example). However, I've found using <code>ts-jest</code> to be an easier setup and still get the same outcomes.</p>
<h4 id="installing-libraries_1"><a class="toclink" href="2025/07/10/creating-a-node-project-with-typescript-and-jest-from-scratch/#installing-libraries_1">Installing Libraries</a></h4>
<p>With our tools selected, let's go ahead and install them.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1"></a>npm<span class="w"> </span>install<span class="w"> </span>--save-dev<span class="w"> </span>jest<span class="w"> </span>ts-jest<span class="w"> </span>@types/jest
</code></pre></div></td></tr></table></div>
<p><em>Note: You might have seen that we're also installing "@types/jest". This does't provide any functionality, however, it does gives us the types that jest uses. Because of that, our code editor can understand @types/jest and give us auto-complete and Intellisense when writing our tests</em></p>
<h4 id="configuring-jest"><a class="toclink" href="2025/07/10/creating-a-node-project-with-typescript-and-jest-from-scratch/#configuring-jest">Configuring Jest</a></h4>
<p>So we have the tools installed, but need to configure them. Generally, you'll need a <code>jest.config.js</code> file which you can hand-write.</p>
<p>Or we can have <em>ts-jest</em> generate that for us :)</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1"></a>npx<span class="w"> </span>ts-jest<span class="w"> </span>config:init
</code></pre></div></td></tr></table></div>
<p>If this step works, you should have a <code>jest.config.js</code> file in the project directory.</p>
<p>Let's write our first test!</p>
<h4 id="writing-our-first-test"><a class="toclink" href="2025/07/10/creating-a-node-project-with-typescript-and-jest-from-scratch/#writing-our-first-test">Writing Our First Test</a></h4>
<p>Jest finds tests based on file names. So as long as your test file ends with either <code>.spec.ts</code>, <code>.spec.js</code>, <code>.test.ts</code>, or <code>.test.js</code>, jest will pick it up.</p>
<p>So let's create a new file in the <code>src</code> folder called <code>index.spec.ts</code> and add the following:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-11-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-11-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-11-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-11-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-11-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-11-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-11-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-11-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-11-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;./index&quot;</span>
<a id="__codelineno-11-2" name="__codelineno-11-2"></a><span class="c1">// describe is container for one or more tests</span>
<a id="__codelineno-11-3" name="__codelineno-11-3"></a><span class="nx">describe</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-11-4" name="__codelineno-11-4"></a><span class="w">  </span><span class="c1">// it - denotes this is a test</span>
<a id="__codelineno-11-5" name="__codelineno-11-5"></a><span class="w">  </span><span class="nx">it</span><span class="p">(</span><span class="s2">&quot;does add work&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-11-6" name="__codelineno-11-6"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">add</span><span class="p">(</span><span class="mf">2</span><span class="p">,</span><span class="mf">2</span><span class="p">);</span>
<a id="__codelineno-11-7" name="__codelineno-11-7"></a>
<a id="__codelineno-11-8" name="__codelineno-11-8"></a><span class="w">    </span><span class="nx">expect</span><span class="p">(</span><span class="nx">result</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="mf">4</span><span class="p">);</span>
<a id="__codelineno-11-9" name="__codelineno-11-9"></a><span class="w">  </span><span class="p">})</span>
<a id="__codelineno-11-10" name="__codelineno-11-10"></a><span class="p">})</span>
</code></pre></div></td></tr></table></div>
<p>With our test written, we can run it in the terminal with the following:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1"></a>npx<span class="w"> </span>jest
</code></pre></div></td></tr></table></div>
<h4 id="adding-a-test-npm-script"><a class="toclink" href="2025/07/10/creating-a-node-project-with-typescript-and-jest-from-scratch/#adding-a-test-npm-script">Adding a Test NPM Script</a></h4>
<p>Just like when we added a custom <code>start</code> script to our <code>package.json</code> file, we can do a similar thing here with our tests. </p>
<p>In <code>package.json</code>, update the <code>scripts</code> section to look like:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1">1</a></span>
<span class="normal"><a href="#__codelineno-13-2">2</a></span>
<span class="normal"><a href="#__codelineno-13-3">3</a></span>
<span class="normal"><a href="#__codelineno-13-4">4</a></span>
<span class="normal"><a href="#__codelineno-13-5">5</a></span>
<span class="normal"><a href="#__codelineno-13-6">6</a></span>
<span class="normal"><a href="#__codelineno-13-7">7</a></span>
<span class="normal"><a href="#__codelineno-13-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="p">{</span>
<a id="__codelineno-13-2" name="__codelineno-13-2"></a><span class="w">  </span><span class="c1">// other code</span>
<a id="__codelineno-13-3" name="__codelineno-13-3"></a><span class="w">  </span><span class="nt">&quot;script&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-4" name="__codelineno-13-4"></a><span class="w">    </span><span class="nt">&quot;start&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ts-node src/index.ts&quot;</span><span class="p">,</span>
<a id="__codelineno-13-5" name="__codelineno-13-5"></a><span class="w">    </span><span class="nt">&quot;test&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;jest&quot;</span>
<a id="__codelineno-13-6" name="__codelineno-13-6"></a><span class="w">  </span><span class="p">},</span>
<a id="__codelineno-13-7" name="__codelineno-13-7"></a><span class="w">  </span><span class="c1">// other code</span>
<a id="__codelineno-13-8" name="__codelineno-13-8"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>With this change, we can run our test suite by using <code>npm run test</code> in the terminal.</p>
<p>Congrats, just like that, you have a working Node application with TypeScript and Jest for testing!</p>
<h3 id="next-steps"><a class="toclink" href="2025/07/10/creating-a-node-project-with-typescript-and-jest-from-scratch/#next-steps">Next Steps</a></h3>
<p>With the scaffolding in place, you're in a solid spot to start growing things out. For example, you could...</p>
<ul>
<li>Start setting up a Continuous Integration pipeline</li>
<li>Fine-tune your <code>tsconfig.json</code> to enable more settings (like turning off the ability to use any)</li>
<li>Fine-tune your <code>jest.config.js</code> (like having your mocks auto-rest)</li>
<li>Start writing application code!</li>
</ul>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/cameronpresley.png" alt="Cameron Presley">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2025-07-07 00:00:00+00:00">Jul 7, 2025</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="category/career/" class="md-meta__link">Career</a></li>
        
        
          
          <li class="md-meta__item">
            
              4 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="career-update-and-a-new-chapter"><a class="toclink" href="2025/07/07/career-update-and-a-new-chapter/">Career Update and a New Chapter</a></h2>
<p>A couple of months back, I announced on <a href="https://www.linkedin.com/posts/pcameronpresley_opentowork-activity-7328792513526325248-TWI6?utm_source=share&amp;utm_medium=member_desktop&amp;rcm=ACoAAAXW-u0Bjcks4GwBr0_diDKc1Ld3B8sOseM">LinkedIn</a> that some opportunities fell through and I found myself unexpectedly on the market looking for work. It has been a while since I've given an update on what was going on and what I've been up to.</p>
<h3 id="the-search-begins-anew"><a class="toclink" href="2025/07/07/career-update-and-a-new-chapter/#the-search-begins-anew">The Search Begins (Anew!)</a></h3>
<p>After watching both opportunities fall through, I began my job search again, leading to me applying to over fifty different companies, focusing on leadership roles (think Team Lead, Engineering Manager, or Director of Engineering). Even though I have quite a few years of recent experience (I've been leading teams in some capacity since 2018), the most common piece of feedback is that it seemed like my recent roles were more technical than leadership.</p>
<p>That's fair feedback as my leadership style is that I wouldn't ask a member of my team to do something that I wouldn't do and I'm naturally curious about how things work, so there are times when I've rolled up my sleeves to help the team get projects done and/or be the technical lead that the team needed.</p>
<p>So, let's try a different approach.</p>
<p>I retooled my resume to highlight my technical accomplishments and applied for more experienced technical roles (think Senior Software Engineer, Staff Software Engineer, Principal Engineer, and Architect). Given the first round of feedback, I figured this would be a shoe-in, right?</p>
<p>Not quite...</p>
<p>Most of the feedback I got for these roles is that I wasn't hands-on technical enough (though my most recent engagements had me coding the vast majority of the time), though my leadership skills were solid.</p>
<h3 id="what-do-you-want-to-be-when-you-grow-up"><a class="toclink" href="2025/07/07/career-update-and-a-new-chapter/#what-do-you-want-to-be-when-you-grow-up">What Do You Want To Be When You Grow Up?</a></h3>
<p>Not going to lie, it's a bit frustrating to be told that you're too technical for leadership, but not technical enough for engineering, especially when you've helped companies launch new products and new offerings.</p>
<p>My theory (potential cope) is that companies don't know what to do when they find someone who's both a strong technical leader and a strong engineer as they don't come across them that often. Most of the companies I've seen typically want their leadership to be able to understand concepts (i.e., what is continuous deployment pipeline), but not enough to implement or fix it when there are issues. For the engineering side, my experience was that they wanted people who were deep in the technical weeds (we're talking edge cases, knowing the docs cold), but didn't ask a ton about how the work fits into the bigger picture of the business.</p>
<p>For me, I need a combination of both to be happy. I enjoy doing the technical work, building new tools/products to solve problems as I'm great at finding issues with a process and making it smoother.</p>
<p>On the other hand, I thoroughly enjoy leading people and coaching up a team. That was one of the original inspirations for this blog, <em>The Software Mentor</em>, a way to give back and be an (unofficial) mentor to those who don't have someone to level up from.</p>
<p>I can't just ignore one side of the equation, that's throwing away half my strengths.</p>
<p>So what do you do?</p>
<p>In my case, change the game.</p>
<h3 id="a-different-approach"><a class="toclink" href="2025/07/07/career-update-and-a-new-chapter/#a-different-approach">A Different Approach</a></h3>
<p>Over my career, I've been lucky to work at quite a few companies and have built great relationships everywhere I went. In addition, I've spent the last ten years building up a reputation in the community as a technical leader (Microsoft MVP since 2017 and have been presenting on technical concepts since 2015).</p>
<p>I figured if I can't get work as an engineer or as a leader, why not try something new.</p>
<p>Back in 2014, some friends and I had started on an ill-fated attempt to build a replacement Point of Sale system to be used by liquor stores (this would have been before tools like Square would become ubiquitous). Though the project never launched, we gave it a name, <em>Small Batch Software</em> as it was both a tip of the cap to <a href="https://en.wikipedia.org/wiki/Small_batch_whiskey">small batch distilling</a> and a nod to working in small batches (a la <a href="https://en.wikipedia.org/wiki/Lean_manufacturing#Methodology">Lean Manufacturing</a> with batch sizes of 1).</p>
<p>We always joked that Small Batch might take off at some point, but we retired the project and the idea of Small Batch was retired (like most ideas go).</p>
<p>Fast forward to 2021, I started taking on some side work, helping other companies with their implementation and process improvement. At the time, I didn't have a formal company, but I started thinking more about forming a company and working through that.</p>
<p>When I left Rocket Mortgage in 2023, I decided to form my own company, <a href="https://smallbatchsolutions.io">Small Batch Solutions LLC</a> to help me with a more formal approach for moonlighting, partly to get some experience and partly to see how it would go.</p>
<p>However, like most things, it was a good idea, but I didn't put the required energy into the company, so it has been mostly dormant since then.</p>
<p>Which brings us to the present.</p>
<h3 id="small-batch-solutions-iteration-one"><a class="toclink" href="2025/07/07/career-update-and-a-new-chapter/#small-batch-solutions-iteration-one">Small Batch Solutions - Iteration One</a></h3>
<p>After pouring more energy into the company over the past two months, I've had success in landing clients, focusing on what I enjoy doing the most: </p>
<ul>
<li>Mentoring others, helping them advance in their career and technical skills</li>
<li>Problem solving, figuring out pain points and solving them simply</li>
</ul>
<p>Given these successes, I've chosen to focus on Small Batch Solutions full-time, allowing me to continue building with the community and also allowing me to use my strengths without having to fit in a single "box".</p>
<p>If you've ever found yourself thinking, "I wish I could work with someone who <em>just gets it</em> and can help me", then <a href="https://calendly.com/cameron-smallbatchsolutions/30min">reach out</a>, I think I might be able to help!</p>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/cameronpresley.png" alt="Cameron Presley">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2025-06-20 00:00:00+00:00">Jun 20, 2025</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="category/today-i-learned/" class="md-meta__link">Today I Learned</a>, 
              <a href="category/typescript/" class="md-meta__link">TypeScript</a></li>
        
        
          
          <li class="md-meta__item">
            
              2 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="today-i-learned-leveraging-records-to-eliminate-switch-statements"><a class="toclink" href="2025/06/20/today-i-learned---leveraging-records-to-eliminate-switch-statements/">Today I Learned - Leveraging Records to Eliminate Switch Statements</a></h2>
<h3 id="the-problem"><a class="toclink" href="2025/06/20/today-i-learned---leveraging-records-to-eliminate-switch-statements/#the-problem">The Problem</a></h3>
<p>A common approach is to have a function for each command (<code>moveForward</code>, <code>moveBackward</code>, <code>turnLeft</code>, and <code>turnRight</code>).</p>
<p>When it comes to implementation though, they all have a similar pattern:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-0-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-0-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-0-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="kd">function</span><span class="w"> </span><span class="nx">moveForward</span><span class="p">(</span><span class="nx">r</span><span class="o">:</span><span class="kt">Rover</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">Rover</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="w">  </span><span class="k">switch</span><span class="p">(</span><span class="nx">r</span><span class="p">.</span><span class="nx">direction</span><span class="p">){</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;North&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="p">{...</span><span class="nx">r</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="o">:</span><span class="kt">r.y</span><span class="o">+</span><span class="mf">1</span><span class="p">};</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;South&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="p">{...</span><span class="nx">r</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="o">:</span><span class="kt">r.y</span><span class="o">-</span><span class="mf">1</span><span class="p">};</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;East&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="p">{...</span><span class="nx">r</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="o">:</span><span class="kt">r.x</span><span class="o">+</span><span class="mf">1</span><span class="p">};</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;West&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="p">{...</span><span class="nx">r</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="o">:</span><span class="kt">r.x</span><span class="o">-</span><span class="mf">1</span><span class="p">};</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="p">}</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="kd">function</span><span class="w"> </span><span class="nx">turnLeft</span><span class="p">(</span><span class="nx">r</span><span class="o">:</span><span class="kt">Rover</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">Rover</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="w">  </span><span class="k">switch</span><span class="p">(</span><span class="nx">r</span><span class="p">.</span><span class="nx">direction</span><span class="p">){</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;North&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="p">{...</span><span class="nx">r</span><span class="p">,</span><span class="w"> </span><span class="nx">direction</span><span class="o">:</span><span class="s1">&#39;West&#39;</span><span class="p">};</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;West&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="p">{...</span><span class="nx">r</span><span class="p">,</span><span class="w"> </span><span class="nx">direction</span><span class="o">:</span><span class="s1">&#39;South&#39;</span><span class="p">};</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;South&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="p">{...</span><span class="nx">r</span><span class="p">,</span><span class="w"> </span><span class="nx">direction</span><span class="o">:</span><span class="s1">&#39;East&#39;</span><span class="p">};</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;East&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="p">{...</span><span class="nx">r</span><span class="p">,</span><span class="w"> </span><span class="nx">direction</span><span class="o">:</span><span class="s1">&#39;North&#39;</span><span class="p">};</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>This works, however, the duplicated switch logic can be annoying to deal with. </p>
<p>During a code review, one of <a href="">our interns</a> proposed an interesting solution using a dictionary for lookups.</p>
<p>Let's take a closer look.</p>
<h3 id="possible-solution"><a class="toclink" href="2025/06/20/today-i-learned---leveraging-records-to-eliminate-switch-statements/#possible-solution">Possible solution</a></h3>
<p>Instead of leveraging a <code>switch</code> statement, they thought about creating a dictionary where the key was the direction the rover was facing and the value being how to update the rover.</p>
<p>At a high level, it looked something like this:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-1-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-1-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-1-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-1-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-1-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-1-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-1-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-1-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-1-10">10</a></span>
<span class="normal"><a href="#__codelineno-1-11">11</a></span>
<span class="normal"><a href="#__codelineno-1-12">12</a></span>
<span class="normal"><a href="#__codelineno-1-13">13</a></span>
<span class="normal"><a href="#__codelineno-1-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Direction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;North&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;South&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;East&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;West&quot;</span><span class="p">;</span>
<a id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Action</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">r</span><span class="o">:</span><span class="kt">Rover</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">Rover</span><span class="p">;</span>
<a id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="kr">type</span><span class="w"> </span><span class="nx">ActionLookup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Record</span><span class="o">&lt;</span><span class="nx">Direction</span><span class="p">,</span><span class="w"> </span><span class="nx">Action</span><span class="o">&gt;</span><span class="p">;</span>
<a id="__codelineno-1-4" name="__codelineno-1-4"></a>
<a id="__codelineno-1-5" name="__codelineno-1-5"></a><span class="kd">function</span><span class="w"> </span><span class="nx">moveForward</span><span class="p">(</span><span class="nx">r</span><span class="o">:</span><span class="kt">Rover</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">Rover</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-1-6" name="__codelineno-1-6"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">lookup</span><span class="o">:</span><span class="w"> </span><span class="kt">ActionLookup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-1-7" name="__codelineno-1-7"></a><span class="w">    </span><span class="s2">&quot;North&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">r</span><span class="p">)=&gt;({...</span><span class="nx">r</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="o">:</span><span class="kt">r.y</span><span class="o">+</span><span class="mf">1</span><span class="p">}),</span>
<a id="__codelineno-1-8" name="__codelineno-1-8"></a><span class="w">    </span><span class="s2">&quot;South&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">r</span><span class="p">)=&gt;({...</span><span class="nx">r</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="o">:</span><span class="kt">r.y</span><span class="o">-</span><span class="mf">1</span><span class="p">}),</span>
<a id="__codelineno-1-9" name="__codelineno-1-9"></a><span class="w">    </span><span class="s2">&quot;East&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">r</span><span class="p">)=&gt;({...</span><span class="nx">r</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="o">:</span><span class="kt">r.x</span><span class="o">+</span><span class="mf">1</span><span class="p">}),</span>
<a id="__codelineno-1-10" name="__codelineno-1-10"></a><span class="w">    </span><span class="s2">&quot;West&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">r</span><span class="p">)=&gt;({...</span><span class="nx">r</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="o">:</span><span class="kt">r.x</span><span class="o">-</span><span class="mf">1</span><span class="p">})</span>
<a id="__codelineno-1-11" name="__codelineno-1-11"></a><span class="w">  </span><span class="p">};</span>
<a id="__codelineno-1-12" name="__codelineno-1-12"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">action</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">lookup</span><span class="p">[</span><span class="nx">r</span><span class="p">.</span><span class="nx">direction</span><span class="p">];</span>
<a id="__codelineno-1-13" name="__codelineno-1-13"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">action</span><span class="p">(</span><span class="nx">r</span><span class="p">);</span>
<a id="__codelineno-1-14" name="__codelineno-1-14"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Even though this looks like a dictionary, I like this approach better for two reasons:</p>
<ol>
<li>Explicit key coverage - By defining Record to have a key of <code>Direction</code>, we're forcing the developer to define options for <em>every</em> direction, not just some of them.</li>
<li>Breaks when type changes - If a new option is added to <code>Direction</code>, this code won't compile anymore as it doesn't cover every option, which allows us to find bugs faster. </li>
</ol>
<h3 id="closing-thoughts"><a class="toclink" href="2025/06/20/today-i-learned---leveraging-records-to-eliminate-switch-statements/#closing-thoughts">Closing Thoughts</a></h3>
<p>When working with data that requires different access levels, think about leveraging private fields and then providing access through public properties.</p>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/cameronpresley.png" alt="Cameron Presley">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2025-06-10 00:00:00+00:00">Jun 10, 2025</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="category/today-i-learned/" class="md-meta__link">Today I Learned</a>, 
              <a href="category/typescript/" class="md-meta__link">TypeScript</a></li>
        
        
          
          <li class="md-meta__item">
            
              4 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="today-i-learned-javascript-private-fields-and-properties"><a class="toclink" href="2025/06/10/today-i-learned---javascript-private-fields-and-properties/">Today I Learned - JavaScript Private Fields and Properties</a></h2>
<p>One of my favorite times of year has started, intern season! I always enjoy getting a new group of people who are excited to learn something new and are naturally curious about everything!</p>
<p>As such, one of the first coding katas we complete is <a href="">Mars Rover</a> as it's a great exercise to introduce union types, records, functions, and some of the basic array operators (map and reduce). It also provides a solid introduction to automated testing practices (Arrange/Act/Assert, naming conventions, test cases). Finally, you can solve it multiple ways and depending on the approach, lends itself to refactoring and cleaning up.</p>
<p>Now my preferred approach to the kata is to leverage functional programming (FP) techniques, however, it wouldn't be correct to only show that approach, so I tackled it using more object-oriented (OO) instead.</p>
<p>One of the things that we run into pretty quickly is that we're going to need a <code>Rover</code> class that will have the different methods for moving and turning. Since the <code>Rover</code> will need to keep track of its <code>X</code>, <code>Y</code>, and <code>Direction</code>, I ended up with the following:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Direction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;North&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;South&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;East&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;West&quot;</span><span class="p">;</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="kd">class</span><span class="w"> </span><span class="nx">Rover</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="w">  </span><span class="kr">constructor</span><span class="p">(</span><span class="k">private</span><span class="w"> </span><span class="nx">x</span><span class="o">:</span><span class="kt">number</span><span class="p">,</span><span class="w"> </span><span class="k">private</span><span class="w"> </span><span class="nx">y</span><span class="o">:</span><span class="kt">number</span><span class="p">,</span><span class="w"> </span><span class="k">private</span><span class="w"> </span><span class="nx">direction</span><span class="o">:</span><span class="kt">Direction</span><span class="p">){}</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="w">  </span><span class="c1">// moveForward, moveBackward, turnLeft, and turnRight definitions below...</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>This approach works just fine as it allows the caller to give us a starting point, but they can't manipulate <code>X</code>, <code>Y</code>, or <code>Direction</code> directly, they have to use one of the methods (i.e., we have encapsulation).</p>
<h3 id="the-problem"><a class="toclink" href="2025/06/10/today-i-learned---javascript-private-fields-and-properties/#the-problem">The Problem</a></h3>
<p>However, we run into a slight problem once we get to the user interface. We would like to be able to display the Rover's location and direction, however, we don't have a way of accessing that data since we marked those as private.</p>
<p>In other words, we can't do the following:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1">1</a></span>
<span class="normal"><a href="#__codelineno-1-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="kd">const</span><span class="w"> </span><span class="nx">rover</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Rover</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;North&#39;</span><span class="p">);</span>
<a id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Rover is at (</span><span class="si">${</span><span class="nx">r</span><span class="p">.</span><span class="nx">x</span><span class="si">}</span><span class="sb">, </span><span class="si">${</span><span class="nx">r</span><span class="p">.</span><span class="nx">y</span><span class="si">}</span><span class="sb">) facing </span><span class="si">${</span><span class="nx">r</span><span class="p">.</span><span class="nx">direction</span><span class="si">}</span><span class="sb">`</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>One way to fix this problem is to remove the <code>private</code> modifier and allow the values to be public, however, this would mean that the state of my object could be manipulated either through it's methods (i.e., <code>moveForward</code>) or through global access <code>rover.X = 100</code>. </p>
<p>What I'd like to do instead is to have a way to get the value to the outside world, but not allow them to modify it.</p>
<p>In languages like C#, we would leverage a public get/private set on properties, which would look something like this:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-2-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-2-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-2-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-2-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-2-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-2-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-2-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-2-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-2-10">10</a></span>
<span class="normal"><a href="#__codelineno-2-11">11</a></span>
<span class="normal"><a href="#__codelineno-2-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">Rover</span><span class="w"> </span>
<a id="__codelineno-2-2" name="__codelineno-2-2"></a><span class="p">{</span>
<a id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="p">{</span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">private</span><span class="w"> </span><span class="k">set</span><span class="p">;}</span>
<a id="__codelineno-2-4" name="__codelineno-2-4"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">Y</span><span class="w"> </span><span class="p">{</span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">private</span><span class="w"> </span><span class="k">set</span><span class="p">;}</span>
<a id="__codelineno-2-5" name="__codelineno-2-5"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="n">Direction</span><span class="w"> </span><span class="n">Direction</span><span class="w"> </span><span class="p">{</span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">private</span><span class="w"> </span><span class="k">set</span><span class="p">;}</span>
<a id="__codelineno-2-6" name="__codelineno-2-6"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="nf">Rover</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">Direction</span><span class="w"> </span><span class="n">direction</span><span class="p">)</span>
<a id="__codelineno-2-7" name="__codelineno-2-7"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-2-8" name="__codelineno-2-8"></a><span class="w">    </span><span class="n">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<a id="__codelineno-2-9" name="__codelineno-2-9"></a><span class="w">    </span><span class="n">Y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="p">;</span>
<a id="__codelineno-2-10" name="__codelineno-2-10"></a><span class="w">    </span><span class="n">Direction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">direction</span><span class="p">;</span>
<a id="__codelineno-2-11" name="__codelineno-2-11"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-2-12" name="__codelineno-2-12"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Let's take a look at how we can build the same idea in TypeScript (and by extension, JavaScript)</p>
<h3 id="introducing-fields"><a class="toclink" href="2025/06/10/today-i-learned---javascript-private-fields-and-properties/#introducing-fields">Introducing Fields</a></h3>
<p>Introducing fields are simple enough, we just define them in the class like so:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">1</a></span>
<span class="normal"><a href="#__codelineno-3-2">2</a></span>
<span class="normal"><a href="#__codelineno-3-3">3</a></span>
<span class="normal"><a href="#__codelineno-3-4">4</a></span>
<span class="normal"><a href="#__codelineno-3-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="kd">class</span><span class="w"> </span><span class="nx">Rover</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">x</span><span class="o">:</span><span class="kt">number</span><span class="p">;</span>
<a id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">y</span><span class="o">:</span><span class="kt">number</span><span class="p">;</span>
<a id="__codelineno-3-4" name="__codelineno-3-4"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">direction</span><span class="o">:</span><span class="kt">Direction</span><span class="p">;</span>
<a id="__codelineno-3-5" name="__codelineno-3-5"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>However, if you're working in JavaScript, the <code>private</code> keyword doesn't exist. However, JavaScript still allows you to mark something as <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes/Private_properties">private by prefixing <code>#</code> to the name.</a></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1">1</a></span>
<span class="normal"><a href="#__codelineno-4-2">2</a></span>
<span class="normal"><a href="#__codelineno-4-3">3</a></span>
<span class="normal"><a href="#__codelineno-4-4">4</a></span>
<span class="normal"><a href="#__codelineno-4-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="kd">class</span><span class="w"> </span><span class="nx">Rover</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="w">  </span><span class="n">#x</span><span class="p">;</span>
<a id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="w">  </span><span class="n">#y</span><span class="p">;</span>
<a id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="w">  </span><span class="n">#direction</span><span class="p">;</span>
<a id="__codelineno-4-5" name="__codelineno-4-5"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>With these fields in place, we now update our constructor to explicitly set the values.</p>
<p>In TypeScript
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1">1</a></span>
<span class="normal"><a href="#__codelineno-5-2">2</a></span>
<span class="normal"><a href="#__codelineno-5-3">3</a></span>
<span class="normal"><a href="#__codelineno-5-4">4</a></span>
<span class="normal"><a href="#__codelineno-5-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="kr">constructor</span><span class="p">(</span><span class="nx">x</span><span class="o">:</span><span class="kt">number</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="o">:</span><span class="kt">number</span><span class="p">,</span><span class="w"> </span><span class="nx">direction</span><span class="o">:</span><span class="kt">Direction</span><span class="p">){</span>
<a id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="w">  </span><span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">x</span><span class="p">;</span>
<a id="__codelineno-5-3" name="__codelineno-5-3"></a><span class="w">  </span><span class="k">this</span><span class="p">.</span><span class="nx">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">y</span><span class="p">;</span>
<a id="__codelineno-5-4" name="__codelineno-5-4"></a><span class="w">  </span><span class="k">this</span><span class="p">.</span><span class="nx">direction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">direction</span><span class="p">;</span>
<a id="__codelineno-5-5" name="__codelineno-5-5"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div></p>
<p>In JavaScript
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1">1</a></span>
<span class="normal"><a href="#__codelineno-6-2">2</a></span>
<span class="normal"><a href="#__codelineno-6-3">3</a></span>
<span class="normal"><a href="#__codelineno-6-4">4</a></span>
<span class="normal"><a href="#__codelineno-6-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="kr">constructor</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="p">,</span><span class="w"> </span><span class="nx">direction</span><span class="p">){</span>
<a id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="w">  </span><span class="k">this</span><span class="p">.</span><span class="n">#x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">x</span><span class="p">;</span>
<a id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="w">  </span><span class="k">this</span><span class="p">.</span><span class="n">#y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">y</span><span class="p">;</span>
<a id="__codelineno-6-4" name="__codelineno-6-4"></a><span class="w">  </span><span class="k">this</span><span class="p">.</span><span class="n">#direction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">direction</span><span class="p">;</span>
<a id="__codelineno-6-5" name="__codelineno-6-5"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div></p>
<p>At this point, we can update the various methods (<code>moveForward</code>, <code>moveBackward</code>, <code>turnLeft</code>, <code>turnRight</code>) to use the fields.</p>
<h3 id="introducing-properties"><a class="toclink" href="2025/06/10/today-i-learned---javascript-private-fields-and-properties/#introducing-properties">Introducing Properties</a></h3>
<p>With out fields in use, we can now expose their values by defining the get (colloquially known as the getter) for the fields.</p>
<p>In TypeScript</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1">1</a></span>
<span class="normal"><a href="#__codelineno-7-2">2</a></span>
<span class="normal"><a href="#__codelineno-7-3">3</a></span>
<span class="normal"><a href="#__codelineno-7-4">4</a></span>
<span class="normal"><a href="#__codelineno-7-5">5</a></span>
<span class="normal"><a href="#__codelineno-7-6">6</a></span>
<span class="normal"><a href="#__codelineno-7-7">7</a></span>
<span class="normal"><a href="#__codelineno-7-8">8</a></span>
<span class="normal"><a href="#__codelineno-7-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="nx">get</span><span class="w"> </span><span class="nx">x</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-7-2" name="__codelineno-7-2"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>
<a id="__codelineno-7-3" name="__codelineno-7-3"></a><span class="p">}</span>
<a id="__codelineno-7-4" name="__codelineno-7-4"></a><span class="nx">get</span><span class="w"> </span><span class="nx">y</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-7-5" name="__codelineno-7-5"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">y</span><span class="p">;</span>
<a id="__codelineno-7-6" name="__codelineno-7-6"></a><span class="p">}</span>
<a id="__codelineno-7-7" name="__codelineno-7-7"></a><span class="nx">get</span><span class="w"> </span><span class="nx">direction</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nx">Direction</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-7-8" name="__codelineno-7-8"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">direction</span><span class="p">;</span>
<a id="__codelineno-7-9" name="__codelineno-7-9"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>In JavaScript
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1">1</a></span>
<span class="normal"><a href="#__codelineno-8-2">2</a></span>
<span class="normal"><a href="#__codelineno-8-3">3</a></span>
<span class="normal"><a href="#__codelineno-8-4">4</a></span>
<span class="normal"><a href="#__codelineno-8-5">5</a></span>
<span class="normal"><a href="#__codelineno-8-6">6</a></span>
<span class="normal"><a href="#__codelineno-8-7">7</a></span>
<span class="normal"><a href="#__codelineno-8-8">8</a></span>
<span class="normal"><a href="#__codelineno-8-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a><span class="nx">get</span><span class="w"> </span><span class="nx">x</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-8-2" name="__codelineno-8-2"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">#x</span><span class="p">;</span>
<a id="__codelineno-8-3" name="__codelineno-8-3"></a><span class="p">}</span>
<a id="__codelineno-8-4" name="__codelineno-8-4"></a><span class="nx">get</span><span class="w"> </span><span class="nx">y</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-8-5" name="__codelineno-8-5"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">#y</span><span class="p">;</span>
<a id="__codelineno-8-6" name="__codelineno-8-6"></a><span class="p">}</span>
<a id="__codelineno-8-7" name="__codelineno-8-7"></a><span class="nx">get</span><span class="w"> </span><span class="nx">direction</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-8-8" name="__codelineno-8-8"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">#direction</span><span class="p">;</span>
<a id="__codelineno-8-9" name="__codelineno-8-9"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div></p>
<p>With our properties in place, the following code will work now</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1">1</a></span>
<span class="normal"><a href="#__codelineno-9-2">2</a></span>
<span class="normal"><a href="#__codelineno-9-3">3</a></span>
<span class="normal"><a href="#__codelineno-9-4">4</a></span>
<span class="normal"><a href="#__codelineno-9-5">5</a></span>
<span class="normal"><a href="#__codelineno-9-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="kd">const</span><span class="w"> </span><span class="nx">rover</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Rover</span><span class="p">(</span><span class="mf">4</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;North&#39;</span><span class="p">);</span>
<a id="__codelineno-9-2" name="__codelineno-9-2"></a><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Rover is at (</span><span class="si">${</span><span class="nx">rover</span><span class="p">.</span><span class="nx">X</span><span class="si">}</span><span class="sb">, </span><span class="si">${</span><span class="nx">rover</span><span class="p">.</span><span class="nx">Y</span><span class="si">}</span><span class="sb">) facing </span><span class="si">${</span><span class="nx">rover</span><span class="p">.</span><span class="nx">Direction</span><span class="si">}</span><span class="sb">)`</span><span class="p">);</span>
<a id="__codelineno-9-3" name="__codelineno-9-3"></a><span class="c1">// prints &quot;Rover is at (4, 2) facing North</span>
<a id="__codelineno-9-4" name="__codelineno-9-4"></a>
<a id="__codelineno-9-5" name="__codelineno-9-5"></a><span class="c1">// But this doesn&#39;t work</span>
<a id="__codelineno-9-6" name="__codelineno-9-6"></a><span class="nx">rover</span><span class="p">.</span><span class="nx">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">100</span><span class="p">;</span><span class="w"> </span><span class="c1">// can&#39;t access X</span>
</code></pre></div></td></tr></table></div>
<h3 id="closing-thoughts"><a class="toclink" href="2025/06/10/today-i-learned---javascript-private-fields-and-properties/#closing-thoughts">Closing Thoughts</a></h3>
<p>When working with data that requires different access levels, think about leveraging private fields and then providing access through public properties.</p>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/cameronpresley.png" alt="Cameron Presley">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2025-05-27 00:00:00+00:00">May 27, 2025</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="category/typescript/" class="md-meta__link">TypeScript</a>, 
              <a href="category/functional-programming/" class="md-meta__link">Functional Programming</a></li>
        
        
          
          <li class="md-meta__item">
            
              5 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="simplifying-console-logic-with-the-model-view-update"><a class="toclink" href="2025/05/27/simplifying-console-logic-with-the-model-view-update/">Simplifying Console Logic with the Model-View-Update</a></h2>
<p>When I first started dabbling in Functional Programming, a new front-end language called <a href="https://elm-lang.org/">Elm</a> had been released and it was generating a lot of buzz about how it simplified web development by introducing four parts (i.e., The Elm Architecture" (TEA)) that provided a mental model when creating web pages. This way of thinking was so powerful that it inspired popular libraries like <a href="https://redux.js.org/understanding/history-and-design/prior-art#elm">Redux</a> and <a href="https://ngrx.io/docs">ngrx</a> which took this architecture mainstream.</p>
<h3 id="spilling-the-tea"><a class="toclink" href="2025/05/27/simplifying-console-logic-with-the-model-view-update/#spilling-the-tea">Spilling the TEA</a></h3>
<p>At a high level, the architecture has four parts:</p>
<ol>
<li>Model -&gt; What are we rendering?</li>
<li>View -&gt; How do we want to render it?</li>
<li>Update -&gt; Given the current model and a Command, what's the new model?</li>
<li>Command -&gt; What did the user do?</li>
</ol>
<p>To help make this a bit more clear, let's define some types for these parts and see how they would work together</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-0-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-0-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-0-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">any</span><span class="p">;</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="kr">type</span><span class="w"> </span><span class="nx">View</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">m</span><span class="o">:</span><span class="kt">Model</span><span class="p">)=&gt;</span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">Command</span><span class="o">&gt;</span><span class="p">;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Update</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">m</span><span class="o">:</span><span class="kt">Model</span><span class="p">,</span><span class="w"> </span><span class="nx">c</span><span class="o">:</span><span class="kt">Command</span><span class="p">)=&gt;</span><span class="nx">Model</span><span class="p">;</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;firstOption&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;secondOption&quot;</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;quit&#39;</span><span class="p">;</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">main</span><span class="p">(</span><span class="nx">model</span><span class="o">:</span><span class="kt">Model</span><span class="p">,</span><span class="w"> </span><span class="nx">view</span><span class="o">:</span><span class="kt">View</span><span class="p">,</span><span class="w"> </span><span class="nx">update</span><span class="o">:</span><span class="kt">Update</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="p">{</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">view</span><span class="p">(</span><span class="nx">model</span><span class="p">);</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">command</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;quit&#39;</span><span class="p">){</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="w">    </span><span class="k">return</span><span class="p">;</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">newModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">update</span><span class="p">(</span><span class="nx">model</span><span class="p">,</span><span class="w"> </span><span class="nx">command</span><span class="p">);</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">main</span><span class="p">(</span><span class="nx">newModel</span><span class="p">);</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>With some types in play, let's go ahead and build out a small application, a counter (the "Hello World" for Elm).</p>
<h3 id="building-a-counter"><a class="toclink" href="2025/05/27/simplifying-console-logic-with-the-model-view-update/#building-a-counter">Building a Counter</a></h3>
<p>First, we need to figure out what the model will be. Since we're only keeping tracking of a number, we can define our model as a number.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
</code></pre></div></td></tr></table></div>
<p>Next, we need to define what the user can do. In this case, they can either <em>increment</em>, <em>decrement</em>, or <em>quit</em> so let's set the command up.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;increment&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;decrement&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;quit&#39;</span><span class="p">;</span>
</code></pre></div></td></tr></table></div>
<p>Now that we have <code>Command</code>, we can work on the <code>update</code> function. Given the type signature from before, we know its going to look like this:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">1</a></span>
<span class="normal"><a href="#__codelineno-3-2">2</a></span>
<span class="normal"><a href="#__codelineno-3-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="kd">function</span><span class="w"> </span><span class="nx">update</span><span class="p">(</span><span class="nx">model</span><span class="o">:</span><span class="kt">Model</span><span class="p">,</span><span class="w"> </span><span class="nx">command</span><span class="o">:</span><span class="kt">Command</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">Model</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="w">  </span><span class="c1">// logic</span>
<a id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>We can leverage a <code>switch</code> and put in our business rules</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1">1</a></span>
<span class="normal"><a href="#__codelineno-4-2">2</a></span>
<span class="normal"><a href="#__codelineno-4-3">3</a></span>
<span class="normal"><a href="#__codelineno-4-4">4</a></span>
<span class="normal"><a href="#__codelineno-4-5">5</a></span>
<span class="normal"><a href="#__codelineno-4-6">6</a></span>
<span class="normal"><a href="#__codelineno-4-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="kd">function</span><span class="w"> </span><span class="nx">update</span><span class="p">(</span><span class="nx">model</span><span class="o">:</span><span class="kt">Model</span><span class="p">,</span><span class="w"> </span><span class="nx">command</span><span class="o">:</span><span class="kt">Command</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">Model</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="w">  </span><span class="k">switch</span><span class="p">(</span><span class="nx">command</span><span class="p">){</span>
<a id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;increment&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">model</span><span class="o">+</span><span class="mf">1</span><span class="p">;</span>
<a id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;decrement&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">model</span><span class="o">-</span><span class="mf">1</span><span class="p">;</span>
<a id="__codelineno-4-5" name="__codelineno-4-5"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;quit&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">model</span><span class="p">;</span>
<a id="__codelineno-4-6" name="__codelineno-4-6"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-4-7" name="__codelineno-4-7"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Finally, we need to define our <code>view</code> function. Like before, we can get the skeleton for the function based on the types from earlier.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1">1</a></span>
<span class="normal"><a href="#__codelineno-5-2">2</a></span>
<span class="normal"><a href="#__codelineno-5-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">view</span><span class="p">(</span><span class="nx">model</span><span class="o">:</span><span class="kt">Model</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">Command</span><span class="o">&gt;</span><span class="p">{</span>
<a id="__codelineno-5-2" name="__codelineno-5-2"></a>
<a id="__codelineno-5-3" name="__codelineno-5-3"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Let's update the function with our rendering logic</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1">1</a></span>
<span class="normal"><a href="#__codelineno-6-2">2</a></span>
<span class="normal"><a href="#__codelineno-6-3">3</a></span>
<span class="normal"><a href="#__codelineno-6-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">view</span><span class="p">(</span><span class="nx">model</span><span class="o">:</span><span class="kt">Model</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">Command</span><span class="o">&gt;</span><span class="p">{</span>
<a id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Counter:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">model</span><span class="p">);</span>
<a id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Choose to (i)ncrement, (d)ecrement, or (q)uit&quot;</span><span class="p">);</span>
<a id="__codelineno-6-4" name="__codelineno-6-4"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>We've got our render up and running, however, we need to get input from the user. Since we're working within Node, we could use <a href="https://nodejs.org/api/readline.html">readline</a>, however, I've recently been using <a href="https://www.npmjs.com/package/@inquirer/prompts">@inquirer/prompts</a> and find it to be a nice abstraction to use. So let's use that package.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-7-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-7-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-7-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-7-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-7-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-7-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-7-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-7-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-7-10">10</a></span>
<span class="normal"><a href="#__codelineno-7-11">11</a></span>
<span class="normal"><a href="#__codelineno-7-12">12</a></span>
<span class="normal"><a href="#__codelineno-7-13">13</a></span>
<span class="normal"><a href="#__codelineno-7-14">14</a></span>
<span class="normal"><a href="#__codelineno-7-15">15</a></span>
<span class="normal"><a href="#__codelineno-7-16">16</a></span>
<span class="normal"><a href="#__codelineno-7-17">17</a></span>
<span class="normal"><a href="#__codelineno-7-18">18</a></span>
<span class="normal"><a href="#__codelineno-7-19">19</a></span>
<span class="normal"><a href="#__codelineno-7-20">20</a></span>
<span class="normal"><a href="#__codelineno-7-21">21</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="nx">input</span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@inquirer/prompts&quot;</span><span class="p">;</span>
<a id="__codelineno-7-2" name="__codelineno-7-2"></a>
<a id="__codelineno-7-3" name="__codelineno-7-3"></a><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">getChoice</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">Command</span><span class="o">&gt;</span><span class="p">{</span>
<a id="__codelineno-7-4" name="__codelineno-7-4"></a><span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Choose to (i)ncrement, (d)ecrement, or (q)uit&quot;</span><span class="p">);</span>
<a id="__codelineno-7-5" name="__codelineno-7-5"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">validChoices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;i&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;d&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;q&quot;</span><span class="p">];</span>
<a id="__codelineno-7-6" name="__codelineno-7-6"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">validator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">s</span><span class="o">:</span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">validChoices</span><span class="p">.</span><span class="nx">include</span><span class="p">(</span><span class="nx">s</span><span class="o">?</span><span class="p">.</span><span class="nx">trim</span><span class="p">().</span><span class="nx">toLowerCase</span><span class="p">());</span>
<a id="__codelineno-7-7" name="__codelineno-7-7"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">selection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">input</span><span class="p">({</span><span class="nx">message</span><span class="o">:</span><span class="kt">message</span><span class="p">,</span><span class="w"> </span><span class="nx">validate</span><span class="o">:</span><span class="kt">validator</span><span class="p">});</span>
<a id="__codelineno-7-8" name="__codelineno-7-8"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">selection</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;i&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-7-9" name="__codelineno-7-9"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s2">&quot;increment&quot;</span><span class="p">;</span>
<a id="__codelineno-7-10" name="__codelineno-7-10"></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">selection</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;d&quot;</span><span class="p">){</span>
<a id="__codelineno-7-11" name="__codelineno-7-11"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s2">&quot;decrement&quot;</span><span class="p">;</span>
<a id="__codelineno-7-12" name="__codelineno-7-12"></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-7-13" name="__codelineno-7-13"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s2">&quot;terminate&quot;</span>
<a id="__codelineno-7-14" name="__codelineno-7-14"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-7-15" name="__codelineno-7-15"></a><span class="p">}</span>
<a id="__codelineno-7-16" name="__codelineno-7-16"></a><span class="c1">// Let&#39;s change the view function to use getChoice</span>
<a id="__codelineno-7-17" name="__codelineno-7-17"></a>
<a id="__codelineno-7-18" name="__codelineno-7-18"></a><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">view</span><span class="p">(</span><span class="nx">model</span><span class="o">:</span><span class="kt">Model</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">Command</span><span class="o">&gt;</span><span class="p">{</span>
<a id="__codelineno-7-19" name="__codelineno-7-19"></a><span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Counter:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">model</span><span class="p">);</span>
<a id="__codelineno-7-20" name="__codelineno-7-20"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">getChoice</span><span class="p">();</span>
<a id="__codelineno-7-21" name="__codelineno-7-21"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>With these pieces defined, we can use the <code>main</code> function from before.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-8-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-8-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-8-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-8-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-8-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-8-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-8-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-8-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-8-10">10</a></span>
<span class="normal"><a href="#__codelineno-8-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">main</span><span class="p">(</span><span class="nx">model</span><span class="o">:</span><span class="kt">Model</span><span class="p">,</span><span class="w"> </span><span class="nx">view</span><span class="o">:</span><span class="kt">View</span><span class="p">,</span><span class="w"> </span><span class="nx">update</span><span class="o">:</span><span class="kt">Update</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="p">{</span>
<a id="__codelineno-8-2" name="__codelineno-8-2"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">view</span><span class="p">(</span><span class="nx">model</span><span class="p">);</span>
<a id="__codelineno-8-3" name="__codelineno-8-3"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">command</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;quit&#39;</span><span class="p">){</span>
<a id="__codelineno-8-4" name="__codelineno-8-4"></a><span class="w">    </span><span class="k">return</span><span class="p">;</span>
<a id="__codelineno-8-5" name="__codelineno-8-5"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-8-6" name="__codelineno-8-6"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">newModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">update</span><span class="p">(</span><span class="nx">model</span><span class="p">,</span><span class="w"> </span><span class="nx">command</span><span class="p">);</span>
<a id="__codelineno-8-7" name="__codelineno-8-7"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">main</span><span class="p">(</span><span class="nx">newModel</span><span class="p">);</span>
<a id="__codelineno-8-8" name="__codelineno-8-8"></a><span class="p">}</span>
<a id="__codelineno-8-9" name="__codelineno-8-9"></a>
<a id="__codelineno-8-10" name="__codelineno-8-10"></a><span class="c1">// Invoking Main</span>
<a id="__codelineno-8-11" name="__codelineno-8-11"></a><span class="nx">main</span><span class="p">(</span><span class="mf">10</span><span class="p">,</span><span class="w"> </span><span class="nx">view</span><span class="p">,</span><span class="w"> </span><span class="nx">update</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<h3 id="starting-back-at-zero"><a class="toclink" href="2025/05/27/simplifying-console-logic-with-the-model-view-update/#starting-back-at-zero">Starting Back at Zero</a></h3>
<p>Now that we have increment and decrement working, it would be nice to be able to reset the counter without having to restart the application, so let's see how bad that would be.</p>
<p>First, we need to add a new choice to <code>Command</code> (called <em>reset</em>). This will force us to update the rest of the code that's working with <code>Command</code>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;increment&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;decrement&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;reset&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;quit&quot;</span><span class="p">;</span>
</code></pre></div></td></tr></table></div>
<p>Next, we need to update the <code>update</code> function so it knows how to handle a <code>reset</code> command. In our case, we need to set the model back to zero.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1">1</a></span>
<span class="normal"><a href="#__codelineno-10-2">2</a></span>
<span class="normal"><a href="#__codelineno-10-3">3</a></span>
<span class="normal"><a href="#__codelineno-10-4">4</a></span>
<span class="normal"><a href="#__codelineno-10-5">5</a></span>
<span class="normal"><a href="#__codelineno-10-6">6</a></span>
<span class="normal"><a href="#__codelineno-10-7">7</a></span>
<span class="normal"><a href="#__codelineno-10-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="kd">function</span><span class="w"> </span><span class="nx">update</span><span class="p">(</span><span class="nx">model</span><span class="o">:</span><span class="kt">Model</span><span class="p">,</span><span class="w"> </span><span class="nx">command</span><span class="o">:</span><span class="kt">Command</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">Model</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-10-2" name="__codelineno-10-2"></a><span class="w">  </span><span class="k">switch</span><span class="p">(</span><span class="nx">command</span><span class="p">){</span>
<a id="__codelineno-10-3" name="__codelineno-10-3"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;increment&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">model</span><span class="o">+</span><span class="mf">1</span><span class="p">;</span>
<a id="__codelineno-10-4" name="__codelineno-10-4"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;decrement&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">model</span><span class="o">-</span><span class="mf">1</span><span class="p">;</span>
<a id="__codelineno-10-5" name="__codelineno-10-5"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;reset&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<a id="__codelineno-10-6" name="__codelineno-10-6"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;quit&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">model</span><span class="p">;</span>
<a id="__codelineno-10-7" name="__codelineno-10-7"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-10-8" name="__codelineno-10-8"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>At this point, the application knows how to handle the new <code>Command</code>, however, we need to update our <code>view</code> function to allow the user to select reset.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-11-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-11-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-11-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-11-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-11-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-11-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-11-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-11-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-11-10">10</a></span>
<span class="normal"><a href="#__codelineno-11-11">11</a></span>
<span class="normal"><a href="#__codelineno-11-12">12</a></span>
<span class="normal"><a href="#__codelineno-11-13">13</a></span>
<span class="normal"><a href="#__codelineno-11-14">14</a></span>
<span class="normal"><a href="#__codelineno-11-15">15</a></span>
<span class="normal"><a href="#__codelineno-11-16">16</a></span>
<span class="normal"><a href="#__codelineno-11-17">17</a></span>
<span class="normal"><a href="#__codelineno-11-18">18</a></span>
<span class="normal"><a href="#__codelineno-11-19">19</a></span>
<span class="normal"><a href="#__codelineno-11-20">20</a></span>
<span class="normal"><a href="#__codelineno-11-21">21</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">view</span><span class="p">(</span><span class="nx">model</span><span class="o">:</span><span class="kt">Model</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">Command</span><span class="o">&gt;</span><span class="p">{</span>
<a id="__codelineno-11-2" name="__codelineno-11-2"></a><span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Counter:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">model</span><span class="p">);</span>
<a id="__codelineno-11-3" name="__codelineno-11-3"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">getChoice</span><span class="p">();</span>
<a id="__codelineno-11-4" name="__codelineno-11-4"></a><span class="p">}</span>
<a id="__codelineno-11-5" name="__codelineno-11-5"></a>
<a id="__codelineno-11-6" name="__codelineno-11-6"></a><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">getChoice</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">Command</span><span class="o">&gt;</span><span class="p">{</span>
<a id="__codelineno-11-7" name="__codelineno-11-7"></a><span class="w">  </span><span class="c1">// updating the console.log</span>
<a id="__codelineno-11-8" name="__codelineno-11-8"></a><span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Choose to (i)ncrement, (d)ecrement, (r)eset, or (q)uit&quot;</span><span class="p">);</span><span class="w"> </span>
<a id="__codelineno-11-9" name="__codelineno-11-9"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">validChoices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;i&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;d&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;r&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;q&quot;</span><span class="p">];</span>
<a id="__codelineno-11-10" name="__codelineno-11-10"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">validator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">s</span><span class="o">:</span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">validChoices</span><span class="p">.</span><span class="nx">include</span><span class="p">(</span><span class="nx">s</span><span class="o">?</span><span class="p">.</span><span class="nx">trim</span><span class="p">().</span><span class="nx">toLowerCase</span><span class="p">());</span>
<a id="__codelineno-11-11" name="__codelineno-11-11"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">selection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">input</span><span class="p">({</span><span class="nx">message</span><span class="o">:</span><span class="kt">message</span><span class="p">,</span><span class="w"> </span><span class="nx">validate</span><span class="o">:</span><span class="kt">validator</span><span class="p">});</span>
<a id="__codelineno-11-12" name="__codelineno-11-12"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">selection</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;i&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-11-13" name="__codelineno-11-13"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s2">&quot;increment&quot;</span><span class="p">;</span>
<a id="__codelineno-11-14" name="__codelineno-11-14"></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">selection</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;d&quot;</span><span class="p">){</span>
<a id="__codelineno-11-15" name="__codelineno-11-15"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s2">&quot;decrement&quot;</span><span class="p">;</span>
<a id="__codelineno-11-16" name="__codelineno-11-16"></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">selection</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;r&quot;</span><span class="p">){</span>
<a id="__codelineno-11-17" name="__codelineno-11-17"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s2">&quot;reset&quot;</span><span class="p">;</span>
<a id="__codelineno-11-18" name="__codelineno-11-18"></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-11-19" name="__codelineno-11-19"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s2">&quot;terminate&quot;</span>
<a id="__codelineno-11-20" name="__codelineno-11-20"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-11-21" name="__codelineno-11-21"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h3 id="whats-next"><a class="toclink" href="2025/05/27/simplifying-console-logic-with-the-model-view-update/#whats-next">What's Next?</a></h3>
<p>Now that we have have a working version, you could start implementing some fun functionality. For example, how would you allow someone to set how much to increment or decrement by? What if you needed to keep track of previous values (i.e., maintaining history)? I highly encourage you trying this out with a simple kata (for example, how about giving <a href="2020/05/20/mars-rover---defining-the-problem/#problem-description">Mars Rover</a> a try?)</p>
<h3 id="full-working-solution"><a class="toclink" href="2025/05/27/simplifying-console-logic-with-the-model-view-update/#full-working-solution">Full Working Solution</a></h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-12-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-12-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-12-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-12-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-12-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-12-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-12-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-12-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-12-10">10</a></span>
<span class="normal"><a href="#__codelineno-12-11">11</a></span>
<span class="normal"><a href="#__codelineno-12-12">12</a></span>
<span class="normal"><a href="#__codelineno-12-13">13</a></span>
<span class="normal"><a href="#__codelineno-12-14">14</a></span>
<span class="normal"><a href="#__codelineno-12-15">15</a></span>
<span class="normal"><a href="#__codelineno-12-16">16</a></span>
<span class="normal"><a href="#__codelineno-12-17">17</a></span>
<span class="normal"><a href="#__codelineno-12-18">18</a></span>
<span class="normal"><a href="#__codelineno-12-19">19</a></span>
<span class="normal"><a href="#__codelineno-12-20">20</a></span>
<span class="normal"><a href="#__codelineno-12-21">21</a></span>
<span class="normal"><a href="#__codelineno-12-22">22</a></span>
<span class="normal"><a href="#__codelineno-12-23">23</a></span>
<span class="normal"><a href="#__codelineno-12-24">24</a></span>
<span class="normal"><a href="#__codelineno-12-25">25</a></span>
<span class="normal"><a href="#__codelineno-12-26">26</a></span>
<span class="normal"><a href="#__codelineno-12-27">27</a></span>
<span class="normal"><a href="#__codelineno-12-28">28</a></span>
<span class="normal"><a href="#__codelineno-12-29">29</a></span>
<span class="normal"><a href="#__codelineno-12-30">30</a></span>
<span class="normal"><a href="#__codelineno-12-31">31</a></span>
<span class="normal"><a href="#__codelineno-12-32">32</a></span>
<span class="normal"><a href="#__codelineno-12-33">33</a></span>
<span class="normal"><a href="#__codelineno-12-34">34</a></span>
<span class="normal"><a href="#__codelineno-12-35">35</a></span>
<span class="normal"><a href="#__codelineno-12-36">36</a></span>
<span class="normal"><a href="#__codelineno-12-37">37</a></span>
<span class="normal"><a href="#__codelineno-12-38">38</a></span>
<span class="normal"><a href="#__codelineno-12-39">39</a></span>
<span class="normal"><a href="#__codelineno-12-40">40</a></span>
<span class="normal"><a href="#__codelineno-12-41">41</a></span>
<span class="normal"><a href="#__codelineno-12-42">42</a></span>
<span class="normal"><a href="#__codelineno-12-43">43</a></span>
<span class="normal"><a href="#__codelineno-12-44">44</a></span>
<span class="normal"><a href="#__codelineno-12-45">45</a></span>
<span class="normal"><a href="#__codelineno-12-46">46</a></span>
<span class="normal"><a href="#__codelineno-12-47">47</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="nx">input</span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;@inquirer/prompts&quot;</span><span class="p">;</span>
<a id="__codelineno-12-2" name="__codelineno-12-2"></a>
<a id="__codelineno-12-3" name="__codelineno-12-3"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<a id="__codelineno-12-4" name="__codelineno-12-4"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;increment&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;decrement&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;reset&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;quit&quot;</span><span class="p">;</span>
<a id="__codelineno-12-5" name="__codelineno-12-5"></a><span class="kr">type</span><span class="w"> </span><span class="nx">View</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">model</span><span class="o">:</span><span class="kt">Model</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">Command</span><span class="o">&gt;</span><span class="p">;</span>
<a id="__codelineno-12-6" name="__codelineno-12-6"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Update</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">model</span><span class="o">:</span><span class="kt">Model</span><span class="p">,</span><span class="w"> </span><span class="nx">command</span><span class="o">:</span><span class="kt">Command</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">Model</span><span class="p">;</span>
<a id="__codelineno-12-7" name="__codelineno-12-7"></a>
<a id="__codelineno-12-8" name="__codelineno-12-8"></a><span class="kd">function</span><span class="w"> </span><span class="nx">update</span><span class="p">(</span><span class="nx">model</span><span class="o">:</span><span class="kt">Model</span><span class="p">,</span><span class="w"> </span><span class="nx">command</span><span class="o">:</span><span class="kt">Command</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">Model</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-12-9" name="__codelineno-12-9"></a><span class="w">  </span><span class="k">switch</span><span class="p">(</span><span class="nx">command</span><span class="p">){</span>
<a id="__codelineno-12-10" name="__codelineno-12-10"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;increment&quot;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">model</span><span class="o">+</span><span class="mf">1</span><span class="p">;</span>
<a id="__codelineno-12-11" name="__codelineno-12-11"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;decrement&quot;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">model</span><span class="o">-</span><span class="mf">1</span><span class="p">;</span>
<a id="__codelineno-12-12" name="__codelineno-12-12"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;reset&quot;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<a id="__codelineno-12-13" name="__codelineno-12-13"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;quit&quot;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">model</span><span class="p">;</span>
<a id="__codelineno-12-14" name="__codelineno-12-14"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-12-15" name="__codelineno-12-15"></a><span class="p">}</span>
<a id="__codelineno-12-16" name="__codelineno-12-16"></a>
<a id="__codelineno-12-17" name="__codelineno-12-17"></a><span class="kd">function</span><span class="w"> </span><span class="nx">view</span><span class="p">(</span><span class="nx">model</span><span class="o">:</span><span class="kt">Model</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">Command</span><span class="o">&gt;</span><span class="p">{</span>
<a id="__codelineno-12-18" name="__codelineno-12-18"></a><span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Counter:</span><span class="si">${</span><span class="nx">model</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<a id="__codelineno-12-19" name="__codelineno-12-19"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">getChoice</span><span class="p">();</span>
<a id="__codelineno-12-20" name="__codelineno-12-20"></a><span class="p">}</span>
<a id="__codelineno-12-21" name="__codelineno-12-21"></a>
<a id="__codelineno-12-22" name="__codelineno-12-22"></a><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">getChoice</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">Command</span><span class="o">&gt;</span><span class="p">{</span>
<a id="__codelineno-12-23" name="__codelineno-12-23"></a><span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Choose to (i)ncrement, (d)ecrement, (r)eset, or (q)uit&quot;</span><span class="p">);</span><span class="w"> </span>
<a id="__codelineno-12-24" name="__codelineno-12-24"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">validChoices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;i&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;d&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;r&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;q&quot;</span><span class="p">];</span>
<a id="__codelineno-12-25" name="__codelineno-12-25"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">validator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">s</span><span class="o">:</span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">validChoices</span><span class="p">.</span><span class="nx">include</span><span class="p">(</span><span class="nx">s</span><span class="o">?</span><span class="p">.</span><span class="nx">trim</span><span class="p">().</span><span class="nx">toLowerCase</span><span class="p">());</span>
<a id="__codelineno-12-26" name="__codelineno-12-26"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">selection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">input</span><span class="p">({</span><span class="nx">message</span><span class="o">:</span><span class="kt">message</span><span class="p">,</span><span class="w"> </span><span class="nx">validate</span><span class="o">:</span><span class="kt">validator</span><span class="p">});</span>
<a id="__codelineno-12-27" name="__codelineno-12-27"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">selection</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;i&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-12-28" name="__codelineno-12-28"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s2">&quot;increment&quot;</span><span class="p">;</span>
<a id="__codelineno-12-29" name="__codelineno-12-29"></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">selection</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;d&quot;</span><span class="p">){</span>
<a id="__codelineno-12-30" name="__codelineno-12-30"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s2">&quot;decrement&quot;</span><span class="p">;</span>
<a id="__codelineno-12-31" name="__codelineno-12-31"></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">selection</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;r&quot;</span><span class="p">){</span>
<a id="__codelineno-12-32" name="__codelineno-12-32"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s2">&quot;reset&quot;</span><span class="p">;</span>
<a id="__codelineno-12-33" name="__codelineno-12-33"></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-12-34" name="__codelineno-12-34"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s2">&quot;terminate&quot;</span>
<a id="__codelineno-12-35" name="__codelineno-12-35"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-12-36" name="__codelineno-12-36"></a><span class="p">}</span>
<a id="__codelineno-12-37" name="__codelineno-12-37"></a>
<a id="__codelineno-12-38" name="__codelineno-12-38"></a><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">main</span><span class="p">(</span><span class="nx">model</span><span class="o">:</span><span class="kt">Model</span><span class="p">,</span><span class="w"> </span><span class="nx">view</span><span class="o">:</span><span class="kt">View</span><span class="p">,</span><span class="w"> </span><span class="nx">update</span><span class="o">:</span><span class="kt">Update</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="p">{</span>
<a id="__codelineno-12-39" name="__codelineno-12-39"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">view</span><span class="p">(</span><span class="nx">model</span><span class="p">);</span>
<a id="__codelineno-12-40" name="__codelineno-12-40"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">command</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;quit&#39;</span><span class="p">){</span>
<a id="__codelineno-12-41" name="__codelineno-12-41"></a><span class="w">    </span><span class="k">return</span><span class="p">;</span>
<a id="__codelineno-12-42" name="__codelineno-12-42"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-12-43" name="__codelineno-12-43"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">newModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">update</span><span class="p">(</span><span class="nx">model</span><span class="p">,</span><span class="w"> </span><span class="nx">command</span><span class="p">);</span>
<a id="__codelineno-12-44" name="__codelineno-12-44"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">main</span><span class="p">(</span><span class="nx">newModel</span><span class="p">,</span><span class="w"> </span><span class="nx">view</span><span class="p">,</span><span class="w"> </span><span class="nx">update</span><span class="p">);</span>
<a id="__codelineno-12-45" name="__codelineno-12-45"></a><span class="p">}</span>
<a id="__codelineno-12-46" name="__codelineno-12-46"></a>
<a id="__codelineno-12-47" name="__codelineno-12-47"></a><span class="nx">main</span><span class="p">(</span><span class="mf">10</span><span class="p">,</span><span class="w"> </span><span class="nx">view</span><span class="p">,</span><span class="w"> </span><span class="nx">update</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/cameronpresley.png" alt="Cameron Presley">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2025-05-13 00:00:00+00:00">May 13, 2025</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="category/today-i-learned/" class="md-meta__link">Today I Learned</a>, 
              <a href="category/typescript/" class="md-meta__link">TypeScript</a></li>
        
        
          
          <li class="md-meta__item">
            
              8 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="leveraging-tuples-in-typescript"><a class="toclink" href="2025/05/13/leveraging-tuples-in-typescript/">Leveraging Tuples in TypeScript</a></h2>
<p>In preparation for <a href="https://stirtrek.com/">StirTrek</a>, I'm revisiting my approach for how to implement the game of <a href="https://en.wikipedia.org/wiki/Blackjack">Blackjack</a>. I find card games to be a great introduction to functional concepts as you hit the major concepts quickly and the use cases are intuitive.</p>
<p>Let's take a look at one of the concepts in the game, <code>Points</code>.</p>
<p>Blackjack is played with a standard deck of cards (13 Ranks and 4 Suits) where the goal is to get the closest to 21 points without going over. A card is worth Points based on its Rank. So let's go ahead and model what we know so far.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Rank</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Ace&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mf">2</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mf">3</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mf">4</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mf">5</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mf">6</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mf">7</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mf">8</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mf">9</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mf">10</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;Jack&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;Queen&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;King&quot;</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Suit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Hearts&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;Clubs&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;Spades&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;Diamonds&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Card</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="k">readonly</span><span class="w"> </span><span class="nx">rank</span><span class="o">:</span><span class="kt">Rank</span><span class="p">,</span><span class="w"> </span><span class="k">readonly</span><span class="w"> </span><span class="nx">suit</span><span class="o">:</span><span class="kt">Suit</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>We know that a <code>Card</code> is worth points based on its rank, the rule are:</p>
<ul>
<li>Cards with a Rank of 2 through 10 are worth that many points (i.e., 2's are worth 2 points, 3's are worth 3 points, ..., 10's are worth 10 points)</li>
<li>Cards with a Rank of Jack, Queen, or King are worth 10 points</li>
<li>Cards with a Rank of Ace can be worth either 1 or 11 points (depending on which one is the most advantageous)</li>
</ul>
<p>Let's explore the Ace in more detail.</p>
<p>For example, if we had a hand consisting of an <code>Ace</code> and a <code>King</code>, then it could be worth either 11 (treating the Ace as a 1) or as 21 (treating the Ace as an 11). In this case, we'd want to treat the Ace as an 11 as that gives us 21 exactly (specifically, a <em>Blackjack</em>).</p>
<p>In another example, if we had a hand consisting of an <code>Ace</code>, <code>6</code>, and <code>Jack</code>, then it could either be worth 17 (treating the Ace as a 1) or 27 (treating the Ace as an 11). Since 27 is greater than 21 (which would cause us to <em>bust</em>), we wouldn't want the Ace to be worth 11.</p>
<h4 id="creating-cardtopoints"><a class="toclink" href="2025/05/13/leveraging-tuples-in-typescript/#creating-cardtopoints">Creating cardToPoints</a></h4>
<p>Now that we have this detail, let's take a look at trying to write the <code>cardToPoints</code> function.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-1-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-1-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-1-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-1-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-1-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-1-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-1-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-1-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-1-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="kd">function</span><span class="w"> </span><span class="nx">cardToPoints</span><span class="p">(</span><span class="nx">c</span><span class="o">:</span><span class="kt">Card</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">Points</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// Note we don&#39;t know what the type of this is yet</span>
<a id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="w">  </span><span class="k">switch</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">rank</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;Ace&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="o">???</span>
<a id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;King&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mf">10</span><span class="p">;</span>
<a id="__codelineno-1-5" name="__codelineno-1-5"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;Queen&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mf">10</span><span class="p">;</span>
<a id="__codelineno-1-6" name="__codelineno-1-6"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;Jack&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mf">10</span><span class="p">;</span>
<a id="__codelineno-1-7" name="__codelineno-1-7"></a><span class="w">    </span><span class="nx">default</span><span class="o">:</span>
<a id="__codelineno-1-8" name="__codelineno-1-8"></a><span class="w">      </span><span class="kt">return</span><span class="w"> </span><span class="nx">c</span><span class="p">.</span><span class="nx">rank</span><span class="p">;</span><span class="w"> </span><span class="c1">// we can do this because TypeScript knows all the remaining options for Rank are numbers</span>
<a id="__codelineno-1-9" name="__codelineno-1-9"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-1-10" name="__codelineno-1-10"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>At this point, we don't know how to score <code>Ace</code> because we would need to know the other cards to get points for. Since we don't have that context here, why not capture both values?</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-2-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-2-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-2-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-2-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-2-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-2-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-2-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-2-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-2-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="kd">function</span><span class="w"> </span><span class="nx">cardToPoints</span><span class="p">(</span><span class="nx">c</span><span class="o">:</span><span class="kt">Card</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">Points</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// Note we don&#39;t know what the type of this is yet</span>
<a id="__codelineno-2-2" name="__codelineno-2-2"></a><span class="w">  </span><span class="k">switch</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">rank</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;Ace&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">11</span><span class="p">];</span>
<a id="__codelineno-2-4" name="__codelineno-2-4"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;King&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mf">10</span><span class="p">;</span>
<a id="__codelineno-2-5" name="__codelineno-2-5"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;Queen&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mf">10</span><span class="p">;</span>
<a id="__codelineno-2-6" name="__codelineno-2-6"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;Jack&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mf">10</span><span class="p">;</span>
<a id="__codelineno-2-7" name="__codelineno-2-7"></a><span class="w">    </span><span class="nx">default</span><span class="o">:</span>
<a id="__codelineno-2-8" name="__codelineno-2-8"></a><span class="w">      </span><span class="kt">return</span><span class="w"> </span><span class="nx">c</span><span class="p">.</span><span class="nx">rank</span><span class="p">;</span><span class="w"> </span><span class="c1">// we can do this because TypeScript knows all the remaining options for Rank are numbers</span>
<a id="__codelineno-2-9" name="__codelineno-2-9"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-2-10" name="__codelineno-2-10"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>In TypeScript, we can denote a tuple by using <code>[]</code>. Going forward, TypeScript knows that it's a two element array and guarantees that we can index using 0 or 1.</p>
<p>This works, however, anything using <code>cardToPoints</code> has to deal with that it could either be a number or a tuple.</p>
<p>When I come across cases like this, I reach for setting up a <a href="2023/04/30/better-domain-modeling-with-discriminated-unions/">sum type</a> to model each case.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">1</a></span>
<span class="normal"><a href="#__codelineno-3-2">2</a></span>
<span class="normal"><a href="#__codelineno-3-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Hard</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="nx">tag</span><span class="o">:</span><span class="s1">&#39;hard&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="o">:</span><span class="kt">number</span><span class="p">};</span>
<a id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Soft</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="nx">tag</span><span class="o">:</span><span class="s1">&#39;soft&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="o">:</span><span class="p">[</span><span class="kt">number</span><span class="p">,</span><span class="kt">number</span><span class="p">]};</span><span class="w"> </span><span class="c1">// note that value here is a tuple of number*number</span>
<a id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Points</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Hard</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nx">Soft</span>
</code></pre></div></td></tr></table></div>
<p>Now, when I call <code>cardToPoints</code>, I can use the <code>tag</code> field to know whether I'm working with a number or a tuple.</p>
<h4 id="adding-points-together"><a class="toclink" href="2025/05/13/leveraging-tuples-in-typescript/#adding-points-together">Adding Points Together</a></h4>
<p>A common workflow in Blackjack is to figure out how many points someone has. At a high level, we'd want to do the following</p>
<ul>
<li>Convert each Card to Points</li>
<li>Add all the Points together</li>
</ul>
<p>Summing things together is a common enough pattern, so we know our code is going to look something like this:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1">1</a></span>
<span class="normal"><a href="#__codelineno-4-2">2</a></span>
<span class="normal"><a href="#__codelineno-4-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="kd">function</span><span class="w"> </span><span class="nx">handToPoints</span><span class="p">(</span><span class="nx">cards</span><span class="o">:</span><span class="kt">Card</span><span class="p">[])</span><span class="o">:</span><span class="w"> </span><span class="nx">Points</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">cards</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">c</span><span class="p">)=&gt;</span><span class="nx">cardToPoints</span><span class="p">(</span><span class="nx">c</span><span class="p">)).</span><span class="nx">reduce</span><span class="p">(</span><span class="nx">SOME_FUNCTION_HERE</span><span class="p">,</span><span class="w"> </span><span class="nx">SOME_INITIAL_VALUE_HERE</span><span class="p">);</span>
<a id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>We don't have the reducer function defined yet, but we do know that it's a function that'll take two <code>Points</code> and return a <code>Points</code>. So let's stub that out.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1">1</a></span>
<span class="normal"><a href="#__codelineno-5-2">2</a></span>
<span class="normal"><a href="#__codelineno-5-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="kd">function</span><span class="w"> </span><span class="nx">addPoints</span><span class="p">(</span><span class="nx">a</span><span class="o">:</span><span class="kt">Points</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="o">:</span><span class="kt">Points</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">Points</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="w">  </span><span class="c1">// implementation</span>
<a id="__codelineno-5-3" name="__codelineno-5-3"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Since we modeled <code>Points</code> as a sum type, we can use the <code>tag</code> field to go over the possible cases</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-6-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-6-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-6-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-6-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-6-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-6-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-6-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-6-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-6-10">10</a></span>
<span class="normal"><a href="#__codelineno-6-11">11</a></span>
<span class="normal"><a href="#__codelineno-6-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="kd">function</span><span class="w"> </span><span class="nx">addPoints</span><span class="p">(</span><span class="nx">a</span><span class="o">:</span><span class="kt">Points</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="o">:</span><span class="kt">Points</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">Points</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">tag</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;hard&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">tag</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;hard&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="w">    </span><span class="c1">// logic</span>
<a id="__codelineno-6-4" name="__codelineno-6-4"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-6-5" name="__codelineno-6-5"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">tag</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;hard&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">tag</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;soft&#39;</span><span class="p">){</span>
<a id="__codelineno-6-6" name="__codelineno-6-6"></a><span class="w">    </span><span class="c1">// logic</span>
<a id="__codelineno-6-7" name="__codelineno-6-7"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-6-8" name="__codelineno-6-8"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">tag</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;soft&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">tag</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;hard&#39;</span><span class="p">){</span>
<a id="__codelineno-6-9" name="__codelineno-6-9"></a><span class="w">    </span><span class="c1">// logic</span>
<a id="__codelineno-6-10" name="__codelineno-6-10"></a><span class="w">  </span><span class="p">}</span><span class="w"> </span>
<a id="__codelineno-6-11" name="__codelineno-6-11"></a><span class="w">  </span><span class="c1">// last case is both of them are soft</span>
<a id="__codelineno-6-12" name="__codelineno-6-12"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>With this skeleton in place, let's start implementing each of the branches</p>
<h5 id="adding-two-hard-values"><a class="toclink" href="2025/05/13/leveraging-tuples-in-typescript/#adding-two-hard-values">Adding Two Hard Values</a></h5>
<p>The first case is the easiest, if we have two hard values, then we add their values together. So a <em>King</em> and <em>7</em> us a <em>17</em> for example. </p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1">1</a></span>
<span class="normal"><a href="#__codelineno-7-2">2</a></span>
<span class="normal"><a href="#__codelineno-7-3">3</a></span>
<span class="normal"><a href="#__codelineno-7-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="kd">function</span><span class="w"> </span><span class="nx">addHardAndHard</span><span class="p">(</span><span class="nx">a</span><span class="o">:</span><span class="kt">Hard</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="o">:</span><span class="kt">Hard</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">Points</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// note that I&#39;m defining a and b as Hard and not just Points</span>
<a id="__codelineno-7-2" name="__codelineno-7-2"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">a</span><span class="p">.</span><span class="nx">value</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
<a id="__codelineno-7-3" name="__codelineno-7-3"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="nx">tag</span><span class="o">:</span><span class="s1">&#39;hard&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="p">};</span>
<a id="__codelineno-7-4" name="__codelineno-7-4"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>With this function defined, we can update <code>addPoints</code> like so</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1">1</a></span>
<span class="normal"><a href="#__codelineno-8-2">2</a></span>
<span class="normal"><a href="#__codelineno-8-3">3</a></span>
<span class="normal"><a href="#__codelineno-8-4">4</a></span>
<span class="normal"><a href="#__codelineno-8-5">5</a></span>
<span class="normal"><a href="#__codelineno-8-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a><span class="kd">function</span><span class="w"> </span><span class="nx">addPoints</span><span class="p">(</span><span class="nx">a</span><span class="o">:</span><span class="kt">Points</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="o">:</span><span class="kt">Points</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">Points</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-8-2" name="__codelineno-8-2"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">tag</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;hard&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">tag</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;hard&#39;</span><span class="p">){</span>
<a id="__codelineno-8-3" name="__codelineno-8-3"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">addHardAndHard</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">);</span>
<a id="__codelineno-8-4" name="__codelineno-8-4"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-8-5" name="__codelineno-8-5"></a><span class="w">  </span><span class="c1">// other branches</span>
<a id="__codelineno-8-6" name="__codelineno-8-6"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h4 id="adding-hard-and-soft"><a class="toclink" href="2025/05/13/leveraging-tuples-in-typescript/#adding-hard-and-soft">Adding Hard and Soft</a></h4>
<p>The next two cases are the same, where we're adding a Hard value to a Soft value. For example, we're adding a <em>6</em> to an <em>Ace</em>. We can't assume that the answer is 7 since that might not be what the player wants. We also can't assume that the value is 17 because that might not be to the players advantage, which means that we need to keep track of both options, which implies that the result would be a <code>Soft</code> value. Let's go ahead and write that logic out</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1">1</a></span>
<span class="normal"><a href="#__codelineno-9-2">2</a></span>
<span class="normal"><a href="#__codelineno-9-3">3</a></span>
<span class="normal"><a href="#__codelineno-9-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="kd">function</span><span class="w"> </span><span class="nx">addHardAndSoft</span><span class="p">(</span><span class="nx">a</span><span class="o">:</span><span class="kt">Hard</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="o">:</span><span class="kt">Soft</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">Points</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// note that a is typed to be Hard and b is typed as Soft</span>
<a id="__codelineno-9-2" name="__codelineno-9-2"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">bLow</span><span class="p">,</span><span class="w"> </span><span class="nx">bHigh</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span><span class="w"> </span><span class="c1">// destructuring the tuple into specific pieces</span>
<a id="__codelineno-9-3" name="__codelineno-9-3"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="nx">tag</span><span class="o">:</span><span class="s1">&#39;soft&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="o">:</span><span class="p">[</span><span class="nx">a</span><span class="p">.</span><span class="nx">value</span><span class="o">+</span><span class="nx">bLow</span><span class="p">,</span><span class="w"> </span><span class="nx">a</span><span class="p">.</span><span class="nx">value</span><span class="o">+</span><span class="nx">bHigh</span><span class="p">]};</span>
<a id="__codelineno-9-4" name="__codelineno-9-4"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>With this function in place, we can write out the next two branches</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-10-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-10-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-10-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-10-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-10-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-10-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-10-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-10-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-10-10">10</a></span>
<span class="normal"><a href="#__codelineno-10-11">11</a></span>
<span class="normal"><a href="#__codelineno-10-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="kd">function</span><span class="w"> </span><span class="nx">addPoints</span><span class="p">(</span><span class="nx">a</span><span class="o">:</span><span class="kt">Points</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="o">:</span><span class="kt">Points</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">Points</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-10-2" name="__codelineno-10-2"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">tag</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;hard&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">tag</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;hard&#39;</span><span class="p">){</span>
<a id="__codelineno-10-3" name="__codelineno-10-3"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">addHardAndHard</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">);</span>
<a id="__codelineno-10-4" name="__codelineno-10-4"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-10-5" name="__codelineno-10-5"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">tag</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;hard&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">tag</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;soft&#39;</span><span class="p">){</span>
<a id="__codelineno-10-6" name="__codelineno-10-6"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">addHardAndSoft</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">);</span>
<a id="__codelineno-10-7" name="__codelineno-10-7"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-10-8" name="__codelineno-10-8"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">tag</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;soft&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">tag</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;hard&#39;</span><span class="p">){</span>
<a id="__codelineno-10-9" name="__codelineno-10-9"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">addHardAndSoft</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="w"> </span><span class="nx">a</span><span class="p">);</span><span class="w"> </span>
<a id="__codelineno-10-10" name="__codelineno-10-10"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-10-11" name="__codelineno-10-11"></a><span class="w">  </span><span class="c1">// remaining logic</span>
<a id="__codelineno-10-12" name="__codelineno-10-12"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h4 id="adding-soft-and-soft"><a class="toclink" href="2025/05/13/leveraging-tuples-in-typescript/#adding-soft-and-soft">Adding Soft and Soft</a></h4>
<p>The last case we need to handle is when both <code>Points</code> are <code>Soft</code>. If we were to break this down, we have four values (aLow, aHIgh for a, and bLow,bHigh for b) we need to keep track of:</p>
<ol>
<li>aLow + bLow</li>
<li>aHigh + bLow</li>
<li>aLow + bHigh</li>
<li>aHigh + bHigh</li>
</ol>
<p>However, let's play around with this by assuming that <code>Points</code> in question are both Ace. We would get the following:</p>
<ol>
<li>aLow + bLow = 1 + 1 = 2</li>
<li>aHigh + bLow = 11 + 1 = 12</li>
<li>aLow + bHigh = 1 + 11 = 12</li>
<li>aHigh + bHigh = 11 + 11 = 22</li>
</ol>
<p>Right off the bat, we can discard the case 4, (aHigh + bHigh), because there is no situation where the player would want that score as they would bust.</p>
<p>For cases 2 and 3, they yield the same value, so they're essentially the same case.</p>
<p>Which means, that our real cases are</p>
<ol>
<li>aLow + bLow</li>
<li>aHigh + bLow (which is the same as aLow + bHigh)</li>
</ol>
<p>So let's go ahead and write that function</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1">1</a></span>
<span class="normal"><a href="#__codelineno-11-2">2</a></span>
<span class="normal"><a href="#__codelineno-11-3">3</a></span>
<span class="normal"><a href="#__codelineno-11-4">4</a></span>
<span class="normal"><a href="#__codelineno-11-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="kd">function</span><span class="w"> </span><span class="nx">addSoftAndSoft</span><span class="p">(</span><span class="nx">a</span><span class="o">:</span><span class="kt">Soft</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="o">:</span><span class="kt">Soft</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">Points</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-11-2" name="__codelineno-11-2"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">aLow</span><span class="p">,</span><span class="w"> </span><span class="nx">aHigh</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">a</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
<a id="__codelineno-11-3" name="__codelineno-11-3"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">bLow</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span><span class="w"> </span><span class="c1">// note that we&#39;re only grabbing the first element of the tuple here</span>
<a id="__codelineno-11-4" name="__codelineno-11-4"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="nx">tag</span><span class="o">:</span><span class="s1">&#39;soft&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="o">:</span><span class="p">[</span><span class="nx">aLow</span><span class="o">+</span><span class="nx">bLow</span><span class="p">,</span><span class="w"> </span><span class="nx">aHigh</span><span class="o">+</span><span class="nx">bLow</span><span class="p">]};</span>
<a id="__codelineno-11-5" name="__codelineno-11-5"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Which gives us the following for <code>addPoints</code></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-12-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-12-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-12-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-12-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-12-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-12-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-12-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-12-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-12-10">10</a></span>
<span class="normal"><a href="#__codelineno-12-11">11</a></span>
<span class="normal"><a href="#__codelineno-12-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="kd">function</span><span class="w"> </span><span class="nx">addPoints</span><span class="p">(</span><span class="nx">a</span><span class="o">:</span><span class="kt">Points</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="o">:</span><span class="kt">Points</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">Points</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-12-2" name="__codelineno-12-2"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">tag</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;hard&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">tag</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;hard&#39;</span><span class="p">){</span>
<a id="__codelineno-12-3" name="__codelineno-12-3"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">addHardAndHard</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">);</span>
<a id="__codelineno-12-4" name="__codelineno-12-4"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-12-5" name="__codelineno-12-5"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">tag</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;hard&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">tag</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;soft&#39;</span><span class="p">){</span>
<a id="__codelineno-12-6" name="__codelineno-12-6"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">addHardAndSoft</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">);</span>
<a id="__codelineno-12-7" name="__codelineno-12-7"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-12-8" name="__codelineno-12-8"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">tag</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;soft&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">tag</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;hard&#39;</span><span class="p">){</span>
<a id="__codelineno-12-9" name="__codelineno-12-9"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">addHardAndSoft</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="w"> </span><span class="nx">a</span><span class="p">);</span>
<a id="__codelineno-12-10" name="__codelineno-12-10"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-12-11" name="__codelineno-12-11"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">addSoftAndSoft</span><span class="p">(</span><span class="nx">a</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">Soft</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">Soft</span><span class="p">);</span>
<a id="__codelineno-12-12" name="__codelineno-12-12"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Now that we have <code>addPoints</code>, let's revisit <code>handToPoints</code></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1">1</a></span>
<span class="normal"><a href="#__codelineno-13-2">2</a></span>
<span class="normal"><a href="#__codelineno-13-3">3</a></span>
<span class="normal"><a href="#__codelineno-13-4">4</a></span>
<span class="normal"><a href="#__codelineno-13-5">5</a></span>
<span class="normal"><a href="#__codelineno-13-6">6</a></span>
<span class="normal"><a href="#__codelineno-13-7">7</a></span>
<span class="normal"><a href="#__codelineno-13-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="c1">// Original Implementation</span>
<a id="__codelineno-13-2" name="__codelineno-13-2"></a><span class="c1">// function handToPoints(cards:Card[]): Points {</span>
<a id="__codelineno-13-3" name="__codelineno-13-3"></a><span class="c1">//   return cards.map((c)=&gt;cardToPoints(c)).reduce(SOME_FUNCTION_HERE, SOME_INITIAL_VALUE_HERE;</span>
<a id="__codelineno-13-4" name="__codelineno-13-4"></a><span class="c1">// }</span>
<a id="__codelineno-13-5" name="__codelineno-13-5"></a>
<a id="__codelineno-13-6" name="__codelineno-13-6"></a><span class="kd">function</span><span class="w"> </span><span class="nx">handToPoints</span><span class="p">(</span><span class="nx">cards</span><span class="o">:</span><span class="kt">Card</span><span class="p">[])</span><span class="o">:</span><span class="w"> </span><span class="nx">Points</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-7" name="__codelineno-13-7"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">cards</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">c</span><span class="p">)=&gt;</span><span class="nx">cardToPoints</span><span class="p">(</span><span class="nx">c</span><span class="p">)).</span><span class="nx">reduce</span><span class="p">(</span><span class="nx">addPoints</span><span class="p">,</span><span class="w"> </span><span class="nx">SOME_INITIAL_VALUE_HERE</span><span class="p">);</span>
<a id="__codelineno-13-8" name="__codelineno-13-8"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Now we need to figure out what <em>SOME_INITIAL_VALUE_HERE</em> would be. When working with <code>reduce</code>, a good initial value would be what would we return if we had no cards in the hand? Well, they would have 0 points, right? We can use 0, but we can't just return 0 since our function returns <code>Points</code>, so we need to go from 0 to Points. Easy enough, we can use <code>Hard</code> to accomplish this.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1">1</a></span>
<span class="normal"><a href="#__codelineno-14-2">2</a></span>
<span class="normal"><a href="#__codelineno-14-3">3</a></span>
<span class="normal"><a href="#__codelineno-14-4">4</a></span>
<span class="normal"><a href="#__codelineno-14-5">5</a></span>
<span class="normal"><a href="#__codelineno-14-6">6</a></span>
<span class="normal"><a href="#__codelineno-14-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="kd">function</span><span class="w"> </span><span class="nx">handToPoints</span><span class="p">(</span><span class="nx">cards</span><span class="o">:</span><span class="kt">Card</span><span class="p">[])</span><span class="o">:</span><span class="w"> </span><span class="nx">Points</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-14-2" name="__codelineno-14-2"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">initialValue</span><span class="o">:</span><span class="kt">Points</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="nx">tag</span><span class="o">:</span><span class="s1">&#39;hard&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="o">:</span><span class="kt">0</span><span class="p">};</span>
<a id="__codelineno-14-3" name="__codelineno-14-3"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">cards</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">c</span><span class="p">)=&gt;</span><span class="nx">cardToPoints</span><span class="p">(</span><span class="nx">c</span><span class="p">)).</span><span class="nx">reduce</span><span class="p">(</span><span class="nx">addPoints</span><span class="p">,</span><span class="w"> </span><span class="nx">initialValue</span><span class="p">);</span>
<a id="__codelineno-14-4" name="__codelineno-14-4"></a><span class="p">}</span>
<a id="__codelineno-14-5" name="__codelineno-14-5"></a>
<a id="__codelineno-14-6" name="__codelineno-14-6"></a><span class="kd">const</span><span class="w"> </span><span class="nx">hand</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[{</span><span class="nx">rank</span><span class="o">:</span><span class="s1">&#39;Ace&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">suit</span><span class="o">:</span><span class="s1">&#39;Hearts&#39;</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="nx">rank</span><span class="o">:</span><span class="kt">7</span><span class="p">,</span><span class="w"> </span><span class="nx">suit</span><span class="o">:</span><span class="s1">&#39;Clubs&#39;</span><span class="p">}]</span>
<a id="__codelineno-14-7" name="__codelineno-14-7"></a><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">handToPoints</span><span class="p">(</span><span class="nx">hand</span><span class="p">));</span><span class="w"> </span><span class="c1">// {tag:&#39;soft&#39;, value:[8, 18]};</span>
</code></pre></div></td></tr></table></div>
<p>For those who know a bit of <a href="https://en.wikipedia.org/wiki/Category_theory">category theory</a>, you might notice that <code>addPoints</code> is the operation and <code>Hard 0</code> is the identity for a <a href="2024/08/27/functional-design-patterns---reduce-and-monoids/">monoid</a> over <code>Points</code>.</p>
<h4 id="one-last-improvement"><a class="toclink" href="2025/05/13/leveraging-tuples-in-typescript/#one-last-improvement">One Last Improvement</a></h4>
<p>So this code works and everything is fine, however, we can make one more improvement to <code>addPoints</code>. Let's take a look at what happens when we try to get the <code>Points</code> for the following:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1">1</a></span>
<span class="normal"><a href="#__codelineno-15-2">2</a></span>
<span class="normal"><a href="#__codelineno-15-3">3</a></span>
<span class="normal"><a href="#__codelineno-15-4">4</a></span>
<span class="normal"><a href="#__codelineno-15-5">5</a></span>
<span class="normal"><a href="#__codelineno-15-6">6</a></span>
<span class="normal"><a href="#__codelineno-15-7">7</a></span>
<span class="normal"><a href="#__codelineno-15-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="kd">const</span><span class="w"> </span><span class="nx">hand</span><span class="o">:</span><span class="w"> </span><span class="kt">Card</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-15-2" name="__codelineno-15-2"></a><span class="w">  </span><span class="p">{</span><span class="nx">rank</span><span class="o">:</span><span class="s1">&#39;Ace&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">suit</span><span class="o">:</span><span class="s1">&#39;Diamonds&#39;</span><span class="p">},</span>
<a id="__codelineno-15-3" name="__codelineno-15-3"></a><span class="w">  </span><span class="p">{</span><span class="nx">rank</span><span class="o">:</span><span class="kt">8</span><span class="p">,</span><span class="w"> </span><span class="nx">suit</span><span class="o">:</span><span class="s1">&#39;Hearts&#39;</span><span class="p">},</span>
<a id="__codelineno-15-4" name="__codelineno-15-4"></a><span class="w">  </span><span class="p">{</span><span class="nx">rank</span><span class="o">:</span><span class="kt">4</span><span class="p">,</span><span class="w"> </span><span class="nx">suit</span><span class="o">:</span><span class="s1">&#39;Clubs&#39;</span><span class="p">},</span>
<a id="__codelineno-15-5" name="__codelineno-15-5"></a><span class="w">  </span><span class="p">{</span><span class="nx">rank</span><span class="o">:</span><span class="kt">8</span><span class="p">,</span><span class="w"> </span><span class="nx">suit</span><span class="o">:</span><span class="s1">&#39;Spades&#39;</span><span class="p">}</span>
<a id="__codelineno-15-6" name="__codelineno-15-6"></a><span class="p">]</span>
<a id="__codelineno-15-7" name="__codelineno-15-7"></a>
<a id="__codelineno-15-8" name="__codelineno-15-8"></a><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">handToPoints</span><span class="p">(</span><span class="nx">hand</span><span class="p">));</span><span class="w"> </span><span class="c1">// {tag:&#39;soft&#39;, value:[21, 31]};</span>
</code></pre></div></td></tr></table></div>
<p>Huh, we got the right value, but we know that for <code>Soft</code>, it doesn't make sense to allow the player a choice between 21 and 31 because 31 is always invalid. Even though the answer isn't wrong <em>per se</em>, it does allow the user to do the wrong thing later on, which isn't the greatest.</p>
<p>Let's add one more function, <code>normalize</code> that will check to see if the <code>Points</code> is <code>Soft</code> with a value over 21. If so, we convert to a <code>Hard</code> and throw out the value over 21. Otherwise we return the value (since it's possible for someone to get a <code>Hard</code> score over 21).</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-16-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-16-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-16-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-16-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-16-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-16-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-16-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-16-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-16-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-16-10">10</a></span>
<span class="normal"><a href="#__codelineno-16-11">11</a></span>
<span class="normal"><a href="#__codelineno-16-12">12</a></span>
<span class="normal"><a href="#__codelineno-16-13">13</a></span>
<span class="normal"><a href="#__codelineno-16-14">14</a></span>
<span class="normal"><a href="#__codelineno-16-15">15</a></span>
<span class="normal"><a href="#__codelineno-16-16">16</a></span>
<span class="normal"><a href="#__codelineno-16-17">17</a></span>
<span class="normal"><a href="#__codelineno-16-18">18</a></span>
<span class="normal"><a href="#__codelineno-16-19">19</a></span>
<span class="normal"><a href="#__codelineno-16-20">20</a></span>
<span class="normal"><a href="#__codelineno-16-21">21</a></span>
<span class="normal"><a href="#__codelineno-16-22">22</a></span>
<span class="normal"><a href="#__codelineno-16-23">23</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1"></a><span class="kd">function</span><span class="w"> </span><span class="nx">normalize</span><span class="p">(</span><span class="nx">p</span><span class="o">:</span><span class="kt">Points</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">Points</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-16-2" name="__codelineno-16-2"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">tag</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;soft&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">value</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">21</span><span class="p">){</span>
<a id="__codelineno-16-3" name="__codelineno-16-3"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="nx">tag</span><span class="o">:</span><span class="s1">&#39;hard&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="o">:</span><span class="kt">p.value</span><span class="p">[</span><span class="mf">0</span><span class="p">]}</span>
<a id="__codelineno-16-4" name="__codelineno-16-4"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-16-5" name="__codelineno-16-5"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">p</span><span class="p">;</span>
<a id="__codelineno-16-6" name="__codelineno-16-6"></a><span class="p">}</span>
<a id="__codelineno-16-7" name="__codelineno-16-7"></a>
<a id="__codelineno-16-8" name="__codelineno-16-8"></a><span class="c1">// updated addPoints with normalize being used</span>
<a id="__codelineno-16-9" name="__codelineno-16-9"></a><span class="kd">function</span><span class="w"> </span><span class="nx">addPoints</span><span class="p">(</span><span class="nx">a</span><span class="o">:</span><span class="kt">Points</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="o">:</span><span class="kt">Points</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">Points</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-16-10" name="__codelineno-16-10"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">tag</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;hard&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">tag</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;hard&#39;</span><span class="p">){</span>
<a id="__codelineno-16-11" name="__codelineno-16-11"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">normalize</span><span class="p">(</span><span class="nx">addHardAndHard</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">));</span>
<a id="__codelineno-16-12" name="__codelineno-16-12"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-16-13" name="__codelineno-16-13"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">tag</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;hard&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">tag</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;soft&#39;</span><span class="p">){</span>
<a id="__codelineno-16-14" name="__codelineno-16-14"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">normalize</span><span class="p">(</span><span class="nx">addHardAndSoft</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">));</span>
<a id="__codelineno-16-15" name="__codelineno-16-15"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-16-16" name="__codelineno-16-16"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">tag</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;soft&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">tag</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;hard&#39;</span><span class="p">){</span>
<a id="__codelineno-16-17" name="__codelineno-16-17"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">normalize</span><span class="p">(</span><span class="nx">addHardAndSoft</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="w"> </span><span class="nx">a</span><span class="p">));</span>
<a id="__codelineno-16-18" name="__codelineno-16-18"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-16-19" name="__codelineno-16-19"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">normalize</span><span class="p">(</span><span class="nx">addSoftAndSoft</span><span class="p">(</span><span class="nx">a</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">Soft</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">Soft</span><span class="p">));</span>
<a id="__codelineno-16-20" name="__codelineno-16-20"></a><span class="p">}</span>
<a id="__codelineno-16-21" name="__codelineno-16-21"></a>
<a id="__codelineno-16-22" name="__codelineno-16-22"></a><span class="c1">// Note: There&#39;s some minor refactoring that we could do here (for example, creating an internal function for handling the add logic and updating `addPoints` to use that function with normalize),</span>
<a id="__codelineno-16-23" name="__codelineno-16-23"></a><span class="c1">// but will leave that as an exercise to the reader :)</span>
</code></pre></div></td></tr></table></div>
<h3 id="wrapping-up"><a class="toclink" href="2025/05/13/leveraging-tuples-in-typescript/#wrapping-up">Wrapping Up</a></h3>
<p>In this post, we took a look at using tuples in TypeScript by tackling a portion of the game of Blackjack. Whether it's through using it in types (like we did for <code>Soft</code>) or for destructuring values (like we did in the various <code>addX</code> functions), they can be a handy way of grouping data together for short-term operations.</p>
<h3 id="interested-in-knowing-more"><a class="toclink" href="2025/05/13/leveraging-tuples-in-typescript/#interested-in-knowing-more">Interested in knowing more?</a></h3>
<p>If you've enjoyed the above, then you might be interested in my new course (launching Summer 2025) where we build out the game of Blackjack using these concepts in TypeScript. <a href="mailto:cameron@thesoftwarementor.com?subject=Interested%20In%20Udemy%20Course&amp;body=I%27m%20interested%20in%20your%20upcoming%20course%20on%20Blackjack%2C%20let%20me%20know%20when%20it%27s%20ready%21">Click here</a> if you're interested in getting an update for when the course goes live!</p>
    
    
  </div>
</article>
      
      
        
          



<nav class="md-pagination">
  <span class="md-pagination__current">1</span> <a class="md-pagination__link" href="page/2/">2</a> <a class="md-pagination__link" href="page/3/">3</a> <span class="md-pagination__dots">..</span> <a class="md-pagination__link" href="page/9/">9</a>
</nav>
        
      
    </div>
  </div>

          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
        
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href=".." class="md-footer__link md-footer__link--prev" aria-label="Previous: About Me">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                About Me
              </div>
            </div>
          </a>
        
        
          
          <a href="category/net/" class="md-footer__link md-footer__link--next" aria-label="Next: .NET">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                .NET
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs Insiders
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.footer", "content.code.copy"], "search": "../assets/javascripts/workers/search.ad38c271.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.b66b2b78.min.js"></script>
      
    
  </body>
</html>