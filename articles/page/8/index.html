
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Cameron Presley">
      
      
      
        <link rel="prev" href="../../..">
      
      
        <link rel="next" href="../../category/net/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16+insiders-4.53.16">
    
    
      
        <title>Index - The Software Mentor</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.1caf78d2.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/page.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-ZE0MGVG7RJ"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-ZE0MGVG7RJ",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-ZE0MGVG7RJ",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#index" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="The Software Mentor" class="md-header__button md-logo" aria-label="The Software Mentor" data-md-component="logo">
      
  <img src="../../../assets/images/favicon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            The Software Mentor
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Index
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="deep-purple"  aria-hidden="true"  type="radio" name="__palette" id="__palette_1">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  About Me

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  
  Articles

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../courses/" class="md-tabs__link">
        
  
  
    
  
  Training Course

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../level-up/" class="md-tabs__link">
        
  
  
    
  
  Level Up Resources

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../presentations/" class="md-tabs__link">
        
  
  
    
  
  Presentations

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../speaking-schedule/" class="md-tabs__link">
        
  
  
    
  
  Speaking Schedule

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../story/" class="md-tabs__link">
        
  
  
    
  
  Story

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../resume/" class="md-tabs__link">
        
  
  
    
  
  Resume

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="The Software Mentor" class="md-nav__button md-logo" aria-label="The Software Mentor" data-md-component="logo">
      
  <img src="../../../assets/images/favicon.png" alt="logo">

    </a>
    The Software Mentor
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    About Me
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Articles
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Articles
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
      
    
  
  
    <li class="md-nav__item">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="../../" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Index
  

    
  </span>
  
  

      </a>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Archive
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Archive
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2025/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2025
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2024/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2024
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2023/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2023
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2020/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2020
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2018/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2018
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2015/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2015
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2014/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2014
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2013/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2013
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Categories
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Categories
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/net/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    .NET
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/aws/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AWS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/basics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Basics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/c/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    C#
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/career/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Career
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/coaching-corner/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Coaching Corner
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/debugging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Debugging
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/functional-programming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Functional Programming
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/interviewing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Interviewing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/leadership/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Leadership
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/learning-through-example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Learning Through Example
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Process
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/solid/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SOLID
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/today-i-learned/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Today I Learned
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/tooling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tooling
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/typescript/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    TypeScript
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../courses/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Training Course
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../level-up/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Level Up Resources
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../presentations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Presentations
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../speaking-schedule/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Speaking Schedule
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../story/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Story
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../resume/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Resume
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
                
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" hidden>
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
  <div class="md-content" data-md-component="content">
    <div class="md-content__inner">
      <header class="md-typeset">
        <h1 id="index">Index</h1>
      </header>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/cameronpresley.png" alt="Cameron Presley">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2015-10-28 00:00:00+00:00">Oct 28, 2015</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../../category/today-i-learned/" class="md-meta__link">Today I Learned</a></li>
        
        
          
          <li class="md-meta__item">
            
              4 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="til-how-to-check-if-a-substitute-was-called-zero-times"><a class="toclink" href="../../2015/10/28/til--how-to-check-if-a-substitute-was-called-zero-times/">TIL – How To Check If a Substitute Was Called Zero Times</a></h2>
<h3 id="setup"><a class="toclink" href="../../2015/10/28/til--how-to-check-if-a-substitute-was-called-zero-times/#setup">Setup</a></h3>
<p>During this past week, I’ve been working on a new feature and during development, I ended up with code that looked like this:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-6-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-6-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-6-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-6-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-6-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-6-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-6-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-6-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-6-10">10</a></span>
<span class="normal"><a href="#__codelineno-6-11">11</a></span>
<span class="normal"><a href="#__codelineno-6-12">12</a></span>
<span class="normal"><a href="#__codelineno-6-13">13</a></span>
<span class="normal"><a href="#__codelineno-6-14">14</a></span>
<span class="normal"><a href="#__codelineno-6-15">15</a></span>
<span class="normal"><a href="#__codelineno-6-16">16</a></span>
<span class="normal"><a href="#__codelineno-6-17">17</a></span>
<span class="normal"><a href="#__codelineno-6-18">18</a></span>
<span class="normal"><a href="#__codelineno-6-19">19</a></span>
<span class="normal"><a href="#__codelineno-6-20">20</a></span>
<span class="normal"><a href="#__codelineno-6-21">21</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">PermissionChecker</span>
<a id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="p">{</span>
<a id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="nf">PermissionChecker</span><span class="p">(</span><span class="n">IModuleDisabler</span><span class="w"> </span><span class="n">moduleDisabler</span><span class="p">,</span><span class="w"> </span><span class="n">User</span><span class="w"> </span><span class="n">user</span><span class="p">)</span>
<a id="__codelineno-6-4" name="__codelineno-6-4"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-6-5" name="__codelineno-6-5"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">user</span><span class="p">.</span><span class="n">IsAdmin</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="p">;</span>
<a id="__codelineno-6-6" name="__codelineno-6-6"></a><span class="w">      </span><span class="k">else</span><span class="w"> </span><span class="nf">if</span><span class="w"> </span><span class="p">(</span><span class="n">user</span><span class="p">.</span><span class="n">HasFullRights</span><span class="p">)</span><span class="w"> </span><span class="n">ConfigureFullRights</span><span class="p">(</span><span class="n">moduleDisabler</span><span class="p">);</span>
<a id="__codelineno-6-7" name="__codelineno-6-7"></a><span class="w">      </span><span class="k">else</span><span class="w"> </span><span class="nf">if</span><span class="w"> </span><span class="p">(</span><span class="n">user</span><span class="p">.</span><span class="n">HasPartialRights</span><span class="p">)</span><span class="w"> </span><span class="n">ConfigurePartialRights</span><span class="p">(</span><span class="n">moduleDisabler</span><span class="p">);</span>
<a id="__codelineno-6-8" name="__codelineno-6-8"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-6-9" name="__codelineno-6-9"></a>
<a id="__codelineno-6-10" name="__codelineno-6-10"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">ConfigureFullRights</span><span class="p">(</span><span class="n">IModuleDisabler</span><span class="w"> </span><span class="n">disabler</span><span class="p">)</span>
<a id="__codelineno-6-11" name="__codelineno-6-11"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-6-12" name="__codelineno-6-12"></a><span class="w">      </span><span class="n">disabler</span><span class="p">.</span><span class="n">DisableSystemAdminModule</span><span class="p">();</span>
<a id="__codelineno-6-13" name="__codelineno-6-13"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-6-14" name="__codelineno-6-14"></a>
<a id="__codelineno-6-15" name="__codelineno-6-15"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">ConfigurePartialRights</span><span class="p">(</span><span class="n">IModuleDisabler</span><span class="w"> </span><span class="n">disabler</span><span class="p">)</span>
<a id="__codelineno-6-16" name="__codelineno-6-16"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-6-17" name="__codelineno-6-17"></a><span class="w">      </span><span class="n">disabler</span><span class="p">.</span><span class="n">DisableSystemAdminModule</span><span class="p">();</span>
<a id="__codelineno-6-18" name="__codelineno-6-18"></a><span class="w">      </span><span class="n">disabler</span><span class="p">.</span><span class="n">DisableReportModule</span><span class="p">();</span>
<a id="__codelineno-6-19" name="__codelineno-6-19"></a><span class="w">      </span><span class="n">disabler</span><span class="p">.</span><span class="n">DisableUserManagementModule</span><span class="p">();</span>
<a id="__codelineno-6-20" name="__codelineno-6-20"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-6-21" name="__codelineno-6-21"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>So the code is pretty straight forward, I have a <strong>PermissionChecker</strong> whose job is to use the <strong>IModuleDisabler</strong> to turn off certain modules depending upon the user permissions. Pretty straightforward implementation.</p>
<p>Now that the solution is fleshed out, it’s time to write some tests around this. When it comes to testing classes that have dependencies on non-trivial classes, I use <a href="https://nsubstitute.github.io/">NSubstitute</a>, a mocking tool, to create mock versions of those dependencies. In this case, NSubstitute allows me to test how the <strong>IModuleDisabler</strong> is being used by the <strong>PermissionsChecker</strong>.</p>
<p>For example, let’s say that I wanted to test how the <strong>PermissionChecker</strong> interacts with the <strong>IModuleDisabler</strong> when the user has a partial access, I’d write a test that looks like the following:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-7-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-7-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-7-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-7-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-7-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-7-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-7-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-7-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-7-10">10</a></span>
<span class="normal"><a href="#__codelineno-7-11">11</a></span>
<span class="normal"><a href="#__codelineno-7-12">12</a></span>
<span class="normal"><a href="#__codelineno-7-13">13</a></span>
<span class="normal"><a href="#__codelineno-7-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="na">[Test]</span>
<a id="__codelineno-7-2" name="__codelineno-7-2"></a><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">And_the_user_has_partial_access_then_the_disabler_disables_the_report_module</span><span class="p">()</span>
<a id="__codelineno-7-3" name="__codelineno-7-3"></a><span class="p">{</span>
<a id="__codelineno-7-4" name="__codelineno-7-4"></a><span class="w">     </span><span class="c1">// Arrange</span>
<a id="__codelineno-7-5" name="__codelineno-7-5"></a><span class="w">     </span><span class="kt">var</span><span class="w"> </span><span class="n">permissionChecker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PermissionChecker</span><span class="p">();</span>
<a id="__codelineno-7-6" name="__codelineno-7-6"></a><span class="w">     </span><span class="kt">var</span><span class="w"> </span><span class="n">mockDisabler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Substitute</span><span class="p">.</span><span class="n">For</span><span class="p">();</span>
<a id="__codelineno-7-7" name="__codelineno-7-7"></a><span class="w">     </span><span class="kt">var</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">User</span><span class="w"> </span><span class="p">{</span><span class="n">HasPartialAccess</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="p">};</span>
<a id="__codelineno-7-8" name="__codelineno-7-8"></a>
<a id="__codelineno-7-9" name="__codelineno-7-9"></a><span class="w">     </span><span class="c1">// Act</span>
<a id="__codelineno-7-10" name="__codelineno-7-10"></a><span class="w">     </span><span class="n">permissionChecker</span><span class="p">.</span><span class="n">CheckPermissions</span><span class="p">(</span><span class="n">mockDisabler</span><span class="p">,</span><span class="w"> </span><span class="n">user</span><span class="p">);</span>
<a id="__codelineno-7-11" name="__codelineno-7-11"></a>
<a id="__codelineno-7-12" name="__codelineno-7-12"></a><span class="w">     </span><span class="c1">// Assert</span>
<a id="__codelineno-7-13" name="__codelineno-7-13"></a><span class="w">     </span><span class="n">mockDisabler</span><span class="p">.</span><span class="n">Received</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">DisableReportModule</span><span class="p">();</span>
<a id="__codelineno-7-14" name="__codelineno-7-14"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>In the above test, our assertion step is to check if the <strong>mockDisabler</strong> received a single call to the <strong>DisableReportModule</strong>. If it didn’t receive a call, then the test fails. We can write similar tests for the different modules that should be disabled for the partial rights permission and follow a similar pattern for the full rights permission.</p>
<p>However, things get a bit more interesting when we’re testing what happens if the user is an admin. If we follow the same pattern, we’d end up with a test that looks like this:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-8-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-8-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-8-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-8-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-8-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-8-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-8-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-8-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-8-10">10</a></span>
<span class="normal"><a href="#__codelineno-8-11">11</a></span>
<span class="normal"><a href="#__codelineno-8-12">12</a></span>
<span class="normal"><a href="#__codelineno-8-13">13</a></span>
<span class="normal"><a href="#__codelineno-8-14">14</a></span>
<span class="normal"><a href="#__codelineno-8-15">15</a></span>
<span class="normal"><a href="#__codelineno-8-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a><span class="na">[Test]</span>
<a id="__codelineno-8-2" name="__codelineno-8-2"></a><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">And_the_user_has_admin_permissions_then_the_disabler_is_not_used</span><span class="p">()</span>
<a id="__codelineno-8-3" name="__codelineno-8-3"></a><span class="p">{</span>
<a id="__codelineno-8-4" name="__codelineno-8-4"></a><span class="w">     </span><span class="c1">// Arrange</span>
<a id="__codelineno-8-5" name="__codelineno-8-5"></a><span class="w">     </span><span class="kt">var</span><span class="w"> </span><span class="n">permissionChecker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PermissionChecker</span><span class="p">();</span>
<a id="__codelineno-8-6" name="__codelineno-8-6"></a><span class="w">     </span><span class="kt">var</span><span class="w"> </span><span class="n">mockDisabler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Substitute</span><span class="p">.</span><span class="n">For</span><span class="p">();</span>
<a id="__codelineno-8-7" name="__codelineno-8-7"></a><span class="w">     </span><span class="kt">var</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">User</span><span class="w"> </span><span class="p">{</span><span class="n">IsAdmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="p">};</span>
<a id="__codelineno-8-8" name="__codelineno-8-8"></a>
<a id="__codelineno-8-9" name="__codelineno-8-9"></a><span class="w">     </span><span class="c1">// Act</span>
<a id="__codelineno-8-10" name="__codelineno-8-10"></a><span class="w">     </span><span class="n">permissionChecker</span><span class="p">.</span><span class="n">CheckPermissions</span><span class="p">(</span><span class="n">mockDisabler</span><span class="p">,</span><span class="w"> </span><span class="n">user</span><span class="p">);</span>
<a id="__codelineno-8-11" name="__codelineno-8-11"></a>
<a id="__codelineno-8-12" name="__codelineno-8-12"></a><span class="w">     </span><span class="c1">// Assert</span>
<a id="__codelineno-8-13" name="__codelineno-8-13"></a><span class="w">     </span><span class="n">mockDisabler</span><span class="p">.</span><span class="n">DidNotReceive</span><span class="p">().</span><span class="n">DisableSystemAdminModule</span><span class="p">();</span>
<a id="__codelineno-8-14" name="__codelineno-8-14"></a><span class="w">     </span><span class="n">mockDisabler</span><span class="p">.</span><span class="n">DidNotReceive</span><span class="p">().</span><span class="n">DisableReportModule</span><span class="p">();</span>
<a id="__codelineno-8-15" name="__codelineno-8-15"></a><span class="w">     </span><span class="n">mockDisabler</span><span class="p">.</span><span class="n">DidNotReceive</span><span class="p">().</span><span class="n">DisableUserManagementModule</span><span class="p">();</span>
<a id="__codelineno-8-16" name="__codelineno-8-16"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>This solution works for now, however, there is a major maintainability issue, can you spot it?</p>
<h3 id="problem"><a class="toclink" href="../../2015/10/28/til--how-to-check-if-a-substitute-was-called-zero-times/#problem">Problem</a></h3>
<p>The issue arises when we add a new module to be disabled which forces the <strong>IModuleDisabler</strong> to implement a new method. In that case, you need to remember to update this test to also check that the new method wasn’t being called. If you forget, this test would still pass, but it’d pass for the wrong reason.</p>
<p>To help illustrate, let’s say that another method, <strong>DisableImportModule</strong>, has been added to the <strong>IModuleDisabler</strong> interface. In addition, we also need to make sure that this is called when users have partial access, but should not be called for users who are admins or users who have full access.</p>
<p>To fulfill those requirements, we modify the <strong>PermissionChecker</strong> as so:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-9-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-9-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-9-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-9-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-9-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-9-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-9-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-9-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-9-10">10</a></span>
<span class="normal"><a href="#__codelineno-9-11">11</a></span>
<span class="normal"><a href="#__codelineno-9-12">12</a></span>
<span class="normal"><a href="#__codelineno-9-13">13</a></span>
<span class="normal"><a href="#__codelineno-9-14">14</a></span>
<span class="normal"><a href="#__codelineno-9-15">15</a></span>
<span class="normal"><a href="#__codelineno-9-16">16</a></span>
<span class="normal"><a href="#__codelineno-9-17">17</a></span>
<span class="normal"><a href="#__codelineno-9-18">18</a></span>
<span class="normal"><a href="#__codelineno-9-19">19</a></span>
<span class="normal"><a href="#__codelineno-9-20">20</a></span>
<span class="normal"><a href="#__codelineno-9-21">21</a></span>
<span class="normal"><a href="#__codelineno-9-22">22</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">PermissionChecker</span>
<a id="__codelineno-9-2" name="__codelineno-9-2"></a><span class="p">{</span>
<a id="__codelineno-9-3" name="__codelineno-9-3"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="nf">PermissionChecker</span><span class="p">(</span><span class="n">IModuleDisabler</span><span class="w"> </span><span class="n">moduleDisabler</span><span class="p">,</span><span class="w"> </span><span class="n">User</span><span class="w"> </span><span class="n">user</span><span class="p">)</span>
<a id="__codelineno-9-4" name="__codelineno-9-4"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-9-5" name="__codelineno-9-5"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">user</span><span class="p">.</span><span class="n">IsAdmin</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="p">;</span>
<a id="__codelineno-9-6" name="__codelineno-9-6"></a><span class="w">      </span><span class="k">else</span><span class="w"> </span><span class="nf">if</span><span class="w"> </span><span class="p">(</span><span class="n">user</span><span class="p">.</span><span class="n">HasFullRights</span><span class="p">)</span><span class="w"> </span><span class="n">ConfigureFullRights</span><span class="p">(</span><span class="n">moduleDisabler</span><span class="p">);</span>
<a id="__codelineno-9-7" name="__codelineno-9-7"></a><span class="w">      </span><span class="k">else</span><span class="w"> </span><span class="nf">if</span><span class="w"> </span><span class="p">(</span><span class="n">user</span><span class="p">.</span><span class="n">HasPartialRights</span><span class="p">)</span><span class="w"> </span><span class="n">ConfigurePartialRights</span><span class="p">(</span><span class="n">moduleDisabler</span><span class="p">);</span>
<a id="__codelineno-9-8" name="__codelineno-9-8"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-9-9" name="__codelineno-9-9"></a>
<a id="__codelineno-9-10" name="__codelineno-9-10"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">ConfigureFullRights</span><span class="p">(</span><span class="n">IModuleDisabler</span><span class="w"> </span><span class="n">disabler</span><span class="p">)</span>
<a id="__codelineno-9-11" name="__codelineno-9-11"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-9-12" name="__codelineno-9-12"></a><span class="w">      </span><span class="n">disabler</span><span class="p">.</span><span class="n">DisableSystemAdminModule</span><span class="p">();</span>
<a id="__codelineno-9-13" name="__codelineno-9-13"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-9-14" name="__codelineno-9-14"></a>
<a id="__codelineno-9-15" name="__codelineno-9-15"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">ConfigurePartialRights</span><span class="p">(</span><span class="n">IModuleDisabler</span><span class="w"> </span><span class="n">disabler</span><span class="p">)</span>
<a id="__codelineno-9-16" name="__codelineno-9-16"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-9-17" name="__codelineno-9-17"></a><span class="w">      </span><span class="n">disabler</span><span class="p">.</span><span class="n">DisableSystemAdminModule</span><span class="p">();</span>
<a id="__codelineno-9-18" name="__codelineno-9-18"></a><span class="w">      </span><span class="n">disabler</span><span class="p">.</span><span class="n">DisableReportModule</span><span class="p">();</span>
<a id="__codelineno-9-19" name="__codelineno-9-19"></a><span class="w">      </span><span class="n">disabler</span><span class="p">.</span><span class="n">DisableUserManagementModule</span><span class="p">();</span>
<a id="__codelineno-9-20" name="__codelineno-9-20"></a><span class="w">      </span><span class="n">disabler</span><span class="p">.</span><span class="n">DisableImportModule</span><span class="p">();</span>
<a id="__codelineno-9-21" name="__codelineno-9-21"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-9-22" name="__codelineno-9-22"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>At this point, we’d write another test for when the a user has partial access, the import module should be disabled. However, it’s very unlikely that we’d remember to update the test for the admin. Remember, for the admin, we’re checking that it received no calls to any disable methods and the way we’re doing that is by checking each method individually.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-10-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-10-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-10-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-10-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-10-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-10-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-10-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-10-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-10-10">10</a></span>
<span class="normal"><a href="#__codelineno-10-11">11</a></span>
<span class="normal"><a href="#__codelineno-10-12">12</a></span>
<span class="normal"><a href="#__codelineno-10-13">13</a></span>
<span class="normal"><a href="#__codelineno-10-14">14</a></span>
<span class="normal"><a href="#__codelineno-10-15">15</a></span>
<span class="normal"><a href="#__codelineno-10-16">16</a></span>
<span class="normal"><a href="#__codelineno-10-17">17</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="na">[Test]</span>
<a id="__codelineno-10-2" name="__codelineno-10-2"></a><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">And_the_user_has_admin_permissions_then_the_disabler_is_not_used</span><span class="p">()</span>
<a id="__codelineno-10-3" name="__codelineno-10-3"></a><span class="p">{</span>
<a id="__codelineno-10-4" name="__codelineno-10-4"></a><span class="w">  </span><span class="c1">// Arrange</span>
<a id="__codelineno-10-5" name="__codelineno-10-5"></a><span class="w">  </span><span class="kt">var</span><span class="w"> </span><span class="n">permissionChecker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PermissionChecker</span><span class="p">();</span>
<a id="__codelineno-10-6" name="__codelineno-10-6"></a><span class="w">  </span><span class="kt">var</span><span class="w"> </span><span class="n">mockDisabler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Substitute</span><span class="p">.</span><span class="n">For</span><span class="p">();</span>
<a id="__codelineno-10-7" name="__codelineno-10-7"></a><span class="w">  </span><span class="kt">var</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">User</span><span class="w"> </span><span class="p">{</span><span class="n">IsAdmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="p">};</span>
<a id="__codelineno-10-8" name="__codelineno-10-8"></a>
<a id="__codelineno-10-9" name="__codelineno-10-9"></a><span class="w">  </span><span class="c1">// Act</span>
<a id="__codelineno-10-10" name="__codelineno-10-10"></a><span class="w">  </span><span class="n">permissionChecker</span><span class="p">.</span><span class="n">CheckPermissions</span><span class="p">(</span><span class="n">mockDisabler</span><span class="p">,</span><span class="w"> </span><span class="n">user</span><span class="p">);</span>
<a id="__codelineno-10-11" name="__codelineno-10-11"></a>
<a id="__codelineno-10-12" name="__codelineno-10-12"></a><span class="w">  </span><span class="c1">// Assert</span>
<a id="__codelineno-10-13" name="__codelineno-10-13"></a><span class="w">  </span><span class="n">mockDisabler</span><span class="p">.</span><span class="n">DidNotReceive</span><span class="p">().</span><span class="n">DisableSystemAdminModule</span><span class="p">();</span>
<a id="__codelineno-10-14" name="__codelineno-10-14"></a><span class="w">  </span><span class="n">mockDisabler</span><span class="p">.</span><span class="n">DidNotReceive</span><span class="p">().</span><span class="n">DisableReportModule</span><span class="p">();</span>
<a id="__codelineno-10-15" name="__codelineno-10-15"></a><span class="w">  </span><span class="n">mockDisabler</span><span class="p">.</span><span class="n">DidNotReceive</span><span class="p">().</span><span class="n">DisableUserManagementModule</span><span class="p">();</span>
<a id="__codelineno-10-16" name="__codelineno-10-16"></a><span class="w">  </span><span class="c1">// Need to add check for DidNotReceive().DisableImportModule();</span>
<a id="__codelineno-10-17" name="__codelineno-10-17"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h3 id="solution"><a class="toclink" href="../../2015/10/28/til--how-to-check-if-a-substitute-was-called-zero-times/#solution">Solution</a></h3>
<p>There’s got to be a better way. After some digging around, I found that any NSubstitute mock, has a <strong>ReceivedCalls</strong> method that returns all calls that the mock received. With this new knowledge, we can refactor the previous test with the following:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-11-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-11-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-11-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-11-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-11-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-11-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-11-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-11-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-11-10">10</a></span>
<span class="normal"><a href="#__codelineno-11-11">11</a></span>
<span class="normal"><a href="#__codelineno-11-12">12</a></span>
<span class="normal"><a href="#__codelineno-11-13">13</a></span>
<span class="normal"><a href="#__codelineno-11-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="na">[Test]</span>
<a id="__codelineno-11-2" name="__codelineno-11-2"></a><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">And_the_user_has_admin_permissions_then_the_disabler_is_not_used</span><span class="p">()</span>
<a id="__codelineno-11-3" name="__codelineno-11-3"></a><span class="p">{</span>
<a id="__codelineno-11-4" name="__codelineno-11-4"></a><span class="w">  </span><span class="c1">// Arrange</span>
<a id="__codelineno-11-5" name="__codelineno-11-5"></a><span class="w">  </span><span class="kt">var</span><span class="w"> </span><span class="n">permissionChecker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PermissionChecker</span><span class="p">();</span>
<a id="__codelineno-11-6" name="__codelineno-11-6"></a><span class="w">  </span><span class="kt">var</span><span class="w"> </span><span class="n">mockDisabler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Substitute</span><span class="p">.</span><span class="n">For</span><span class="p">();</span>
<a id="__codelineno-11-7" name="__codelineno-11-7"></a><span class="w">  </span><span class="kt">var</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">User</span><span class="w"> </span><span class="p">{</span><span class="n">IsAdmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="p">};</span>
<a id="__codelineno-11-8" name="__codelineno-11-8"></a>
<a id="__codelineno-11-9" name="__codelineno-11-9"></a><span class="w">  </span><span class="c1">// Act</span>
<a id="__codelineno-11-10" name="__codelineno-11-10"></a><span class="w">  </span><span class="n">permissionChecker</span><span class="p">.</span><span class="n">CheckPermissions</span><span class="p">(</span><span class="n">mockDisabler</span><span class="p">,</span><span class="w"> </span><span class="n">user</span><span class="p">);</span>
<a id="__codelineno-11-11" name="__codelineno-11-11"></a>
<a id="__codelineno-11-12" name="__codelineno-11-12"></a><span class="w">  </span><span class="c1">// Assert</span>
<a id="__codelineno-11-13" name="__codelineno-11-13"></a><span class="w">  </span><span class="n">CollectionAssert</span><span class="p">.</span><span class="n">IsEmpty</span><span class="p">(</span><span class="n">mockDisabler</span><span class="p">.</span><span class="n">ReceivedCalls</span><span class="p">());</span>
<a id="__codelineno-11-14" name="__codelineno-11-14"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>This solution is much better because if we add more modules, this test is still checking to make sure that admin users do not have any modules disabled.</p>
<h3 id="summary"><a class="toclink" href="../../2015/10/28/til--how-to-check-if-a-substitute-was-called-zero-times/#summary">Summary</a></h3>
<p>When using a NSubstitute mock and you need to make sure that it received no calls to any methods or properties, you can using NSubstitute’s <strong>ReceivedCalls</strong> in conjunction with <strong>CollectionAssert.IsEmpty</strong> to ensure that the substitute was not called.</p>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/cameronpresley.png" alt="Cameron Presley">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2015-10-20 00:00:00+00:00">Oct 20, 2015</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../../category/functional-programming/" class="md-meta__link">Functional Programming</a></li>
        
        
          
          <li class="md-meta__item">
            
              7 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="using-f-to-solve-a-constraints-problem"><a class="toclink" href="../../2015/10/20/using-f-to-solve-a-constraints-problem/">Using F# To Solve a Constraints Problem</a></h2>
<p>In this post, I’m going to solve a logic puzzle using C# and F#. First, I’ll define the problem being solved and what our restrictions are. Next, I’ll show how I’d break down the problem and write an easy-to-read, extendable solution using idiomatic C#. Afterwards, I’ll solve the same problem and write an easy-to-read, extendable solution writing in idiomatic F#. Finally, we’ll compare the two solutions and see why the F# solution is the better solution.</p>
<h3 id="the-problem"><a class="toclink" href="../../2015/10/20/using-f-to-solve-a-constraints-problem/#the-problem">The Problem</a></h3>
<p>For this problem, I’m going to write a constraint solver (thanks to <a href="https://geoffmazeroff.com/">Geoff Mazeroff</a> for the inspiration).</p>
<p>If you’re not familiar with the concept, a constraint is simply some rule that must be followed (such as all numbers must start with a 4). So a constraint solver is something that takes all the constraints and a source of inputs and returns all values that fit all the constraints.</p>
<p>With that being said, our source will be a list of positive integers and our constraints are the following:</p>
<ul>
<li>4 digits long (so 1000 – 9999)</li>
<li>Must be even (so 1000, 1002, 1004, etc…)</li>
<li>The first digit must match the last digit (2002, 2012, 2022, etc…)</li>
</ul>
<p>To further restrict solutions, all code will be production ready. This includes handling error conditions (like input being null), being maintainable (easily adding more constraints) and easy to read.</p>
<p>To quickly summarize, we need to find a robust, maintainable, and readable solution to help us find all 4 digit number that are even and that the first and last digit are equal.</p>
<h3 id="implementing-a-solution-in-c"><a class="toclink" href="../../2015/10/20/using-f-to-solve-a-constraints-problem/#implementing-a-solution-in-c">Implementing a Solution in C</a></h3>
<p>For the C# solution, I’m going to need a class for every constraint, a class to execute all constraints against a source (positive integers) and a runner that ties all the pieces together.</p>
<p>Starting with the smaller blocks and building up, I’m going to start with the constraint classes. Each constraint is going to take a single number and will return true if the number follows the constraint, false otherwise.</p>
<p>With that being said, I’d first implement the constraint that all numbers must be 4 digits long</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-22-1">1</a></span>
<span class="normal"><a href="#__codelineno-22-2">2</a></span>
<span class="normal"><a href="#__codelineno-22-3">3</a></span>
<span class="normal"><a href="#__codelineno-22-4">4</a></span>
<span class="normal"><a href="#__codelineno-22-5">5</a></span>
<span class="normal"><a href="#__codelineno-22-6">6</a></span>
<span class="normal"><a href="#__codelineno-22-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">MustBeFourDigitsLongConstraint</span>
<a id="__codelineno-22-2" name="__codelineno-22-2"></a><span class="p">{</span>
<a id="__codelineno-22-3" name="__codelineno-22-3"></a><span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="nf">FollowsConstraint</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="k">value</span><span class="p">)</span>
<a id="__codelineno-22-4" name="__codelineno-22-4"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-22-5" name="__codelineno-22-5"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">value</span><span class="p">.</span><span class="n">ToString</span><span class="p">().</span><span class="n">Length</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span>
<a id="__codelineno-22-6" name="__codelineno-22-6"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-22-7" name="__codelineno-22-7"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Second, I’d write the constraint that all numbers must be even</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-23-1">1</a></span>
<span class="normal"><a href="#__codelineno-23-2">2</a></span>
<span class="normal"><a href="#__codelineno-23-3">3</a></span>
<span class="normal"><a href="#__codelineno-23-4">4</a></span>
<span class="normal"><a href="#__codelineno-23-5">5</a></span>
<span class="normal"><a href="#__codelineno-23-6">6</a></span>
<span class="normal"><a href="#__codelineno-23-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">MustBeEvenConstraint</span>
<a id="__codelineno-23-2" name="__codelineno-23-2"></a><span class="p">{</span>
<a id="__codelineno-23-3" name="__codelineno-23-3"></a><span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="nf">FollowsConstraint</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="k">value</span><span class="p">)</span>
<a id="__codelineno-23-4" name="__codelineno-23-4"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-23-5" name="__codelineno-23-5"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">value</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="__codelineno-23-6" name="__codelineno-23-6"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-23-7" name="__codelineno-23-7"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Third, I’d implement the constraint that all numbers must have the same first digit and the last digit</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-24-1">1</a></span>
<span class="normal"><a href="#__codelineno-24-2">2</a></span>
<span class="normal"><a href="#__codelineno-24-3">3</a></span>
<span class="normal"><a href="#__codelineno-24-4">4</a></span>
<span class="normal"><a href="#__codelineno-24-5">5</a></span>
<span class="normal"><a href="#__codelineno-24-6">6</a></span>
<span class="normal"><a href="#__codelineno-24-7">7</a></span>
<span class="normal"><a href="#__codelineno-24-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">FirstDigitMustEqualLastDigitConstraint</span>
<a id="__codelineno-24-2" name="__codelineno-24-2"></a><span class="p">{</span>
<a id="__codelineno-24-3" name="__codelineno-24-3"></a><span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="nf">FollowsConstraint</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="k">value</span><span class="p">)</span>
<a id="__codelineno-24-4" name="__codelineno-24-4"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-24-5" name="__codelineno-24-5"></a><span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">valueString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">value</span><span class="p">.</span><span class="n">ToString</span><span class="p">();</span>
<a id="__codelineno-24-6" name="__codelineno-24-6"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">valueString</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">valueString</span><span class="p">[</span><span class="n">valueString</span><span class="p">.</span><span class="n">Length</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
<a id="__codelineno-24-7" name="__codelineno-24-7"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-24-8" name="__codelineno-24-8"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>At this point, I have the constraints written, but I need them to follow a general contract so that the <strong>Constraint Solver</strong> (about to be defined) can take a list of these constraints. I’ll introduce an interface, <strong>IConstraint</strong> and update my classes to implement that interface.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-25-1">1</a></span>
<span class="normal"><a href="#__codelineno-25-2">2</a></span>
<span class="normal"><a href="#__codelineno-25-3">3</a></span>
<span class="normal"><a href="#__codelineno-25-4">4</a></span>
<span class="normal"><a href="#__codelineno-25-5">5</a></span>
<span class="normal"><a href="#__codelineno-25-6">6</a></span>
<span class="normal"><a href="#__codelineno-25-7">7</a></span>
<span class="normal"><a href="#__codelineno-25-8">8</a></span>
<span class="normal"><a href="#__codelineno-25-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1"></a><span class="k">public</span><span class="w"> </span><span class="k">interface</span><span class="w"> </span><span class="n">IConstraint</span>
<a id="__codelineno-25-2" name="__codelineno-25-2"></a><span class="p">{</span>
<a id="__codelineno-25-3" name="__codelineno-25-3"></a><span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="nf">FollowsConstraint</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="k">value</span><span class="p">);</span>
<a id="__codelineno-25-4" name="__codelineno-25-4"></a><span class="p">}</span>
<a id="__codelineno-25-5" name="__codelineno-25-5"></a><span class="k">class</span><span class="w"> </span><span class="nc">MustBeFourDigitsLongConstraint</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">IConstraint</span><span class="w"> </span><span class="p">{</span><span class="cm">/* Implementation Details Omitted */</span><span class="p">}</span>
<a id="__codelineno-25-6" name="__codelineno-25-6"></a>
<a id="__codelineno-25-7" name="__codelineno-25-7"></a><span class="k">class</span><span class="w"> </span><span class="nc">MustBeEvenConstraint</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">IConstraint</span><span class="w"> </span><span class="p">{</span><span class="cm">/* Implementation Details Omitted */</span><span class="p">}</span>
<a id="__codelineno-25-8" name="__codelineno-25-8"></a>
<a id="__codelineno-25-9" name="__codelineno-25-9"></a><span class="k">class</span><span class="w"> </span><span class="nc">FirstDigitMustEqualLastDigitConstraint</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">IConstraint</span><span class="w"> </span><span class="p">{</span><span class="cm">/* Implementation Details Omitted */</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>So now I have the constraints defined and they’re now implementing a uniform interface, I can now create the constraint solver. This class is responsible for taking the list of numbers and the list of constraints and then returning a list of numbers that follow all constraints.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-26-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-26-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-26-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-26-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-26-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-26-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-26-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-26-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-26-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-26-10">10</a></span>
<span class="normal"><a href="#__codelineno-26-11">11</a></span>
<span class="normal"><a href="#__codelineno-26-12">12</a></span>
<span class="normal"><a href="#__codelineno-26-13">13</a></span>
<span class="normal"><a href="#__codelineno-26-14">14</a></span>
<span class="normal"><a href="#__codelineno-26-15">15</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">ConstraintSolver</span>
<a id="__codelineno-26-2" name="__codelineno-26-2"></a><span class="p">{</span>
<a id="__codelineno-26-3" name="__codelineno-26-3"></a><span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="n">List</span><span class="w"> </span><span class="nf">FindValues</span><span class="p">(</span><span class="n">List</span><span class="w"> </span><span class="n">constraints</span><span class="p">,</span><span class="w"> </span><span class="n">List</span><span class="w"> </span><span class="n">values</span><span class="p">)</span>
<a id="__codelineno-26-4" name="__codelineno-26-4"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-26-5" name="__codelineno-26-5"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">constraints</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">null</span><span class="p">)</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArgumentNullException</span><span class="p">(</span><span class="s">&quot;constraints&quot;</span><span class="p">);</span>
<a id="__codelineno-26-6" name="__codelineno-26-6"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">null</span><span class="p">)</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArgumentNullException</span><span class="p">(</span><span class="s">&quot;values&quot;</span><span class="p">);</span>
<a id="__codelineno-26-7" name="__codelineno-26-7"></a>
<a id="__codelineno-26-8" name="__codelineno-26-8"></a><span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">values</span><span class="p">;</span>
<a id="__codelineno-26-9" name="__codelineno-26-9"></a><span class="w">        </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="kt">var</span><span class="w"> </span><span class="n">constraint</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">constraints</span><span class="p">)</span>
<a id="__codelineno-26-10" name="__codelineno-26-10"></a><span class="w">        </span><span class="p">{</span>
<a id="__codelineno-26-11" name="__codelineno-26-11"></a><span class="w">            </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="n">Where</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">constraint</span><span class="p">.</span><span class="n">FollowsConstraint</span><span class="p">(</span><span class="n">x</span><span class="p">)).</span><span class="n">ToList</span><span class="p">();</span>
<a id="__codelineno-26-12" name="__codelineno-26-12"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-26-13" name="__codelineno-26-13"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
<a id="__codelineno-26-14" name="__codelineno-26-14"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-26-15" name="__codelineno-26-15"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Finally, I can put all the pieces together using LINQPad (Full C# solution can be found here).</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-27-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-27-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-27-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-27-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-27-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-27-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-27-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-27-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-27-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-27-10">10</a></span>
<span class="normal"><a href="#__codelineno-27-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1"></a><span class="k">void</span><span class="w"> </span><span class="nf">Main</span><span class="p">()</span>
<a id="__codelineno-27-2" name="__codelineno-27-2"></a><span class="p">{</span>
<a id="__codelineno-27-3" name="__codelineno-27-3"></a><span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">numbers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Enumerable</span><span class="p">.</span><span class="n">Range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">10000</span><span class="p">).</span><span class="n">ToList</span><span class="p">();</span>
<a id="__codelineno-27-4" name="__codelineno-27-4"></a><span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">constraints</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">IConstraint</span><span class="o">&gt;</span><span class="p">{</span><span class="k">new</span><span class="w"> </span><span class="n">MustBeFourDigitsLongConstraint</span><span class="p">(),</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">MustBeEvenConstraint</span><span class="p">(),</span><span class="w"> </span>
<a id="__codelineno-27-5" name="__codelineno-27-5"></a><span class="w">             </span><span class="k">new</span><span class="w"> </span><span class="nf">FirstDigitMustEqualLastDigitConstraint</span><span class="p">()};</span>
<a id="__codelineno-27-6" name="__codelineno-27-6"></a>
<a id="__codelineno-27-7" name="__codelineno-27-7"></a><span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">constraintSolver</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ConstraintSolver</span><span class="p">();</span>
<a id="__codelineno-27-8" name="__codelineno-27-8"></a><span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">constraintSolver</span><span class="p">.</span><span class="n">FindValues</span><span class="p">(</span><span class="n">constraints</span><span class="p">,</span><span class="w"> </span><span class="n">numbers</span><span class="p">.</span><span class="n">ToList</span><span class="p">());</span>
<a id="__codelineno-27-9" name="__codelineno-27-9"></a>
<a id="__codelineno-27-10" name="__codelineno-27-10"></a><span class="w">    </span><span class="n">result</span><span class="p">.</span><span class="n">Dump</span><span class="p">();</span>
<a id="__codelineno-27-11" name="__codelineno-27-11"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>This solution is easily extendable because if we need to add another constraint, we just add another class that implements the IConstraint interface and change the Main method to add an instance of the new constraint to the list of constraints.</p>
<h3 id="implementing-a-solution-in-f"><a class="toclink" href="../../2015/10/20/using-f-to-solve-a-constraints-problem/#implementing-a-solution-in-f">Implementing a Solution in F</a></h3>
<p>Now that we have the C# solution, let’s take a look at how I would solve the problem using F#.</p>
<p>Similar to the C# solution, I’m going to create a function for every constraint, a function to execute all constraints against a source (positive integers) and a runner that ties all the pieces together.</p>
<p>Also similar to the C# solution, I’m going to start with creating the constraints and then work on the constraint solver function.</p>
<p>First, I’d implement that the number must be four digits long constraint.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-28-1">1</a></span>
<span class="normal"><a href="#__codelineno-28-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1"></a><span class="k">let</span><span class="w"> </span><span class="nv">mustBeFourDigit</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<a id="__codelineno-28-2" name="__codelineno-28-2"></a><span class="w">    </span><span class="n">number</span><span class="o">.</span><span class="n">ToString</span><span class="bp">()</span><span class="o">.</span><span class="n">Length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span>
</code></pre></div></td></tr></table></div>
<p>Next, the number must be even constraint.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-29-1">1</a></span>
<span class="normal"><a href="#__codelineno-29-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1"></a><span class="k">let</span><span class="w"> </span><span class="nv">mustBeEven</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="o">=</span>
<a id="__codelineno-29-2" name="__codelineno-29-2"></a><span class="w">    </span><span class="n">number</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
</code></pre></div></td></tr></table></div>
<p>Lastly, the first digit is the same as the last digit constraint.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-30-1">1</a></span>
<span class="normal"><a href="#__codelineno-30-2">2</a></span>
<span class="normal"><a href="#__codelineno-30-3">3</a></span>
<span class="normal"><a href="#__codelineno-30-4">4</a></span>
<span class="normal"><a href="#__codelineno-30-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1"></a><span class="k">let</span><span class="w"> </span><span class="nv">firstDigitMustBeEqualLast</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="o">=</span>
<a id="__codelineno-30-2" name="__codelineno-30-2"></a><span class="w">    </span><span class="k">let</span><span class="w"> </span><span class="nv">numberString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">number</span><span class="o">.</span><span class="n">ToString</span><span class="bp">()</span><span class="o">.</span><span class="n">ToCharArray</span><span class="bp">()</span>
<a id="__codelineno-30-3" name="__codelineno-30-3"></a><span class="w">    </span><span class="k">let</span><span class="w"> </span><span class="nv">firstDigit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">numberString</span><span class="o">.</span><span class="n">GetValue</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span>
<a id="__codelineno-30-4" name="__codelineno-30-4"></a><span class="w">    </span><span class="k">let</span><span class="w"> </span><span class="nv">lastDigit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">numberString</span><span class="o">.</span><span class="n">GetValue</span><span class="o">(</span><span class="n">numberString</span><span class="o">.</span><span class="n">Length</span><span class="o">-</span><span class="mi">1</span><span class="o">)</span>
<a id="__codelineno-30-5" name="__codelineno-30-5"></a><span class="w">    </span><span class="n">firstDigit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lastDigit</span>
</code></pre></div></td></tr></table></div>
<p>At this stage in the C# solution, I had to create an interface, <strong>IConstraint</strong>, so that the constraint solver could take a list of constraints. What’s cool with F# is that I don’t have to define the interface. The F# type inference is saying that each of these functions are taking the same input (some generic `a) and returning a bool, so I can add all of them to the list. This is pretty convenient since I don’t have to worry about this piece of plumbing.</p>
<p>Now that the different constraints are defined, I’d go ahead and write the last function that takes a list of constraints and a list of numbers and returns the numbers that the constraints fit. (Confused by this function? Take a look at <a href="../../2015/10/13/implementing-your-own-version-of-fs-listfilter/">Implementing your own version of # List.Filter</a>)</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-31-1">1</a></span>
<span class="normal"><a href="#__codelineno-31-2">2</a></span>
<span class="normal"><a href="#__codelineno-31-3">3</a></span>
<span class="normal"><a href="#__codelineno-31-4">4</a></span>
<span class="normal"><a href="#__codelineno-31-5">5</a></span>
<span class="normal"><a href="#__codelineno-31-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1"></a><span class="k">let</span><span class="w"> </span><span class="nv">rec</span><span class="w"> </span><span class="n">findValidNumbers</span><span class="w"> </span><span class="n">numbers</span><span class="w"> </span><span class="n">constraints</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<a id="__codelineno-31-2" name="__codelineno-31-2"></a><span class="w">    </span><span class="k">match</span><span class="w"> </span><span class="n">constraints</span><span class="w"> </span><span class="k">with</span>
<a id="__codelineno-31-3" name="__codelineno-31-3"></a><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="bp">[]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">numbers</span>
<a id="__codelineno-31-4" name="__codelineno-31-4"></a><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="n">firstConstraint</span><span class="o">::</span><span class="n">remainingConstraints</span><span class="w"> </span><span class="o">-&gt;</span>
<a id="__codelineno-31-5" name="__codelineno-31-5"></a><span class="w">        </span><span class="k">let</span><span class="w"> </span><span class="nv">validNumbers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">numbers</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">List</span><span class="p">.</span><span class="n">filter</span><span class="w"> </span><span class="n">firstConstraint</span>
<a id="__codelineno-31-6" name="__codelineno-31-6"></a><span class="w">        </span><span class="n">findValidNumbers</span><span class="w"> </span><span class="n">validNumbers</span><span class="w"> </span><span class="n">remainingConstraints</span>
</code></pre></div></td></tr></table></div>
<p>Finally, all the pieces are in place, so I can now put all the pieces together using LINQPad.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-32-1">1</a></span>
<span class="normal"><a href="#__codelineno-32-2">2</a></span>
<span class="normal"><a href="#__codelineno-32-3">3</a></span>
<span class="normal"><a href="#__codelineno-32-4">4</a></span>
<span class="normal"><a href="#__codelineno-32-5">5</a></span>
<span class="normal"><a href="#__codelineno-32-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1"></a><span class="k">let</span><span class="w"> </span><span class="nv">numbers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="mi">1000</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="mi">9999</span><span class="o">]</span>
<a id="__codelineno-32-2" name="__codelineno-32-2"></a><span class="k">let</span><span class="w"> </span><span class="nv">constraints</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">mustBeFourDigits</span><span class="o">;</span><span class="w"> </span><span class="n">mustBeEven</span><span class="o">;</span><span class="w"> </span><span class="n">firstDigitMustEqualLast</span><span class="o">;]</span>
<a id="__codelineno-32-3" name="__codelineno-32-3"></a>
<a id="__codelineno-32-4" name="__codelineno-32-4"></a><span class="k">let</span><span class="w"> </span><span class="nv">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">findValidNumbers</span><span class="w"> </span><span class="n">numbers</span><span class="w"> </span><span class="n">constraints</span>
<a id="__codelineno-32-5" name="__codelineno-32-5"></a>
<a id="__codelineno-32-6" name="__codelineno-32-6"></a><span class="n">printf</span><span class="w"> </span><span class="s">&quot;%A&quot;</span><span class="w"> </span><span class="n">result</span>
</code></pre></div></td></tr></table></div>
<h3 id="comparing-both-solutions"><a class="toclink" href="../../2015/10/20/using-f-to-solve-a-constraints-problem/#comparing-both-solutions">Comparing Both Solutions</a></h3>
<p>Now that we have both solutions written up, let’s compare and see which solution is better.</p>
<p>First, the same design was used for both solutions. I decided to use this design for both because it’s flexible enough that we could add new constraints if needed (such as, the 2nd digit must be odd). As an example, for the C# solution, I’d create a new class that implemented <strong>IConstraint</strong> and then update the runner to use the new class. For the F# solution, I’d create a new function and update the runner. So, I’d think it’s safe to say that both solutions score about the same from a maintainability and extendability point of view.</p>
<p>From an implementation perspective, both solutions are production ready since the code handles possible error conditions (C# with null checks in the <strong>ConstraintSolver</strong> class, F# with none because it doesn’t support null). In addition to being robust, both solutions are readable by using ample whitespace and having all variables, classes, and interfaces clearly described.</p>
<p>With that being said, this is where the similarities end. When we look at how much code was written to solve the problem, we have a stark difference. For the C# solution, I ended up with 48 lines of code (omitting blank lines), however, for the F# solution, it only took 19. Now you could argue that I could have written the C# solution in fewer lines of code by removing curly braces around one line statements or ignoring null inputs. However, this would lead the code to be less robust.</p>
<p>Another difference between the F# solution and C# is that I was able to focus on the solution without having to wire up an interface. You’ll often hear developers talk about the how little plumbing you need for F# to “just work” and this small example demonstrates that point.</p>
<p>Another difference (albeit subtle) is that the F# solution is that I can use the <strong>findValidNumbers</strong> function with any generic list of values and any generic list of functions that take the generic type and return true/false.</p>
<p>In other words, if I had another constraint problem using strings, I’d still implement the different constraints, but I could use the same <strong>findValidNumbers</strong> function. At that point, however, I’d probably rename it to <strong>findValidValues</strong> to signify the generic solution.</p>
<p>What’s awesome about this is that I didn’t have to do any more work to have a generic solution, F# did that for me. To be fair, the C# solution can easily be made generic, but that would have to be a conscious design decision and I think that’s a downside.</p>
<h3 id="tldr"><a class="toclink" href="../../2015/10/20/using-f-to-solve-a-constraints-problem/#tldr">TL;DR</a></h3>
<p>In this post, we took a look at solving a number constraint problem by using idiomatic C# and F#. Even though both solutions are easy to read and easy to extend, the F# version was less than 1/2 the size of the C# solution. In addition, I didn’t have to do any plumbing for the F# version, but had to do some for the C# solution, and to top it off, the F# solution is generically solved, whereas the C# solution is not.</p>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/cameronpresley.png" alt="Cameron Presley">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2015-10-13 00:00:00+00:00">Oct 13, 2015</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../../category/functional-programming/" class="md-meta__link">Functional Programming</a>, 
              <a href="../../category/net/" class="md-meta__link">.NET</a></li>
        
        
          
          <li class="md-meta__item">
            
              3 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="implementing-your-own-version-of-fs-listfilter"><a class="toclink" href="../../2015/10/13/implementing-your-own-version-of-fs-listfilter/">Implementing Your Own Version of F#’s List.Filter</a></h2>
<p>As I’ve been thinking more about F#, I began to wonder how certain methods in the F# stack work, so I decided to implement F#’s List.filter method.</p>
<p>For those of you who aren’t familiar, List.Filter takes a function that returns true or false and a list of values. The result of the call is all values that fulfill the fuction.</p>
<p>For example, if we wanted to keep just the even numbers in our list, then the following would accomplish that goal.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-24-1">1</a></span>
<span class="normal"><a href="#__codelineno-24-2">2</a></span>
<span class="normal"><a href="#__codelineno-24-3">3</a></span>
<span class="normal"><a href="#__codelineno-24-4">4</a></span>
<span class="normal"><a href="#__codelineno-24-5">5</a></span>
<span class="normal"><a href="#__codelineno-24-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1"></a><span class="k">let</span><span class="w"> </span><span class="nv">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="mi">1</span><span class="o">;</span><span class="mi">2</span><span class="o">;</span><span class="mi">3</span><span class="o">;</span><span class="mi">4</span><span class="o">]</span>
<a id="__codelineno-24-2" name="__codelineno-24-2"></a><span class="k">let</span><span class="w"> </span><span class="nv">isItEven</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<a id="__codelineno-24-3" name="__codelineno-24-3"></a>
<a id="__codelineno-24-4" name="__codelineno-24-4"></a>
<a id="__codelineno-24-5" name="__codelineno-24-5"></a><span class="k">let</span><span class="w"> </span><span class="nv">evenValues</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nn">List</span><span class="p">.</span><span class="n">filter</span><span class="w"> </span><span class="n">isItEven</span><span class="w"> </span><span class="n">values</span>
<a id="__codelineno-24-6" name="__codelineno-24-6"></a><span class="c1">// val it : int list = [2; 4]</span>
</code></pre></div></td></tr></table></div>
<p>Now that we know the problem, how would we begin to implement? First, we need to define a function called filter:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-25-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1"></a><span class="k">let</span><span class="w"> </span><span class="nv">filter</span><span class="w"> </span><span class="bp">()</span><span class="w"> </span><span class="o">=</span>
</code></pre></div></td></tr></table></div>
<p>However, to match the signature for List.filter, it needs to take a function that maps integers to bools and the list of values to work on</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-26-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1"></a><span class="k">let</span><span class="w"> </span><span class="nv">filter</span><span class="w"> </span><span class="o">(</span><span class="n">func</span><span class="o">:</span><span class="n">int</span><span class="o">-&gt;</span><span class="kt">bool</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">values</span><span class="o">:</span><span class="n">int</span><span class="w"> </span><span class="n">List</span><span class="o">)</span><span class="w"> </span><span class="o">=</span>
</code></pre></div></td></tr></table></div>
<p>Now that we have the signature, let’s add some logic to match on the list of values. When working with lists, there are two possibilities, an empty list and a non-empty list. Let’s first explore the empty list option.</p>
<p>In the case of an empty list of values, then it doesn’t matter what the func parameter does, there are no possible results, so we should return an empty list for the result.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-27-1">1</a></span>
<span class="normal"><a href="#__codelineno-27-2">2</a></span>
<span class="normal"><a href="#__codelineno-27-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1"></a><span class="k">let</span><span class="w"> </span><span class="nv">filter</span><span class="w"> </span><span class="o">(</span><span class="n">func</span><span class="o">:</span><span class="n">int</span><span class="o">-&gt;</span><span class="kt">bool</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">values</span><span class="o">:</span><span class="n">int</span><span class="w"> </span><span class="n">List</span><span class="o">)</span><span class="w"> </span><span class="o">=</span>
<a id="__codelineno-27-2" name="__codelineno-27-2"></a><span class="w">    </span><span class="k">match</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="k">with</span>
<a id="__codelineno-27-3" name="__codelineno-27-3"></a><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="bp">[]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="bp">[]</span>
</code></pre></div></td></tr></table></div>
<p>Now that we’ve handled the empty list, let’s explore the non-empty list scenario. In this branch, the list must have a head and a tail, so we can deconstruct the list to follow that pattern.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-28-1">1</a></span>
<span class="normal"><a href="#__codelineno-28-2">2</a></span>
<span class="normal"><a href="#__codelineno-28-3">3</a></span>
<span class="normal"><a href="#__codelineno-28-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1"></a><span class="k">let</span><span class="w"> </span><span class="nv">filter</span><span class="w"> </span><span class="o">(</span><span class="n">func</span><span class="o">:</span><span class="n">int</span><span class="o">-&gt;</span><span class="kt">bool</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">values</span><span class="o">:</span><span class="n">int</span><span class="w"> </span><span class="n">List</span><span class="o">)</span><span class="w"> </span><span class="o">=</span>
<a id="__codelineno-28-2" name="__codelineno-28-2"></a><span class="w">    </span><span class="k">match</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="k">with</span>
<a id="__codelineno-28-3" name="__codelineno-28-3"></a><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="bp">[]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="bp">[]</span>
<a id="__codelineno-28-4" name="__codelineno-28-4"></a><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="n">head</span><span class="o">::</span><span class="n">tail</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="c1">// what goes here?</span>
</code></pre></div></td></tr></table></div>
<p>Now that we’ve deconstructed the list, we can now use the func parameter with the head element. If the value satisfies the func parameter, then we want to add the head element to the list of results and continue processing the rest of the list. To do that, we can use recursion to call back into filter with the same func parameter and the rest of the list:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-29-1">1</a></span>
<span class="normal"><a href="#__codelineno-29-2">2</a></span>
<span class="normal"><a href="#__codelineno-29-3">3</a></span>
<span class="normal"><a href="#__codelineno-29-4">4</a></span>
<span class="normal"><a href="#__codelineno-29-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1"></a><span class="k">let</span><span class="w"> </span><span class="nv">rec</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="o">(</span><span class="n">func</span><span class="o">:</span><span class="n">int</span><span class="o">-&gt;</span><span class="kt">bool</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">values</span><span class="o">:</span><span class="n">int</span><span class="w"> </span><span class="n">List</span><span class="o">)</span><span class="w"> </span><span class="o">=</span>
<a id="__codelineno-29-2" name="__codelineno-29-2"></a><span class="w">    </span><span class="k">match</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="k">with</span>
<a id="__codelineno-29-3" name="__codelineno-29-3"></a><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="bp">[]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="bp">[]</span>
<a id="__codelineno-29-4" name="__codelineno-29-4"></a><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="n">head</span><span class="o">::</span><span class="n">tail</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span>
<a id="__codelineno-29-5" name="__codelineno-29-5"></a><span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="n">func</span><span class="w"> </span><span class="n">head</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">head</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="n">func</span><span class="w"> </span><span class="n">tail</span>
</code></pre></div></td></tr></table></div>
<p>At this point, we need to handle the case where the head element does not satisfy the func parameter. In this case, we should not add the element to the list of results and we should let filter continue the work</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-30-1">1</a></span>
<span class="normal"><a href="#__codelineno-30-2">2</a></span>
<span class="normal"><a href="#__codelineno-30-3">3</a></span>
<span class="normal"><a href="#__codelineno-30-4">4</a></span>
<span class="normal"><a href="#__codelineno-30-5">5</a></span>
<span class="normal"><a href="#__codelineno-30-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1"></a><span class="k">let</span><span class="w"> </span><span class="nv">rec</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="o">(</span><span class="n">func</span><span class="o">:</span><span class="n">int</span><span class="o">-&gt;</span><span class="kt">bool</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">values</span><span class="o">:</span><span class="n">int</span><span class="w"> </span><span class="n">List</span><span class="o">)</span><span class="w"> </span><span class="o">=</span>
<a id="__codelineno-30-2" name="__codelineno-30-2"></a><span class="w">    </span><span class="k">match</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="k">with</span>
<a id="__codelineno-30-3" name="__codelineno-30-3"></a><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="bp">[]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="bp">[]</span>
<a id="__codelineno-30-4" name="__codelineno-30-4"></a><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="n">head</span><span class="o">::</span><span class="n">tail</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span>
<a id="__codelineno-30-5" name="__codelineno-30-5"></a><span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="n">func</span><span class="w"> </span><span class="n">head</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">head</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="n">func</span><span class="w"> </span><span class="n">tail</span>
<a id="__codelineno-30-6" name="__codelineno-30-6"></a><span class="w">         </span><span class="k">else</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="n">func</span><span class="w"> </span><span class="n">tail</span>
</code></pre></div></td></tr></table></div>
<p>By handling the base case first (an empty list), filter can focus on the current element in the list (head) and then recurse to process the rest of the list. This solution works, but we can make this better by removing the type annotations. Interestingly enough, we don’t care if we’re working with integers, strings, or whatever. Just as long as the function takes some type and returns bool and the list of values matches the same type as the func parameter, it works. So then we end up with the following:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-31-1">1</a></span>
<span class="normal"><a href="#__codelineno-31-2">2</a></span>
<span class="normal"><a href="#__codelineno-31-3">3</a></span>
<span class="normal"><a href="#__codelineno-31-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1"></a><span class="k">let</span><span class="w"> </span><span class="nv">rec</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="n">func</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="o">=</span>
<a id="__codelineno-31-2" name="__codelineno-31-2"></a><span class="w">    </span><span class="k">match</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="k">with</span>
<a id="__codelineno-31-3" name="__codelineno-31-3"></a><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="bp">[]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="bp">[]</span>
<a id="__codelineno-31-4" name="__codelineno-31-4"></a><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="n">head</span><span class="o">::</span><span class="n">tail</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">func</span><span class="w"> </span><span class="n">head</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">head</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="n">func</span><span class="w"> </span><span class="n">tail</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="n">func</span><span class="w"> </span><span class="n">tail</span>
</code></pre></div></td></tr></table></div>
<p>In general, when working with lists, I tend to start by matching the list with either an empty list or non-empty. From there, I’ve got my base case, so I can focus on the implementation for the first element. After performing the work for the first element, I can then recurse to the next element.</p>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/cameronpresley.png" alt="Cameron Presley">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2015-01-16 00:00:00+00:00">Jan 16, 2015</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../../category/today-i-learned/" class="md-meta__link">Today I Learned</a></li>
        
        
          
          <li class="md-meta__item">
            
              7 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="today-i-learned-the-chain-of-responsibility-design-pattern"><a class="toclink" href="../../2015/01/16/today-i-learned--the-chain-of-responsibility-design-pattern/">Today I Learned – The Chain of Responsibility Design Pattern</a></h2>
<blockquote>
<p>There is nothing new in the world except the history you do not know.
– Harry S. Truman</p>
</blockquote>
<p>The more experience I gain problem solving, the more this holds true. For this post, I’m going to first discuss the problem that I was trying to solve. Next, I’ll show what my first solution was, followed by the shortcomings of this solution. Thirdly, we’ll iterate over a better solution to the problem. This in turn, will provide the motivation for what the Chain of Responsibility is and how to implement. Finally, I’ll wrap up with what the benefits were of using this design. .</p>
<h3 id="problem-i-was-trying-to-solve"><a class="toclink" href="../../2015/01/16/today-i-learned--the-chain-of-responsibility-design-pattern/#problem-i-was-trying-to-solve">Problem I was trying to solve</a></h3>
<p>As part of the process of installing our software, there are scripts that will update the database from it’s current version to the latest version. As it stands, it needs to be able to upgrade a database from any version to the current version.</p>
<h4 id="previous-solution"><a class="toclink" href="../../2015/01/16/today-i-learned--the-chain-of-responsibility-design-pattern/#previous-solution">Previous Solution</a></h4>
<p>The first thing that comes to me is that I need to apply database scripts in a sequential way. For example, if the database’s current version is 1.0 and the latest version is 3.0, it would need to apply the script to upgrade the database from 1.0 to 2.0 and then apply the script to upgrade the database from 2.0 to 3.0.</p>
<p>For the first implementation, there were only two versions, 1.0 and 2.0. Since I didn’t want to build in a lot of functionality if it wasn’t needed yet, I created a helper method that returns the correct updater for a given version. In the below code, if the version does not exist, I assume the database does not exist and return the class that will create the database. Otherwise if the version is 1.0, I return a class that is responsible for the upgrading a database from 1.0 to 2.0. If the version is 2.0, I return a class that doesn’t do anything (i.e. there’s no upgrades to be done).</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-11-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-11-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-11-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-11-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-11-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-11-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-11-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-11-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-11-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="k">public</span><span class="w"> </span><span class="n">IDatabaseUpdater</span><span class="w"> </span><span class="nf">GetDatabaseUpdater</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">version</span><span class="p">)</span>
<a id="__codelineno-11-2" name="__codelineno-11-2"></a><span class="p">{</span>
<a id="__codelineno-11-3" name="__codelineno-11-3"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="n">IsNullOrWhiteSpace</span><span class="p">(</span><span class="n">version</span><span class="p">))</span>
<a id="__codelineno-11-4" name="__codelineno-11-4"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">DatabaseCreator</span><span class="p">();</span>
<a id="__codelineno-11-5" name="__codelineno-11-5"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">version</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;1.0&quot;</span><span class="p">)</span>
<a id="__codelineno-11-6" name="__codelineno-11-6"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">Database100To200Updater</span><span class="p">();</span>
<a id="__codelineno-11-7" name="__codelineno-11-7"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">version</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;2.0&quot;</span><span class="p">)</span>
<a id="__codelineno-11-8" name="__codelineno-11-8"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">CurrentVersionUpdater</span><span class="p">();</span>
<a id="__codelineno-11-9" name="__codelineno-11-9"></a><span class="w">  </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">ArgumentException</span><span class="p">(</span><span class="s">&quot;The version &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; is not supported for database upgrades.&quot;</span><span class="p">);</span>
<a id="__codelineno-11-10" name="__codelineno-11-10"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h4 id="problem-with-solution"><a class="toclink" href="../../2015/01/16/today-i-learned--the-chain-of-responsibility-design-pattern/#problem-with-solution">Problem with solution</a></h4>
<p>This solution worked well when there only three possible actions (create a new database, apply the single script, or do nothing). However, we are now going to be shipping version 3.0 and there will need to be a new class that is responsible for upgrading the 2.0 to 3.0. In order to add this functionality, I’d have to do the following:</p>
<ol>
<li>Create the Database200To300Updater class that contained the logic for updating the database from 2.0 to 3.0.</li>
<li>Modify the Database100To200Updater class to also use the Database200To300Updater in order to perform the next part of the upgrade.</li>
<li>Add additional logic to the above method so that if the database is 2.0 to return the Database200To300Updater class.</li>
</ol>
<p>After making the modifications, the method now looks like:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-12-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-12-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-12-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-12-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-12-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-12-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-12-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-12-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-12-10">10</a></span>
<span class="normal"><a href="#__codelineno-12-11">11</a></span>
<span class="normal"><a href="#__codelineno-12-12">12</a></span>
<span class="normal"><a href="#__codelineno-12-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="k">public</span><span class="w"> </span><span class="n">IDatabaseUpdater</span><span class="w"> </span><span class="nf">GetDatabaseUpdater</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">version</span><span class="p">)</span>
<a id="__codelineno-12-2" name="__codelineno-12-2"></a><span class="p">{</span>
<a id="__codelineno-12-3" name="__codelineno-12-3"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="n">IsNullOrWhiteSpace</span><span class="p">(</span><span class="n">version</span><span class="p">))</span>
<a id="__codelineno-12-4" name="__codelineno-12-4"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">DatabaseCreator</span><span class="p">();</span>
<a id="__codelineno-12-5" name="__codelineno-12-5"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">version</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;1.0&quot;</span><span class="p">)</span>
<a id="__codelineno-12-6" name="__codelineno-12-6"></a><span class="hll"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">Database100To200Updater</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Database200To300Updater</span><span class="p">());</span>
</span><a id="__codelineno-12-7" name="__codelineno-12-7"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">version</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;2.0&quot;</span><span class="p">)</span>
<a id="__codelineno-12-8" name="__codelineno-12-8"></a><span class="hll"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">Database200To300Updater</span><span class="p">();</span>
</span><a id="__codelineno-12-9" name="__codelineno-12-9"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">version</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;3.0&quot;</span><span class="p">)</span>
<a id="__codelineno-12-10" name="__codelineno-12-10"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">CurrentVersionUpdater</span><span class="p">();</span>
<a id="__codelineno-12-11" name="__codelineno-12-11"></a>
<a id="__codelineno-12-12" name="__codelineno-12-12"></a><span class="w">  </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">ArgumentException</span><span class="p">(</span><span class="s">&quot;The version &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; is not supported for database upgrades.&quot;</span><span class="p">);</span>
<a id="__codelineno-12-13" name="__codelineno-12-13"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>So far, so good, we now have the logic to be able to apply scripts in order, however, now that we’ve added version 3.0, I start to wonder what I would do if we added more versions? After some thought, it would look identical to the previous steps (see below for what would happen if we added version 4.0).</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-13-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-13-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-13-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-13-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-13-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-13-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-13-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-13-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-13-10">10</a></span>
<span class="normal"><a href="#__codelineno-13-11">11</a></span>
<span class="normal"><a href="#__codelineno-13-12">12</a></span>
<span class="normal"><a href="#__codelineno-13-13">13</a></span>
<span class="normal"><a href="#__codelineno-13-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="k">public</span><span class="w"> </span><span class="n">IDatabaseUpdater</span><span class="w"> </span><span class="nf">GetDatabaseUpdater</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">version</span><span class="p">)</span>
<a id="__codelineno-13-2" name="__codelineno-13-2"></a><span class="p">{</span>
<a id="__codelineno-13-3" name="__codelineno-13-3"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="n">IsNullOrWhiteSpace</span><span class="p">(</span><span class="n">version</span><span class="p">))</span>
<a id="__codelineno-13-4" name="__codelineno-13-4"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">DatabaseCreator</span><span class="p">();</span>
<a id="__codelineno-13-5" name="__codelineno-13-5"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">version</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;1.0&quot;</span><span class="p">)</span>
<a id="__codelineno-13-6" name="__codelineno-13-6"></a><span class="hll"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">Database100To200Updater</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Database200To300Updater</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Database300To400Updater</span><span class="p">()));</span>
</span><a id="__codelineno-13-7" name="__codelineno-13-7"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">version</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;2.0&quot;</span><span class="p">)</span>
<a id="__codelineno-13-8" name="__codelineno-13-8"></a><span class="hll"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">Database200To300Updater</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Database300To400Updater</span><span class="p">());</span>
</span><a id="__codelineno-13-9" name="__codelineno-13-9"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">version</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;3.0&quot;</span><span class="p">)</span>
<a id="__codelineno-13-10" name="__codelineno-13-10"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">Database300To400Updater</span><span class="p">();</span>
<a id="__codelineno-13-11" name="__codelineno-13-11"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">version</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;4.0&quot;</span><span class="p">)</span>
<a id="__codelineno-13-12" name="__codelineno-13-12"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">CurrentVersionUpdater</span><span class="p">();</span>
<a id="__codelineno-13-13" name="__codelineno-13-13"></a><span class="w">  </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">ArgumentException</span><span class="p">(</span><span class="s">&quot;The version &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; is not supported for database upgrades.&quot;</span><span class="p">);</span>
<a id="__codelineno-13-14" name="__codelineno-13-14"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>If we create some variables to hold onto these classes, and reorder the if statements, we can write this helper method as:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-14-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-14-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-14-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-14-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-14-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-14-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-14-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-14-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-14-10">10</a></span>
<span class="normal"><a href="#__codelineno-14-11">11</a></span>
<span class="normal"><a href="#__codelineno-14-12">12</a></span>
<span class="normal"><a href="#__codelineno-14-13">13</a></span>
<span class="normal"><a href="#__codelineno-14-14">14</a></span>
<span class="normal"><a href="#__codelineno-14-15">15</a></span>
<span class="normal"><a href="#__codelineno-14-16">16</a></span>
<span class="normal"><a href="#__codelineno-14-17">17</a></span>
<span class="normal"><a href="#__codelineno-14-18">18</a></span>
<span class="normal"><a href="#__codelineno-14-19">19</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="k">public</span><span class="w"> </span><span class="n">IDatabaseUpdater</span><span class="w"> </span><span class="nf">GetDatabaseUpdater</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">version</span><span class="p">)</span>
<a id="__codelineno-14-2" name="__codelineno-14-2"></a><span class="p">{</span>
<a id="__codelineno-14-3" name="__codelineno-14-3"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="n">IsNullOrWhiteSpace</span><span class="p">(</span><span class="n">version</span><span class="p">))</span>
<a id="__codelineno-14-4" name="__codelineno-14-4"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">DatabaseCreator</span><span class="p">();</span>
<a id="__codelineno-14-5" name="__codelineno-14-5"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">version</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;4.0&quot;</span><span class="p">)</span>
<a id="__codelineno-14-6" name="__codelineno-14-6"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">CurrentVersionUpdater</span><span class="p">();</span>
<a id="__codelineno-14-7" name="__codelineno-14-7"></a><span class="w">  </span><span class="kt">var</span><span class="w"> </span><span class="n">database300Updater</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Database300To400Updater</span><span class="p">();</span>
<a id="__codelineno-14-8" name="__codelineno-14-8"></a><span class="hll"><span class="w">  </span><span class="kt">var</span><span class="w"> </span><span class="n">database200Updater</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Database200To300Updater</span><span class="p">(</span><span class="n">database300To400Updater</span><span class="p">);</span>
</span><a id="__codelineno-14-9" name="__codelineno-14-9"></a><span class="hll"><span class="w">  </span><span class="kt">var</span><span class="w"> </span><span class="n">database100Updater</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Database100To200Updater</span><span class="p">(</span><span class="n">database200To300Updater</span><span class="p">);</span>
</span><a id="__codelineno-14-10" name="__codelineno-14-10"></a><span class="hll">
</span><a id="__codelineno-14-11" name="__codelineno-14-11"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">version</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;1.0&quot;</span><span class="p">)</span>
<a id="__codelineno-14-12" name="__codelineno-14-12"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">database100Updater</span><span class="p">;</span>
<a id="__codelineno-14-13" name="__codelineno-14-13"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">version</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;2.0&quot;</span><span class="p">)</span>
<a id="__codelineno-14-14" name="__codelineno-14-14"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">database200Updater</span><span class="p">;</span>
<a id="__codelineno-14-15" name="__codelineno-14-15"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">version</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;3.0&quot;</span><span class="p">)</span>
<a id="__codelineno-14-16" name="__codelineno-14-16"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">database300Updater</span><span class="p">;</span>
<a id="__codelineno-14-17" name="__codelineno-14-17"></a>
<a id="__codelineno-14-18" name="__codelineno-14-18"></a><span class="w">  </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">ArgumentException</span><span class="p">(</span><span class="s">&quot;The version &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; is not supported for database upgrades.&quot;</span><span class="p">);</span>
<a id="__codelineno-14-19" name="__codelineno-14-19"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h4 id="motivation-for-the-chain-of-responsibility"><a class="toclink" href="../../2015/01/16/today-i-learned--the-chain-of-responsibility-design-pattern/#motivation-for-the-chain-of-responsibility">Motivation for the Chain of Responsibility</a></h4>
<p>What I find interesting in this design is that I’ve now chained these updater classes together so that if the version 1.0 is returned, it will also use the 2.0 updater, which in turn calls the 3.0 updater. It was at this point, that I remembered a design pattern that followed this structure.</p>
<p>In this design pattern, you essentially have Handlers (in my case updaters) that check to see if they can handle the request. If so, they do and that stops the chain. However, if they can’t handle the request, they pass it to their Successor (which was also a Handler) to handle the request. The design pattern I was thinking about is the <a href="https://refactoring.guru/design-patterns/chain-of-responsibility">Chain of Responsibility pattern</a>.</p>
<p>In order to implement this pattern, you need to have an IHandler interface that exposes a Handle method and either a method or property to set the Successor. The method is the action to take (in our case Update) and the Successor represents the next Handler in the chain if the request could not be handled. The second component is referred to as ConcreteHandlers and they are just the implementors of the interface. One way to implement this is like the following:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-15-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-15-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-15-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-15-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-15-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-15-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-15-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-15-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-15-10">10</a></span>
<span class="normal"><a href="#__codelineno-15-11">11</a></span>
<span class="normal"><a href="#__codelineno-15-12">12</a></span>
<span class="normal"><a href="#__codelineno-15-13">13</a></span>
<span class="normal"><a href="#__codelineno-15-14">14</a></span>
<span class="normal"><a href="#__codelineno-15-15">15</a></span>
<span class="normal"><a href="#__codelineno-15-16">16</a></span>
<span class="normal"><a href="#__codelineno-15-17">17</a></span>
<span class="normal"><a href="#__codelineno-15-18">18</a></span>
<span class="normal"><a href="#__codelineno-15-19">19</a></span>
<span class="normal"><a href="#__codelineno-15-20">20</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="k">public</span><span class="w"> </span><span class="k">interface</span><span class="w"> </span><span class="n">IHandler</span>
<a id="__codelineno-15-2" name="__codelineno-15-2"></a><span class="p">{</span>
<a id="__codelineno-15-3" name="__codelineno-15-3"></a><span class="w">  </span><span class="n">IHandler</span><span class="w"> </span><span class="n">Successor</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-15-4" name="__codelineno-15-4"></a><span class="w">  </span><span class="k">void</span><span class="w"> </span><span class="nf">Update</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">version</span><span class="p">);</span>
<a id="__codelineno-15-5" name="__codelineno-15-5"></a><span class="p">}</span>
<a id="__codelineno-15-6" name="__codelineno-15-6"></a>
<a id="__codelineno-15-7" name="__codelineno-15-7"></a><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">ConcreteHandlerA</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">IHandler</span>
<a id="__codelineno-15-8" name="__codelineno-15-8"></a><span class="p">{</span>
<a id="__codelineno-15-9" name="__codelineno-15-9"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="n">IHandler</span><span class="w"> </span><span class="n">Successor</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-15-10" name="__codelineno-15-10"></a>
<a id="__codelineno-15-11" name="__codelineno-15-11"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">Update</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">version</span><span class="p">)</span>
<a id="__codelineno-15-12" name="__codelineno-15-12"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-15-13" name="__codelineno-15-13"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">CanTheRequestBeHandled</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-15-14" name="__codelineno-15-14"></a><span class="w">      </span><span class="c1">// handle the request</span>
<a id="__codelineno-15-15" name="__codelineno-15-15"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-15-16" name="__codelineno-15-16"></a><span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-15-17" name="__codelineno-15-17"></a><span class="w">      </span><span class="n">Successor</span><span class="p">.</span><span class="n">Update</span><span class="p">(</span><span class="n">version</span><span class="p">);</span>
<a id="__codelineno-15-18" name="__codelineno-15-18"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-15-19" name="__codelineno-15-19"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-15-20" name="__codelineno-15-20"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>The main difference between the pattern and what I need is that instead of doing if (canHandle)/else call Successor, what I’m really looking for is to run the upgrade script if the version we’re upgrading to is higher than our current version and then always call the successor. Given this change, here’s what that new implementation looks like:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-16-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-16-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-16-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-16-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-16-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-16-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-16-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-16-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-16-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-16-10">10</a></span>
<span class="normal"><a href="#__codelineno-16-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1"></a><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">ConcreteHandlerA</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">IHandler</span>
<a id="__codelineno-16-2" name="__codelineno-16-2"></a><span class="p">{</span>
<a id="__codelineno-16-3" name="__codelineno-16-3"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="n">Successor</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-16-4" name="__codelineno-16-4"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">Update</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">version</span><span class="p">)</span>
<a id="__codelineno-16-5" name="__codelineno-16-5"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-16-6" name="__codelineno-16-6"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">CanTheRequestBeHandled</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-16-7" name="__codelineno-16-7"></a><span class="w">      </span><span class="c1">// handle the request</span>
<a id="__codelineno-16-8" name="__codelineno-16-8"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-16-9" name="__codelineno-16-9"></a><span class="w">    </span><span class="n">Successor</span><span class="p">.</span><span class="n">Update</span><span class="p">(</span><span class="n">version</span><span class="p">);</span>
<a id="__codelineno-16-10" name="__codelineno-16-10"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-16-11" name="__codelineno-16-11"></a><span class="hll"><span class="p">}</span>
</span></code></pre></div></td></tr></table></div>
<h3 id="implementing-the-chain-of-responsibility"><a class="toclink" href="../../2015/01/16/today-i-learned--the-chain-of-responsibility-design-pattern/#implementing-the-chain-of-responsibility">Implementing the Chain of Responsibility</a></h3>
<p>Now that I know the pattern to use and how it works, I need to update the IDatabaseUpdater interface to follow the IHandler interface. Next, I will need to modify the concrete handlers to use the new interface correctly.</p>
<h4 id="implementing-the-handler"><a class="toclink" href="../../2015/01/16/today-i-learned--the-chain-of-responsibility-design-pattern/#implementing-the-handler">Implementing the Handler</a></h4>
<p>First, we will update our IDatabaseUpdater interface to follow the IHandler look:</p>
<h5 id="before"><a class="toclink" href="../../2015/01/16/today-i-learned--the-chain-of-responsibility-design-pattern/#before">Before</a></h5>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-17-1">1</a></span>
<span class="normal"><a href="#__codelineno-17-2">2</a></span>
<span class="normal"><a href="#__codelineno-17-3">3</a></span>
<span class="normal"><a href="#__codelineno-17-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1"></a><span class="k">public</span><span class="w"> </span><span class="k">interface</span><span class="w"> </span><span class="n">IDatabaseUpdater</span>
<a id="__codelineno-17-2" name="__codelineno-17-2"></a><span class="p">{</span>
<a id="__codelineno-17-3" name="__codelineno-17-3"></a><span class="w">  </span><span class="k">void</span><span class="w"> </span><span class="nf">Update</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">version</span><span class="p">);</span>
<a id="__codelineno-17-4" name="__codelineno-17-4"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h5 id="after"><a class="toclink" href="../../2015/01/16/today-i-learned--the-chain-of-responsibility-design-pattern/#after">After</a></h5>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-18-1">1</a></span>
<span class="normal"><a href="#__codelineno-18-2">2</a></span>
<span class="normal"><a href="#__codelineno-18-3">3</a></span>
<span class="normal"><a href="#__codelineno-18-4">4</a></span>
<span class="normal"><a href="#__codelineno-18-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1"></a><span class="k">public</span><span class="w"> </span><span class="k">interface</span><span class="w"> </span><span class="n">IDatabaseUpdateHandler</span>
<a id="__codelineno-18-2" name="__codelineno-18-2"></a><span class="p">{</span>
<a id="__codelineno-18-3" name="__codelineno-18-3"></a><span class="w">  </span><span class="k">void</span><span class="w"> </span><span class="nf">Update</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">version</span><span class="p">);</span>
<a id="__codelineno-18-4" name="__codelineno-18-4"></a><span class="w">  </span><span class="n">IDatabaseUpdateHandler</span><span class="w"> </span><span class="n">Successor</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-18-5" name="__codelineno-18-5"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h4 id="implementing-the-concrete-handler"><a class="toclink" href="../../2015/01/16/today-i-learned--the-chain-of-responsibility-design-pattern/#implementing-the-concrete-handler">Implementing the Concrete Handler</a></h4>
<p>Second, we will need to update our concrete handlers to implement the interface correctly and to update their UpdateMethod to follow the design. In my case, the concrete handlers perform similar logic, so one of the classes is used for an example.</p>
<h5 id="before_1"><a class="toclink" href="../../2015/01/16/today-i-learned--the-chain-of-responsibility-design-pattern/#before_1">Before</a></h5>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-19-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-19-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-19-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-19-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-19-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-19-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-19-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-19-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-19-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-19-10">10</a></span>
<span class="normal"><a href="#__codelineno-19-11">11</a></span>
<span class="normal"><a href="#__codelineno-19-12">12</a></span>
<span class="normal"><a href="#__codelineno-19-13">13</a></span>
<span class="normal"><a href="#__codelineno-19-14">14</a></span>
<span class="normal"><a href="#__codelineno-19-15">15</a></span>
<span class="normal"><a href="#__codelineno-19-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1"></a><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">Database100To200Updater</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">IDatabaseUpdater</span>
<a id="__codelineno-19-2" name="__codelineno-19-2"></a><span class="p">{</span>
<a id="__codelineno-19-3" name="__codelineno-19-3"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="n">Database200To300Updater</span><span class="w"> </span><span class="n">_successor</span><span class="p">;</span>
<a id="__codelineno-19-4" name="__codelineno-19-4"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="nf">Database100To200Updater</span><span class="p">(</span><span class="n">Database200To300Updater</span><span class="w"> </span><span class="n">successor</span><span class="p">)</span>
<a id="__codelineno-19-5" name="__codelineno-19-5"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-19-6" name="__codelineno-19-6"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">successor</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">null</span><span class="p">)</span>
<a id="__codelineno-19-7" name="__codelineno-19-7"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">ArgumentNullException</span><span class="p">(</span><span class="s">&quot;successor&quot;</span><span class="p">);</span>
<a id="__codelineno-19-8" name="__codelineno-19-8"></a><span class="w">    </span><span class="n">_successor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">successor</span><span class="p">;</span>
<a id="__codelineno-19-9" name="__codelineno-19-9"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-19-10" name="__codelineno-19-10"></a>
<a id="__codelineno-19-11" name="__codelineno-19-11"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">Update</span><span class="p">()</span>
<a id="__codelineno-19-12" name="__codelineno-19-12"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-19-13" name="__codelineno-19-13"></a><span class="w">    </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;Updating the database to version 2.0&quot;</span><span class="p">);</span>
<a id="__codelineno-19-14" name="__codelineno-19-14"></a><span class="w">    </span><span class="n">_successor</span><span class="p">.</span><span class="n">Update</span><span class="p">();</span>
<a id="__codelineno-19-15" name="__codelineno-19-15"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-19-16" name="__codelineno-19-16"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h5 id="after_1"><a class="toclink" href="../../2015/01/16/today-i-learned--the-chain-of-responsibility-design-pattern/#after_1">After</a></h5>
<p>Thanks to the public property, I was able to remove the private member and that in turn allowed me to remove the constructor.
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-20-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-20-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-20-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-20-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-20-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-20-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-20-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-20-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-20-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-20-10">10</a></span>
<span class="normal"><a href="#__codelineno-20-11">11</a></span>
<span class="normal"><a href="#__codelineno-20-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1"></a><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">Database100To200Updater</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">IDatabaseUpdateHandler</span>
<a id="__codelineno-20-2" name="__codelineno-20-2"></a><span class="p">{</span>
<a id="__codelineno-20-3" name="__codelineno-20-3"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">Update</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">version</span><span class="p">)</span>
<a id="__codelineno-20-4" name="__codelineno-20-4"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-20-5" name="__codelineno-20-5"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">version</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-20-6" name="__codelineno-20-6"></a><span class="w">      </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;Updating the database to version 2.0&quot;</span><span class="p">);</span>
<a id="__codelineno-20-7" name="__codelineno-20-7"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Successor</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">null</span><span class="p">)</span>
<a id="__codelineno-20-8" name="__codelineno-20-8"></a><span class="w">      </span><span class="n">Successor</span><span class="p">.</span><span class="n">Update</span><span class="p">(</span><span class="n">version</span><span class="p">);</span>
<a id="__codelineno-20-9" name="__codelineno-20-9"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-20-10" name="__codelineno-20-10"></a>
<a id="__codelineno-20-11" name="__codelineno-20-11"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="n">IDatabaseUpdateHandler</span><span class="w"> </span><span class="n">Successor</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;}</span>
<a id="__codelineno-20-12" name="__codelineno-20-12"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div></p>
<h4 id="updating-the-helper-method"><a class="toclink" href="../../2015/01/16/today-i-learned--the-chain-of-responsibility-design-pattern/#updating-the-helper-method">Updating the Helper Method</a></h4>
<p>Now that we’ve updated the interface and implementors, it’s time to update the helper method to take advantage of the new design.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-21-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-21-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-21-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-21-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-21-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-21-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-21-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-21-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-21-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-21-10">10</a></span>
<span class="normal"><a href="#__codelineno-21-11">11</a></span>
<span class="normal"><a href="#__codelineno-21-12">12</a></span>
<span class="normal"><a href="#__codelineno-21-13">13</a></span>
<span class="normal"><a href="#__codelineno-21-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1"></a><span class="k">public</span><span class="w"> </span><span class="n">IDatabaseUpdateHandler</span><span class="w"> </span><span class="nf">GetDatabaseUpdater</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">version</span><span class="p">)</span>
<a id="__codelineno-21-2" name="__codelineno-21-2"></a><span class="p">{</span>
<a id="__codelineno-21-3" name="__codelineno-21-3"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="n">IsNullOrWhiteSpace</span><span class="p">(</span><span class="n">version</span><span class="p">))</span>
<a id="__codelineno-21-4" name="__codelineno-21-4"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">DatabaseCreator</span><span class="p">();</span>
<a id="__codelineno-21-5" name="__codelineno-21-5"></a>
<a id="__codelineno-21-6" name="__codelineno-21-6"></a><span class="w">  </span><span class="kt">var</span><span class="w"> </span><span class="n">database300To400</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Database300To400Updater</span><span class="p">();</span>
<a id="__codelineno-21-7" name="__codelineno-21-7"></a><span class="w">  </span><span class="kt">var</span><span class="w"> </span><span class="n">database200To300</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Database200To300Updater</span><span class="p">();</span>
<a id="__codelineno-21-8" name="__codelineno-21-8"></a><span class="w">  </span><span class="kt">var</span><span class="w"> </span><span class="n">database100To200</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Database100To200Updater</span><span class="p">();</span>
<a id="__codelineno-21-9" name="__codelineno-21-9"></a>
<a id="__codelineno-21-10" name="__codelineno-21-10"></a><span class="w">  </span><span class="n">database100To200</span><span class="p">.</span><span class="n">Successor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">database200To300</span><span class="p">;</span>
<a id="__codelineno-21-11" name="__codelineno-21-11"></a><span class="w">  </span><span class="n">database200To300</span><span class="p">.</span><span class="n">Successor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">database300To400</span><span class="p">;</span>
<a id="__codelineno-21-12" name="__codelineno-21-12"></a>
<a id="__codelineno-21-13" name="__codelineno-21-13"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">database100To200</span><span class="p">;</span>
<a id="__codelineno-21-14" name="__codelineno-21-14"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h3 id="chain-of-responsibility-is-great-heres-why"><a class="toclink" href="../../2015/01/16/today-i-learned--the-chain-of-responsibility-design-pattern/#chain-of-responsibility-is-great-heres-why">Chain of Responsibility is great, here’s why</a></h3>
<p>What I really like about the chain of responsibility pattern is that I was able to connect my upgrade classes together in a consistent fashion. Another reason why I like this pattern is that it forces me to have the logic to determine whether I should run the update or not inside the individual classes instead of the helper method. This produces more readable code which then lends itself to easier maintainability.</p>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/cameronpresley.png" alt="Cameron Presley">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2014-12-22 00:00:00+00:00">Dec 22, 2014</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../../category/today-i-learned/" class="md-meta__link">Today I Learned</a></li>
        
        
          
          <li class="md-meta__item">
            
              5 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="today-i-learned-how-to-break-down-a-massive-method"><a class="toclink" href="../../2014/12/22/today-i-learned--how-to-break-down-a-massive-method/">Today I Learned – How to Break Down A Massive Method</a></h2>
<p>During this past week, I was working with our intern and showing him some cool debugging tricks when I came across a massive method. I gave him 30 seconds to look at it and tell me what he thought the method was doing. After a while, he was able to figure it out, but the fact that it wasn’t easy discernible was enough to give pause.</p>
<p>The lesson here is that if you can’t determine what the method is doing easily, then it’s probably doing way too much (violating the <a href="../../2013/11/11/beginner-basics-establishing-a-solid-foundation--the-single-responsibility-principle/">Single Responsibility Principle</a>) and needs to be broken into more easily readable pieces.</p>
<p>To demonstrate what I mean, I wrote a program that inserts Messages into a database. A Message contains a description, the number (for identification when troubleshooting) and the module. We would have issues where different messages would have the same number which would cause confusion when troubleshooting errors.</p>
<p>In the program I wrote, the user provides the message and what module the message belongs to and the program automatically generates the message number and inserts the message into the database.</p>
<p>For brevity’s sake, shown below is the logic for determining what the next message number should be.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-3-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-3-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-3-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-3-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-3-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-3-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-3-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-3-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-3-10">10</a></span>
<span class="normal"><a href="#__codelineno-3-11">11</a></span>
<span class="normal"><a href="#__codelineno-3-12">12</a></span>
<span class="normal"><a href="#__codelineno-3-13">13</a></span>
<span class="normal"><a href="#__codelineno-3-14">14</a></span>
<span class="normal"><a href="#__codelineno-3-15">15</a></span>
<span class="normal"><a href="#__codelineno-3-16">16</a></span>
<span class="normal"><a href="#__codelineno-3-17">17</a></span>
<span class="normal"><a href="#__codelineno-3-18">18</a></span>
<span class="normal"><a href="#__codelineno-3-19">19</a></span>
<span class="normal"><a href="#__codelineno-3-20">20</a></span>
<span class="normal"><a href="#__codelineno-3-21">21</a></span>
<span class="normal"><a href="#__codelineno-3-22">22</a></span>
<span class="normal"><a href="#__codelineno-3-23">23</a></span>
<span class="normal"><a href="#__codelineno-3-24">24</a></span>
<span class="normal"><a href="#__codelineno-3-25">25</a></span>
<span class="normal"><a href="#__codelineno-3-26">26</a></span>
<span class="normal"><a href="#__codelineno-3-27">27</a></span>
<span class="normal"><a href="#__codelineno-3-28">28</a></span>
<span class="normal"><a href="#__codelineno-3-29">29</a></span>
<span class="normal"><a href="#__codelineno-3-30">30</a></span>
<span class="normal"><a href="#__codelineno-3-31">31</a></span>
<span class="normal"><a href="#__codelineno-3-32">32</a></span>
<span class="normal"><a href="#__codelineno-3-33">33</a></span>
<span class="normal"><a href="#__codelineno-3-34">34</a></span>
<span class="normal"><a href="#__codelineno-3-35">35</a></span>
<span class="normal"><a href="#__codelineno-3-36">36</a></span>
<span class="normal"><a href="#__codelineno-3-37">37</a></span>
<span class="normal"><a href="#__codelineno-3-38">38</a></span>
<span class="normal"><a href="#__codelineno-3-39">39</a></span>
<span class="normal"><a href="#__codelineno-3-40">40</a></span>
<span class="normal"><a href="#__codelineno-3-41">41</a></span>
<span class="normal"><a href="#__codelineno-3-42">42</a></span>
<span class="normal"><a href="#__codelineno-3-43">43</a></span>
<span class="normal"><a href="#__codelineno-3-44">44</a></span>
<span class="normal"><a href="#__codelineno-3-45">45</a></span>
<span class="normal"><a href="#__codelineno-3-46">46</a></span>
<span class="normal"><a href="#__codelineno-3-47">47</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="k">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">GetNextAlertAndErrorModuleNumber</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">module</span><span class="p">)</span>
<a id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="p">{</span>
<a id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="n">module</span><span class="p">))</span>
<a id="__codelineno-3-4" name="__codelineno-3-4"></a><span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">ArgumentException</span><span class="p">(</span><span class="s">&quot;module cannot be null or empty&quot;</span><span class="p">);</span>
<a id="__codelineno-3-5" name="__codelineno-3-5"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">_connection</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">null</span><span class="p">)</span>
<a id="__codelineno-3-6" name="__codelineno-3-6"></a><span class="w">    </span><span class="n">_connection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CreateConnection</span><span class="p">();</span>
<a id="__codelineno-3-7" name="__codelineno-3-7"></a>
<a id="__codelineno-3-8" name="__codelineno-3-8"></a><span class="w">  </span><span class="kt">var</span><span class="w"> </span><span class="n">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">();</span>
<a id="__codelineno-3-9" name="__codelineno-3-9"></a>
<a id="__codelineno-3-10" name="__codelineno-3-10"></a><span class="w">  </span><span class="n">_connection</span><span class="p">.</span><span class="n">Open</span><span class="p">();</span>
<a id="__codelineno-3-11" name="__codelineno-3-11"></a><span class="w">  </span><span class="kt">var</span><span class="w"> </span><span class="n">cmd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SqlCommand</span><span class="p">(</span><span class="s">&quot;dbo.GetAlertData&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">_connection</span><span class="p">);</span>
<a id="__codelineno-3-12" name="__codelineno-3-12"></a><span class="w">  </span><span class="n">cmd</span><span class="p">.</span><span class="n">CommandType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CommandType</span><span class="p">.</span><span class="n">StoredProcedure</span><span class="p">;</span>
<a id="__codelineno-3-13" name="__codelineno-3-13"></a>
<a id="__codelineno-3-14" name="__codelineno-3-14"></a><span class="w">  </span><span class="kt">var</span><span class="w"> </span><span class="n">reader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cmd</span><span class="p">.</span><span class="n">ExecuteReader</span><span class="p">();</span>
<a id="__codelineno-3-15" name="__codelineno-3-15"></a><span class="w">  </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">reader</span><span class="p">.</span><span class="n">Read</span><span class="p">())</span>
<a id="__codelineno-3-16" name="__codelineno-3-16"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-3-17" name="__codelineno-3-17"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">reader</span><span class="p">[</span><span class="s">&quot;ALERT_ID_NUMBER&quot;</span><span class="p">].</span><span class="n">ToString</span><span class="p">().</span><span class="n">Contains</span><span class="p">(</span><span class="n">module</span><span class="p">))</span>
<a id="__codelineno-3-18" name="__codelineno-3-18"></a><span class="w">      </span><span class="k">continue</span><span class="p">;</span>
<a id="__codelineno-3-19" name="__codelineno-3-19"></a>
<a id="__codelineno-3-20" name="__codelineno-3-20"></a><span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">pieces</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reader</span><span class="p">[</span><span class="s">&quot;ALERT_ID_NUMBER&quot;</span><span class="p">].</span><span class="n">ToString</span><span class="p">().</span><span class="n">Split</span><span class="p">(</span><span class="err">‘</span><span class="w"> </span><span class="err">‘</span><span class="p">);</span>
<a id="__codelineno-3-21" name="__codelineno-3-21"></a>
<a id="__codelineno-3-22" name="__codelineno-3-22"></a><span class="w">    </span><span class="n">results</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">Int32</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="n">pieces</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span>
<a id="__codelineno-3-23" name="__codelineno-3-23"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-3-24" name="__codelineno-3-24"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">reader</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">null</span><span class="p">)</span>
<a id="__codelineno-3-25" name="__codelineno-3-25"></a><span class="w">    </span><span class="n">reader</span><span class="p">.</span><span class="n">Close</span><span class="p">();</span>
<a id="__codelineno-3-26" name="__codelineno-3-26"></a>
<a id="__codelineno-3-27" name="__codelineno-3-27"></a><span class="w">  </span><span class="n">cmd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SqlCommand</span><span class="p">(</span><span class="s">&quot;dbo.GetErrorData&quot;</span><span class="p">;,</span><span class="w"> </span><span class="n">_connection</span><span class="p">);</span>
<a id="__codelineno-3-28" name="__codelineno-3-28"></a><span class="w">  </span><span class="n">cmd</span><span class="p">.</span><span class="n">CommandType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CommandType</span><span class="p">.</span><span class="n">StoredProcedure</span><span class="p">;</span>
<a id="__codelineno-3-29" name="__codelineno-3-29"></a>
<a id="__codelineno-3-30" name="__codelineno-3-30"></a><span class="w">  </span><span class="n">reader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cmd</span><span class="p">.</span><span class="n">ExecuteReader</span><span class="p">();</span>
<a id="__codelineno-3-31" name="__codelineno-3-31"></a><span class="w">  </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">reader</span><span class="p">.</span><span class="n">Read</span><span class="p">())</span>
<a id="__codelineno-3-32" name="__codelineno-3-32"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-3-33" name="__codelineno-3-33"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">reader</span><span class="p">[</span><span class="s">&quot;ERROR_ID_NUMBER&quot;</span><span class="p">].</span><span class="n">ToString</span><span class="p">().</span><span class="n">Contains</span><span class="p">(</span><span class="n">module</span><span class="p">))</span>
<a id="__codelineno-3-34" name="__codelineno-3-34"></a><span class="w">      </span><span class="k">continue</span><span class="p">;</span>
<a id="__codelineno-3-35" name="__codelineno-3-35"></a>
<a id="__codelineno-3-36" name="__codelineno-3-36"></a><span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">pieces</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reader</span><span class="p">[</span><span class="s">&quot;ERROR_ID_NUMBER&quot;</span><span class="p">].</span><span class="n">ToString</span><span class="p">().</span><span class="n">Split</span><span class="p">(</span><span class="err">‘</span><span class="w"> </span><span class="err">‘</span><span class="p">);</span>
<a id="__codelineno-3-37" name="__codelineno-3-37"></a>
<a id="__codelineno-3-38" name="__codelineno-3-38"></a><span class="w">    </span><span class="n">results</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">Int32</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="n">pieces</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span>
<a id="__codelineno-3-39" name="__codelineno-3-39"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-3-40" name="__codelineno-3-40"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">reader</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">null</span><span class="p">)</span>
<a id="__codelineno-3-41" name="__codelineno-3-41"></a><span class="w">    </span><span class="n">reader</span><span class="p">.</span><span class="n">Close</span><span class="p">();</span>
<a id="__codelineno-3-42" name="__codelineno-3-42"></a>
<a id="__codelineno-3-43" name="__codelineno-3-43"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">_connection</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">null</span><span class="p">)</span>
<a id="__codelineno-3-44" name="__codelineno-3-44"></a><span class="w">    </span><span class="n">_connection</span><span class="p">.</span><span class="n">Close</span><span class="p">();</span>
<a id="__codelineno-3-45" name="__codelineno-3-45"></a>
<a id="__codelineno-3-46" name="__codelineno-3-46"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">results</span><span class="p">.</span><span class="n">Max</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<a id="__codelineno-3-47" name="__codelineno-3-47"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>The method itself isn’t complex, just calling some stored procedures, parsing the output and adding the number to a list. However, it’s not abundantly clear what the purpose of the calling the stored procedures.</p>
<p>First, it looks like we’re reading the alerts error numbers from a stored procedure call, why don’t we extract that logic out to a helper method and have the public method call the helper?</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-4-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-4-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-4-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-4-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-4-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-4-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-4-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-4-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-4-10">10</a></span>
<span class="normal"><a href="#__codelineno-4-11">11</a></span>
<span class="normal"><a href="#__codelineno-4-12">12</a></span>
<span class="normal"><a href="#__codelineno-4-13">13</a></span>
<span class="normal"><a href="#__codelineno-4-14">14</a></span>
<span class="normal"><a href="#__codelineno-4-15">15</a></span>
<span class="normal"><a href="#__codelineno-4-16">16</a></span>
<span class="normal"><a href="#__codelineno-4-17">17</a></span>
<span class="normal"><a href="#__codelineno-4-18">18</a></span>
<span class="normal"><a href="#__codelineno-4-19">19</a></span>
<span class="normal"><a href="#__codelineno-4-20">20</a></span>
<span class="normal"><a href="#__codelineno-4-21">21</a></span>
<span class="normal"><a href="#__codelineno-4-22">22</a></span>
<span class="normal"><a href="#__codelineno-4-23">23</a></span>
<span class="normal"><a href="#__codelineno-4-24">24</a></span>
<span class="normal"><a href="#__codelineno-4-25">25</a></span>
<span class="normal"><a href="#__codelineno-4-26">26</a></span>
<span class="normal"><a href="#__codelineno-4-27">27</a></span>
<span class="normal"><a href="#__codelineno-4-28">28</a></span>
<span class="normal"><a href="#__codelineno-4-29">29</a></span>
<span class="normal"><a href="#__codelineno-4-30">30</a></span>
<span class="normal"><a href="#__codelineno-4-31">31</a></span>
<span class="normal"><a href="#__codelineno-4-32">32</a></span>
<span class="normal"><a href="#__codelineno-4-33">33</a></span>
<span class="normal"><a href="#__codelineno-4-34">34</a></span>
<span class="normal"><a href="#__codelineno-4-35">35</a></span>
<span class="normal"><a href="#__codelineno-4-36">36</a></span>
<span class="normal"><a href="#__codelineno-4-37">37</a></span>
<span class="normal"><a href="#__codelineno-4-38">38</a></span>
<span class="normal"><a href="#__codelineno-4-39">39</a></span>
<span class="normal"><a href="#__codelineno-4-40">40</a></span>
<span class="normal"><a href="#__codelineno-4-41">41</a></span>
<span class="normal"><a href="#__codelineno-4-42">42</a></span>
<span class="normal"><a href="#__codelineno-4-43">43</a></span>
<span class="normal"><a href="#__codelineno-4-44">44</a></span>
<span class="normal"><a href="#__codelineno-4-45">45</a></span>
<span class="normal"><a href="#__codelineno-4-46">46</a></span>
<span class="normal"><a href="#__codelineno-4-47">47</a></span>
<span class="normal"><a href="#__codelineno-4-48">48</a></span>
<span class="normal"><a href="#__codelineno-4-49">49</a></span>
<span class="normal"><a href="#__codelineno-4-50">50</a></span>
<span class="normal"><a href="#__codelineno-4-51">51</a></span>
<span class="normal"><a href="#__codelineno-4-52">52</a></span>
<span class="normal"><a href="#__codelineno-4-53">53</a></span>
<span class="normal"><a href="#__codelineno-4-54">54</a></span>
<span class="normal"><a href="#__codelineno-4-55">55</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="k">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">GetNextAlertAndErrorModuleNumber</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">module</span><span class="p">)</span>
<a id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="p">{</span>
<a id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="n">module</span><span class="p">))</span>
<a id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">ArgumentException</span><span class="p">(</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="n">amp</span><span class="p">;</span><span class="n">quot</span><span class="p">;</span><span class="n">module</span><span class="w"> </span><span class="n">cannot</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">empty</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="n">amp</span><span class="p">;</span><span class="n">quot</span><span class="p">;);</span>
<a id="__codelineno-4-5" name="__codelineno-4-5"></a>
<a id="__codelineno-4-6" name="__codelineno-4-6"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">_connection</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">null</span><span class="p">)</span>
<a id="__codelineno-4-7" name="__codelineno-4-7"></a><span class="w">    </span><span class="n">_connection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CreateConnection</span><span class="p">();</span>
<a id="__codelineno-4-8" name="__codelineno-4-8"></a>
<a id="__codelineno-4-9" name="__codelineno-4-9"></a><span class="w">  </span><span class="kt">var</span><span class="w"> </span><span class="n">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">();</span>
<a id="__codelineno-4-10" name="__codelineno-4-10"></a>
<a id="__codelineno-4-11" name="__codelineno-4-11"></a><span class="w">  </span><span class="n">_connection</span><span class="p">.</span><span class="n">Open</span><span class="p">();</span>
<a id="__codelineno-4-12" name="__codelineno-4-12"></a><span class="hll"><span class="w">  </span><span class="n">results</span><span class="p">.</span><span class="n">AddRange</span><span class="p">(</span><span class="n">ReadAlerts</span><span class="p">(</span><span class="n">module</span><span class="p">.</span><span class="n">ToUpper</span><span class="p">()));</span>
</span><a id="__codelineno-4-13" name="__codelineno-4-13"></a>
<a id="__codelineno-4-14" name="__codelineno-4-14"></a><span class="w">  </span><span class="kt">var</span><span class="w"> </span><span class="n">cmd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SqlCommand</span><span class="p">(</span><span class="s">&quot;dbo.GetErrorData&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">_connection</span><span class="p">);</span>
<a id="__codelineno-4-15" name="__codelineno-4-15"></a><span class="w">  </span><span class="n">cmd</span><span class="p">.</span><span class="n">CommandType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CommandType</span><span class="p">.</span><span class="n">StoredProcedure</span><span class="p">;</span>
<a id="__codelineno-4-16" name="__codelineno-4-16"></a>
<a id="__codelineno-4-17" name="__codelineno-4-17"></a><span class="w">  </span><span class="kt">var</span><span class="w"> </span><span class="n">reader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cmd</span><span class="p">.</span><span class="n">ExecuteReader</span><span class="p">();</span>
<a id="__codelineno-4-18" name="__codelineno-4-18"></a><span class="w">  </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">reader</span><span class="p">.</span><span class="n">Read</span><span class="p">())</span>
<a id="__codelineno-4-19" name="__codelineno-4-19"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-4-20" name="__codelineno-4-20"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">reader</span><span class="p">[</span><span class="s">&quot;ERROR_ID_NUMBER&quot;</span><span class="p">].</span><span class="n">ToString</span><span class="p">().</span><span class="n">Contains</span><span class="p">(</span><span class="n">module</span><span class="p">))</span>
<a id="__codelineno-4-21" name="__codelineno-4-21"></a><span class="w">      </span><span class="k">continue</span><span class="p">;</span>
<a id="__codelineno-4-22" name="__codelineno-4-22"></a>
<a id="__codelineno-4-23" name="__codelineno-4-23"></a><span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">pieces</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reader</span><span class="p">[</span><span class="s">&quot;ERROR_ID_NUMBER&amp;&quot;</span><span class="p">].</span><span class="n">ToString</span><span class="p">().</span><span class="n">Split</span><span class="p">(</span><span class="err">‘</span><span class="w"> </span><span class="err">‘</span><span class="p">);</span>
<a id="__codelineno-4-24" name="__codelineno-4-24"></a>
<a id="__codelineno-4-25" name="__codelineno-4-25"></a><span class="w">    </span><span class="n">results</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">Int32</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="n">pieces</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span>
<a id="__codelineno-4-26" name="__codelineno-4-26"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-4-27" name="__codelineno-4-27"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">reader</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">null</span><span class="p">)</span>
<a id="__codelineno-4-28" name="__codelineno-4-28"></a><span class="w">    </span><span class="n">reader</span><span class="p">.</span><span class="n">Close</span><span class="p">();</span>
<a id="__codelineno-4-29" name="__codelineno-4-29"></a>
<a id="__codelineno-4-30" name="__codelineno-4-30"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">_connection</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">null</span><span class="p">)</span>
<a id="__codelineno-4-31" name="__codelineno-4-31"></a><span class="w">    </span><span class="n">_connection</span><span class="p">.</span><span class="n">Close</span><span class="p">();</span>
<a id="__codelineno-4-32" name="__codelineno-4-32"></a>
<a id="__codelineno-4-33" name="__codelineno-4-33"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">results</span><span class="p">.</span><span class="n">Max</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<a id="__codelineno-4-34" name="__codelineno-4-34"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-4-35" name="__codelineno-4-35"></a>
<a id="__codelineno-4-36" name="__codelineno-4-36"></a><span class="hll"><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ReadAlerts</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">module</span><span class="p">)</span>
</span><a id="__codelineno-4-37" name="__codelineno-4-37"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-4-38" name="__codelineno-4-38"></a><span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">();</span>
<a id="__codelineno-4-39" name="__codelineno-4-39"></a><span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">cmd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SqlCommand</span><span class="p">(</span><span class="s">&quot;dbo.GetAlertData&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">_connection</span><span class="p">);</span>
<a id="__codelineno-4-40" name="__codelineno-4-40"></a><span class="w">    </span><span class="n">cmd</span><span class="p">.</span><span class="n">CommandType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CommandType</span><span class="p">.</span><span class="n">StoredProcedure</span><span class="p">;</span>
<a id="__codelineno-4-41" name="__codelineno-4-41"></a>
<a id="__codelineno-4-42" name="__codelineno-4-42"></a><span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">reader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cmd</span><span class="p">.</span><span class="n">ExecuteReader</span><span class="p">();</span>
<a id="__codelineno-4-43" name="__codelineno-4-43"></a><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">reader</span><span class="p">.</span><span class="n">Read</span><span class="p">())</span>
<a id="__codelineno-4-44" name="__codelineno-4-44"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-4-45" name="__codelineno-4-45"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">reader</span><span class="p">[</span><span class="s">&quot;ALERT_ID_NUMBER&quot;</span><span class="p">].</span><span class="n">ToString</span><span class="p">().</span><span class="n">Contains</span><span class="p">(</span><span class="n">module</span><span class="p">))</span>
<a id="__codelineno-4-46" name="__codelineno-4-46"></a><span class="w">        </span><span class="k">continue</span><span class="p">;</span>
<a id="__codelineno-4-47" name="__codelineno-4-47"></a>
<a id="__codelineno-4-48" name="__codelineno-4-48"></a><span class="w">      </span><span class="kt">var</span><span class="w"> </span><span class="n">pieces</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reader</span><span class="p">[</span><span class="s">&quot;ALERT_ID_NUMBER&quot;</span><span class="p">].</span><span class="n">ToString</span><span class="p">().</span><span class="n">Split</span><span class="p">(</span><span class="err">‘</span><span class="w"> </span><span class="err">‘</span><span class="p">);</span>
<a id="__codelineno-4-49" name="__codelineno-4-49"></a><span class="w">      </span><span class="n">results</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">Int32</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="n">pieces</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span>
<a id="__codelineno-4-50" name="__codelineno-4-50"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-4-51" name="__codelineno-4-51"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">reader</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">null</span><span class="p">)</span>
<a id="__codelineno-4-52" name="__codelineno-4-52"></a><span class="w">    </span><span class="n">reader</span><span class="p">.</span><span class="n">Close</span><span class="p">();</span>
<a id="__codelineno-4-53" name="__codelineno-4-53"></a>
<a id="__codelineno-4-54" name="__codelineno-4-54"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">results</span><span class="p">;</span>
<a id="__codelineno-4-55" name="__codelineno-4-55"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>By doing this, we fix two issues at once. First, we’ve given a name to the process of reading the alerts which in turns allows us to quickly understand what the public method should be doing (i.e. improved readability).</p>
<p>Second, it allows us for easier debugging because we now have smaller components. For example, let’s say that we were getting the wrong value. In the first implementation, we would have to put breakpoints in different areas trying to determine which part was broken. However, in the new form, we can check to see if ReadAlerts is behaving correctly. If it isn’t, we now know the bug has to be in that method, otherwise, it’s in the rest.</p>
<p>For the next step, you may have noticed that we can repeat the same refactoring trick again, except this time, we can extract the logic for reading the errors into a helper method.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-5-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-5-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-5-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-5-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-5-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-5-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-5-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-5-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-5-10">10</a></span>
<span class="normal"><a href="#__codelineno-5-11">11</a></span>
<span class="normal"><a href="#__codelineno-5-12">12</a></span>
<span class="normal"><a href="#__codelineno-5-13">13</a></span>
<span class="normal"><a href="#__codelineno-5-14">14</a></span>
<span class="normal"><a href="#__codelineno-5-15">15</a></span>
<span class="normal"><a href="#__codelineno-5-16">16</a></span>
<span class="normal"><a href="#__codelineno-5-17">17</a></span>
<span class="normal"><a href="#__codelineno-5-18">18</a></span>
<span class="normal"><a href="#__codelineno-5-19">19</a></span>
<span class="normal"><a href="#__codelineno-5-20">20</a></span>
<span class="normal"><a href="#__codelineno-5-21">21</a></span>
<span class="normal"><a href="#__codelineno-5-22">22</a></span>
<span class="normal"><a href="#__codelineno-5-23">23</a></span>
<span class="normal"><a href="#__codelineno-5-24">24</a></span>
<span class="normal"><a href="#__codelineno-5-25">25</a></span>
<span class="normal"><a href="#__codelineno-5-26">26</a></span>
<span class="normal"><a href="#__codelineno-5-27">27</a></span>
<span class="normal"><a href="#__codelineno-5-28">28</a></span>
<span class="normal"><a href="#__codelineno-5-29">29</a></span>
<span class="normal"><a href="#__codelineno-5-30">30</a></span>
<span class="normal"><a href="#__codelineno-5-31">31</a></span>
<span class="normal"><a href="#__codelineno-5-32">32</a></span>
<span class="normal"><a href="#__codelineno-5-33">33</a></span>
<span class="normal"><a href="#__codelineno-5-34">34</a></span>
<span class="normal"><a href="#__codelineno-5-35">35</a></span>
<span class="normal"><a href="#__codelineno-5-36">36</a></span>
<span class="normal"><a href="#__codelineno-5-37">37</a></span>
<span class="normal"><a href="#__codelineno-5-38">38</a></span>
<span class="normal"><a href="#__codelineno-5-39">39</a></span>
<span class="normal"><a href="#__codelineno-5-40">40</a></span>
<span class="normal"><a href="#__codelineno-5-41">41</a></span>
<span class="normal"><a href="#__codelineno-5-42">42</a></span>
<span class="normal"><a href="#__codelineno-5-43">43</a></span>
<span class="normal"><a href="#__codelineno-5-44">44</a></span>
<span class="normal"><a href="#__codelineno-5-45">45</a></span>
<span class="normal"><a href="#__codelineno-5-46">46</a></span>
<span class="normal"><a href="#__codelineno-5-47">47</a></span>
<span class="normal"><a href="#__codelineno-5-48">48</a></span>
<span class="normal"><a href="#__codelineno-5-49">49</a></span>
<span class="normal"><a href="#__codelineno-5-50">50</a></span>
<span class="normal"><a href="#__codelineno-5-51">51</a></span>
<span class="normal"><a href="#__codelineno-5-52">52</a></span>
<span class="normal"><a href="#__codelineno-5-53">53</a></span>
<span class="normal"><a href="#__codelineno-5-54">54</a></span>
<span class="normal"><a href="#__codelineno-5-55">55</a></span>
<span class="normal"><a href="#__codelineno-5-56">56</a></span>
<span class="normal"><a href="#__codelineno-5-57">57</a></span>
<span class="normal"><a href="#__codelineno-5-58">58</a></span>
<span class="normal"><a href="#__codelineno-5-59">59</a></span>
<span class="normal"><a href="#__codelineno-5-60">60</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="k">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">GetNextAlertAndErrorModuleNumber</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">module</span><span class="p">)</span>
<a id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="p">{</span>
<a id="__codelineno-5-3" name="__codelineno-5-3"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="n">module</span><span class="p">))</span>
<a id="__codelineno-5-4" name="__codelineno-5-4"></a><span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">ArgumentException</span><span class="p">(</span><span class="s">&quot;module cannot be null or empty&quot;</span><span class="p">);</span>
<a id="__codelineno-5-5" name="__codelineno-5-5"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">_connection</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">null</span><span class="p">)</span>
<a id="__codelineno-5-6" name="__codelineno-5-6"></a><span class="w">    </span><span class="n">_connection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CreateConnection</span><span class="p">();</span>
<a id="__codelineno-5-7" name="__codelineno-5-7"></a>
<a id="__codelineno-5-8" name="__codelineno-5-8"></a><span class="w">  </span><span class="n">_connection</span><span class="p">.</span><span class="n">Open</span><span class="p">();</span>
<a id="__codelineno-5-9" name="__codelineno-5-9"></a>
<a id="__codelineno-5-10" name="__codelineno-5-10"></a><span class="w">  </span><span class="kt">var</span><span class="w"> </span><span class="n">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">();</span>
<a id="__codelineno-5-11" name="__codelineno-5-11"></a><span class="hll"><span class="w">  </span><span class="n">results</span><span class="p">.</span><span class="n">AddRange</span><span class="p">(</span><span class="n">ReadAlerts</span><span class="p">(</span><span class="n">module</span><span class="p">.</span><span class="n">ToUpper</span><span class="p">()));</span>
</span><a id="__codelineno-5-12" name="__codelineno-5-12"></a><span class="hll"><span class="w">  </span><span class="n">results</span><span class="p">.</span><span class="n">AddRange</span><span class="p">(</span><span class="n">ReadErrors</span><span class="p">(</span><span class="n">module</span><span class="p">.</span><span class="n">ToUpper</span><span class="p">()));</span>
</span><a id="__codelineno-5-13" name="__codelineno-5-13"></a>
<a id="__codelineno-5-14" name="__codelineno-5-14"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">_connection</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">null</span><span class="p">)</span>
<a id="__codelineno-5-15" name="__codelineno-5-15"></a><span class="w">    </span><span class="n">_connection</span><span class="p">.</span><span class="n">Close</span><span class="p">();</span>
<a id="__codelineno-5-16" name="__codelineno-5-16"></a>
<a id="__codelineno-5-17" name="__codelineno-5-17"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">results</span><span class="p">.</span><span class="n">Max</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<a id="__codelineno-5-18" name="__codelineno-5-18"></a><span class="p">}</span>
<a id="__codelineno-5-19" name="__codelineno-5-19"></a>
<a id="__codelineno-5-20" name="__codelineno-5-20"></a><span class="k">private</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ReadAlerts</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">module</span><span class="p">)</span>
<a id="__codelineno-5-21" name="__codelineno-5-21"></a><span class="p">{</span>
<a id="__codelineno-5-22" name="__codelineno-5-22"></a><span class="w">  </span><span class="kt">var</span><span class="w"> </span><span class="n">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">();</span>
<a id="__codelineno-5-23" name="__codelineno-5-23"></a><span class="w">  </span><span class="kt">var</span><span class="w"> </span><span class="n">cmd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SqlCommand</span><span class="p">(</span><span class="s">&quot;dbo.GetAlertData&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">_connection</span><span class="p">);</span>
<a id="__codelineno-5-24" name="__codelineno-5-24"></a><span class="w">  </span><span class="n">cmd</span><span class="p">.</span><span class="n">CommandType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CommandType</span><span class="p">.</span><span class="n">StoredProcedure</span><span class="p">;</span>
<a id="__codelineno-5-25" name="__codelineno-5-25"></a>
<a id="__codelineno-5-26" name="__codelineno-5-26"></a><span class="w">  </span><span class="kt">var</span><span class="w"> </span><span class="n">reader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cmd</span><span class="p">.</span><span class="n">ExecuteReader</span><span class="p">();</span>
<a id="__codelineno-5-27" name="__codelineno-5-27"></a><span class="w">  </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">reader</span><span class="p">.</span><span class="n">Read</span><span class="p">())</span>
<a id="__codelineno-5-28" name="__codelineno-5-28"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-5-29" name="__codelineno-5-29"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">reader</span><span class="p">[</span><span class="s">&quot;ALERT_ID_NUMBER&quot;</span><span class="p">].</span><span class="n">ToString</span><span class="p">().</span><span class="n">Contains</span><span class="p">(</span><span class="n">module</span><span class="p">))</span>
<a id="__codelineno-5-30" name="__codelineno-5-30"></a><span class="w">      </span><span class="k">continue</span><span class="p">;</span>
<a id="__codelineno-5-31" name="__codelineno-5-31"></a>
<a id="__codelineno-5-32" name="__codelineno-5-32"></a><span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">pieces</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reader</span><span class="p">[</span><span class="s">&quot;ALERT_ID_NUMBER&quot;</span><span class="p">].</span><span class="n">ToString</span><span class="p">().</span><span class="n">Split</span><span class="p">(</span><span class="err">‘</span><span class="w"> </span><span class="err">‘</span><span class="p">);</span>
<a id="__codelineno-5-33" name="__codelineno-5-33"></a><span class="w">    </span><span class="n">results</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">Int32</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="n">pieces</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span>
<a id="__codelineno-5-34" name="__codelineno-5-34"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-5-35" name="__codelineno-5-35"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">reader</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">null</span><span class="p">)</span>
<a id="__codelineno-5-36" name="__codelineno-5-36"></a><span class="w">    </span><span class="n">reader</span><span class="p">.</span><span class="n">Close</span><span class="p">();</span>
<a id="__codelineno-5-37" name="__codelineno-5-37"></a>
<a id="__codelineno-5-38" name="__codelineno-5-38"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">results</span><span class="p">;</span>
<a id="__codelineno-5-39" name="__codelineno-5-39"></a><span class="p">}</span>
<a id="__codelineno-5-40" name="__codelineno-5-40"></a>
<a id="__codelineno-5-41" name="__codelineno-5-41"></a><span class="k">private</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ReadErrors</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">module</span><span class="p">)</span>
<a id="__codelineno-5-42" name="__codelineno-5-42"></a><span class="p">{</span>
<a id="__codelineno-5-43" name="__codelineno-5-43"></a><span class="w">  </span><span class="kt">var</span><span class="w"> </span><span class="n">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">();</span>
<a id="__codelineno-5-44" name="__codelineno-5-44"></a><span class="w">  </span><span class="kt">var</span><span class="w"> </span><span class="n">cmd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SqlCommand</span><span class="p">(</span><span class="s">&quot;dbo.GetErrorData&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">_connection</span><span class="p">);</span>
<a id="__codelineno-5-45" name="__codelineno-5-45"></a><span class="w">  </span><span class="n">cmd</span><span class="p">.</span><span class="n">CommandType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CommandType</span><span class="p">.</span><span class="n">StoredProcedure</span><span class="p">;</span>
<a id="__codelineno-5-46" name="__codelineno-5-46"></a>
<a id="__codelineno-5-47" name="__codelineno-5-47"></a><span class="w">  </span><span class="kt">var</span><span class="w"> </span><span class="n">reader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cmd</span><span class="p">.</span><span class="n">ExecuteReader</span><span class="p">();</span>
<a id="__codelineno-5-48" name="__codelineno-5-48"></a><span class="w">  </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">reader</span><span class="p">.</span><span class="n">Read</span><span class="p">())</span>
<a id="__codelineno-5-49" name="__codelineno-5-49"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-5-50" name="__codelineno-5-50"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">reader</span><span class="p">[</span><span class="s">&quot;ERROR_ID_NUMBER&quot;</span><span class="p">].</span><span class="n">ToString</span><span class="p">().</span><span class="n">Contains</span><span class="p">(</span><span class="n">module</span><span class="p">))</span>
<a id="__codelineno-5-51" name="__codelineno-5-51"></a><span class="w">      </span><span class="k">continue</span><span class="p">;</span>
<a id="__codelineno-5-52" name="__codelineno-5-52"></a>
<a id="__codelineno-5-53" name="__codelineno-5-53"></a><span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">pieces</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reader</span><span class="p">[</span><span class="s">&quot;ERROR_ID_NUMBER&quot;</span><span class="p">].</span><span class="n">ToString</span><span class="p">().</span><span class="n">Split</span><span class="p">(</span><span class="err">‘</span><span class="w"> </span><span class="err">‘</span><span class="p">);</span>
<a id="__codelineno-5-54" name="__codelineno-5-54"></a><span class="w">    </span><span class="n">results</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">Int32</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="n">pieces</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span>
<a id="__codelineno-5-55" name="__codelineno-5-55"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-5-56" name="__codelineno-5-56"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">reader</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">null</span><span class="p">)</span>
<a id="__codelineno-5-57" name="__codelineno-5-57"></a><span class="w">    </span><span class="n">reader</span><span class="p">.</span><span class="n">Close</span><span class="p">();</span>
<a id="__codelineno-5-58" name="__codelineno-5-58"></a>
<a id="__codelineno-5-59" name="__codelineno-5-59"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">results</span><span class="p">;</span>
<a id="__codelineno-5-60" name="__codelineno-5-60"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>After the changes, anyone who looks at the public API can easily see that it’s reading from both Alerts and Errors. This is really powerful because now you can communicate with non-technical people about requirements and what the code is doing.</p>
<p>Let’s say that in the future, the requirements change and this conversation plays out:</p>
<blockquote>
<p>Alice (QA, finding an error) – Hey Bob, I was running one of our test plans and it looks like that we’re getting the wrong message number if we’re trying to add a new message and there are warning messages in the database. We are including the warning table when figuring that out, right?</p>
<p>Bob (Engineer, finding the root cause) – Hey you’re right, it looks like we’re only using the alerts and error tables when calculating the next number. Why don’t we write up a ticket for that and get a fix in?</p>
</blockquote>
<p>The key point is that no matter how large a method is, there always have to be steps being performed in some order (by definition of an algorithm) and this is the key to refactoring larger methods into more maintainable pieces of code. The trick is determining what those steps are and making decisions on whether to make helper methods or helper classes.</p>
<p>If those steps become complicated, then they should be broken out into helper methods. As time progresses and those helper methods start to become more complicated, then those helper methods should in turn become classes of their own.</p>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/cameronpresley.png" alt="Cameron Presley">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2014-12-11 00:00:00+00:00">Dec 11, 2014</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../../category/today-i-learned/" class="md-meta__link">Today I Learned</a></li>
        
        
          
          <li class="md-meta__item">
            
              2 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="today-i-learned-the-law-of-demeter"><a class="toclink" href="../../2014/12/11/today-i-learned-the-law-of-demeter/">Today I Learned: The Law of Demeter</a></h2>
<p>Don’t pass in more information that you need. It sounds simple, but when working with messy legacy code, it’s easy to forget.</p>
<p>The impetus for this post came from a peer code review. During the review, I found this method:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1">1</a></span>
<span class="normal"><a href="#__codelineno-4-2">2</a></span>
<span class="normal"><a href="#__codelineno-4-3">3</a></span>
<span class="normal"><a href="#__codelineno-4-4">4</a></span>
<span class="normal"><a href="#__codelineno-4-5">5</a></span>
<span class="normal"><a href="#__codelineno-4-6">6</a></span>
<span class="normal"><a href="#__codelineno-4-7">7</a></span>
<span class="normal"><a href="#__codelineno-4-8">8</a></span>
<span class="normal"><a href="#__codelineno-4-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="k">public</span><span class="w"> </span><span class="n">IStrategy</span><span class="w"> </span><span class="nf">GetStrategy</span><span class="p">(</span><span class="n">Project</span><span class="w"> </span><span class="n">project</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">isAffected</span><span class="p">)</span>
<a id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="p">{</span>
<a id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="w">  </span><span class="kt">var</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">project</span><span class="p">.</span><span class="n">Type</span><span class="p">;</span>
<a id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ProjectType</span><span class="p">.</span><span class="n">A</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">isAffected</span><span class="p">)</span>
<a id="__codelineno-4-5" name="__codelineno-4-5"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">ProjectAIsAffectedStrategy</span><span class="p">();</span>
<a id="__codelineno-4-6" name="__codelineno-4-6"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ProjectType</span><span class="p">.</span><span class="n">B</span><span class="p">)</span>
<a id="__codelineno-4-7" name="__codelineno-4-7"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">ProjectBStrategy</span><span class="p">();</span>
<a id="__codelineno-4-8" name="__codelineno-4-8"></a><span class="w">  </span><span class="c1">// Similar if statements</span>
<a id="__codelineno-4-9" name="__codelineno-4-9"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>At first glance, it looks pretty good. Logic was sound and it seemed to be returning a class implementing an interface similar to what we would expect for the Factory pattern. However, there’s a slight problem, can you spot it?</p>
<p>The issue is with the first parameter, Project. The method takes a Project, however, we’re only really depending on the Project’s Type property.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1">1</a></span>
<span class="normal"><a href="#__codelineno-5-2">2</a></span>
<span class="normal"><a href="#__codelineno-5-3">3</a></span>
<span class="normal"><a href="#__codelineno-5-4">4</a></span>
<span class="normal"><a href="#__codelineno-5-5">5</a></span>
<span class="normal"><a href="#__codelineno-5-6">6</a></span>
<span class="normal"><a href="#__codelineno-5-7">7</a></span>
<span class="normal"><a href="#__codelineno-5-8">8</a></span>
<span class="normal"><a href="#__codelineno-5-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="k">public</span><span class="w"> </span><span class="n">IStrategy</span><span class="w"> </span><span class="nf">GetStrategy</span><span class="p">(</span><span class="n">Project</span><span class="w"> </span><span class="n">project</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">isAffected</span><span class="p">)</span>
<a id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="p">{</span>
<a id="__codelineno-5-3" name="__codelineno-5-3"></a><span class="hll"><span class="w">  </span><span class="kt">var</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">project</span><span class="p">.</span><span class="n">Type</span><span class="p">;</span>
</span><a id="__codelineno-5-4" name="__codelineno-5-4"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ProjectType</span><span class="p">.</span><span class="n">A</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">isAffected</span><span class="p">)</span>
<a id="__codelineno-5-5" name="__codelineno-5-5"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">ProjectAIsAffectedStrategy</span><span class="p">();</span>
<a id="__codelineno-5-6" name="__codelineno-5-6"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ProjectType</span><span class="p">.</span><span class="n">B</span><span class="p">)</span>
<a id="__codelineno-5-7" name="__codelineno-5-7"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">ProjectBStrategy</span><span class="p">();</span>
<a id="__codelineno-5-8" name="__codelineno-5-8"></a><span class="w">  </span><span class="c1">// Similar if statements</span>
<a id="__codelineno-5-9" name="__codelineno-5-9"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>So why don’t we get rid of the dependency on the Project and instead replace it with the dependency on the ProjectType instead?</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1">1</a></span>
<span class="normal"><a href="#__codelineno-6-2">2</a></span>
<span class="normal"><a href="#__codelineno-6-3">3</a></span>
<span class="normal"><a href="#__codelineno-6-4">4</a></span>
<span class="normal"><a href="#__codelineno-6-5">5</a></span>
<span class="normal"><a href="#__codelineno-6-6">6</a></span>
<span class="normal"><a href="#__codelineno-6-7">7</a></span>
<span class="normal"><a href="#__codelineno-6-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="hll"><span class="k">public</span><span class="w"> </span><span class="n">IStrategy</span><span class="w"> </span><span class="nf">GetStrategy</span><span class="p">(</span><span class="n">ProjectType</span><span class="w"> </span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">isAffected</span><span class="p">)</span>
</span><a id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="p">{</span>
<a id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ProjectType</span><span class="p">.</span><span class="n">A</span><span class="w"> </span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="w"> </span><span class="n">isAffected</span><span class="p">)</span>
<a id="__codelineno-6-4" name="__codelineno-6-4"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">ProjectAIsAffectedStrategy</span><span class="p">();</span>
<a id="__codelineno-6-5" name="__codelineno-6-5"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ProjectType</span><span class="p">.</span><span class="n">B</span><span class="p">)</span>
<a id="__codelineno-6-6" name="__codelineno-6-6"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">ProjectBStrategy</span><span class="p">();</span>
<a id="__codelineno-6-7" name="__codelineno-6-7"></a><span class="w">  </span><span class="c1">// Similar if statements</span>
<a id="__codelineno-6-8" name="__codelineno-6-8"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Instinctual, I knew this was the right call, but I couldn’t remember why I knew it was a good choice. After some digging, I remembered that this is a <a href="http://en.wikipedia.org/wiki/Law_of_Demeter">Law of Demeter</a> violation, or better known as the Principle of Least Knowledge violation.</p>
<p>In general, this principle states that a method should have the least amount of information it needs to do it’s job. Other classic violations of this principle is when you use a class’s internals internals. For example,</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="n">SomeClassA</span><span class="p">.</span><span class="n">SomePropertyB</span><span class="p">.</span><span class="n">WithSomeMethodC</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<p>One of the reasons that I really like the Law of Demeter is that if you follow it, you create easier to test methods. Don’t believe me? Which is easier to create, the Project class (which may have many dependencies that would need to be stubbed) or the ProjectType enum (which by definition has zero dependencies)?</p>
<p>Another reason that following the Law of Demeter is good practice is that it forces your code to be explicit about what dependencies are required. For example, in the first implementation, the caller knew that the method needed a Project, but had no clue on how much of the Project it needed (does it need all of the properties set? Does it need further setup besides basic instantiation?). However, with the refactored version, now it’s much clearer that the method has a looser dependency on not Project, but just the ProjectType.</p>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/cameronpresley.png" alt="Cameron Presley">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2014-01-07 00:00:00+00:00">Jan 7, 2014</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../../category/basics/" class="md-meta__link">Basics</a>, 
              <a href="../../category/solid/" class="md-meta__link">SOLID</a></li>
        
        
          
          <li class="md-meta__item">
            
              5 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="beginner-basics-establishing-a-solid-foundation-the-dependency-inversion-principle"><a class="toclink" href="../../2014/01/07/beginner-basics-establishing-a-solid-foundation--the-dependency-inversion-principle/">Beginner Basics: Establishing a SOLID Foundation – The Dependency Inversion Principle</a></h2>
<p>Welcome to the final installment of Establishing a SOLID Foundation series. In this post, we’ll be exploring the fifth part of SOLID, the Dependency Inversion Principle.</p>
<h3 id="what-is-the-dependency-inversion-principle"><a class="toclink" href="../../2014/01/07/beginner-basics-establishing-a-solid-foundation--the-dependency-inversion-principle/#what-is-the-dependency-inversion-principle">What is the Dependency Inversion Principle?</a></h3>
<p>When working with object-oriented languages, we take large problems and break them down into smaller pieces. These smaller pieces in turn are broken down into even smaller, more manageable pieces to work on. As part of the breaking down process, we inherently have to introduce dependencies between the larger pieces and the smaller pieces.</p>
<p>How we weave these dependencies together is the difference between easily changing behavior and spending the next week pulling your hair out.</p>
<p>When working with classes, dependencies are usually introduced by constructing them in the class that they’re used in. For example, let’s say that we’ve been asked to write an utility that emulates an calculator but it also keeps a transaction log for record keeping purposes.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-21-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-21-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-21-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-21-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-21-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-21-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-21-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-21-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-21-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-21-10">10</a></span>
<span class="normal"><a href="#__codelineno-21-11">11</a></span>
<span class="normal"><a href="#__codelineno-21-12">12</a></span>
<span class="normal"><a href="#__codelineno-21-13">13</a></span>
<span class="normal"><a href="#__codelineno-21-14">14</a></span>
<span class="normal"><a href="#__codelineno-21-15">15</a></span>
<span class="normal"><a href="#__codelineno-21-16">16</a></span>
<span class="normal"><a href="#__codelineno-21-17">17</a></span>
<span class="normal"><a href="#__codelineno-21-18">18</a></span>
<span class="normal"><a href="#__codelineno-21-19">19</a></span>
<span class="normal"><a href="#__codelineno-21-20">20</a></span>
<span class="normal"><a href="#__codelineno-21-21">21</a></span>
<span class="normal"><a href="#__codelineno-21-22">22</a></span>
<span class="normal"><a href="#__codelineno-21-23">23</a></span>
<span class="normal"><a href="#__codelineno-21-24">24</a></span>
<span class="normal"><a href="#__codelineno-21-25">25</a></span>
<span class="normal"><a href="#__codelineno-21-26">26</a></span>
<span class="normal"><a href="#__codelineno-21-27">27</a></span>
<span class="normal"><a href="#__codelineno-21-28">28</a></span>
<span class="normal"><a href="#__codelineno-21-29">29</a></span>
<span class="normal"><a href="#__codelineno-21-30">30</a></span>
<span class="normal"><a href="#__codelineno-21-31">31</a></span>
<span class="normal"><a href="#__codelineno-21-32">32</a></span>
<span class="normal"><a href="#__codelineno-21-33">33</a></span>
<span class="normal"><a href="#__codelineno-21-34">34</a></span>
<span class="normal"><a href="#__codelineno-21-35">35</a></span>
<span class="normal"><a href="#__codelineno-21-36">36</a></span>
<span class="normal"><a href="#__codelineno-21-37">37</a></span>
<span class="normal"><a href="#__codelineno-21-38">38</a></span>
<span class="normal"><a href="#__codelineno-21-39">39</a></span>
<span class="normal"><a href="#__codelineno-21-40">40</a></span>
<span class="normal"><a href="#__codelineno-21-41">41</a></span>
<span class="normal"><a href="#__codelineno-21-42">42</a></span>
<span class="normal"><a href="#__codelineno-21-43">43</a></span>
<span class="normal"><a href="#__codelineno-21-44">44</a></span>
<span class="normal"><a href="#__codelineno-21-45">45</a></span>
<span class="normal"><a href="#__codelineno-21-46">46</a></span>
<span class="normal"><a href="#__codelineno-21-47">47</a></span>
<span class="normal"><a href="#__codelineno-21-48">48</a></span>
<span class="normal"><a href="#__codelineno-21-49">49</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">Logger</span>
<a id="__codelineno-21-2" name="__codelineno-21-2"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">log</span><span class="w"> </span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
<a id="__codelineno-21-3" name="__codelineno-21-3"></a><span class="w">    </span><span class="no">File</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">temp</span><span class="se">\\</span><span class="s2">results.txt&quot;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="o">|</span><span class="n">f</span><span class="o">|</span><span class="w"> </span><span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">content</span><span class="p">)}</span>
<a id="__codelineno-21-4" name="__codelineno-21-4"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-21-5" name="__codelineno-21-5"></a><span class="k">end</span>
<a id="__codelineno-21-6" name="__codelineno-21-6"></a>
<a id="__codelineno-21-7" name="__codelineno-21-7"></a><span class="k">class</span><span class="w"> </span><span class="nc">Calculator</span>
<a id="__codelineno-21-8" name="__codelineno-21-8"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">initialize</span>
<a id="__codelineno-21-9" name="__codelineno-21-9"></a><span class="w">      </span><span class="vi">@logger</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">Logger</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
<a id="__codelineno-21-10" name="__codelineno-21-10"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-21-11" name="__codelineno-21-11"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">)</span>
<a id="__codelineno-21-12" name="__codelineno-21-12"></a><span class="w">      </span><span class="n">log</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;+&quot;</span><span class="p">)</span>
<a id="__codelineno-21-13" name="__codelineno-21-13"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span>
<a id="__codelineno-21-14" name="__codelineno-21-14"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-21-15" name="__codelineno-21-15"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">sub</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">)</span>
<a id="__codelineno-21-16" name="__codelineno-21-16"></a><span class="w">      </span><span class="n">log</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;-&quot;</span><span class="p">)</span>
<a id="__codelineno-21-17" name="__codelineno-21-17"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">b</span>
<a id="__codelineno-21-18" name="__codelineno-21-18"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-21-19" name="__codelineno-21-19"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">mult</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">)</span>
<a id="__codelineno-21-20" name="__codelineno-21-20"></a><span class="w">      </span><span class="n">log</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="s2">&quot;*&quot;</span><span class="p">)</span>
<a id="__codelineno-21-21" name="__codelineno-21-21"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">b</span>
<a id="__codelineno-21-22" name="__codelineno-21-22"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-21-23" name="__codelineno-21-23"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">div</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">)</span>
<a id="__codelineno-21-24" name="__codelineno-21-24"></a><span class="w">      </span><span class="n">log</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
<a id="__codelineno-21-25" name="__codelineno-21-25"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">a</span><span class="o">.</span><span class="n">to_f</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">b</span>
<a id="__codelineno-21-26" name="__codelineno-21-26"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-21-27" name="__codelineno-21-27"></a>
<a id="__codelineno-21-28" name="__codelineno-21-28"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">log</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">sym</span><span class="p">)</span>
<a id="__codelineno-21-29" name="__codelineno-21-29"></a><span class="w">      </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="o">.</span><span class="n">to_s</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sym</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="o">.</span><span class="n">to_s</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot; = &quot;</span>
<a id="__codelineno-21-30" name="__codelineno-21-30"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="n">sym</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;+&quot;</span>
<a id="__codelineno-21-31" name="__codelineno-21-31"></a><span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">to_s</span>
<a id="__codelineno-21-32" name="__codelineno-21-32"></a><span class="w">      </span><span class="k">elsif</span><span class="w"> </span><span class="n">sym</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;-&quot;</span>
<a id="__codelineno-21-33" name="__codelineno-21-33"></a><span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">to_s</span>
<a id="__codelineno-21-34" name="__codelineno-21-34"></a><span class="w">      </span><span class="k">elsif</span><span class="w"> </span><span class="n">sym</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;*&quot;</span>
<a id="__codelineno-21-35" name="__codelineno-21-35"></a><span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">to_s</span>
<a id="__codelineno-21-36" name="__codelineno-21-36"></a><span class="w">      </span><span class="k">else</span>
<a id="__codelineno-21-37" name="__codelineno-21-37"></a><span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">to_f</span><span class="o">/</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">to_s</span>
<a id="__codelineno-21-38" name="__codelineno-21-38"></a><span class="w">      </span><span class="k">end</span>
<a id="__codelineno-21-39" name="__codelineno-21-39"></a><span class="w">      </span><span class="n">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-21-40" name="__codelineno-21-40"></a><span class="w">      </span><span class="vi">@logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<a id="__codelineno-21-41" name="__codelineno-21-41"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-21-42" name="__codelineno-21-42"></a><span class="k">end</span>
<a id="__codelineno-21-43" name="__codelineno-21-43"></a>
<a id="__codelineno-21-44" name="__codelineno-21-44"></a><span class="c1"># Usage</span>
<a id="__codelineno-21-45" name="__codelineno-21-45"></a><span class="n">calc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">Calculator</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
<a id="__codelineno-21-46" name="__codelineno-21-46"></a><span class="nb">puts</span><span class="w"> </span><span class="n">calc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-21-47" name="__codelineno-21-47"></a><span class="nb">puts</span><span class="w"> </span><span class="n">calc</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-21-48" name="__codelineno-21-48"></a><span class="nb">puts</span><span class="w"> </span><span class="n">calc</span><span class="o">.</span><span class="n">mult</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-21-49" name="__codelineno-21-49"></a><span class="nb">puts</span><span class="w"> </span><span class="n">calc</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>So far so good, we have two classes (Logger and Calculator) that is responsible for logging and the calculations. Even though this is a small amount of code (~50 lines for both classes), there are three dependencies in the code. The first dependency that I notice is that Calculator depends on Logger. We can see this by looking at the initialize method for Calculator (as hinted above):</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-22-1">1</a></span>
<span class="normal"><a href="#__codelineno-22-2">2</a></span>
<span class="normal"><a href="#__codelineno-22-3">3</a></span>
<span class="normal"><a href="#__codelineno-22-4">4</a></span>
<span class="normal"><a href="#__codelineno-22-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">Calculator</span>
<a id="__codelineno-22-2" name="__codelineno-22-2"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">initialize</span>
<a id="__codelineno-22-3" name="__codelineno-22-3"></a><span class="w">    </span><span class="vi">@logger</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">Logger</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">temp</span><span class="se">\\</span><span class="s2">results.txt&quot;</span><span class="p">)</span>
<a id="__codelineno-22-4" name="__codelineno-22-4"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-22-5" name="__codelineno-22-5"></a><span class="k">end</span>
</code></pre></div></td></tr></table></div>
<p>The second dependency is a bit trickier to find, but in the Logger class’ log method, we use a hard coded file path.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-23-1">1</a></span>
<span class="normal"><a href="#__codelineno-23-2">2</a></span>
<span class="normal"><a href="#__codelineno-23-3">3</a></span>
<span class="normal"><a href="#__codelineno-23-4">4</a></span>
<span class="normal"><a href="#__codelineno-23-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">Logger</span>
<a id="__codelineno-23-2" name="__codelineno-23-2"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">log</span><span class="w"> </span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
<a id="__codelineno-23-3" name="__codelineno-23-3"></a><span class="w">      </span><span class="no">File</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">temp</span><span class="se">\\</span><span class="s2">results.txt&quot;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="o">|</span><span class="n">f</span><span class="o">|</span><span class="w"> </span><span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">content</span><span class="p">)}</span>
<a id="__codelineno-23-4" name="__codelineno-23-4"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-23-5" name="__codelineno-23-5"></a><span class="k">end</span>
</code></pre></div></td></tr></table></div>
<p>The third dependency is probably the hardest to find, but in the the Logger class’ log method, we are also depending on the file system for the machine by using Ruby’s File class. <em>But wait a minute</em>, I hear you say, <em>why is the File class considered a dependency, that’s a part of the Ruby language?</em> I agree with you, but it’s still a dependency in the code and something that we should keep in mind.</p>
<p>From these three dependencies, we’re going to focus on resolving the first two. We could make resolve the dependency on the file system, but it would take so much effort for so little gain.</p>
<h3 id="why-dont-we-resolve-the-file-dependency-issue"><a class="toclink" href="../../2014/01/07/beginner-basics-establishing-a-solid-foundation--the-dependency-inversion-principle/#why-dont-we-resolve-the-file-dependency-issue">Why don’t we resolve the file dependency issue?</a></h3>
<p>One thing that I keep in mind when identifying which dependencies to invert is to focus on inverting dependencies outside of the framework. In this case, we’re going to ignore the file system dependency because I, the programmer, depend on Ruby to behave correctly. If Ruby stops working, then a broken file system is the least of my worries. Therefore, it’s not worth the effort to resolve.</p>
<h4 id="making-the-calculator-and-logger-more-flexible"><a class="toclink" href="../../2014/01/07/beginner-basics-establishing-a-solid-foundation--the-dependency-inversion-principle/#making-the-calculator-and-logger-more-flexible">Making the Calculator and Logger more flexible</a></h4>
<p>In order to resolve these DIP violations, we need to expose ways to drop in these dependencies. There are two ways of doing this. We can either:</p>
<ul>
<li>Expose the dependency via the constructor</li>
<li>Expose the dependency via a public property</li>
</ul>
<p>Using the Calculator example, we can expose the logger dependency via the constructor and we can expose the filePath dependency by exposing it as a property.</p>
<p>For the Calculator class, I’m going to first change the initialize method so that it takes a logger instead of constructing it’s own.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-24-1">1</a></span>
<span class="normal"><a href="#__codelineno-24-2">2</a></span>
<span class="normal"><a href="#__codelineno-24-3">3</a></span>
<span class="normal"><a href="#__codelineno-24-4">4</a></span>
<span class="normal"><a href="#__codelineno-24-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">Calculator</span>
<a id="__codelineno-24-2" name="__codelineno-24-2"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">initialize</span><span class="p">(</span><span class="n">logger</span><span class="p">)</span>
<a id="__codelineno-24-3" name="__codelineno-24-3"></a><span class="w">    </span><span class="vi">@logger</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">logger</span>
<a id="__codelineno-24-4" name="__codelineno-24-4"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-24-5" name="__codelineno-24-5"></a><span class="k">end</span>
</code></pre></div></td></tr></table></div>
<p>Next, I will construct the logger in the usage and pass the logger as part of the constructor.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-25-1">1</a></span>
<span class="normal"><a href="#__codelineno-25-2">2</a></span>
<span class="normal"><a href="#__codelineno-25-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1"></a><span class="c1"># Usage</span>
<a id="__codelineno-25-2" name="__codelineno-25-2"></a><span class="n">logger</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">Logger</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
<a id="__codelineno-25-3" name="__codelineno-25-3"></a><span class="n">calc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">Calculator</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">logger</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>A quick run of our program tells us that everything is still working correctly.</p>
<p>Now that we’ve finished up exposing the logger dependency, it’s time to expose the file path. First, I’m going to add a public property on the Logger class call filePath and use that property in the log method</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-26-1">1</a></span>
<span class="normal"><a href="#__codelineno-26-2">2</a></span>
<span class="normal"><a href="#__codelineno-26-3">3</a></span>
<span class="normal"><a href="#__codelineno-26-4">4</a></span>
<span class="normal"><a href="#__codelineno-26-5">5</a></span>
<span class="normal"><a href="#__codelineno-26-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">Logger</span>
<a id="__codelineno-26-2" name="__codelineno-26-2"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">log</span><span class="w"> </span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
<a id="__codelineno-26-3" name="__codelineno-26-3"></a><span class="w">      </span><span class="no">File</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="o">|</span><span class="n">f</span><span class="o">|</span><span class="w"> </span><span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">content</span><span class="p">)}</span>
<a id="__codelineno-26-4" name="__codelineno-26-4"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-26-5" name="__codelineno-26-5"></a><span class="w">  </span><span class="kp">attr_accessor</span><span class="w"> </span><span class="ss">:filePath</span>
<a id="__codelineno-26-6" name="__codelineno-26-6"></a><span class="k">end</span>
</code></pre></div></td></tr></table></div>
<p>Now that we’ve introduced a seam for the file path dependency, we use that seam in the program and assign the property```ruby</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-27-1">1</a></span>
<span class="normal"><a href="#__codelineno-27-2">2</a></span>
<span class="normal"><a href="#__codelineno-27-3">3</a></span>
<span class="normal"><a href="#__codelineno-27-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1"></a><span class="c1"># Usage</span>
<a id="__codelineno-27-2" name="__codelineno-27-2"></a><span class="n">logger</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">Logger</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
<a id="__codelineno-27-3" name="__codelineno-27-3"></a><span class="n">logger</span><span class="o">.</span><span class="n">filePath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">temp</span><span class="se">\\</span><span class="s2">results.txt&quot;</span>
<a id="__codelineno-27-4" name="__codelineno-27-4"></a><span class="n">calc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">Calculator</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">logger</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h3 id="multiple-ways-of-solving-the-issue-which-one-is-best"><a class="toclink" href="../../2014/01/07/beginner-basics-establishing-a-solid-foundation--the-dependency-inversion-principle/#multiple-ways-of-solving-the-issue-which-one-is-best">Multiple ways of solving the issue, which one is best?</a></h3>
<p>When using the constructor method, it’s very clear to see what dependencies the class has, just look at the constructor. However, adding a new dependency to the constructor may cause other code to fail because the signature of the constructor has changed. This in turn can lead to cascading changes where multiple places of code need to be updated to pass in the dependency.</p>
<p>On the other hand, using the property method, the change is less invasive because the property can be set independently of the when the object was constructed. However, it’s harder to see the dependencies for the class because now the properties are containing the dependencies. Also, it’s very easy to forget to set a property before using the object.</p>
<p>Both of these methods are valid, but when I’m working with DIP, I prefer to expose the dependencies via the constructor because if my class starts to gain more and more dependencies, then it’s a sign that my class is doing too much and violating the Single Responsibility Principle (SRP). You can say that DIP is the canary in the coal mine for SRP.</p>
<h3 id="tldr"><a class="toclink" href="../../2014/01/07/beginner-basics-establishing-a-solid-foundation--the-dependency-inversion-principle/#tldr">TL;DR</a></h3>
<p>In summary, the Dependency Inversion Principle (DIP) tells us that we should we should have the outside world pass in our dependencies. If we don’t follow this rule, then we will not. In order to resolve violations, we need to determine what dependencies we have and modify our constructor to accept those dependencies. If our constructor becomes too large, then our class might be violating the Single Responsibility Principle. By following the DIP, we expose the dependencies our classes require and allows for greater decoupling. As always, don’t forget to refactor as you go along.</p>
<h3 id="establishing-a-solid-foundation-series"><a class="toclink" href="../../2014/01/07/beginner-basics-establishing-a-solid-foundation--the-dependency-inversion-principle/#establishing-a-solid-foundation-series">Establishing a SOLID Foundation Series</a></h3>
<ul>
<li><a href="../../2013/11/04/establish-solid-intro/">Introduction</a></li>
<li><a href="../../2013/11/11/beginner-basics-establishing-a-solid-foundation--the-single-responsibility-principle/">The Single Responsibility Principle (SRP)</a></li>
<li><a href="../../2013/11/18/beginner-basics-establishing-a-solid-foundation---the-openclosed-principle/">The Open/Closed Principle (OCP)</a></li>
<li><a href="../../2013/11/29/beginner-basics-establishing-a-solid-foundation--the-liskov-substitution-principle/">The Liskov Substitution Principle (LSP)</a></li>
<li><a href="../../2013/12/12/beginner-basics-establishing-a-solid-foundation--the-interface-segregation-principle/">The Interface Segregation Principle (ISP)</a></li>
<li><a href="../../2014/01/07/beginner-basics-establishing-a-solid-foundation--the-dependency-inversion-principle/">The Dependency Inversion Principle (DIP)</a></li>
</ul>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/cameronpresley.png" alt="Cameron Presley">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2013-12-12 00:00:00+00:00">Dec 12, 2013</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../../category/basics/" class="md-meta__link">Basics</a>, 
              <a href="../../category/solid/" class="md-meta__link">SOLID</a></li>
        
        
          
          <li class="md-meta__item">
            
              4 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="beginner-basics-establishing-a-solid-foundation-the-interface-segregation-principle"><a class="toclink" href="../../2013/12/12/beginner-basics-establishing-a-solid-foundation--the-interface-segregation-principle/">Beginner Basics: Establishing a SOLID Foundation – The Interface Segregation Principle</a></h2>
<p>Welcome to the fourth installment of Establishing a SOLID Foundation series. In this post, we’ll be exploring the fourth part of SOLID, the Interface Segregation Principle and how by following this principle, you will write more robust code.</p>
<h3 id="what-is-the-interface-segregation-principle"><a class="toclink" href="../../2013/12/12/beginner-basics-establishing-a-solid-foundation--the-interface-segregation-principle/#what-is-the-interface-segregation-principle">What is the Interface Segregation Principle?</a></h3>
<p>The Interface Segregation Principle (ISP) tell us that clients should not be forced to use an interface that defines methods that it does not use. But what does this mean? Let’s say that we have the following ContactManager class and a ContactFinder class.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-15-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-15-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-15-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-15-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-15-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-15-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-15-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-15-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-15-10">10</a></span>
<span class="normal"><a href="#__codelineno-15-11">11</a></span>
<span class="normal"><a href="#__codelineno-15-12">12</a></span>
<span class="normal"><a href="#__codelineno-15-13">13</a></span>
<span class="normal"><a href="#__codelineno-15-14">14</a></span>
<span class="normal"><a href="#__codelineno-15-15">15</a></span>
<span class="normal"><a href="#__codelineno-15-16">16</a></span>
<span class="normal"><a href="#__codelineno-15-17">17</a></span>
<span class="normal"><a href="#__codelineno-15-18">18</a></span>
<span class="normal"><a href="#__codelineno-15-19">19</a></span>
<span class="normal"><a href="#__codelineno-15-20">20</a></span>
<span class="normal"><a href="#__codelineno-15-21">21</a></span>
<span class="normal"><a href="#__codelineno-15-22">22</a></span>
<span class="normal"><a href="#__codelineno-15-23">23</a></span>
<span class="normal"><a href="#__codelineno-15-24">24</a></span>
<span class="normal"><a href="#__codelineno-15-25">25</a></span>
<span class="normal"><a href="#__codelineno-15-26">26</a></span>
<span class="normal"><a href="#__codelineno-15-27">27</a></span>
<span class="normal"><a href="#__codelineno-15-28">28</a></span>
<span class="normal"><a href="#__codelineno-15-29">29</a></span>
<span class="normal"><a href="#__codelineno-15-30">30</a></span>
<span class="normal"><a href="#__codelineno-15-31">31</a></span>
<span class="normal"><a href="#__codelineno-15-32">32</a></span>
<span class="normal"><a href="#__codelineno-15-33">33</a></span>
<span class="normal"><a href="#__codelineno-15-34">34</a></span>
<span class="normal"><a href="#__codelineno-15-35">35</a></span>
<span class="normal"><a href="#__codelineno-15-36">36</a></span>
<span class="normal"><a href="#__codelineno-15-37">37</a></span>
<span class="normal"><a href="#__codelineno-15-38">38</a></span>
<span class="normal"><a href="#__codelineno-15-39">39</a></span>
<span class="normal"><a href="#__codelineno-15-40">40</a></span>
<span class="normal"><a href="#__codelineno-15-41">41</a></span>
<span class="normal"><a href="#__codelineno-15-42">42</a></span>
<span class="normal"><a href="#__codelineno-15-43">43</a></span>
<span class="normal"><a href="#__codelineno-15-44">44</a></span>
<span class="normal"><a href="#__codelineno-15-45">45</a></span>
<span class="normal"><a href="#__codelineno-15-46">46</a></span>
<span class="normal"><a href="#__codelineno-15-47">47</a></span>
<span class="normal"><a href="#__codelineno-15-48">48</a></span>
<span class="normal"><a href="#__codelineno-15-49">49</a></span>
<span class="normal"><a href="#__codelineno-15-50">50</a></span>
<span class="normal"><a href="#__codelineno-15-51">51</a></span>
<span class="normal"><a href="#__codelineno-15-52">52</a></span>
<span class="normal"><a href="#__codelineno-15-53">53</a></span>
<span class="normal"><a href="#__codelineno-15-54">54</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">ContactManager</span>
<a id="__codelineno-15-2" name="__codelineno-15-2"></a><span class="p">{</span>
<a id="__codelineno-15-3" name="__codelineno-15-3"></a><span class="w">     </span><span class="k">private</span><span class="w"> </span><span class="n">List</span><span class="w"> </span><span class="n">_names</span><span class="p">;</span>
<a id="__codelineno-15-4" name="__codelineno-15-4"></a>
<a id="__codelineno-15-5" name="__codelineno-15-5"></a><span class="w">     </span><span class="k">public</span><span class="w"> </span><span class="nf">ContactManager</span><span class="p">()</span>
<a id="__codelineno-15-6" name="__codelineno-15-6"></a><span class="w">     </span><span class="p">{</span>
<a id="__codelineno-15-7" name="__codelineno-15-7"></a><span class="w">          </span><span class="n">_names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">List</span><span class="p">();</span>
<a id="__codelineno-15-8" name="__codelineno-15-8"></a><span class="w">          </span><span class="n">_names</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s">&quot;Cameron&quot;</span><span class="p">);</span>
<a id="__codelineno-15-9" name="__codelineno-15-9"></a><span class="w">          </span><span class="n">_names</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s">&quot;Geoff&quot;</span><span class="p">);</span>
<a id="__codelineno-15-10" name="__codelineno-15-10"></a><span class="w">          </span><span class="n">_names</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s">&quot;Phillip&quot;</span><span class="p">);</span>
<a id="__codelineno-15-11" name="__codelineno-15-11"></a><span class="w">     </span><span class="p">}</span>
<a id="__codelineno-15-12" name="__codelineno-15-12"></a>
<a id="__codelineno-15-13" name="__codelineno-15-13"></a><span class="w">     </span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">PrintNames</span><span class="p">()</span>
<a id="__codelineno-15-14" name="__codelineno-15-14"></a><span class="w">     </span><span class="p">{</span>
<a id="__codelineno-15-15" name="__codelineno-15-15"></a><span class="w">          </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="kt">var</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">_names</span><span class="p">)</span>
<a id="__codelineno-15-16" name="__codelineno-15-16"></a><span class="w">              </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<a id="__codelineno-15-17" name="__codelineno-15-17"></a><span class="w">     </span><span class="p">}</span>
<a id="__codelineno-15-18" name="__codelineno-15-18"></a>
<a id="__codelineno-15-19" name="__codelineno-15-19"></a><span class="w">     </span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">SetNames</span><span class="p">(</span><span class="n">List</span><span class="w"> </span><span class="n">names</span><span class="p">)</span>
<a id="__codelineno-15-20" name="__codelineno-15-20"></a><span class="w">     </span><span class="p">{</span>
<a id="__codelineno-15-21" name="__codelineno-15-21"></a><span class="w">          </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="kt">var</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">names</span><span class="p">)</span>
<a id="__codelineno-15-22" name="__codelineno-15-22"></a><span class="w">               </span><span class="n">_names</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<a id="__codelineno-15-23" name="__codelineno-15-23"></a><span class="w">     </span><span class="p">}</span>
<a id="__codelineno-15-24" name="__codelineno-15-24"></a>
<a id="__codelineno-15-25" name="__codelineno-15-25"></a><span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="nf">DoesNameExist</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-15-26" name="__codelineno-15-26"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-15-27" name="__codelineno-15-27"></a><span class="w">         </span><span class="kt">var</span><span class="w"> </span><span class="n">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_names</span><span class="p">.</span><span class="n">IndexOf</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<a id="__codelineno-15-28" name="__codelineno-15-28"></a><span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">results</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-15-29" name="__codelineno-15-29"></a><span class="w">              </span><span class="k">return</span><span class="w"> </span><span class="k">true</span><span class="p">;</span>
<a id="__codelineno-15-30" name="__codelineno-15-30"></a>
<a id="__codelineno-15-31" name="__codelineno-15-31"></a><span class="w">         </span><span class="k">return</span><span class="w"> </span><span class="k">false</span><span class="p">;</span>
<a id="__codelineno-15-32" name="__codelineno-15-32"></a><span class="w">     </span><span class="p">}</span>
<a id="__codelineno-15-33" name="__codelineno-15-33"></a><span class="p">}</span>
<a id="__codelineno-15-34" name="__codelineno-15-34"></a>
<a id="__codelineno-15-35" name="__codelineno-15-35"></a><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">ContactFinder</span>
<a id="__codelineno-15-36" name="__codelineno-15-36"></a><span class="p">{</span>
<a id="__codelineno-15-37" name="__codelineno-15-37"></a><span class="w">     </span><span class="k">private</span><span class="w"> </span><span class="n">ContactManager</span><span class="w"> </span><span class="n">_manager</span><span class="p">;</span>
<a id="__codelineno-15-38" name="__codelineno-15-38"></a>
<a id="__codelineno-15-39" name="__codelineno-15-39"></a><span class="w">     </span><span class="k">public</span><span class="w"> </span><span class="nf">ContactFinder</span><span class="p">(</span><span class="n">ContactManager</span><span class="w"> </span><span class="n">manager</span><span class="p">)</span>
<a id="__codelineno-15-40" name="__codelineno-15-40"></a><span class="w">     </span><span class="p">{</span>
<a id="__codelineno-15-41" name="__codelineno-15-41"></a><span class="w">         </span><span class="n">_manager</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">manager</span><span class="p">;</span>
<a id="__codelineno-15-42" name="__codelineno-15-42"></a><span class="w">     </span><span class="p">}</span>
<a id="__codelineno-15-43" name="__codelineno-15-43"></a>
<a id="__codelineno-15-44" name="__codelineno-15-44"></a><span class="w">     </span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">FindContacts</span><span class="p">(</span><span class="n">List</span><span class="w"> </span><span class="n">names</span><span class="p">)</span>
<a id="__codelineno-15-45" name="__codelineno-15-45"></a><span class="w">     </span><span class="p">{</span>
<a id="__codelineno-15-46" name="__codelineno-15-46"></a><span class="w">          </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="kt">var</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">names</span><span class="p">)</span>
<a id="__codelineno-15-47" name="__codelineno-15-47"></a><span class="w">          </span><span class="p">{</span>
<a id="__codelineno-15-48" name="__codelineno-15-48"></a><span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">_manager</span><span class="p">.</span><span class="n">DoesNameExist</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
<a id="__codelineno-15-49" name="__codelineno-15-49"></a><span class="w">                    </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;Found &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">name</span><span class="p">);</span>
<a id="__codelineno-15-50" name="__codelineno-15-50"></a><span class="w">               </span><span class="k">else</span>
<a id="__codelineno-15-51" name="__codelineno-15-51"></a><span class="w">                    </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;Couldn&#39;t find &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">name</span><span class="p">);</span>
<a id="__codelineno-15-52" name="__codelineno-15-52"></a><span class="w">          </span><span class="p">}</span>
<a id="__codelineno-15-53" name="__codelineno-15-53"></a><span class="w">      </span><span class="p">}</span>
<a id="__codelineno-15-54" name="__codelineno-15-54"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>So far, so good, the ContactManager is responsible for holding onto the list of names and some basic methods and the ContactFinder is responsible for determining which contacts are in our list.</p>
<p>However, there is a problem with this example code. We have this ContactManager class that has a lot methods defined, but the only method that’s required is the DoesNameExist method.</p>
<p>Another concept ISP tells in a roundabout fashion is that objects should depend on interfaces, not concrete classes. This allows us to switch out dependencies much easier when we code to the interface.</p>
<h3 id="whats-the-big-deal-i-dont-see-what-the-issue-is"><a class="toclink" href="../../2013/12/12/beginner-basics-establishing-a-solid-foundation--the-interface-segregation-principle/#whats-the-big-deal-i-dont-see-what-the-issue-is">What’s the big deal, I don’t see what the issue is</a></h3>
<p>The big issue that comes up is that it’s hard to figure out what methods that the ContactFinder actually needs. We say that it needs a ContactManager which would lead us to assume that it needs all of those methods. However, that’s not the case. So by violating ISP, it’s easy to make the wrong design decision.</p>
<p>Another issue arises when it comes to creating the interface for the dependency. If we assume that all methods for the ContactManager is required, then any class that implements that interface has to also implement those unneeded methods. How many times have you seen an object implement an interface with a lot of methods that did nothing or just threw exceptions?</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-16-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-16-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-16-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-16-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-16-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-16-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-16-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-16-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-16-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-16-10">10</a></span>
<span class="normal"><a href="#__codelineno-16-11">11</a></span>
<span class="normal"><a href="#__codelineno-16-12">12</a></span>
<span class="normal"><a href="#__codelineno-16-13">13</a></span>
<span class="normal"><a href="#__codelineno-16-14">14</a></span>
<span class="normal"><a href="#__codelineno-16-15">15</a></span>
<span class="normal"><a href="#__codelineno-16-16">16</a></span>
<span class="normal"><a href="#__codelineno-16-17">17</a></span>
<span class="normal"><a href="#__codelineno-16-18">18</a></span>
<span class="normal"><a href="#__codelineno-16-19">19</a></span>
<span class="normal"><a href="#__codelineno-16-20">20</a></span>
<span class="normal"><a href="#__codelineno-16-21">21</a></span>
<span class="normal"><a href="#__codelineno-16-22">22</a></span>
<span class="normal"><a href="#__codelineno-16-23">23</a></span>
<span class="normal"><a href="#__codelineno-16-24">24</a></span>
<span class="normal"><a href="#__codelineno-16-25">25</a></span>
<span class="normal"><a href="#__codelineno-16-26">26</a></span>
<span class="normal"><a href="#__codelineno-16-27">27</a></span>
<span class="normal"><a href="#__codelineno-16-28">28</a></span>
<span class="normal"><a href="#__codelineno-16-29">29</a></span>
<span class="normal"><a href="#__codelineno-16-30">30</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1"></a><span class="k">public</span><span class="w"> </span><span class="k">interface</span><span class="w"> </span><span class="n">BloatedInterface</span>
<a id="__codelineno-16-2" name="__codelineno-16-2"></a><span class="p">{</span>
<a id="__codelineno-16-3" name="__codelineno-16-3"></a><span class="w">     </span><span class="k">void</span><span class="w"> </span><span class="nf">SetContent</span><span class="p">();</span>
<a id="__codelineno-16-4" name="__codelineno-16-4"></a><span class="w">     </span><span class="kt">bool</span><span class="w"> </span><span class="nf">IsContentSet</span><span class="p">();</span>
<a id="__codelineno-16-5" name="__codelineno-16-5"></a><span class="w">     </span><span class="k">void</span><span class="w"> </span><span class="nf">RemoveContent</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">content</span><span class="p">);</span>
<a id="__codelineno-16-6" name="__codelineno-16-6"></a><span class="w">     </span><span class="k">void</span><span class="w"> </span><span class="nf">AddContent</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">content</span><span class="p">);</span>
<a id="__codelineno-16-7" name="__codelineno-16-7"></a><span class="w">     </span><span class="k">void</span><span class="w"> </span><span class="nf">ImportantMethod</span><span class="p">();</span>
<a id="__codelineno-16-8" name="__codelineno-16-8"></a><span class="p">}</span>
<a id="__codelineno-16-9" name="__codelineno-16-9"></a>
<a id="__codelineno-16-10" name="__codelineno-16-10"></a><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">BloatedObject</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">BloatedInterface</span>
<a id="__codelineno-16-11" name="__codelineno-16-11"></a><span class="p">{</span>
<a id="__codelineno-16-12" name="__codelineno-16-12"></a><span class="w">     </span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">SetContent</span><span class="p">()</span>
<a id="__codelineno-16-13" name="__codelineno-16-13"></a><span class="w">     </span><span class="p">{</span>
<a id="__codelineno-16-14" name="__codelineno-16-14"></a><span class="w">     </span><span class="p">}</span>
<a id="__codelineno-16-15" name="__codelineno-16-15"></a><span class="w">     </span><span class="k">public</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="nf">IsContentSet</span><span class="p">()</span>
<a id="__codelineno-16-16" name="__codelineno-16-16"></a><span class="w">     </span><span class="p">{</span>
<a id="__codelineno-16-17" name="__codelineno-16-17"></a><span class="w">          </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">NotImplementedException</span><span class="p">();</span>
<a id="__codelineno-16-18" name="__codelineno-16-18"></a><span class="w">     </span><span class="p">}</span>
<a id="__codelineno-16-19" name="__codelineno-16-19"></a><span class="w">     </span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">RemoveContent</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">content</span><span class="p">)</span>
<a id="__codelineno-16-20" name="__codelineno-16-20"></a><span class="w">     </span><span class="p">{</span>
<a id="__codelineno-16-21" name="__codelineno-16-21"></a><span class="w">          </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">NotImplementedException</span><span class="p">();</span>
<a id="__codelineno-16-22" name="__codelineno-16-22"></a><span class="w">     </span><span class="p">}</span>
<a id="__codelineno-16-23" name="__codelineno-16-23"></a><span class="w">     </span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">AddContent</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">content</span><span class="p">)</span>
<a id="__codelineno-16-24" name="__codelineno-16-24"></a><span class="w">     </span><span class="p">{</span>
<a id="__codelineno-16-25" name="__codelineno-16-25"></a><span class="w">          </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">NotImplementedException</span><span class="p">();</span>
<a id="__codelineno-16-26" name="__codelineno-16-26"></a><span class="w">     </span><span class="p">}</span>
<a id="__codelineno-16-27" name="__codelineno-16-27"></a><span class="w">     </span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">ImportantMethod</span><span class="p">()</span>
<a id="__codelineno-16-28" name="__codelineno-16-28"></a><span class="w">     </span><span class="p">{</span>
<a id="__codelineno-16-29" name="__codelineno-16-29"></a><span class="w">     </span><span class="p">}</span>
<a id="__codelineno-16-30" name="__codelineno-16-30"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h3 id="fixing-the-issue"><a class="toclink" href="../../2013/12/12/beginner-basics-establishing-a-solid-foundation--the-interface-segregation-principle/#fixing-the-issue">Fixing the issue</a></h3>
<p><em>Alright, alright</em>, I hear you say, <em>you’ve convinced me, how do I fix this problem?</em> The steps are simple:</p>
<ol>
<li>First, you need to identify which methods the client needs</li>
<li>Next, you need to create an interface that contains the methods that the client uses</li>
<li>After creating the interface, have the dependency implement the interface</li>
<li>Finally, change the signature client so that it uses the interface instead of the concrete class</li>
</ol>
<p>Using our code base, first, we look at the ContactFinder class and see what methods from ContactManager that it uses.</p>
<p>So far, it looks like it only needs the DoesNameExist method. So let’s create an interface, called IContactSearcher that contains the single method.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-17-1">1</a></span>
<span class="normal"><a href="#__codelineno-17-2">2</a></span>
<span class="normal"><a href="#__codelineno-17-3">3</a></span>
<span class="normal"><a href="#__codelineno-17-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1"></a><span class="k">public</span><span class="w"> </span><span class="k">interface</span><span class="w"> </span><span class="n">IContactSearcher</span>
<a id="__codelineno-17-2" name="__codelineno-17-2"></a><span class="p">{</span>
<a id="__codelineno-17-3" name="__codelineno-17-3"></a><span class="w">     </span><span class="kt">bool</span><span class="w"> </span><span class="nf">DoesNameExist</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">name</span><span class="p">);</span>
<a id="__codelineno-17-4" name="__codelineno-17-4"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Now that we’ve extracted the interface, it’s time to have the ContactManager class implement the interface:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-18-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-18-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-18-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-18-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-18-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-18-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-18-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-18-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-18-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-18-10">10</a></span>
<span class="normal"><a href="#__codelineno-18-11">11</a></span>
<span class="normal"><a href="#__codelineno-18-12">12</a></span>
<span class="normal"><a href="#__codelineno-18-13">13</a></span>
<span class="normal"><a href="#__codelineno-18-14">14</a></span>
<span class="normal"><a href="#__codelineno-18-15">15</a></span>
<span class="normal"><a href="#__codelineno-18-16">16</a></span>
<span class="normal"><a href="#__codelineno-18-17">17</a></span>
<span class="normal"><a href="#__codelineno-18-18">18</a></span>
<span class="normal"><a href="#__codelineno-18-19">19</a></span>
<span class="normal"><a href="#__codelineno-18-20">20</a></span>
<span class="normal"><a href="#__codelineno-18-21">21</a></span>
<span class="normal"><a href="#__codelineno-18-22">22</a></span>
<span class="normal"><a href="#__codelineno-18-23">23</a></span>
<span class="normal"><a href="#__codelineno-18-24">24</a></span>
<span class="normal"><a href="#__codelineno-18-25">25</a></span>
<span class="normal"><a href="#__codelineno-18-26">26</a></span>
<span class="normal"><a href="#__codelineno-18-27">27</a></span>
<span class="normal"><a href="#__codelineno-18-28">28</a></span>
<span class="normal"><a href="#__codelineno-18-29">29</a></span>
<span class="normal"><a href="#__codelineno-18-30">30</a></span>
<span class="normal"><a href="#__codelineno-18-31">31</a></span>
<span class="normal"><a href="#__codelineno-18-32">32</a></span>
<span class="normal"><a href="#__codelineno-18-33">33</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1"></a><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">ContactManager</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">IContactSearcher</span>
<a id="__codelineno-18-2" name="__codelineno-18-2"></a><span class="p">{</span>
<a id="__codelineno-18-3" name="__codelineno-18-3"></a><span class="w">     </span><span class="k">private</span><span class="w"> </span><span class="n">List</span><span class="w"> </span><span class="n">_names</span><span class="p">;</span>
<a id="__codelineno-18-4" name="__codelineno-18-4"></a>
<a id="__codelineno-18-5" name="__codelineno-18-5"></a><span class="w">     </span><span class="k">public</span><span class="w"> </span><span class="nf">ContactManager</span><span class="p">()</span>
<a id="__codelineno-18-6" name="__codelineno-18-6"></a><span class="w">     </span><span class="p">{</span>
<a id="__codelineno-18-7" name="__codelineno-18-7"></a><span class="w">          </span><span class="n">_names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">List</span><span class="p">();</span>
<a id="__codelineno-18-8" name="__codelineno-18-8"></a><span class="w">          </span><span class="n">_names</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s">&quot;Cameron&quot;</span><span class="p">);</span>
<a id="__codelineno-18-9" name="__codelineno-18-9"></a><span class="w">          </span><span class="n">_names</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s">&quot;Geoff&quot;</span><span class="p">);</span>
<a id="__codelineno-18-10" name="__codelineno-18-10"></a><span class="w">          </span><span class="n">_names</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s">&quot;Phillip&quot;</span><span class="p">);</span>
<a id="__codelineno-18-11" name="__codelineno-18-11"></a><span class="w">     </span><span class="p">}</span>
<a id="__codelineno-18-12" name="__codelineno-18-12"></a>
<a id="__codelineno-18-13" name="__codelineno-18-13"></a><span class="w">     </span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">PrintNames</span><span class="p">()</span>
<a id="__codelineno-18-14" name="__codelineno-18-14"></a><span class="w">     </span><span class="p">{</span>
<a id="__codelineno-18-15" name="__codelineno-18-15"></a><span class="w">          </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="kt">var</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">_names</span><span class="p">)</span>
<a id="__codelineno-18-16" name="__codelineno-18-16"></a><span class="w">          </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<a id="__codelineno-18-17" name="__codelineno-18-17"></a><span class="w">     </span><span class="p">}</span>
<a id="__codelineno-18-18" name="__codelineno-18-18"></a>
<a id="__codelineno-18-19" name="__codelineno-18-19"></a><span class="w">     </span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">SetNames</span><span class="p">(</span><span class="n">List</span><span class="w"> </span><span class="n">names</span><span class="p">)</span>
<a id="__codelineno-18-20" name="__codelineno-18-20"></a><span class="w">     </span><span class="p">{</span>
<a id="__codelineno-18-21" name="__codelineno-18-21"></a><span class="w">          </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="kt">var</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">names</span><span class="p">)</span>
<a id="__codelineno-18-22" name="__codelineno-18-22"></a><span class="w">               </span><span class="n">_names</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<a id="__codelineno-18-23" name="__codelineno-18-23"></a><span class="w">     </span><span class="p">}</span>
<a id="__codelineno-18-24" name="__codelineno-18-24"></a>
<a id="__codelineno-18-25" name="__codelineno-18-25"></a><span class="w">     </span><span class="k">public</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="nf">DoesNameExist</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-18-26" name="__codelineno-18-26"></a><span class="w">     </span><span class="p">{</span>
<a id="__codelineno-18-27" name="__codelineno-18-27"></a><span class="w">          </span><span class="kt">var</span><span class="w"> </span><span class="n">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_names</span><span class="p">.</span><span class="n">IndexOf</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<a id="__codelineno-18-28" name="__codelineno-18-28"></a><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">results</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-18-29" name="__codelineno-18-29"></a><span class="w">               </span><span class="k">return</span><span class="w"> </span><span class="k">true</span><span class="p">;</span>
<a id="__codelineno-18-30" name="__codelineno-18-30"></a>
<a id="__codelineno-18-31" name="__codelineno-18-31"></a><span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="k">false</span><span class="p">;</span>
<a id="__codelineno-18-32" name="__codelineno-18-32"></a><span class="w">     </span><span class="p">}</span>
<a id="__codelineno-18-33" name="__codelineno-18-33"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Finally, we update the references in ContactFinder to use the IContactSearcher interface instead of the concrete class ContactManager.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-19-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-19-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-19-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-19-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-19-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-19-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-19-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-19-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-19-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-19-10">10</a></span>
<span class="normal"><a href="#__codelineno-19-11">11</a></span>
<span class="normal"><a href="#__codelineno-19-12">12</a></span>
<span class="normal"><a href="#__codelineno-19-13">13</a></span>
<span class="normal"><a href="#__codelineno-19-14">14</a></span>
<span class="normal"><a href="#__codelineno-19-15">15</a></span>
<span class="normal"><a href="#__codelineno-19-16">16</a></span>
<span class="normal"><a href="#__codelineno-19-17">17</a></span>
<span class="normal"><a href="#__codelineno-19-18">18</a></span>
<span class="normal"><a href="#__codelineno-19-19">19</a></span>
<span class="normal"><a href="#__codelineno-19-20">20</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1"></a><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">ContactFinder</span>
<a id="__codelineno-19-2" name="__codelineno-19-2"></a><span class="p">{</span>
<a id="__codelineno-19-3" name="__codelineno-19-3"></a><span class="w">     </span><span class="k">private</span><span class="w"> </span><span class="n">IContactSearcher</span><span class="w"> </span><span class="n">_searcher</span><span class="p">;</span>
<a id="__codelineno-19-4" name="__codelineno-19-4"></a>
<a id="__codelineno-19-5" name="__codelineno-19-5"></a><span class="w">     </span><span class="k">public</span><span class="w"> </span><span class="nf">ContactFinder</span><span class="p">(</span><span class="n">IContactSearcher</span><span class="w"> </span><span class="n">searcher</span><span class="p">)</span>
<a id="__codelineno-19-6" name="__codelineno-19-6"></a><span class="w">     </span><span class="p">{</span>
<a id="__codelineno-19-7" name="__codelineno-19-7"></a><span class="w">         </span><span class="n">_searcher</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">searcher</span><span class="p">;</span>
<a id="__codelineno-19-8" name="__codelineno-19-8"></a><span class="w">     </span><span class="p">}</span>
<a id="__codelineno-19-9" name="__codelineno-19-9"></a>
<a id="__codelineno-19-10" name="__codelineno-19-10"></a><span class="w">     </span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">FindContacts</span><span class="p">(</span><span class="n">List</span><span class="w"> </span><span class="n">names</span><span class="p">)</span>
<a id="__codelineno-19-11" name="__codelineno-19-11"></a><span class="w">     </span><span class="p">{</span>
<a id="__codelineno-19-12" name="__codelineno-19-12"></a><span class="w">          </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="kt">var</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">names</span><span class="p">)</span>
<a id="__codelineno-19-13" name="__codelineno-19-13"></a><span class="w">          </span><span class="p">{</span>
<a id="__codelineno-19-14" name="__codelineno-19-14"></a><span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">_searcher</span><span class="p">.</span><span class="n">DoesNameExist</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
<a id="__codelineno-19-15" name="__codelineno-19-15"></a><span class="w">                    </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;Found &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">name</span><span class="p">);</span>
<a id="__codelineno-19-16" name="__codelineno-19-16"></a><span class="w">               </span><span class="k">else</span>
<a id="__codelineno-19-17" name="__codelineno-19-17"></a><span class="w">                    </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;Couldn&#39;t find &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">name</span><span class="p">);</span>
<a id="__codelineno-19-18" name="__codelineno-19-18"></a><span class="w">          </span><span class="p">}</span>
<a id="__codelineno-19-19" name="__codelineno-19-19"></a><span class="w">     </span><span class="p">}</span>
<a id="__codelineno-19-20" name="__codelineno-19-20"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>With this last step, we’ve now resolved the ISP violation.</p>
<h3 id="tldr"><a class="toclink" href="../../2013/12/12/beginner-basics-establishing-a-solid-foundation--the-interface-segregation-principle/#tldr">TL;DR</a></h3>
<p>In summary, the Interface Segregation Principle (ISP) tells us that we should interfaces instead of concrete classes for our dependencies and that we should use the smallest interface for our client to work. If we don’t follow these rules, then it’s easy to create bloated interfaces that clutter up readability. In order to resolve violations, we need to determine what methods our client require and code an interface to contains those methods. Finally, we have our class implement those methods and pass it to the client. By following the ISP, we reduce the complexity required by our code and reduce the coupling between client and dependency. As always, don’t forget to refactor as you go along.</p>
<h3 id="establishing-a-solid-foundation-series"><a class="toclink" href="../../2013/12/12/beginner-basics-establishing-a-solid-foundation--the-interface-segregation-principle/#establishing-a-solid-foundation-series">Establishing a SOLID Foundation Series</a></h3>
<ul>
<li><a href="../../2013/11/04/establish-solid-intro/">Introduction</a></li>
<li><a href="../../2013/11/11/beginner-basics-establishing-a-solid-foundation--the-single-responsibility-principle/">The Single Responsibility Principle (SRP)</a></li>
<li><a href="../../2013/11/18/beginner-basics-establishing-a-solid-foundation---the-openclosed-principle/">The Open/Closed Principle (OCP)</a></li>
<li><a href="../../2013/11/29/beginner-basics-establishing-a-solid-foundation--the-liskov-substitution-principle/">The Liskov Substitution Principle (LSP)</a></li>
<li><a href="../../2013/12/12/beginner-basics-establishing-a-solid-foundation--the-interface-segregation-principle/">The Interface Segregation Principle (ISP)</a></li>
<li><a href="../../2014/01/07/beginner-basics-establishing-a-solid-foundation--the-dependency-inversion-principle/">The Dependency Inversion Principle (DIP)</a></li>
</ul>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/cameronpresley.png" alt="Cameron Presley">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2013-11-29 00:00:00+00:00">Nov 29, 2013</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../../category/basics/" class="md-meta__link">Basics</a>, 
              <a href="../../category/solid/" class="md-meta__link">SOLID</a></li>
        
        
          
          <li class="md-meta__item">
            
              5 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="beginner-basics-establishing-a-solid-foundation-the-liskov-substitution-principle"><a class="toclink" href="../../2013/11/29/beginner-basics-establishing-a-solid-foundation--the-liskov-substitution-principle/">Beginner Basics: Establishing a SOLID Foundation – The Liskov Substitution Principle</a></h2>
<p>Welcome to the third installment of Establishing a SOLID Foundation series. In this post, we’ll be exploring the third part of SOLID, the Liskov Substitution Principle and how following this principle can lead to loose coupling of your code.</p>
<h3 id="so-what-is-the-liskov-substitution-principle"><a class="toclink" href="../../2013/11/29/beginner-basics-establishing-a-solid-foundation--the-liskov-substitution-principle/#so-what-is-the-liskov-substitution-principle">So what is the Liskov Substitution Principle?</a></h3>
<p>Before diving into the Liskov Substitution Principle (LSP), let’s look at a code example demonstrating the violation.</p>
<p>Let’s say that we have a Rectangle class:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-24-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-24-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-24-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-24-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-24-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-24-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-24-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-24-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-24-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-24-10">10</a></span>
<span class="normal"><a href="#__codelineno-24-11">11</a></span>
<span class="normal"><a href="#__codelineno-24-12">12</a></span>
<span class="normal"><a href="#__codelineno-24-13">13</a></span>
<span class="normal"><a href="#__codelineno-24-14">14</a></span>
<span class="normal"><a href="#__codelineno-24-15">15</a></span>
<span class="normal"><a href="#__codelineno-24-16">16</a></span>
<span class="normal"><a href="#__codelineno-24-17">17</a></span>
<span class="normal"><a href="#__codelineno-24-18">18</a></span>
<span class="normal"><a href="#__codelineno-24-19">19</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1"></a><span class="c1"># A Rectangle can have height and width</span>
<a id="__codelineno-24-2" name="__codelineno-24-2"></a><span class="c1"># set to any value</span>
<a id="__codelineno-24-3" name="__codelineno-24-3"></a><span class="k">class</span><span class="w"> </span><span class="nc">Rectangle</span>
<a id="__codelineno-24-4" name="__codelineno-24-4"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">height=</span><span class="p">(</span><span class="n">height</span><span class="p">)</span>
<a id="__codelineno-24-5" name="__codelineno-24-5"></a><span class="w">      </span><span class="vi">@height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">height</span>
<a id="__codelineno-24-6" name="__codelineno-24-6"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-24-7" name="__codelineno-24-7"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">width=</span><span class="p">(</span><span class="n">width</span><span class="p">)</span>
<a id="__codelineno-24-8" name="__codelineno-24-8"></a><span class="w">      </span><span class="vi">@width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">width</span>
<a id="__codelineno-24-9" name="__codelineno-24-9"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-24-10" name="__codelineno-24-10"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">height</span>
<a id="__codelineno-24-11" name="__codelineno-24-11"></a><span class="w">      </span><span class="vi">@height</span>
<a id="__codelineno-24-12" name="__codelineno-24-12"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-24-13" name="__codelineno-24-13"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">width</span>
<a id="__codelineno-24-14" name="__codelineno-24-14"></a><span class="w">      </span><span class="vi">@width</span>
<a id="__codelineno-24-15" name="__codelineno-24-15"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-24-16" name="__codelineno-24-16"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">area</span>
<a id="__codelineno-24-17" name="__codelineno-24-17"></a><span class="w">      </span><span class="n">height</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">width</span>
<a id="__codelineno-24-18" name="__codelineno-24-18"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-24-19" name="__codelineno-24-19"></a><span class="k">end</span>
</code></pre></div></td></tr></table></div>
<p>If we run the following implementation, it’s pretty clear that it works like we would expect:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-25-1">1</a></span>
<span class="normal"><a href="#__codelineno-25-2">2</a></span>
<span class="normal"><a href="#__codelineno-25-3">3</a></span>
<span class="normal"><a href="#__codelineno-25-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1"></a><span class="n">rect</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">Rectangle</span><span class="o">.</span><span class="n">new</span>
<a id="__codelineno-25-2" name="__codelineno-25-2"></a><span class="n">rect</span><span class="o">.</span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span>
<a id="__codelineno-25-3" name="__codelineno-25-3"></a><span class="n">rect</span><span class="o">.</span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span>
<a id="__codelineno-25-4" name="__codelineno-25-4"></a><span class="nb">puts</span><span class="w"> </span><span class="n">rect</span><span class="o">.</span><span class="n">area</span><span class="w"> </span><span class="c1"># =&gt; 30</span>
</code></pre></div></td></tr></table></div>
<p>Seems pretty simple, we have a Rectangle class with two public properties, height and width and the class behaves the way we would expect.</p>
<p>Now let’s add a new class, called Square. Since all Squares are also Rectangles, it makes sense that the Square class should inherit from the Rectangle class. However, since Squares have to maintain the same height and width, we need to add some additional logic for that:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-26-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-26-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-26-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-26-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-26-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-26-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-26-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-26-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-26-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-26-10">10</a></span>
<span class="normal"><a href="#__codelineno-26-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1"></a><span class="c1"># A Square must maintain the same height and width</span>
<a id="__codelineno-26-2" name="__codelineno-26-2"></a><span class="k">class</span><span class="w"> </span><span class="nc">Square</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="no">Rectangle</span>
<a id="__codelineno-26-3" name="__codelineno-26-3"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">height=</span><span class="p">(</span><span class="n">height</span><span class="p">)</span>
<a id="__codelineno-26-4" name="__codelineno-26-4"></a><span class="w">      </span><span class="vi">@height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">height</span>
<a id="__codelineno-26-5" name="__codelineno-26-5"></a><span class="w">      </span><span class="vi">@width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">height</span>
<a id="__codelineno-26-6" name="__codelineno-26-6"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-26-7" name="__codelineno-26-7"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">width=</span><span class="p">(</span><span class="n">width</span><span class="p">)</span>
<a id="__codelineno-26-8" name="__codelineno-26-8"></a><span class="w">      </span><span class="vi">@width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">width</span>
<a id="__codelineno-26-9" name="__codelineno-26-9"></a><span class="w">      </span><span class="vi">@height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">width</span>
<a id="__codelineno-26-10" name="__codelineno-26-10"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-26-11" name="__codelineno-26-11"></a><span class="k">end</span>
</code></pre></div></td></tr></table></div>
<p>Using a Square instead of a Rectangle and running the same input, we get the following output:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-27-1">1</a></span>
<span class="normal"><a href="#__codelineno-27-2">2</a></span>
<span class="normal"><a href="#__codelineno-27-3">3</a></span>
<span class="normal"><a href="#__codelineno-27-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1"></a><span class="n">square</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">Square</span><span class="o">.</span><span class="n">new</span>
<a id="__codelineno-27-2" name="__codelineno-27-2"></a><span class="n">square</span><span class="o">.</span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span>
<a id="__codelineno-27-3" name="__codelineno-27-3"></a><span class="n">square</span><span class="o">.</span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span>
<a id="__codelineno-27-4" name="__codelineno-27-4"></a><span class="nb">puts</span><span class="w"> </span><span class="n">square</span><span class="o">.</span><span class="n">area</span><span class="w"> </span><span class="c1"># =&gt; 25</span>
</code></pre></div></td></tr></table></div>
<p>Hold up, why is the area 25? If I read this code, then the height should be 10 and the width should be 5, giving an area of 50. This is no longer the case because of the domain constraint caused by the Square class. By using a Square where the code expected a Rectangle, we get different behavior then we would expect. This is the heart of the Liskov Substitution Principle.</p>
<p>In short, the Liskov Substitution Principle states that if we have an object (Rectangle) in our code and it works correctly, then we should be able to use any sub-type (Square) without the results being modified.</p>
<p>The most common example of LSP violations are when the “is-a” phrase from Object-Oriented Design break down. In the Rectangle-Square example, we say that a Square “is-a” Rectangle which is true. However, when we covert that relationship to code and use inheritance, the relationship does not hold up.</p>
<p>I don’t know, this sounds confusing, what’s the point?
To me, the Liskov Substitution Principle is the hardest part of SOLID to understand. It’s <a href="http://en.wikipedia.org/wiki/Liskov_substitution_principle#Principle">heavy on the theoretical</a> and it’s not blatantly obvious when a violation has occurred until testing.</p>
<p>However, there are plenty of benefits of following LSP.</p>
<p>First, following LSP reduces the tight coupling involved in your code. Let’s look back at our Recipes class from the <a href="../../2013/11/18/beginner-basics-establishing-a-solid-foundation---the-openclosed-principle/">Open/Closed Principle post</a> and examine the MakeOrder method:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-28-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-28-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-28-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-28-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-28-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-28-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-28-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-28-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-28-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-28-10">10</a></span>
<span class="normal"><a href="#__codelineno-28-11">11</a></span>
<span class="normal"><a href="#__codelineno-28-12">12</a></span>
<span class="normal"><a href="#__codelineno-28-13">13</a></span>
<span class="normal"><a href="#__codelineno-28-14">14</a></span>
<span class="normal"><a href="#__codelineno-28-15">15</a></span>
<span class="normal"><a href="#__codelineno-28-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">Recipes</span>
<a id="__codelineno-28-2" name="__codelineno-28-2"></a><span class="w">     </span><span class="k">def</span><span class="w"> </span><span class="nf">initialize</span>
<a id="__codelineno-28-3" name="__codelineno-28-3"></a><span class="w">          </span><span class="vi">@recipes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>
<a id="__codelineno-28-4" name="__codelineno-28-4"></a><span class="w">          </span><span class="vi">@recipes</span><span class="o">[</span><span class="no">RecipeNames</span><span class="o">::</span><span class="no">ChickenWithBroccoli</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">ChickenWithBroccoli</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
<a id="__codelineno-28-5" name="__codelineno-28-5"></a><span class="w">          </span><span class="vi">@recipes</span><span class="o">[</span><span class="no">RecipeNames</span><span class="o">::</span><span class="no">SteakWithPotatoes</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SteakWithPotatoes</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
<a id="__codelineno-28-6" name="__codelineno-28-6"></a><span class="w">          </span><span class="vi">@recipes</span><span class="o">[</span><span class="no">RecipeNames</span><span class="o">::</span><span class="no">PorkWithApples</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">PorkWithApples</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
<a id="__codelineno-28-7" name="__codelineno-28-7"></a><span class="w">     </span><span class="k">end</span>
<a id="__codelineno-28-8" name="__codelineno-28-8"></a><span class="w">     </span><span class="k">def</span><span class="w"> </span><span class="nf">MakeOrder</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
<a id="__codelineno-28-9" name="__codelineno-28-9"></a><span class="w">          </span><span class="n">recipe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vi">@recipes</span><span class="o">[</span><span class="n">order</span><span class="o">]</span>
<a id="__codelineno-28-10" name="__codelineno-28-10"></a><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="n">recipe</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kp">nil</span>
<a id="__codelineno-28-11" name="__codelineno-28-11"></a><span class="w">               </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Can&#39;t cook &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">order</span>
<a id="__codelineno-28-12" name="__codelineno-28-12"></a><span class="w">          </span><span class="k">else</span>
<a id="__codelineno-28-13" name="__codelineno-28-13"></a><span class="w">               </span><span class="n">recipe</span><span class="o">.</span><span class="n">Cook</span><span class="p">()</span>
<a id="__codelineno-28-14" name="__codelineno-28-14"></a><span class="w">          </span><span class="k">end</span>
<a id="__codelineno-28-15" name="__codelineno-28-15"></a><span class="w">     </span><span class="k">end</span>
<a id="__codelineno-28-16" name="__codelineno-28-16"></a><span class="k">end</span>
</code></pre></div></td></tr></table></div>
<p>In this class, you see that we load different recipes and when one’s requested, we call the Cook method. We don’t have to do any set-up, special handling, or other logic, we just trust that the Cook method for whatever recipe we choose works as expected. By following this design, code will be easier to read and to maintain.</p>
<p>Going back to our Square/Rectangle example, if we wanted a method that would return a new Square or Rectangle, it would have to look something like this:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-29-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-29-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-29-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-29-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-29-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-29-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-29-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-29-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-29-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-29-10">10</a></span>
<span class="normal"><a href="#__codelineno-29-11">11</a></span>
<span class="normal"><a href="#__codelineno-29-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">CreateShape</span><span class="p">(</span><span class="n">classType</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="p">)</span>
<a id="__codelineno-29-2" name="__codelineno-29-2"></a><span class="w">     </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kp">nil</span>
<a id="__codelineno-29-3" name="__codelineno-29-3"></a><span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="n">classType</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;Rectangle&quot;</span>
<a id="__codelineno-29-4" name="__codelineno-29-4"></a><span class="w">          </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">Rectangle</span><span class="o">.</span><span class="n">new</span>
<a id="__codelineno-29-5" name="__codelineno-29-5"></a><span class="w">          </span><span class="n">shape</span><span class="o">.</span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">height</span>
<a id="__codelineno-29-6" name="__codelineno-29-6"></a><span class="w">          </span><span class="n">shape</span><span class="o">.</span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">width</span>
<a id="__codelineno-29-7" name="__codelineno-29-7"></a><span class="w">     </span><span class="k">else</span>
<a id="__codelineno-29-8" name="__codelineno-29-8"></a><span class="w">          </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">Square</span><span class="o">.</span><span class="n">new</span>
<a id="__codelineno-29-9" name="__codelineno-29-9"></a><span class="w">          </span><span class="n">shape</span><span class="o">.</span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">height</span>
<a id="__codelineno-29-10" name="__codelineno-29-10"></a><span class="w">     </span><span class="k">end</span>
<a id="__codelineno-29-11" name="__codelineno-29-11"></a><span class="w">     </span><span class="k">return</span><span class="w"> </span><span class="n">shape</span>
<a id="__codelineno-29-12" name="__codelineno-29-12"></a><span class="k">end</span>
</code></pre></div></td></tr></table></div>
<p>This code works, but there is one major problem. When someone is looking at this code, they’re going to get confused of why the Rectangle and Square are setup differently.</p>
<p>For example, when I see that the Square’s height is being set, but not the width, my first thought is that this is a bug. Then, I’d have to look into the Square’s class definition and then I’d see the logic of where setting the height also sets the width.</p>
<p>Long story short, by identifying and resolving LSP violations, we can make the code easier to read and maintain.</p>
<h3 id="so-it-looks-like-lsp-is-pretty-useful-but-how-do-i-fix-violations"><a class="toclink" href="../../2013/11/29/beginner-basics-establishing-a-solid-foundation--the-liskov-substitution-principle/#so-it-looks-like-lsp-is-pretty-useful-but-how-do-i-fix-violations">So it looks like LSP is pretty useful, but how do I fix violations?</a></h3>
<p>Now that we’ve talked about spotting LSP violations and why it’s important to follow LSP, let’s discuss how to fix the violations.</p>
<p>To be honest, fixing a LSP violation is not easy. Since the nature of the problem is caused by a broken abstraction, discarding the abstraction is the best option. However, if you absolutely need to use the abstraction, then one solution is to remove the method that causes the violation.</p>
<p>In the Square/Rectangle example, we would remove the setters for height and width from our Rectangle class because that is how the violation can occur. After removing the setters, we need to modify the initialize method of Square to only take one parameter, size, and send that twice to the Rectangle class. Now, our classes look something like this:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-30-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-30-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-30-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-30-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-30-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-30-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-30-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-30-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-30-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-30-10">10</a></span>
<span class="normal"><a href="#__codelineno-30-11">11</a></span>
<span class="normal"><a href="#__codelineno-30-12">12</a></span>
<span class="normal"><a href="#__codelineno-30-13">13</a></span>
<span class="normal"><a href="#__codelineno-30-14">14</a></span>
<span class="normal"><a href="#__codelineno-30-15">15</a></span>
<span class="normal"><a href="#__codelineno-30-16">16</a></span>
<span class="normal"><a href="#__codelineno-30-17">17</a></span>
<span class="normal"><a href="#__codelineno-30-18">18</a></span>
<span class="normal"><a href="#__codelineno-30-19">19</a></span>
<span class="normal"><a href="#__codelineno-30-20">20</a></span>
<span class="normal"><a href="#__codelineno-30-21">21</a></span>
<span class="normal"><a href="#__codelineno-30-22">22</a></span>
<span class="normal"><a href="#__codelineno-30-23">23</a></span>
<span class="normal"><a href="#__codelineno-30-24">24</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1"></a><span class="c1"># A Rectangle can have height and width</span>
<a id="__codelineno-30-2" name="__codelineno-30-2"></a><span class="c1"># set to any value</span>
<a id="__codelineno-30-3" name="__codelineno-30-3"></a><span class="k">class</span><span class="w"> </span><span class="nc">Rectangle</span>
<a id="__codelineno-30-4" name="__codelineno-30-4"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">initialize</span><span class="p">(</span><span class="n">height</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="p">)</span>
<a id="__codelineno-30-5" name="__codelineno-30-5"></a><span class="w">      </span><span class="vi">@height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">height</span>
<a id="__codelineno-30-6" name="__codelineno-30-6"></a><span class="w">      </span><span class="vi">@width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">width</span>
<a id="__codelineno-30-7" name="__codelineno-30-7"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-30-8" name="__codelineno-30-8"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">height</span>
<a id="__codelineno-30-9" name="__codelineno-30-9"></a><span class="w">      </span><span class="vi">@height</span>
<a id="__codelineno-30-10" name="__codelineno-30-10"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-30-11" name="__codelineno-30-11"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">width</span>
<a id="__codelineno-30-12" name="__codelineno-30-12"></a><span class="w">      </span><span class="vi">@width</span>
<a id="__codelineno-30-13" name="__codelineno-30-13"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-30-14" name="__codelineno-30-14"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">area</span>
<a id="__codelineno-30-15" name="__codelineno-30-15"></a><span class="w">      </span><span class="n">height</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">width</span>
<a id="__codelineno-30-16" name="__codelineno-30-16"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-30-17" name="__codelineno-30-17"></a><span class="k">end</span>
<a id="__codelineno-30-18" name="__codelineno-30-18"></a>
<a id="__codelineno-30-19" name="__codelineno-30-19"></a><span class="c1"># A Square must maintain the same height and width</span>
<a id="__codelineno-30-20" name="__codelineno-30-20"></a><span class="k">class</span><span class="w"> </span><span class="nc">Square</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="no">Rectangle</span>
<a id="__codelineno-30-21" name="__codelineno-30-21"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">initialize</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
<a id="__codelineno-30-22" name="__codelineno-30-22"></a><span class="w">      </span><span class="k">super</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">)</span>
<a id="__codelineno-30-23" name="__codelineno-30-23"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-30-24" name="__codelineno-30-24"></a><span class="k">end</span>
</code></pre></div></td></tr></table></div>
<p>With sample implementation and output</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-31-1">1</a></span>
<span class="normal"><a href="#__codelineno-31-2">2</a></span>
<span class="normal"><a href="#__codelineno-31-3">3</a></span>
<span class="normal"><a href="#__codelineno-31-4">4</a></span>
<span class="normal"><a href="#__codelineno-31-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1"></a><span class="n">rect</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">Rectangle</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>
<a id="__codelineno-31-2" name="__codelineno-31-2"></a><span class="nb">puts</span><span class="w"> </span><span class="n">rect</span><span class="o">.</span><span class="n">area</span><span class="w"> </span><span class="c1"># =&gt; 50</span>
<a id="__codelineno-31-3" name="__codelineno-31-3"></a>
<a id="__codelineno-31-4" name="__codelineno-31-4"></a><span class="n">square</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">Square</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a id="__codelineno-31-5" name="__codelineno-31-5"></a><span class="nb">puts</span><span class="w"> </span><span class="n">square</span><span class="o">.</span><span class="n">area</span><span class="w"> </span><span class="c1"># =&gt; 25</span>
</code></pre></div></td></tr></table></div>
<h3 id="tldr"><a class="toclink" href="../../2013/11/29/beginner-basics-establishing-a-solid-foundation--the-liskov-substitution-principle/#tldr">TL;DR</a></h3>
<p>In short, the Liskov Substitution Principle (LSP) enforces the idea that if a class has a sub-type (through inheritance or interfaces), then by passing the sub-type, the program should still produce the same results. If you run across a class that violates LSP, then you know that your abstraction is not complete and you can either</p>
<ul>
<li>Remove the offending methods/properties or</li>
<li>Abandon the abstraction</li>
</ul>
<p>As always, don’t forget to refactor and reorganize your code as needed.</p>
<h3 id="establishing-a-solid-foundation-series"><a class="toclink" href="../../2013/11/29/beginner-basics-establishing-a-solid-foundation--the-liskov-substitution-principle/#establishing-a-solid-foundation-series">Establishing a SOLID Foundation Series</a></h3>
<ul>
<li><a href="../../2013/11/04/establish-solid-intro/">Introduction</a></li>
<li><a href="../../2013/11/11/beginner-basics-establishing-a-solid-foundation--the-single-responsibility-principle/">The Single Responsibility Principle (SRP)</a></li>
<li><a href="../../2013/11/18/beginner-basics-establishing-a-solid-foundation---the-openclosed-principle/">The Open/Closed Principle (OCP)</a></li>
<li><a href="../../2013/11/29/beginner-basics-establishing-a-solid-foundation--the-liskov-substitution-principle/">The Liskov Substitution Principle (LSP)</a></li>
<li><a href="../../2013/12/12/beginner-basics-establishing-a-solid-foundation--the-interface-segregation-principle/">The Interface Segregation Principle (ISP)</a></li>
<li><a href="../../2014/01/07/beginner-basics-establishing-a-solid-foundation--the-dependency-inversion-principle/">The Dependency Inversion Principle (DIP)</a></li>
</ul>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/cameronpresley.png" alt="Cameron Presley">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2013-11-18 00:00:00+00:00">Nov 18, 2013</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../../category/basics/" class="md-meta__link">Basics</a>, 
              <a href="../../category/solid/" class="md-meta__link">SOLID</a></li>
        
        
          
          <li class="md-meta__item">
            
              7 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="beginner-basics-establishing-a-solid-foundation-the-openclosed-principle"><a class="toclink" href="../../2013/11/18/beginner-basics-establishing-a-solid-foundation---the-openclosed-principle/">Beginner Basics: Establishing a SOLID Foundation - The Open/Closed Principle</a></h2>
<p>Welcome to the second installment of Establishing a SOLID Foundation series. In this post, we’ll be exploring the second part of SOLID, the Open/Closed Principle and how following this principle can lead to great design choices.</p>
<p>So what is the Open/Closed Principle?
In order to set the context for discussion, let’s revisit our last example of the Chef class:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-30-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-30-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-30-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-30-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-30-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-30-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-30-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-30-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-30-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-30-10">10</a></span>
<span class="normal"><a href="#__codelineno-30-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">Chef</span>
<a id="__codelineno-30-2" name="__codelineno-30-2"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">CookFood</span><span class="p">(</span><span class="n">order</span><span class="p">,</span><span class="w"> </span><span class="n">tableNumber</span><span class="p">)</span>
<a id="__codelineno-30-3" name="__codelineno-30-3"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;chicken with broccoli&quot;</span>
<a id="__codelineno-30-4" name="__codelineno-30-4"></a><span class="w">      </span><span class="no">CookChickenWithBroccoli</span><span class="p">()</span>
<a id="__codelineno-30-5" name="__codelineno-30-5"></a><span class="w">    </span><span class="k">end</span>
<a id="__codelineno-30-6" name="__codelineno-30-6"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-30-7" name="__codelineno-30-7"></a>
<a id="__codelineno-30-8" name="__codelineno-30-8"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">CookChickenWithBroccoli</span>
<a id="__codelineno-30-9" name="__codelineno-30-9"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Cooked chicken with broccoli&quot;</span>
<a id="__codelineno-30-10" name="__codelineno-30-10"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-30-11" name="__codelineno-30-11"></a><span class="k">end</span>
</code></pre></div></td></tr></table></div>
<p>So it looks like this Chef is pretty simple, it only has one public method of CookFood and he can only cook ChickenWithBroccoli. However, a Chef that can only cook one thing isn’t very useful. So how about we add some more menu items?</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-31-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-31-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-31-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-31-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-31-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-31-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-31-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-31-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-31-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-31-10">10</a></span>
<span class="normal"><a href="#__codelineno-31-11">11</a></span>
<span class="normal"><a href="#__codelineno-31-12">12</a></span>
<span class="normal"><a href="#__codelineno-31-13">13</a></span>
<span class="normal"><a href="#__codelineno-31-14">14</a></span>
<span class="normal"><a href="#__codelineno-31-15">15</a></span>
<span class="normal"><a href="#__codelineno-31-16">16</a></span>
<span class="normal"><a href="#__codelineno-31-17">17</a></span>
<span class="normal"><a href="#__codelineno-31-18">18</a></span>
<span class="normal"><a href="#__codelineno-31-19">19</a></span>
<span class="normal"><a href="#__codelineno-31-20">20</a></span>
<span class="normal"><a href="#__codelineno-31-21">21</a></span>
<span class="normal"><a href="#__codelineno-31-22">22</a></span>
<span class="normal"><a href="#__codelineno-31-23">23</a></span>
<span class="normal"><a href="#__codelineno-31-24">24</a></span>
<span class="normal"><a href="#__codelineno-31-25">25</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">Chef</span>
<a id="__codelineno-31-2" name="__codelineno-31-2"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">CookFood</span><span class="w"> </span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
<a id="__codelineno-31-3" name="__codelineno-31-3"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;chicken with broccoli&quot;</span>
<a id="__codelineno-31-4" name="__codelineno-31-4"></a><span class="w">      </span><span class="no">CookChickenWithBroccoli</span><span class="p">()</span>
<a id="__codelineno-31-5" name="__codelineno-31-5"></a><span class="w">    </span><span class="k">elsif</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;steak with potatoes&quot;</span>
<a id="__codelineno-31-6" name="__codelineno-31-6"></a><span class="w">      </span><span class="no">CookSteakWithPotatoes</span><span class="p">()</span>
<a id="__codelineno-31-7" name="__codelineno-31-7"></a><span class="w">    </span><span class="k">elsif</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;pork with apples&quot;</span>
<a id="__codelineno-31-8" name="__codelineno-31-8"></a><span class="w">      </span><span class="no">CookPorkWithApples</span><span class="p">()</span>
<a id="__codelineno-31-9" name="__codelineno-31-9"></a><span class="w">    </span><span class="k">else</span>
<a id="__codelineno-31-10" name="__codelineno-31-10"></a><span class="w">      </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Don&#39;t know how to cook &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">order</span>
<a id="__codelineno-31-11" name="__codelineno-31-11"></a><span class="w">    </span><span class="k">end</span>
<a id="__codelineno-31-12" name="__codelineno-31-12"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-31-13" name="__codelineno-31-13"></a>
<a id="__codelineno-31-14" name="__codelineno-31-14"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">CookChickenWithBroccoli</span>
<a id="__codelineno-31-15" name="__codelineno-31-15"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Cooked chicken with broccoli&quot;</span>
<a id="__codelineno-31-16" name="__codelineno-31-16"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-31-17" name="__codelineno-31-17"></a>
<a id="__codelineno-31-18" name="__codelineno-31-18"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">CookSteakWithPotatoes</span>
<a id="__codelineno-31-19" name="__codelineno-31-19"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Cooked steak with potatoes&quot;</span>
<a id="__codelineno-31-20" name="__codelineno-31-20"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-31-21" name="__codelineno-31-21"></a>
<a id="__codelineno-31-22" name="__codelineno-31-22"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">CookPorkWithApples</span>
<a id="__codelineno-31-23" name="__codelineno-31-23"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Cooked pork with apples&quot;</span>
<a id="__codelineno-31-24" name="__codelineno-31-24"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-31-25" name="__codelineno-31-25"></a><span class="k">end</span>
</code></pre></div></td></tr></table></div>
<p>So our new Chef can cook more food, but the code base expanded quite a bit. In order to add more menu choices, we need to add an additional if check in CookFood and to define a new method for CookFood to call. This might not sound like a lot of work because each of these Cook* methods just print something to the screen. However, what if the steps to create each food item were much more complex?</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-32-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-32-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-32-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-32-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-32-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-32-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-32-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-32-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-32-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-32-10">10</a></span>
<span class="normal"><a href="#__codelineno-32-11">11</a></span>
<span class="normal"><a href="#__codelineno-32-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">CookChickenWithBroccoli</span>
<a id="__codelineno-32-2" name="__codelineno-32-2"></a><span class="w">  </span><span class="no">CookChicken</span><span class="p">()</span>
<a id="__codelineno-32-3" name="__codelineno-32-3"></a><span class="w">  </span><span class="no">CookBroccoli</span><span class="p">()</span>
<a id="__codelineno-32-4" name="__codelineno-32-4"></a><span class="k">end</span>
<a id="__codelineno-32-5" name="__codelineno-32-5"></a>
<a id="__codelineno-32-6" name="__codelineno-32-6"></a><span class="k">def</span><span class="w"> </span><span class="nf">CookChicken</span>
<a id="__codelineno-32-7" name="__codelineno-32-7"></a><span class="w">  </span><span class="nb">print</span><span class="w"> </span><span class="s2">&quot;Cooked chicken &quot;</span>
<a id="__codelineno-32-8" name="__codelineno-32-8"></a><span class="k">end</span>
<a id="__codelineno-32-9" name="__codelineno-32-9"></a>
<a id="__codelineno-32-10" name="__codelineno-32-10"></a><span class="k">def</span><span class="w"> </span><span class="nf">CookBroccoli</span>
<a id="__codelineno-32-11" name="__codelineno-32-11"></a><span class="w">  </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;with broccoli&quot;</span>
<a id="__codelineno-32-12" name="__codelineno-32-12"></a><span class="k">end</span>
</code></pre></div></td></tr></table></div>
<p>Also, what if we modified how the CookChickenWithBroccoli method worked? We would need to modify the Chef class, but that doesn’t make sense. In the real world, we would modify the recipe and the Chef would then follow the new recipe. This concept that we would have to modify an unrelated object in order to add new functionality is the inspiration for the Open/Closed Principle.</p>
<p>In short, the Open/Closed Principle means that an object should be <strong>Open</strong> for extension, but <strong>Closed</strong> for modification. This principle relies on the idea that new functionality is added by creating new classes, not by modifying pre-existing classes’ behavior. By doing this, we’re decreasing the chances of breaking current functionality and increasing code stability.</p>
<h3 id="this-sounds-good-but-is-it-worth-the-additional-design-time"><a class="toclink" href="../../2013/11/18/beginner-basics-establishing-a-solid-foundation---the-openclosed-principle/#this-sounds-good-but-is-it-worth-the-additional-design-time">This sounds good, but is it worth the additional design time?</a></h3>
<p>Now that we’ve discussed the Open/Closed Principle, you might be wondering what some of the benefits are of cleaning up this design.</p>
<p>First, classes that follow the Open/Closed Principle are small and focused in nature playing off the idea of the Single Responsibility Principle. Looking back at our Chef class, it’s very clear that by adding new functionality, Chef is going to be handling way too many things.</p>
<p>Next, by following OCP, there won’t be multiple classes modified just to add new functionality. There’s nothing like a change set containing tons of modified files to make even the most experienced developer shudder in fear.</p>
<p>By definition of OCP, we won’t be modifying a lot of files (ideally only one file should be modified) and we’re adding new classes. Since we’re adding in these new classes, we inherently have the opportunity to bake in testing.</p>
<h3 id="alright-i-get-it-ocp-is-awesome-but-how-do-i-refactor-the-chef-class"><a class="toclink" href="../../2013/11/18/beginner-basics-establishing-a-solid-foundation---the-openclosed-principle/#alright-i-get-it-ocp-is-awesome-but-how-do-i-refactor-the-chef-class">Alright, I get it OCP is awesome, but how do I refactor the Chef class?</a></h3>
<p>In order to fix the violation, we’re going to take each menu item and make them into their own class</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-33-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-33-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-33-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-33-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-33-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-33-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-33-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-33-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-33-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-33-10">10</a></span>
<span class="normal"><a href="#__codelineno-33-11">11</a></span>
<span class="normal"><a href="#__codelineno-33-12">12</a></span>
<span class="normal"><a href="#__codelineno-33-13">13</a></span>
<span class="normal"><a href="#__codelineno-33-14">14</a></span>
<span class="normal"><a href="#__codelineno-33-15">15</a></span>
<span class="normal"><a href="#__codelineno-33-16">16</a></span>
<span class="normal"><a href="#__codelineno-33-17">17</a></span>
<span class="normal"><a href="#__codelineno-33-18">18</a></span>
<span class="normal"><a href="#__codelineno-33-19">19</a></span>
<span class="normal"><a href="#__codelineno-33-20">20</a></span>
<span class="normal"><a href="#__codelineno-33-21">21</a></span>
<span class="normal"><a href="#__codelineno-33-22">22</a></span>
<span class="normal"><a href="#__codelineno-33-23">23</a></span>
<span class="normal"><a href="#__codelineno-33-24">24</a></span>
<span class="normal"><a href="#__codelineno-33-25">25</a></span>
<span class="normal"><a href="#__codelineno-33-26">26</a></span>
<span class="normal"><a href="#__codelineno-33-27">27</a></span>
<span class="normal"><a href="#__codelineno-33-28">28</a></span>
<span class="normal"><a href="#__codelineno-33-29">29</a></span>
<span class="normal"><a href="#__codelineno-33-30">30</a></span>
<span class="normal"><a href="#__codelineno-33-31">31</a></span>
<span class="normal"><a href="#__codelineno-33-32">32</a></span>
<span class="normal"><a href="#__codelineno-33-33">33</a></span>
<span class="normal"><a href="#__codelineno-33-34">34</a></span>
<span class="normal"><a href="#__codelineno-33-35">35</a></span>
<span class="normal"><a href="#__codelineno-33-36">36</a></span>
<span class="normal"><a href="#__codelineno-33-37">37</a></span>
<span class="normal"><a href="#__codelineno-33-38">38</a></span>
<span class="normal"><a href="#__codelineno-33-39">39</a></span>
<span class="normal"><a href="#__codelineno-33-40">40</a></span>
<span class="normal"><a href="#__codelineno-33-41">41</a></span>
<span class="normal"><a href="#__codelineno-33-42">42</a></span>
<span class="normal"><a href="#__codelineno-33-43">43</a></span>
<span class="normal"><a href="#__codelineno-33-44">44</a></span>
<span class="normal"><a href="#__codelineno-33-45">45</a></span>
<span class="normal"><a href="#__codelineno-33-46">46</a></span>
<span class="normal"><a href="#__codelineno-33-47">47</a></span>
<span class="normal"><a href="#__codelineno-33-48">48</a></span>
<span class="normal"><a href="#__codelineno-33-49">49</a></span>
<span class="normal"><a href="#__codelineno-33-50">50</a></span>
<span class="normal"><a href="#__codelineno-33-51">51</a></span>
<span class="normal"><a href="#__codelineno-33-52">52</a></span>
<span class="normal"><a href="#__codelineno-33-53">53</a></span>
<span class="normal"><a href="#__codelineno-33-54">54</a></span>
<span class="normal"><a href="#__codelineno-33-55">55</a></span>
<span class="normal"><a href="#__codelineno-33-56">56</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">ChickenWithBroccoli</span>
<a id="__codelineno-33-2" name="__codelineno-33-2"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">initialize</span>
<a id="__codelineno-33-3" name="__codelineno-33-3"></a><span class="w">    </span><span class="vi">@name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Chicken with Broccoli&quot;</span>
<a id="__codelineno-33-4" name="__codelineno-33-4"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-33-5" name="__codelineno-33-5"></a>
<a id="__codelineno-33-6" name="__codelineno-33-6"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">Cook</span>
<a id="__codelineno-33-7" name="__codelineno-33-7"></a><span class="w">    </span><span class="no">CookChicken</span><span class="p">()</span>
<a id="__codelineno-33-8" name="__codelineno-33-8"></a><span class="w">    </span><span class="no">CookBroccoli</span><span class="p">()</span>
<a id="__codelineno-33-9" name="__codelineno-33-9"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-33-10" name="__codelineno-33-10"></a>
<a id="__codelineno-33-11" name="__codelineno-33-11"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">CookChicken</span>
<a id="__codelineno-33-12" name="__codelineno-33-12"></a><span class="w">    </span><span class="nb">print</span><span class="w"> </span><span class="s2">&quot;Cooked chicken &quot;</span>
<a id="__codelineno-33-13" name="__codelineno-33-13"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-33-14" name="__codelineno-33-14"></a>
<a id="__codelineno-33-15" name="__codelineno-33-15"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">CookBroccoli</span>
<a id="__codelineno-33-16" name="__codelineno-33-16"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;with broccoli&quot;</span>
<a id="__codelineno-33-17" name="__codelineno-33-17"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-33-18" name="__codelineno-33-18"></a><span class="k">end</span>
<a id="__codelineno-33-19" name="__codelineno-33-19"></a>
<a id="__codelineno-33-20" name="__codelineno-33-20"></a><span class="k">class</span><span class="w"> </span><span class="nc">SteakWithPotatoes</span>
<a id="__codelineno-33-21" name="__codelineno-33-21"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">initialize</span>
<a id="__codelineno-33-22" name="__codelineno-33-22"></a><span class="w">    </span><span class="vi">@name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Steak with Potatoes&quot;</span>
<a id="__codelineno-33-23" name="__codelineno-33-23"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-33-24" name="__codelineno-33-24"></a>
<a id="__codelineno-33-25" name="__codelineno-33-25"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">Cook</span>
<a id="__codelineno-33-26" name="__codelineno-33-26"></a><span class="w">    </span><span class="no">CookSteak</span><span class="p">()</span>
<a id="__codelineno-33-27" name="__codelineno-33-27"></a><span class="w">    </span><span class="no">CookPotatoes</span><span class="p">()</span>
<a id="__codelineno-33-28" name="__codelineno-33-28"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-33-29" name="__codelineno-33-29"></a>
<a id="__codelineno-33-30" name="__codelineno-33-30"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">CookSteak</span>
<a id="__codelineno-33-31" name="__codelineno-33-31"></a><span class="w">    </span><span class="nb">print</span><span class="w"> </span><span class="s2">&quot;Cooked steak &quot;</span>
<a id="__codelineno-33-32" name="__codelineno-33-32"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-33-33" name="__codelineno-33-33"></a>
<a id="__codelineno-33-34" name="__codelineno-33-34"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">CookPotatoes</span>
<a id="__codelineno-33-35" name="__codelineno-33-35"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;with potatoes&quot;</span>
<a id="__codelineno-33-36" name="__codelineno-33-36"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-33-37" name="__codelineno-33-37"></a><span class="k">end</span>
<a id="__codelineno-33-38" name="__codelineno-33-38"></a>
<a id="__codelineno-33-39" name="__codelineno-33-39"></a><span class="k">class</span><span class="w"> </span><span class="nc">PorkWithApples</span>
<a id="__codelineno-33-40" name="__codelineno-33-40"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">initialize</span>
<a id="__codelineno-33-41" name="__codelineno-33-41"></a><span class="w">    </span><span class="vi">@name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Pork with Apples&quot;</span>
<a id="__codelineno-33-42" name="__codelineno-33-42"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-33-43" name="__codelineno-33-43"></a>
<a id="__codelineno-33-44" name="__codelineno-33-44"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">Cook</span>
<a id="__codelineno-33-45" name="__codelineno-33-45"></a><span class="w">    </span><span class="no">CookPork</span><span class="p">()</span>
<a id="__codelineno-33-46" name="__codelineno-33-46"></a><span class="w">    </span><span class="no">CookApples</span><span class="p">()</span>
<a id="__codelineno-33-47" name="__codelineno-33-47"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-33-48" name="__codelineno-33-48"></a>
<a id="__codelineno-33-49" name="__codelineno-33-49"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">CookPork</span>
<a id="__codelineno-33-50" name="__codelineno-33-50"></a><span class="w">    </span><span class="nb">print</span><span class="w"> </span><span class="s2">&quot;Cooked pork &quot;</span>
<a id="__codelineno-33-51" name="__codelineno-33-51"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-33-52" name="__codelineno-33-52"></a>
<a id="__codelineno-33-53" name="__codelineno-33-53"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">CookApples</span>
<a id="__codelineno-33-54" name="__codelineno-33-54"></a><span class="w">    </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;with apples&quot;</span>
<a id="__codelineno-33-55" name="__codelineno-33-55"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-33-56" name="__codelineno-33-56"></a><span class="w"> </span><span class="k">end</span>
</code></pre></div></td></tr></table></div>
<p>Now that we have these different classes, we need to come up with some way for our Chef to interact with them. So why don’t we organize these menu items into a Recipes class?</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-34-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-34-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-34-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-34-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-34-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-34-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-34-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-34-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-34-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-34-10">10</a></span>
<span class="normal"><a href="#__codelineno-34-11">11</a></span>
<span class="normal"><a href="#__codelineno-34-12">12</a></span>
<span class="normal"><a href="#__codelineno-34-13">13</a></span>
<span class="normal"><a href="#__codelineno-34-14">14</a></span>
<span class="normal"><a href="#__codelineno-34-15">15</a></span>
<span class="normal"><a href="#__codelineno-34-16">16</a></span>
<span class="normal"><a href="#__codelineno-34-17">17</a></span>
<span class="normal"><a href="#__codelineno-34-18">18</a></span>
<span class="normal"><a href="#__codelineno-34-19">19</a></span>
<span class="normal"><a href="#__codelineno-34-20">20</a></span>
<span class="normal"><a href="#__codelineno-34-21">21</a></span>
<span class="normal"><a href="#__codelineno-34-22">22</a></span>
<span class="normal"><a href="#__codelineno-34-23">23</a></span>
<span class="normal"><a href="#__codelineno-34-24">24</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">Recipes</span>
<a id="__codelineno-34-2" name="__codelineno-34-2"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">initialize</span>
<a id="__codelineno-34-3" name="__codelineno-34-3"></a><span class="w">      </span><span class="vi">@recipes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>
<a id="__codelineno-34-4" name="__codelineno-34-4"></a><span class="w">      </span><span class="vi">@recipes</span><span class="o">[</span><span class="ss">:chicken</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">ChickenWithBroccoli</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
<a id="__codelineno-34-5" name="__codelineno-34-5"></a><span class="w">      </span><span class="vi">@recipes</span><span class="o">[</span><span class="ss">:steak</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SteakWithPotatoes</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
<a id="__codelineno-34-6" name="__codelineno-34-6"></a><span class="w">      </span><span class="vi">@recipes</span><span class="o">[</span><span class="ss">:pork</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">PorkWithApples</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
<a id="__codelineno-34-7" name="__codelineno-34-7"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-34-8" name="__codelineno-34-8"></a>
<a id="__codelineno-34-9" name="__codelineno-34-9"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">MakeOrder</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
<a id="__codelineno-34-10" name="__codelineno-34-10"></a><span class="w">      </span><span class="n">recipe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kp">nil</span>
<a id="__codelineno-34-11" name="__codelineno-34-11"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;chicken with broccoli&quot;</span>
<a id="__codelineno-34-12" name="__codelineno-34-12"></a><span class="w">          </span><span class="n">recipe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vi">@recipes</span><span class="o">[</span><span class="ss">:chicken</span><span class="o">]</span>
<a id="__codelineno-34-13" name="__codelineno-34-13"></a><span class="w">      </span><span class="k">elsif</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;steak with potatoes&quot;</span>
<a id="__codelineno-34-14" name="__codelineno-34-14"></a><span class="w">          </span><span class="n">recipe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vi">@recipes</span><span class="o">[</span><span class="ss">:steak</span><span class="o">]</span>
<a id="__codelineno-34-15" name="__codelineno-34-15"></a><span class="w">      </span><span class="k">elsif</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;pork with apples&quot;</span>
<a id="__codelineno-34-16" name="__codelineno-34-16"></a><span class="w">          </span><span class="n">recipe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vi">@recipes</span><span class="o">[</span><span class="ss">:pork</span><span class="o">]</span>
<a id="__codelineno-34-17" name="__codelineno-34-17"></a><span class="w">      </span><span class="k">end</span>
<a id="__codelineno-34-18" name="__codelineno-34-18"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="n">recipe</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kp">nil</span>
<a id="__codelineno-34-19" name="__codelineno-34-19"></a><span class="w">          </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Can&#39;t cook &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">order</span>
<a id="__codelineno-34-20" name="__codelineno-34-20"></a><span class="w">      </span><span class="k">else</span>
<a id="__codelineno-34-21" name="__codelineno-34-21"></a><span class="w">          </span><span class="n">recipe</span><span class="o">.</span><span class="n">Cook</span><span class="p">()</span>
<a id="__codelineno-34-22" name="__codelineno-34-22"></a><span class="w">      </span><span class="k">end</span>
<a id="__codelineno-34-23" name="__codelineno-34-23"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-34-24" name="__codelineno-34-24"></a><span class="k">end</span>
</code></pre></div></td></tr></table></div>
<p>Now we have this Recipes class that contains all of the menu items for our Chef to use. When adding new menu items to Recipes, all we have to add is the class in the initialize method and add an additional if check in the MakeOrder method. <em>But hold on</em>, I hear you say, <em>This is the same as what we had with the Chef at the beginning, why is this design better?</em> Before, we would have to modify the Chef in order to add more menu items which doesn’t really make sense, now we’ve moved that logic to Recipes which makes sense that it needs to be modified if a new menu item is added.</p>
<p>On the topic of our Chef, after cleaning up to use the Recipes class, our Chef is simpler and relies on Recipes for the menu items, not itself:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-35-1">1</a></span>
<span class="normal"><a href="#__codelineno-35-2">2</a></span>
<span class="normal"><a href="#__codelineno-35-3">3</a></span>
<span class="normal"><a href="#__codelineno-35-4">4</a></span>
<span class="normal"><a href="#__codelineno-35-5">5</a></span>
<span class="normal"><a href="#__codelineno-35-6">6</a></span>
<span class="normal"><a href="#__codelineno-35-7">7</a></span>
<span class="normal"><a href="#__codelineno-35-8">8</a></span>
<span class="normal"><a href="#__codelineno-35-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">Chef</span>
<a id="__codelineno-35-2" name="__codelineno-35-2"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">initialize</span>
<a id="__codelineno-35-3" name="__codelineno-35-3"></a><span class="w">    </span><span class="vi">@recipes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">Recipes</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
<a id="__codelineno-35-4" name="__codelineno-35-4"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-35-5" name="__codelineno-35-5"></a>
<a id="__codelineno-35-6" name="__codelineno-35-6"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">CookFood</span><span class="w"> </span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
<a id="__codelineno-35-7" name="__codelineno-35-7"></a><span class="w">    </span><span class="vi">@recipes</span><span class="o">.</span><span class="n">MakeOrder</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
<a id="__codelineno-35-8" name="__codelineno-35-8"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-35-9" name="__codelineno-35-9"></a><span class="k">end</span>
</code></pre></div></td></tr></table></div>
<p>Now that we’ve fixed the violation, let’s go ahead and refactor some. Looking at the menu choices, it’s pretty clear that we can abstract the behavior to a base class called MenuItem for them all to share (<em>Note: By defining Cook by raising an exception, I’m forcing all classes to provide their own implementation</em>).</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-36-1">1</a></span>
<span class="normal"><a href="#__codelineno-36-2">2</a></span>
<span class="normal"><a href="#__codelineno-36-3">3</a></span>
<span class="normal"><a href="#__codelineno-36-4">4</a></span>
<span class="normal"><a href="#__codelineno-36-5">5</a></span>
<span class="normal"><a href="#__codelineno-36-6">6</a></span>
<span class="normal"><a href="#__codelineno-36-7">7</a></span>
<span class="normal"><a href="#__codelineno-36-8">8</a></span>
<span class="normal"><a href="#__codelineno-36-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">MenuItem</span>
<a id="__codelineno-36-2" name="__codelineno-36-2"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">initialize</span><span class="p">(</span><span class="nb">name</span><span class="p">)</span>
<a id="__codelineno-36-3" name="__codelineno-36-3"></a><span class="w">      </span><span class="vi">@name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">name</span>
<a id="__codelineno-36-4" name="__codelineno-36-4"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-36-5" name="__codelineno-36-5"></a>
<a id="__codelineno-36-6" name="__codelineno-36-6"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">Cook</span>
<a id="__codelineno-36-7" name="__codelineno-36-7"></a><span class="w">      </span><span class="k">raise</span><span class="w"> </span><span class="s2">&quot;This should be overridden in child class&quot;</span>
<a id="__codelineno-36-8" name="__codelineno-36-8"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-36-9" name="__codelineno-36-9"></a><span class="k">end</span>
</code></pre></div></td></tr></table></div>
<p>Also, as part of this refactoring, we’re going to move some of the strings into constants as part of the RecipeNames module so that the Chef and Recipes can communicate with one another:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-37-1">1</a></span>
<span class="normal"><a href="#__codelineno-37-2">2</a></span>
<span class="normal"><a href="#__codelineno-37-3">3</a></span>
<span class="normal"><a href="#__codelineno-37-4">4</a></span>
<span class="normal"><a href="#__codelineno-37-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1"></a><span class="k">module</span><span class="w"> </span><span class="nn">RecipeNames</span>
<a id="__codelineno-37-2" name="__codelineno-37-2"></a><span class="w">  </span><span class="no">ChickenWithBroccoli</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Chicken with Broccoli&quot;</span>
<a id="__codelineno-37-3" name="__codelineno-37-3"></a><span class="w">  </span><span class="no">SteakWithPotatoes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Steak with Potatoes&quot;</span>
<a id="__codelineno-37-4" name="__codelineno-37-4"></a><span class="w">  </span><span class="no">PorkWithApples</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Pork with Apples&quot;</span>
<a id="__codelineno-37-5" name="__codelineno-37-5"></a><span class="k">end</span>
</code></pre></div></td></tr></table></div>
<p>With these additions, let’s update the menu choices to use the module and the MenuItem base class:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-38-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-38-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-38-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-38-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-38-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-38-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-38-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-38-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-38-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-38-10">10</a></span>
<span class="normal"><a href="#__codelineno-38-11">11</a></span>
<span class="normal"><a href="#__codelineno-38-12">12</a></span>
<span class="normal"><a href="#__codelineno-38-13">13</a></span>
<span class="normal"><a href="#__codelineno-38-14">14</a></span>
<span class="normal"><a href="#__codelineno-38-15">15</a></span>
<span class="normal"><a href="#__codelineno-38-16">16</a></span>
<span class="normal"><a href="#__codelineno-38-17">17</a></span>
<span class="normal"><a href="#__codelineno-38-18">18</a></span>
<span class="normal"><a href="#__codelineno-38-19">19</a></span>
<span class="normal"><a href="#__codelineno-38-20">20</a></span>
<span class="normal"><a href="#__codelineno-38-21">21</a></span>
<span class="normal"><a href="#__codelineno-38-22">22</a></span>
<span class="normal"><a href="#__codelineno-38-23">23</a></span>
<span class="normal"><a href="#__codelineno-38-24">24</a></span>
<span class="normal"><a href="#__codelineno-38-25">25</a></span>
<span class="normal"><a href="#__codelineno-38-26">26</a></span>
<span class="normal"><a href="#__codelineno-38-27">27</a></span>
<span class="normal"><a href="#__codelineno-38-28">28</a></span>
<span class="normal"><a href="#__codelineno-38-29">29</a></span>
<span class="normal"><a href="#__codelineno-38-30">30</a></span>
<span class="normal"><a href="#__codelineno-38-31">31</a></span>
<span class="normal"><a href="#__codelineno-38-32">32</a></span>
<span class="normal"><a href="#__codelineno-38-33">33</a></span>
<span class="normal"><a href="#__codelineno-38-34">34</a></span>
<span class="normal"><a href="#__codelineno-38-35">35</a></span>
<span class="normal"><a href="#__codelineno-38-36">36</a></span>
<span class="normal"><a href="#__codelineno-38-37">37</a></span>
<span class="normal"><a href="#__codelineno-38-38">38</a></span>
<span class="normal"><a href="#__codelineno-38-39">39</a></span>
<span class="normal"><a href="#__codelineno-38-40">40</a></span>
<span class="normal"><a href="#__codelineno-38-41">41</a></span>
<span class="normal"><a href="#__codelineno-38-42">42</a></span>
<span class="normal"><a href="#__codelineno-38-43">43</a></span>
<span class="normal"><a href="#__codelineno-38-44">44</a></span>
<span class="normal"><a href="#__codelineno-38-45">45</a></span>
<span class="normal"><a href="#__codelineno-38-46">46</a></span>
<span class="normal"><a href="#__codelineno-38-47">47</a></span>
<span class="normal"><a href="#__codelineno-38-48">48</a></span>
<span class="normal"><a href="#__codelineno-38-49">49</a></span>
<span class="normal"><a href="#__codelineno-38-50">50</a></span>
<span class="normal"><a href="#__codelineno-38-51">51</a></span>
<span class="normal"><a href="#__codelineno-38-52">52</a></span>
<span class="normal"><a href="#__codelineno-38-53">53</a></span>
<span class="normal"><a href="#__codelineno-38-54">54</a></span>
<span class="normal"><a href="#__codelineno-38-55">55</a></span>
<span class="normal"><a href="#__codelineno-38-56">56</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">ChickenWithBroccoli</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="no">MenuItem</span>
<a id="__codelineno-38-2" name="__codelineno-38-2"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">initialize</span>
<a id="__codelineno-38-3" name="__codelineno-38-3"></a><span class="w">      </span><span class="k">super</span><span class="p">(</span><span class="no">RecipeNames</span><span class="o">::</span><span class="no">ChickenWithBroccoli</span><span class="p">)</span>
<a id="__codelineno-38-4" name="__codelineno-38-4"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-38-5" name="__codelineno-38-5"></a>
<a id="__codelineno-38-6" name="__codelineno-38-6"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">Cook</span>
<a id="__codelineno-38-7" name="__codelineno-38-7"></a><span class="w">      </span><span class="no">CookChicken</span><span class="p">()</span>
<a id="__codelineno-38-8" name="__codelineno-38-8"></a><span class="w">      </span><span class="no">CookBroccoli</span><span class="p">()</span>
<a id="__codelineno-38-9" name="__codelineno-38-9"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-38-10" name="__codelineno-38-10"></a>
<a id="__codelineno-38-11" name="__codelineno-38-11"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">CookChicken</span>
<a id="__codelineno-38-12" name="__codelineno-38-12"></a><span class="w">      </span><span class="nb">print</span><span class="w"> </span><span class="s2">&quot;Cooked chicken &quot;</span>
<a id="__codelineno-38-13" name="__codelineno-38-13"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-38-14" name="__codelineno-38-14"></a>
<a id="__codelineno-38-15" name="__codelineno-38-15"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">CookBroccoli</span>
<a id="__codelineno-38-16" name="__codelineno-38-16"></a><span class="w">      </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;with broccoli&quot;</span>
<a id="__codelineno-38-17" name="__codelineno-38-17"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-38-18" name="__codelineno-38-18"></a><span class="k">end</span>
<a id="__codelineno-38-19" name="__codelineno-38-19"></a>
<a id="__codelineno-38-20" name="__codelineno-38-20"></a><span class="k">class</span><span class="w"> </span><span class="nc">SteakWithPotatoes</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="no">MenuItem</span>
<a id="__codelineno-38-21" name="__codelineno-38-21"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">initialize</span>
<a id="__codelineno-38-22" name="__codelineno-38-22"></a><span class="w">      </span><span class="k">super</span><span class="p">(</span><span class="no">RecipeNames</span><span class="o">::</span><span class="no">SteakWithPotatoes</span><span class="p">)</span>
<a id="__codelineno-38-23" name="__codelineno-38-23"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-38-24" name="__codelineno-38-24"></a>
<a id="__codelineno-38-25" name="__codelineno-38-25"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">Cook</span>
<a id="__codelineno-38-26" name="__codelineno-38-26"></a><span class="w">      </span><span class="no">CookSteak</span><span class="p">()</span>
<a id="__codelineno-38-27" name="__codelineno-38-27"></a><span class="w">      </span><span class="no">CookPotatoes</span><span class="p">()</span>
<a id="__codelineno-38-28" name="__codelineno-38-28"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-38-29" name="__codelineno-38-29"></a>
<a id="__codelineno-38-30" name="__codelineno-38-30"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">CookSteak</span>
<a id="__codelineno-38-31" name="__codelineno-38-31"></a><span class="w">      </span><span class="nb">print</span><span class="w"> </span><span class="s2">&quot;Cooked steak &quot;</span>
<a id="__codelineno-38-32" name="__codelineno-38-32"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-38-33" name="__codelineno-38-33"></a>
<a id="__codelineno-38-34" name="__codelineno-38-34"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">CookPotatoes</span>
<a id="__codelineno-38-35" name="__codelineno-38-35"></a><span class="w">      </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;with potatoes&quot;</span>
<a id="__codelineno-38-36" name="__codelineno-38-36"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-38-37" name="__codelineno-38-37"></a><span class="k">end</span>
<a id="__codelineno-38-38" name="__codelineno-38-38"></a>
<a id="__codelineno-38-39" name="__codelineno-38-39"></a><span class="k">class</span><span class="w"> </span><span class="nc">PorkWithApples</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="no">MenuItem</span>
<a id="__codelineno-38-40" name="__codelineno-38-40"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">initialize</span>
<a id="__codelineno-38-41" name="__codelineno-38-41"></a><span class="w">      </span><span class="k">super</span><span class="p">(</span><span class="no">RecipeNames</span><span class="o">::</span><span class="no">PorkWithApples</span><span class="p">)</span>
<a id="__codelineno-38-42" name="__codelineno-38-42"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-38-43" name="__codelineno-38-43"></a>
<a id="__codelineno-38-44" name="__codelineno-38-44"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">Cook</span>
<a id="__codelineno-38-45" name="__codelineno-38-45"></a><span class="w">      </span><span class="no">CookPork</span><span class="p">()</span>
<a id="__codelineno-38-46" name="__codelineno-38-46"></a><span class="w">      </span><span class="no">CookApples</span><span class="p">()</span>
<a id="__codelineno-38-47" name="__codelineno-38-47"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-38-48" name="__codelineno-38-48"></a>
<a id="__codelineno-38-49" name="__codelineno-38-49"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">CookPork</span>
<a id="__codelineno-38-50" name="__codelineno-38-50"></a><span class="w">      </span><span class="nb">print</span><span class="w"> </span><span class="s2">&quot;Cooked pork &quot;</span>
<a id="__codelineno-38-51" name="__codelineno-38-51"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-38-52" name="__codelineno-38-52"></a>
<a id="__codelineno-38-53" name="__codelineno-38-53"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">CookApples</span>
<a id="__codelineno-38-54" name="__codelineno-38-54"></a><span class="w">      </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;with apples&quot;</span>
<a id="__codelineno-38-55" name="__codelineno-38-55"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-38-56" name="__codelineno-38-56"></a><span class="w"> </span><span class="k">end</span>
</code></pre></div></td></tr></table></div>
<p>With these changes, we need to update the Recipes class to use the RecipeNames module:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-39-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-39-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-39-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-39-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-39-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-39-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-39-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-39-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-39-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-39-10">10</a></span>
<span class="normal"><a href="#__codelineno-39-11">11</a></span>
<span class="normal"><a href="#__codelineno-39-12">12</a></span>
<span class="normal"><a href="#__codelineno-39-13">13</a></span>
<span class="normal"><a href="#__codelineno-39-14">14</a></span>
<span class="normal"><a href="#__codelineno-39-15">15</a></span>
<span class="normal"><a href="#__codelineno-39-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">Recipes</span>
<a id="__codelineno-39-2" name="__codelineno-39-2"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">initialize</span>
<a id="__codelineno-39-3" name="__codelineno-39-3"></a><span class="w">      </span><span class="vi">@recipes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>
<a id="__codelineno-39-4" name="__codelineno-39-4"></a><span class="w">      </span><span class="vi">@recipes</span><span class="o">[</span><span class="no">RecipeNames</span><span class="o">::</span><span class="no">ChickenWithBroccoli</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">ChickenWithBroccoli</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
<a id="__codelineno-39-5" name="__codelineno-39-5"></a><span class="w">      </span><span class="vi">@recipes</span><span class="o">[</span><span class="no">RecipeNames</span><span class="o">::</span><span class="no">SteakWithPotatoes</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">SteakWithPotatoes</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
<a id="__codelineno-39-6" name="__codelineno-39-6"></a><span class="w">      </span><span class="vi">@recipes</span><span class="o">[</span><span class="no">RecipeNames</span><span class="o">::</span><span class="no">PorkWithApples</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">PorkWithApples</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
<a id="__codelineno-39-7" name="__codelineno-39-7"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-39-8" name="__codelineno-39-8"></a><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">MakeOrder</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
<a id="__codelineno-39-9" name="__codelineno-39-9"></a><span class="w">      </span><span class="n">recipe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vi">@recipes</span><span class="o">[</span><span class="n">order</span><span class="o">]</span>
<a id="__codelineno-39-10" name="__codelineno-39-10"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="n">recipe</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kp">nil</span>
<a id="__codelineno-39-11" name="__codelineno-39-11"></a><span class="w">          </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;Can&#39;t cook &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">order</span>
<a id="__codelineno-39-12" name="__codelineno-39-12"></a><span class="w">      </span><span class="k">else</span>
<a id="__codelineno-39-13" name="__codelineno-39-13"></a><span class="w">          </span><span class="n">recipe</span><span class="o">.</span><span class="n">Cook</span><span class="p">()</span>
<a id="__codelineno-39-14" name="__codelineno-39-14"></a><span class="w">      </span><span class="k">end</span>
<a id="__codelineno-39-15" name="__codelineno-39-15"></a><span class="w">  </span><span class="k">end</span>
<a id="__codelineno-39-16" name="__codelineno-39-16"></a><span class="k">end</span>
</code></pre></div></td></tr></table></div>
<p>With this current layout, if we needed to add another menu item (let’s say Fish and Chips), we would need to:</p>
<ol>
<li>Create a new class that extends MenuItem called FishAndChips</li>
<li>Add another string constant to RecipeNames</li>
<li>Add another line in the Recipes initialize method to add it to the array</li>
</ol>
<h3 id="tldr"><a class="toclink" href="../../2013/11/18/beginner-basics-establishing-a-solid-foundation---the-openclosed-principle/#tldr">TL;DR</a></h3>
<p>In short, the Open/Closed Principle (OCP) reinforces the idea that every class should be open for extension and closed to modifications. By following this principle, you’re much more likely to create separated code that allows you to increase functionality and decrease the odds of breaking current functionality. If you run across a class that is doing way too much, use the Single Responsibility Principle to separate the classes and then use a new object that serves as the middle man. In our case, the Recipes class was the middle man between the Chef and the different menu items. As always, don’t forget to refactor and reorganize your code as needed.</p>
<h3 id="establishing-a-solid-foundation-series"><a class="toclink" href="../../2013/11/18/beginner-basics-establishing-a-solid-foundation---the-openclosed-principle/#establishing-a-solid-foundation-series">Establishing a SOLID Foundation Series</a></h3>
<ul>
<li><a href="../../2013/11/04/establish-solid-intro/">Introduction</a></li>
<li><a href="../../2013/11/11/beginner-basics-establishing-a-solid-foundation--the-single-responsibility-principle/">The Single Responsibility Principle (SRP)</a></li>
<li><a href="../../2013/11/18/beginner-basics-establishing-a-solid-foundation---the-openclosed-principle/">The Open/Closed Principle (OCP)</a></li>
<li><a href="../../2013/11/29/beginner-basics-establishing-a-solid-foundation--the-liskov-substitution-principle/">The Liskov Substitution Principle (LSP)</a></li>
<li><a href="../../2013/12/12/beginner-basics-establishing-a-solid-foundation--the-interface-segregation-principle/">The Interface Segregation Principle (ISP)</a></li>
<li><a href="../../2014/01/07/beginner-basics-establishing-a-solid-foundation--the-dependency-inversion-principle/">The Dependency Inversion Principle (DIP)</a></li>
</ul>
    
    
  </div>
</article>
      
      
        
          



<nav class="md-pagination">
  <a class="md-pagination__link" href="../../">1</a> <span class="md-pagination__dots">..</span> <a class="md-pagination__link" href="../6/">6</a> <a class="md-pagination__link" href="../7/">7</a> <span class="md-pagination__current">8</span> <a class="md-pagination__link" href="../9/">9</a>
</nav>
        
      
    </div>
  </div>

          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
        
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../../.." class="md-footer__link md-footer__link--prev" aria-label="Previous: About Me">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                About Me
              </div>
            </div>
          </a>
        
        
          
          <a href="../../category/net/" class="md-footer__link md-footer__link--next" aria-label="Next: .NET">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                .NET
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs Insiders
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.footer", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.ad38c271.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.b66b2b78.min.js"></script>
      
    
  </body>
</html>