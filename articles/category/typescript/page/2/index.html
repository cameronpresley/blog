
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Cameron Presley">
      
      
      
        <link rel="prev" href="../../../tooling/">
      
      
        <link rel="next" href="../../../../archive/2025/">
      
      
        
      
      
      <link rel="icon" href="../../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16+insiders-4.53.16">
    
    
      
        <title>TypeScript - The Software Mentor</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.1caf78d2.min.css">
      
        
        <link rel="stylesheet" href="../../../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../stylesheets/page.css">
    
    <script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-ZE0MGVG7RJ"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-ZE0MGVG7RJ",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-ZE0MGVG7RJ",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#typescript" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../.." title="The Software Mentor" class="md-header__button md-logo" aria-label="The Software Mentor" data-md-component="logo">
      
  <img src="../../../../../assets/images/favicon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            The Software Mentor
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              TypeScript
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="deep-purple"  aria-hidden="true"  type="radio" name="__palette" id="__palette_1">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../.." class="md-tabs__link">
        
  
  
    
  
  About Me

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../../" class="md-tabs__link">
          
  
  
  Articles

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../courses/" class="md-tabs__link">
        
  
  
    
  
  Training Course

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../level-up/" class="md-tabs__link">
        
  
  
    
  
  Level Up Resources

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../presentations/" class="md-tabs__link">
        
  
  
    
  
  Presentations

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../speaking-schedule/" class="md-tabs__link">
        
  
  
    
  
  Speaking Schedule

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../story/" class="md-tabs__link">
        
  
  
    
  
  Story

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../resume/" class="md-tabs__link">
        
  
  
    
  
  Resume

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../.." title="The Software Mentor" class="md-nav__button md-logo" aria-label="The Software Mentor" data-md-component="logo">
      
  <img src="../../../../../assets/images/favicon.png" alt="logo">

    </a>
    The Software Mentor
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    About Me
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Articles
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Articles
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Index
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Archive
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Archive
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../archive/2025/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2025
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../archive/2024/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2024
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../archive/2023/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2023
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../archive/2020/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2020
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../archive/2018/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2018
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../archive/2015/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2015
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../archive/2014/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2014
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../archive/2013/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2013
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" checked>
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Categories
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Categories
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../net/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    .NET
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../aws/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AWS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../basics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Basics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../c/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    C#
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../career/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Career
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../coaching-corner/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Coaching Corner
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../debugging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Debugging
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../functional-programming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Functional Programming
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../interviewing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Interviewing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../leadership/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Leadership
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../learning-through-example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Learning Through Example
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Process
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../solid/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SOLID
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../today-i-learned/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Today I Learned
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../tooling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tooling
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
      
    
  
  
    <li class="md-nav__item">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="../../" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    TypeScript
  

    
  </span>
  
  

      </a>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../courses/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Training Course
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../level-up/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Level Up Resources
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../presentations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Presentations
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../speaking-schedule/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Speaking Schedule
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../story/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Story
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../resume/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Resume
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
  <div class="md-content" data-md-component="content">
    <div class="md-content__inner">
      <header class="md-typeset">
        <h1 id="typescript">TypeScript</h1>
      </header>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/cameronpresley.png" alt="Cameron Presley">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2024-08-27 00:00:00+00:00">Aug 27, 2024</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../../" class="md-meta__link">TypeScript</a>, 
              <a href="../../../functional-programming/" class="md-meta__link">Functional Programming</a></li>
        
        
          
          <li class="md-meta__item">
            
              4 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="functional-design-patterns-reduce-and-monoids"><a class="toclink" href="../../../../2024/08/27/functional-design-patterns---reduce-and-monoids/">Functional Design Patterns - Reduce and Monoids</a></h2>
<p>When learning about a loops, a common exercise is to take an array of elements and calculate some value based on them.  For example, let's say that we have an array of numbers and we want to find their sum. One approach would be the following:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-39-1">1</a></span>
<span class="normal"><a href="#__codelineno-39-2">2</a></span>
<span class="normal"><a href="#__codelineno-39-3">3</a></span>
<span class="normal"><a href="#__codelineno-39-4">4</a></span>
<span class="normal"><a href="#__codelineno-39-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1"></a><span class="kd">const</span><span class="w"> </span><span class="nx">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="mf">4</span><span class="p">,</span><span class="w"> </span><span class="mf">5</span><span class="p">];</span>
<a id="__codelineno-39-2" name="__codelineno-39-2"></a><span class="kd">let</span><span class="w"> </span><span class="nx">total</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<a id="__codelineno-39-3" name="__codelineno-39-3"></a><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nx">values</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-4" name="__codelineno-39-4"></a><span class="w">    </span><span class="nx">total</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nx">val</span><span class="p">;</span>
<a id="__codelineno-39-5" name="__codelineno-39-5"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>This code works and we'll get the right answer, however, there's a pattern sitting here. If you find yourself writing code that has this shape (some initial value and some logic in the loop), then you have a <em>reducer</em> in disguise.</p>
<p>Let's convert this code to use the <em><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/reduce">reduce</a></em> function instead.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-40-1">1</a></span>
<span class="normal"><a href="#__codelineno-40-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1"></a><span class="kd">const</span><span class="w"> </span><span class="nx">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="mf">4</span><span class="p">,</span><span class="w"> </span><span class="mf">5</span><span class="p">];</span>
<a id="__codelineno-40-2" name="__codelineno-40-2"></a><span class="kd">const</span><span class="w"> </span><span class="nx">total</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">values</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">acc</span><span class="p">,</span><span class="w"> </span><span class="nx">curr</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">acc</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">curr</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<p>The <code>reduce</code> function takes two parameters, the <em>reducer</em> and the <em>initial value</em>. For the <em>initial value</em>, this is the value that the result should be if the array is empty. Since we're adding numbers together, zero makes the most sense.</p>
<p>The <em>reducer</em>, on the other hand, says that if you give me the accumulated result so far (called <em>acc</em> in the example) and an element from the array (called <em>curr</em> in the above example), what's the new accumulation?</p>
<p>Reduce is an extremely powerful tool (in fact, <a href="../../../../../presentations/#level-up-on-functional-programming-by-rebuilding-linq">I give a presentation where we rewrite some of C#'s LINQ operators as reduce</a>).</p>
<p>But there's another pattern sitting here. If you find that the initial value and elements of the array have the same type, you most likely have a <a href="https://en.wikipedia.org/wiki/Monoid">monoid</a>.</p>
<h3 id="intro-to-monoids"><a class="toclink" href="../../../../2024/08/27/functional-design-patterns---reduce-and-monoids/#intro-to-monoids">Intro to Monoids</a></h3>
<p>The concept of Monoid comes from the field of <a href="https://en.wikipedia.org/wiki/Category_theory">category theory</a> where a Monoid contains three things</p>
<ol>
<li>A set of values (you can think about this as a type)</li>
<li>Some binary operation (e.g., a function that takes two inputs and returns a single output of said type)</li>
<li>Some identity element such that if you pass the id to the binary operation, you get the other element back.</li>
</ol>
<p>There's a lot of theory sitting here, so let's put it in more concrete terms.</p>
<p>If we have a Monoid over the a type A, then the following must be true:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-41-1">1</a></span>
<span class="normal"><a href="#__codelineno-41-2">2</a></span>
<span class="normal"><a href="#__codelineno-41-3">3</a></span>
<span class="normal"><a href="#__codelineno-41-4">4</a></span>
<span class="normal"><a href="#__codelineno-41-5">5</a></span>
<span class="normal"><a href="#__codelineno-41-6">6</a></span>
<span class="normal"><a href="#__codelineno-41-7">7</a></span>
<span class="normal"><a href="#__codelineno-41-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1"></a><span class="kd">function</span><span class="w"> </span><span class="nx">operation</span><span class="o">&lt;</span><span class="nx">A</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">x</span><span class="o">:</span><span class="kt">A</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="o">:</span><span class="kt">A</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">A</span><span class="w"> </span>
<a id="__codelineno-41-2" name="__codelineno-41-2"></a><span class="p">{</span>
<a id="__codelineno-41-3" name="__codelineno-41-3"></a><span class="w">    </span><span class="c1">// logic for operation</span>
<a id="__codelineno-41-4" name="__codelineno-41-4"></a><span class="p">}</span>
<a id="__codelineno-41-5" name="__codelineno-41-5"></a><span class="kd">const</span><span class="w"> </span><span class="nx">identity</span><span class="o">:</span><span class="w"> </span><span class="kt">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="c1">// some value of type A</span>
<a id="__codelineno-41-6" name="__codelineno-41-6"></a><span class="nx">operation</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span><span class="w"> </span><span class="nx">identity</span><span class="p">)</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">operation</span><span class="p">(</span><span class="nx">identity</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">x</span>
<a id="__codelineno-41-7" name="__codelineno-41-7"></a>
<a id="__codelineno-41-8" name="__codelineno-41-8"></a><span class="nx">operation</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span><span class="w"> </span><span class="nx">operation</span><span class="p">(</span><span class="nx">y</span><span class="p">,</span><span class="w"> </span><span class="nx">z</span><span class="p">))</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">operation</span><span class="p">(</span><span class="nx">operation</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="p">),</span><span class="w"> </span><span class="nx">z</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>Here's how we would define such a thing in TypeScript.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-42-1">1</a></span>
<span class="normal"><a href="#__codelineno-42-2">2</a></span>
<span class="normal"><a href="#__codelineno-42-3">3</a></span>
<span class="normal"><a href="#__codelineno-42-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-42-1" name="__codelineno-42-1"></a><span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">Monoid</span><span class="o">&lt;</span><span class="nx">A</span><span class="o">&gt;</span><span class="p">{</span>
<a id="__codelineno-42-2" name="__codelineno-42-2"></a><span class="w">    </span><span class="nx">operation</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">x</span><span class="o">:</span><span class="kt">A</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="o">:</span><span class="kt">A</span><span class="p">)=&gt;</span><span class="w"> </span><span class="nx">A</span><span class="p">;</span>
<a id="__codelineno-42-3" name="__codelineno-42-3"></a><span class="w">    </span><span class="nx">identity</span><span class="o">:</span><span class="kt">A</span><span class="p">;</span>
<a id="__codelineno-42-4" name="__codelineno-42-4"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h4 id="exploring-total"><a class="toclink" href="../../../../2024/08/27/functional-design-patterns---reduce-and-monoids/#exploring-total">Exploring Total</a></h4>
<p>With more theory in place, let's apply it to our running total from before. It turns out that addition forms a Monoid over positive numbers with the following:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-43-1">1</a></span>
<span class="normal"><a href="#__codelineno-43-2">2</a></span>
<span class="normal"><a href="#__codelineno-43-3">3</a></span>
<span class="normal"><a href="#__codelineno-43-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-43-1" name="__codelineno-43-1"></a><span class="kd">const</span><span class="w"> </span><span class="nx">additionOverNumber</span><span class="o">:</span><span class="w"> </span><span class="kt">Monoid</span><span class="o">&lt;</span><span class="kt">number</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-43-2" name="__codelineno-43-2"></a><span class="w">    </span><span class="nx">identity</span><span class="o">:</span><span class="w"> </span><span class="kt">0</span><span class="p">,</span>
<a id="__codelineno-43-3" name="__codelineno-43-3"></a><span class="w">    </span><span class="nx">operation</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">a</span><span class="o">:</span><span class="kt">number</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="o">:</span><span class="kt">number</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">a</span><span class="o">+</span><span class="nx">b</span><span class="p">;</span>
<a id="__codelineno-43-4" name="__codelineno-43-4"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Wait a minute... This looks like what the <code>reduce</code> function needed from before! </p>
<p>In the case where we have a Monoid, we have a way of reducing an array to a single value <em>for free</em> because of the properties that Monoid gives us.</p>
<h4 id="exploring-booleans"><a class="toclink" href="../../../../2024/08/27/functional-design-patterns---reduce-and-monoids/#exploring-booleans">Exploring Booleans</a></h4>
<p>Thankfully, we're not limited to just numbers. For example, let's take a look at booleans with the <code>&amp;&amp;</code> and <code>||</code> operators.</p>
<p>In the case of <code>&amp;&amp;</code>, that's our operation, so now we need to find the identity element. In other words, what value must <code>id</code> be if the following statements are true?</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-44-1">1</a></span>
<span class="normal"><a href="#__codelineno-44-2">2</a></span>
<span class="normal"><a href="#__codelineno-44-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-44-1" name="__codelineno-44-1"></a><span class="kd">const</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...</span>
<a id="__codelineno-44-2" name="__codelineno-44-2"></a><span class="nx">id</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="kc">true</span>
<a id="__codelineno-44-3" name="__codelineno-44-3"></a><span class="nx">id</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="kc">false</span>
</code></pre></div></td></tr></table></div>
<p>Since <code>id</code> has to be a boolean, the answer is <code>true</code>. Therefore, we can define our Monoid like so</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-45-1">1</a></span>
<span class="normal"><a href="#__codelineno-45-2">2</a></span>
<span class="normal"><a href="#__codelineno-45-3">3</a></span>
<span class="normal"><a href="#__codelineno-45-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-45-1" name="__codelineno-45-1"></a><span class="kd">const</span><span class="w"> </span><span class="nx">AndOverBoolean</span><span class="o">:</span><span class="w"> </span><span class="kt">Monoid</span><span class="o">&lt;</span><span class="kt">boolean</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-45-2" name="__codelineno-45-2"></a><span class="w">    </span><span class="nx">identity</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="p">,</span>
<a id="__codelineno-45-3" name="__codelineno-45-3"></a><span class="w">    </span><span class="nx">operation</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">a</span><span class="o">:</span><span class="kt">boolean</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="o">:</span><span class="kt">boolean</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">b</span>
<a id="__codelineno-45-4" name="__codelineno-45-4"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>With this monoid defined, let's put it to use. Let's say that we wanted to check if every number in a list is even. We could write the following:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-46-1">1</a></span>
<span class="normal"><a href="#__codelineno-46-2">2</a></span>
<span class="normal"><a href="#__codelineno-46-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-46-1" name="__codelineno-46-1"></a><span class="kd">const</span><span class="w"> </span><span class="nx">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="mf">4</span><span class="p">,</span><span class="w"> </span><span class="mf">5</span><span class="p">];</span>
<a id="__codelineno-46-2" name="__codelineno-46-2"></a>
<a id="__codelineno-46-3" name="__codelineno-46-3"></a><span class="kd">const</span><span class="w"> </span><span class="nx">areAllEven</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">values</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">x</span><span class="p">=&gt;</span><span class="nx">x</span><span class="o">%</span><span class="mf">2</span><span class="o">===</span><span class="mf">0</span><span class="p">).</span><span class="nx">reduce</span><span class="p">(</span><span class="nx">AndOverBoolean</span><span class="p">.</span><span class="nx">operation</span><span class="p">,</span><span class="w"> </span><span class="nx">AndOverBoolean</span><span class="p">.</span><span class="nx">identity</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<p>Huh, that looks an awful lot like how we could have used <em><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/every">every</a></em>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-47-1">1</a></span>
<span class="normal"><a href="#__codelineno-47-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-47-1" name="__codelineno-47-1"></a><span class="kd">const</span><span class="w"> </span><span class="nx">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="mf">4</span><span class="p">,</span><span class="w"> </span><span class="mf">5</span><span class="p">];</span>
<a id="__codelineno-47-2" name="__codelineno-47-2"></a><span class="kd">const</span><span class="w"> </span><span class="nx">areAllEven</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">values</span><span class="p">.</span><span class="nx">every</span><span class="p">(</span><span class="nx">x</span><span class="p">=&gt;</span><span class="nx">x</span><span class="o">%</span><span class="mf">2</span><span class="o">===</span><span class="mf">0</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<p>Let's take a look at the <code>||</code> monoid now. We have the operation, but we now we need to find the identity. In other words, what value must <code>id</code> be if the following statements are true?</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-48-1">1</a></span>
<span class="normal"><a href="#__codelineno-48-2">2</a></span>
<span class="normal"><a href="#__codelineno-48-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-48-1" name="__codelineno-48-1"></a><span class="kd">const</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...;</span>
<a id="__codelineno-48-2" name="__codelineno-48-2"></a><span class="nx">id</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="kc">true</span>
<a id="__codelineno-48-3" name="__codelineno-48-3"></a><span class="nx">id</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="kc">false</span>
</code></pre></div></td></tr></table></div>
<p>Since <code>id</code> has to be a boolean, the answer is <code>false</code>. Therefore, we can define our monoid as such.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-49-1">1</a></span>
<span class="normal"><a href="#__codelineno-49-2">2</a></span>
<span class="normal"><a href="#__codelineno-49-3">3</a></span>
<span class="normal"><a href="#__codelineno-49-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-49-1" name="__codelineno-49-1"></a><span class="kd">const</span><span class="w"> </span><span class="nx">OrOverBoolean</span><span class="o">:</span><span class="w"> </span><span class="kt">Monoid</span><span class="o">&lt;</span><span class="kt">boolean</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-49-2" name="__codelineno-49-2"></a><span class="w">    </span><span class="nx">identity</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="p">,</span>
<a id="__codelineno-49-3" name="__codelineno-49-3"></a><span class="w">    </span><span class="nx">operation</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">x</span><span class="o">:</span><span class="kt">boolean</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="o">:</span><span class="kt">boolean</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">y</span>
<a id="__codelineno-49-4" name="__codelineno-49-4"></a><span class="p">}</span><span class="w"> </span>
</code></pre></div></td></tr></table></div>
<p>With this monoid defined, let's put it to use. Let's say that we wanted to check if some number in a list is even. We could write the following:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-50-1">1</a></span>
<span class="normal"><a href="#__codelineno-50-2">2</a></span>
<span class="normal"><a href="#__codelineno-50-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-50-1" name="__codelineno-50-1"></a><span class="kd">const</span><span class="w"> </span><span class="nx">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="mf">4</span><span class="p">,</span><span class="w"> </span><span class="mf">5</span><span class="p">];</span>
<a id="__codelineno-50-2" name="__codelineno-50-2"></a>
<a id="__codelineno-50-3" name="__codelineno-50-3"></a><span class="kd">const</span><span class="w"> </span><span class="nx">areAllEven</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">values</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">x</span><span class="p">=&gt;</span><span class="nx">x</span><span class="o">%</span><span class="mf">2</span><span class="o">===</span><span class="mf">0</span><span class="p">).</span><span class="nx">reduce</span><span class="p">(</span><span class="nx">OrOverBoolean</span><span class="p">.</span><span class="nx">operation</span><span class="p">,</span><span class="w"> </span><span class="nx">OrOverBoolean</span><span class="p">.</span><span class="nx">identity</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<p>Similar to the <code>AndOverBoolean</code>, this looks very similar to the code we would have written if we had leveraged <em><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/some">some</a></em>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-51-1">1</a></span>
<span class="normal"><a href="#__codelineno-51-2">2</a></span>
<span class="normal"><a href="#__codelineno-51-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-51-1" name="__codelineno-51-1"></a><span class="kd">const</span><span class="w"> </span><span class="nx">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="mf">4</span><span class="p">,</span><span class="w"> </span><span class="mf">5</span><span class="p">];</span>
<a id="__codelineno-51-2" name="__codelineno-51-2"></a>
<a id="__codelineno-51-3" name="__codelineno-51-3"></a><span class="kd">const</span><span class="w"> </span><span class="nx">isAnyEven</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">values</span><span class="p">.</span><span class="nx">some</span><span class="p">(</span><span class="nx">x</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">x</span><span class="o">%</span><span class="mf">2</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<h3 id="wrapping-up"><a class="toclink" href="../../../../2024/08/27/functional-design-patterns---reduce-and-monoids/#wrapping-up">Wrapping Up</a></h3>
<p>When working with arrays of items, it's common to need to reduce the list down to a single element. You can start with a for loop and then refactor to using the reduce function. If the types are all the same, then it's likely that you also have a monoid, which can give you stronger guarantees about your code.</p>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/cameronpresley.png" alt="Cameron Presley">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2024-08-19 00:00:00+00:00">Aug 19, 2024</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../../../today-i-learned/" class="md-meta__link">Today I Learned</a>, 
              <a href="../../" class="md-meta__link">TypeScript</a></li>
        
        
          
          <li class="md-meta__item">
            
              3 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="today-i-learned-leveraging-mock-names-with-jest"><a class="toclink" href="../../../../2024/08/19/today-i-learned---leveraging-mock-names-with-jest/">Today I Learned - Leveraging Mock Names with Jest</a></h2>
<p>I was working through the <a href="https://blog.thesoftwarementor.com/articles/2020/05/20/learning-through-example--mars-rover-kata/">Mars Rover kata</a> the other day and found myself in a predicament when trying to test one of the functions, the <code>convertCommandToAction</code> function.</p>
<p>The idea behind the function is that based on the Command you pass in, it'll return the right function to call. The code looks something like this.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-12-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-12-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-12-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-12-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-12-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-12-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-12-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-12-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-12-10">10</a></span>
<span class="normal"><a href="#__codelineno-12-11">11</a></span>
<span class="normal"><a href="#__codelineno-12-12">12</a></span>
<span class="normal"><a href="#__codelineno-12-13">13</a></span>
<span class="normal"><a href="#__codelineno-12-14">14</a></span>
<span class="normal"><a href="#__codelineno-12-15">15</a></span>
<span class="normal"><a href="#__codelineno-12-16">16</a></span>
<span class="normal"><a href="#__codelineno-12-17">17</a></span>
<span class="normal"><a href="#__codelineno-12-18">18</a></span>
<span class="normal"><a href="#__codelineno-12-19">19</a></span>
<span class="normal"><a href="#__codelineno-12-20">20</a></span>
<span class="normal"><a href="#__codelineno-12-21">21</a></span>
<span class="normal"><a href="#__codelineno-12-22">22</a></span>
<span class="normal"><a href="#__codelineno-12-23">23</a></span>
<span class="normal"><a href="#__codelineno-12-24">24</a></span>
<span class="normal"><a href="#__codelineno-12-25">25</a></span>
<span class="normal"><a href="#__codelineno-12-26">26</a></span>
<span class="normal"><a href="#__codelineno-12-27">27</a></span>
<span class="normal"><a href="#__codelineno-12-28">28</a></span>
<span class="normal"><a href="#__codelineno-12-29">29</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;MoveForward&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;MoveBackward&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;TurnLeft&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;TurnRight&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;Quit&#39;</span>
<a id="__codelineno-12-2" name="__codelineno-12-2"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Action</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">r</span><span class="o">:</span><span class="kt">Rover</span><span class="p">)</span><span class="o">:</span><span class="nx">Rover</span><span class="p">;</span>
<a id="__codelineno-12-3" name="__codelineno-12-3"></a>
<a id="__codelineno-12-4" name="__codelineno-12-4"></a><span class="kd">const</span><span class="w"> </span><span class="nx">moveForward</span><span class="o">:</span><span class="kt">Action</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">r</span><span class="o">:</span><span class="kt">Rover</span><span class="p">)</span><span class="o">:</span><span class="nx">Rover</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-12-5" name="__codelineno-12-5"></a><span class="w">  </span><span class="c1">// business rules</span>
<a id="__codelineno-12-6" name="__codelineno-12-6"></a><span class="p">}</span>
<a id="__codelineno-12-7" name="__codelineno-12-7"></a><span class="kd">const</span><span class="w"> </span><span class="nx">moveBackward</span><span class="o">:</span><span class="kt">Action</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">r</span><span class="o">:</span><span class="kt">Rover</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">Rover</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-12-8" name="__codelineno-12-8"></a><span class="w">  </span><span class="c1">// business rules</span>
<a id="__codelineno-12-9" name="__codelineno-12-9"></a><span class="p">}</span>
<a id="__codelineno-12-10" name="__codelineno-12-10"></a><span class="kd">const</span><span class="w"> </span><span class="nx">turnLeft</span><span class="o">:</span><span class="kt">Action</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">r</span><span class="o">:</span><span class="kt">Rover</span><span class="p">)</span><span class="o">:</span><span class="nx">Rover</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-12-11" name="__codelineno-12-11"></a><span class="w">  </span><span class="c1">// business rules</span>
<a id="__codelineno-12-12" name="__codelineno-12-12"></a><span class="p">}</span>
<a id="__codelineno-12-13" name="__codelineno-12-13"></a><span class="kd">const</span><span class="w"> </span><span class="nx">turnRight</span><span class="o">:</span><span class="kt">Action</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">r</span><span class="o">:</span><span class="kt">Rover</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">Rover</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-12-14" name="__codelineno-12-14"></a><span class="w">  </span><span class="c1">// business rules</span>
<a id="__codelineno-12-15" name="__codelineno-12-15"></a><span class="p">}</span>
<a id="__codelineno-12-16" name="__codelineno-12-16"></a><span class="kd">const</span><span class="w"> </span><span class="nx">quit</span><span class="o">:</span><span class="kt">Action</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">r</span><span class="o">:</span><span class="kt">Rover</span><span class="p">)</span><span class="o">:</span><span class="nx">Rover</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-12-17" name="__codelineno-12-17"></a><span class="w">  </span><span class="c1">// business rules</span>
<a id="__codelineno-12-18" name="__codelineno-12-18"></a><span class="p">}</span>
<a id="__codelineno-12-19" name="__codelineno-12-19"></a>
<a id="__codelineno-12-20" name="__codelineno-12-20"></a><span class="c1">// Function that I&#39;m wanting to write tests against.</span>
<a id="__codelineno-12-21" name="__codelineno-12-21"></a><span class="kd">function</span><span class="w"> </span><span class="nx">convertCommandToAction</span><span class="p">(</span><span class="nx">c</span><span class="o">:</span><span class="kt">Command</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">Action</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-12-22" name="__codelineno-12-22"></a><span class="w">  </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">c</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-12-23" name="__codelineno-12-23"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;MoveForward&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">moveForward</span><span class="p">;</span>
<a id="__codelineno-12-24" name="__codelineno-12-24"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;MoveBackward&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">moveBackward</span><span class="p">;</span>
<a id="__codelineno-12-25" name="__codelineno-12-25"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;TurnLeft&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">turnLeft</span><span class="p">;</span>
<a id="__codelineno-12-26" name="__codelineno-12-26"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;TurnRight&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">turnRight</span><span class="p">;</span>
<a id="__codelineno-12-27" name="__codelineno-12-27"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;Quit&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">quit</span><span class="p">;</span>
<a id="__codelineno-12-28" name="__codelineno-12-28"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-12-29" name="__codelineno-12-29"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>I'm able to write tests across all the other functions easily enough, but for the <code>convertCommandToAction</code>, I needed some way to know which function is being returned.</p>
<p>Since I don't want the real functions to be used, my mind went to leveraging <code>Jest</code> and mocking out the module that the actions were defined in, yielding the following test setup.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-13-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-13-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-13-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-13-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-13-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-13-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-13-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-13-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-13-10">10</a></span>
<span class="normal"><a href="#__codelineno-13-11">11</a></span>
<span class="normal"><a href="#__codelineno-13-12">12</a></span>
<span class="normal"><a href="#__codelineno-13-13">13</a></span>
<span class="normal"><a href="#__codelineno-13-14">14</a></span>
<span class="normal"><a href="#__codelineno-13-15">15</a></span>
<span class="normal"><a href="#__codelineno-13-16">16</a></span>
<span class="normal"><a href="#__codelineno-13-17">17</a></span>
<span class="normal"><a href="#__codelineno-13-18">18</a></span>
<span class="normal"><a href="#__codelineno-13-19">19</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Command</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;./models&quot;</span><span class="p">;</span>
<a id="__codelineno-13-2" name="__codelineno-13-2"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">convertCommandToAction</span><span class="p">,</span><span class="w"> </span><span class="nx">convertStringToCommand</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;./parsers&quot;</span><span class="p">;</span>
<a id="__codelineno-13-3" name="__codelineno-13-3"></a>
<a id="__codelineno-13-4" name="__codelineno-13-4"></a><span class="nx">jest</span><span class="p">.</span><span class="nx">mock</span><span class="p">(</span><span class="s2">&quot;./actions&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">({</span>
<a id="__codelineno-13-5" name="__codelineno-13-5"></a><span class="w">  </span><span class="nx">moveForward</span><span class="o">:</span><span class="w"> </span><span class="kt">jest.fn</span><span class="p">(),</span>
<a id="__codelineno-13-6" name="__codelineno-13-6"></a><span class="w">  </span><span class="nx">moveBackward</span><span class="o">:</span><span class="w"> </span><span class="kt">jest.fn</span><span class="p">(),</span>
<a id="__codelineno-13-7" name="__codelineno-13-7"></a><span class="w">  </span><span class="nx">turnLeft</span><span class="o">:</span><span class="w"> </span><span class="kt">jest.fn</span><span class="p">(),</span>
<a id="__codelineno-13-8" name="__codelineno-13-8"></a><span class="w">  </span><span class="nx">turnRight</span><span class="o">:</span><span class="w"> </span><span class="kt">jest.fn</span><span class="p">(),</span>
<a id="__codelineno-13-9" name="__codelineno-13-9"></a><span class="w">  </span><span class="nx">quit</span><span class="o">:</span><span class="w"> </span><span class="kt">jest.fn</span><span class="p">(),</span>
<a id="__codelineno-13-10" name="__codelineno-13-10"></a><span class="p">}));</span>
<a id="__codelineno-13-11" name="__codelineno-13-11"></a>
<a id="__codelineno-13-12" name="__codelineno-13-12"></a><span class="nx">describe</span><span class="p">(</span><span class="s2">&quot;When converting a Command to an Action&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-13" name="__codelineno-13-13"></a><span class="w">  </span><span class="nx">it</span><span class="p">(</span><span class="s2">&quot;and the command is MoveForward, then the right action is returned&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-14" name="__codelineno-13-14"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">convertCommandToAction</span><span class="p">(</span><span class="s2">&quot;MoveForward&quot;</span><span class="p">);</span>
<a id="__codelineno-13-15" name="__codelineno-13-15"></a>
<a id="__codelineno-13-16" name="__codelineno-13-16"></a><span class="w">    </span><span class="c1">// What should my expect be?</span>
<a id="__codelineno-13-17" name="__codelineno-13-17"></a><span class="w">    </span><span class="nx">expect</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
<a id="__codelineno-13-18" name="__codelineno-13-18"></a><span class="w">  </span><span class="p">});</span>
<a id="__codelineno-13-19" name="__codelineno-13-19"></a><span class="p">});</span>
</code></pre></div></td></tr></table></div>
<p>One approach that I have used in the past is jest's ability <a href="https://jestjs.io/docs/jest-object#jestismockfunctionfn">to test if a function is a mocked function</a>, however, that approach doesn't work here because all of the functions are being mocked out. Meaning, that my test would pass, but if I returned <code>moveBackward</code> instead of <code>moveForward</code>, my test would still pass (but now for the wrong reason). I need a way to know <em>which</em> function was being returned.</p>
<p>Doing some digging, I found that the <code>jest.fn()</code> has a way of setting a name for a mock by leveraging the <a href="https://jestjs.io/docs/mock-function-api#mockfnmocknamename"><code>mockName</code></a> function. This in turn allowed me to change my setup to look like this.</p>
<p><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1">1</a></span>
<span class="normal"><a href="#__codelineno-14-2">2</a></span>
<span class="normal"><a href="#__codelineno-14-3">3</a></span>
<span class="normal"><a href="#__codelineno-14-4">4</a></span>
<span class="normal"><a href="#__codelineno-14-5">5</a></span>
<span class="normal"><a href="#__codelineno-14-6">6</a></span>
<span class="normal"><a href="#__codelineno-14-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="nx">jest</span><span class="p">.</span><span class="nx">mock</span><span class="p">(</span><span class="s2">&quot;./actions&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">({</span>
<a id="__codelineno-14-2" name="__codelineno-14-2"></a><span class="w">  </span><span class="nx">moveForward</span><span class="o">:</span><span class="w"> </span><span class="kt">jest.fn</span><span class="p">().</span><span class="nx">mockName</span><span class="p">(</span><span class="s1">&#39;moveForward&#39;</span><span class="p">),</span>
<a id="__codelineno-14-3" name="__codelineno-14-3"></a><span class="w">  </span><span class="nx">moveBackward</span><span class="o">:</span><span class="w"> </span><span class="kt">jest.fn</span><span class="p">().</span><span class="nx">mockName</span><span class="p">(</span><span class="s1">&#39;moveBackward&#39;</span><span class="p">),</span>
<a id="__codelineno-14-4" name="__codelineno-14-4"></a><span class="w">  </span><span class="nx">turnLeft</span><span class="o">:</span><span class="w"> </span><span class="kt">jest.fn</span><span class="p">().</span><span class="nx">mockName</span><span class="p">(</span><span class="s1">&#39;turnLeft&#39;</span><span class="p">),</span>
<a id="__codelineno-14-5" name="__codelineno-14-5"></a><span class="w">  </span><span class="nx">turnRight</span><span class="o">:</span><span class="w"> </span><span class="kt">jest.fn</span><span class="p">().</span><span class="nx">mockName</span><span class="p">(</span><span class="s1">&#39;turnRight&#39;</span><span class="p">),</span>
<a id="__codelineno-14-6" name="__codelineno-14-6"></a><span class="w">  </span><span class="nx">quit</span><span class="o">:</span><span class="w"> </span><span class="kt">jest.fn</span><span class="p">().</span><span class="nx">mockName</span><span class="p">(</span><span class="s1">&#39;quit&#39;</span><span class="p">),</span>
<a id="__codelineno-14-7" name="__codelineno-14-7"></a><span class="p">}));</span>
</code></pre></div></td></tr></table></div>
<em>Note: It turns out that the <code>mockName</code> function is part of a <a href="https://martinfowler.com/bliki/FluentInterface.html">fluent interface</a>, which allows it to return a jest.Mock as the result of the mockName call</em></p>
<p>With my setup updated, my tests can now check that the result has the right mockName.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1">1</a></span>
<span class="normal"><a href="#__codelineno-15-2">2</a></span>
<span class="normal"><a href="#__codelineno-15-3">3</a></span>
<span class="normal"><a href="#__codelineno-15-4">4</a></span>
<span class="normal"><a href="#__codelineno-15-5">5</a></span>
<span class="normal"><a href="#__codelineno-15-6">6</a></span>
<span class="normal"><a href="#__codelineno-15-7">7</a></span>
<span class="normal"><a href="#__codelineno-15-8">8</a></span>
<span class="normal"><a href="#__codelineno-15-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="nx">describe</span><span class="p">(</span><span class="s2">&quot;When converting a Command to an Action&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-15-2" name="__codelineno-15-2"></a><span class="w">  </span><span class="nx">it</span><span class="p">(</span><span class="s2">&quot;and the command is MoveForward, then the right action is returned&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-15-3" name="__codelineno-15-3"></a>
<a id="__codelineno-15-4" name="__codelineno-15-4"></a><span class="w">    </span><span class="c1">// have to convert result as a jest.Mock to make TypeScript happy</span>
<a id="__codelineno-15-5" name="__codelineno-15-5"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">convertCommandToAction</span><span class="p">(</span><span class="s2">&quot;MoveForward&quot;</span><span class="p">)</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">unknown</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">Jest</span><span class="p">.</span><span class="nx">Mock</span><span class="p">;</span>
<a id="__codelineno-15-6" name="__codelineno-15-6"></a>
<a id="__codelineno-15-7" name="__codelineno-15-7"></a><span class="w">    </span><span class="nx">expect</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">getMockName</span><span class="p">()).</span><span class="nx">toBe</span><span class="p">(</span><span class="s2">&quot;moveForward&quot;</span><span class="p">);</span>
<a id="__codelineno-15-8" name="__codelineno-15-8"></a><span class="w">  </span><span class="p">});</span>
<a id="__codelineno-15-9" name="__codelineno-15-9"></a><span class="p">});</span>
</code></pre></div></td></tr></table></div>
<h3 id="wrapping-up"><a class="toclink" href="../../../../2024/08/19/today-i-learned---leveraging-mock-names-with-jest/#wrapping-up">Wrapping Up</a></h3>
<p>If you find yourself writing functions that return other function (i.e., leveraging functional programming concepts), then you check out using <code>mockName</code> for keeping track of which functions are being returned.</p>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/cameronpresley.png" alt="Cameron Presley">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2024-06-13 00:00:00+00:00">Jun 13, 2024</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../../" class="md-meta__link">TypeScript</a>, 
              <a href="../../../today-i-learned/" class="md-meta__link">Today I Learned</a></li>
        
        
          
          <li class="md-meta__item">
            
              7 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="today-i-learned-validating-data-in-zod"><a class="toclink" href="../../../../2024/06/13/today-i-learned-validating-data-in-zod/">Today I Learned: Validating Data in Zod</a></h2>
<p>Validating input. You've got to do it, otherwise, you're going to be processing garbage, and that never goes well, right?</p>
<p>Whether it's through the front-end (via a form) or through the back-end (via an API call), it's important to make sure that the data we're processing is valid.</p>
<p>Coming from a C# background, I was used to ASP.NET Web Api's ability to create a class and then use the <a href="https://learn.microsoft.com/en-us/aspnet/core/mvc/models/model-binding?view=aspnetcore-8.0#frombody-attribute"><code>FromBody attribute</code></a> for the appropriate route to ensure the data is good. By using this approach, ASP.NET will reject requests automatically that don't fit the data contract.</p>
<p>However, picking up JavaScript and TypeScript, that's not the case. At first, this surprised me because I figured that this would automatically happen when using libraries like Express or Nest.js. Thinking more about it, though, it shouldn't have surprised me. ASP.NET can catch those issues because it's a statically typed/ran language. JavaScript isn't and since TypeScript types are removed during the compilation phase, neither is statically typed at <em>runtime</em>.</p>
<p>When writing validations, I find <a href="https://github.com/colinhacks/zod">zod</a> to be a delightful library to leverage. There are a ton of useful built-in options, you can create your own validators (which you can then compose!) and you can infer models based off of your validations.</p>
<h3 id="building-the-amazin-bookstore"><a class="toclink" href="../../../../2024/06/13/today-i-learned-validating-data-in-zod/#building-the-amazin-bookstore">Building the Amazin' Bookstore</a></h3>
<p>To demonstrate some of the cool things that you can do with Zod, let's pretend that we're building out a new POST endpoint for creating a new book. After talking to the business, we determine that the payload for a new book should look like this:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-72-1">1</a></span>
<span class="normal"><a href="#__codelineno-72-2">2</a></span>
<span class="normal"><a href="#__codelineno-72-3">3</a></span>
<span class="normal"><a href="#__codelineno-72-4">4</a></span>
<span class="normal"><a href="#__codelineno-72-5">5</a></span>
<span class="normal"><a href="#__codelineno-72-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-72-1" name="__codelineno-72-1"></a><span class="c1">// A valid book will have the following</span>
<a id="__codelineno-72-2" name="__codelineno-72-2"></a><span class="c1">// - A non-empty title</span>
<a id="__codelineno-72-3" name="__codelineno-72-3"></a><span class="c1">// - A numeric price (can&#39;t be negative or zero)</span>
<a id="__codelineno-72-4" name="__codelineno-72-4"></a><span class="c1">// - A genre from a list of possibilities (mystery, fantasy, history are examples, platypus would not be valid)</span>
<a id="__codelineno-72-5" name="__codelineno-72-5"></a><span class="c1">// - An ISBN which must be in a particular format</span>
<a id="__codelineno-72-6" name="__codelineno-72-6"></a><span class="c1">// - A valid author which must have a first name, a last name, and an optional middle name</span>
</code></pre></div></td></tr></table></div>
<h4 id="whats-in-a-name"><a class="toclink" href="../../../../2024/06/13/today-i-learned-validating-data-in-zod/#whats-in-a-name">What's in a Name?</a></h4>
<p>Since the <code>Book</code> type needs a valid <code>Author</code>, let's build that out first:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-73-1">1</a></span>
<span class="normal"><a href="#__codelineno-73-2">2</a></span>
<span class="normal"><a href="#__codelineno-73-3">3</a></span>
<span class="normal"><a href="#__codelineno-73-4">4</a></span>
<span class="normal"><a href="#__codelineno-73-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-73-1" name="__codelineno-73-1"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="nx">z</span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;zod&quot;</span><span class="p">;</span>
<a id="__codelineno-73-2" name="__codelineno-73-2"></a>
<a id="__codelineno-73-3" name="__codelineno-73-3"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">AuthorSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<a id="__codelineno-73-4" name="__codelineno-73-4"></a>
<a id="__codelineno-73-5" name="__codelineno-73-5"></a><span class="p">});</span>
</code></pre></div></td></tr></table></div>
<p>Since <code>Author</code> will need to be an object, we'll use <code>z.object</code> to signify that. Right off the bat, this prevents a string, number, or other primitive types from being accepted.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-74-1">1</a></span>
<span class="normal"><a href="#__codelineno-74-2">2</a></span>
<span class="normal"><a href="#__codelineno-74-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-74-1" name="__codelineno-74-1"></a><span class="nx">AuthorSchema</span><span class="p">.</span><span class="nx">safeParse</span><span class="p">(</span><span class="s2">&quot;someString&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// will result in a failure</span>
<a id="__codelineno-74-2" name="__codelineno-74-2"></a><span class="nx">AuthorSchema</span><span class="p">.</span><span class="nx">safeParse</span><span class="p">(</span><span class="mf">42</span><span class="p">);</span><span class="w"> </span><span class="c1">// will result in a failure</span>
<a id="__codelineno-74-3" name="__codelineno-74-3"></a><span class="nx">AuthorSchema</span><span class="p">.</span><span class="nx">safeParse</span><span class="p">({});</span><span class="w"> </span><span class="c1">// will result in success!</span>
</code></pre></div></td></tr></table></div>
<p>This is a great start, but we know that Author has some required properties (like a first name), so let's implement that by using <code>z.string()</code></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-75-1">1</a></span>
<span class="normal"><a href="#__codelineno-75-2">2</a></span>
<span class="normal"><a href="#__codelineno-75-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-75-1" name="__codelineno-75-1"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">AuthorSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<a id="__codelineno-75-2" name="__codelineno-75-2"></a><span class="w">    </span><span class="nx">firstName</span><span class="o">:</span><span class="w"> </span><span class="kt">z.string</span><span class="p">()</span>
<a id="__codelineno-75-3" name="__codelineno-75-3"></a><span class="p">});</span>
</code></pre></div></td></tr></table></div>
<p>With this change, let's take a look at our schema validation</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-76-1">1</a></span>
<span class="normal"><a href="#__codelineno-76-2">2</a></span>
<span class="normal"><a href="#__codelineno-76-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-76-1" name="__codelineno-76-1"></a><span class="nx">AuthorSchema</span><span class="p">.</span><span class="nx">safeParse</span><span class="p">({});</span><span class="w"> </span><span class="c1">// fails because no firstName property</span>
<a id="__codelineno-76-2" name="__codelineno-76-2"></a><span class="nx">AuthorSchema</span><span class="p">.</span><span class="nx">safeParse</span><span class="p">({</span><span class="nx">firstName</span><span class="o">:</span><span class="kt">42</span><span class="p">});</span><span class="w"> </span><span class="c1">// fails because firstName is not a string</span>
<a id="__codelineno-76-3" name="__codelineno-76-3"></a><span class="nx">AuthorSchema</span><span class="p">.</span><span class="nx">safeParse</span><span class="p">({</span><span class="nx">firstName</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Cameron&quot;</span><span class="p">});</span><span class="w"> </span><span class="c1">// succeeds because firstName is present and a string</span>
</code></pre></div></td></tr></table></div>
<p>However, there's one problem with our validation. We would allow an empty <code>firstName</code></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-77-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-77-1" name="__codelineno-77-1"></a><span class="nx">AuthorSchema</span><span class="p">.</span><span class="nx">safeParse</span><span class="p">({</span><span class="nx">firstName</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">});</span><span class="w"> </span><span class="c1">// succeeds, but should have failed :(</span>
</code></pre></div></td></tr></table></div>
<p>To make our validation stronger, we can update our <code>firstName</code> property to have a minimum length of 1 like so.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-78-1">1</a></span>
<span class="normal"><a href="#__codelineno-78-2">2</a></span>
<span class="normal"><a href="#__codelineno-78-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-78-1" name="__codelineno-78-1"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">AuthorSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<a id="__codelineno-78-2" name="__codelineno-78-2"></a><span class="w">    </span><span class="nx">firstName</span><span class="o">:</span><span class="w"> </span><span class="kt">z.string</span><span class="p">().</span><span class="nx">min</span><span class="p">(</span><span class="mf">1</span><span class="p">)</span>
<a id="__codelineno-78-3" name="__codelineno-78-3"></a><span class="p">});</span>
</code></pre></div></td></tr></table></div>
<p>Finally, we have a way to enforce that an author has a non-empty firstName!. Looking at the requirements, it seems like <code>lastName</code> is going to be similar, so let's update our <code>AuthorSchema</code> to include lastName.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-79-1">1</a></span>
<span class="normal"><a href="#__codelineno-79-2">2</a></span>
<span class="normal"><a href="#__codelineno-79-3">3</a></span>
<span class="normal"><a href="#__codelineno-79-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-79-1" name="__codelineno-79-1"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">AuthorSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<a id="__codelineno-79-2" name="__codelineno-79-2"></a><span class="w">    </span><span class="nx">firstName</span><span class="o">:</span><span class="w"> </span><span class="kt">z.string</span><span class="p">().</span><span class="nx">min</span><span class="p">(</span><span class="mf">1</span><span class="p">),</span>
<a id="__codelineno-79-3" name="__codelineno-79-3"></a><span class="w">    </span><span class="nx">lastName</span><span class="o">:</span><span class="w"> </span><span class="kt">z.string</span><span class="p">().</span><span class="nx">min</span><span class="p">(</span><span class="mf">1</span><span class="p">)</span>
<a id="__codelineno-79-4" name="__codelineno-79-4"></a><span class="p">});</span>
</code></pre></div></td></tr></table></div>
<p>Hmmm, it looks like we have the same concept in multiple places, the idea of a non empty string. Let's refactor that to its own schema.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-80-1">1</a></span>
<span class="normal"><a href="#__codelineno-80-2">2</a></span>
<span class="normal"><a href="#__codelineno-80-3">3</a></span>
<span class="normal"><a href="#__codelineno-80-4">4</a></span>
<span class="normal"><a href="#__codelineno-80-5">5</a></span>
<span class="normal"><a href="#__codelineno-80-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-80-1" name="__codelineno-80-1"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">NonEmptyStringSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="kt">string</span><span class="p">().</span><span class="nx">min</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>
<a id="__codelineno-80-2" name="__codelineno-80-2"></a>
<a id="__codelineno-80-3" name="__codelineno-80-3"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">AuthorSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<a id="__codelineno-80-4" name="__codelineno-80-4"></a><span class="w">    </span><span class="nx">firstName</span><span class="o">:</span><span class="w"> </span><span class="kt">NonEmptyStringSchema</span><span class="p">,</span>
<a id="__codelineno-80-5" name="__codelineno-80-5"></a><span class="w">    </span><span class="nx">lastName</span><span class="o">:</span><span class="w"> </span><span class="kt">NonEmptyStringSchema</span>
<a id="__codelineno-80-6" name="__codelineno-80-6"></a><span class="p">});</span>
</code></pre></div></td></tr></table></div>
<p>Nice! We're almost done with <code>Author</code>, we need to implement <code>middleName</code>. Unlike the other properties, an author may not have a middle name. In this case, we're going to leverage the <code>optional</code> function from zod to signify that as so.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-81-1">1</a></span>
<span class="normal"><a href="#__codelineno-81-2">2</a></span>
<span class="normal"><a href="#__codelineno-81-3">3</a></span>
<span class="normal"><a href="#__codelineno-81-4">4</a></span>
<span class="normal"><a href="#__codelineno-81-5">5</a></span>
<span class="normal"><a href="#__codelineno-81-6">6</a></span>
<span class="normal"><a href="#__codelineno-81-7">7</a></span>
<span class="normal"><a href="#__codelineno-81-8">8</a></span>
<span class="normal"><a href="#__codelineno-81-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-81-1" name="__codelineno-81-1"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">NonEmptyStringSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="kt">string</span><span class="p">().</span><span class="nx">min</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>
<a id="__codelineno-81-2" name="__codelineno-81-2"></a>
<a id="__codelineno-81-3" name="__codelineno-81-3"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">AuthorSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<a id="__codelineno-81-4" name="__codelineno-81-4"></a><span class="w">    </span><span class="nx">firstName</span><span class="o">:</span><span class="w"> </span><span class="kt">NonEmptyStringSchema</span><span class="p">,</span>
<a id="__codelineno-81-5" name="__codelineno-81-5"></a><span class="w">    </span><span class="nx">lastName</span><span class="o">:</span><span class="w"> </span><span class="kt">NonEmptyStringSchema</span><span class="p">,</span>
<a id="__codelineno-81-6" name="__codelineno-81-6"></a><span class="w">    </span><span class="c1">// This would read that middleName may or not may be present. </span>
<a id="__codelineno-81-7" name="__codelineno-81-7"></a><span class="w">    </span><span class="c1">// If it is, then it must be a string (could be empty)</span>
<a id="__codelineno-81-8" name="__codelineno-81-8"></a><span class="w">    </span><span class="nx">middleName</span><span class="o">:</span><span class="w"> </span><span class="kt">z.string</span><span class="p">().</span><span class="nx">optional</span><span class="p">(),</span><span class="w"> </span>
<a id="__codelineno-81-9" name="__codelineno-81-9"></a><span class="p">});</span>
</code></pre></div></td></tr></table></div>
<p>With the implementation of <code>AuthorSchema</code>, we can start working on the <code>BookSchema</code>.</p>
<h4 id="judging-a-book-by-its-cover"><a class="toclink" href="../../../../2024/06/13/today-i-learned-validating-data-in-zod/#judging-a-book-by-its-cover">Judging a Book By It's Cover</a></h4>
<p>Since we have <code>AuthorSchema</code>, we can use that as our start as so:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-82-1">1</a></span>
<span class="normal"><a href="#__codelineno-82-2">2</a></span>
<span class="normal"><a href="#__codelineno-82-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-82-1" name="__codelineno-82-1"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">BookSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<a id="__codelineno-82-2" name="__codelineno-82-2"></a><span class="w">    </span><span class="nx">author</span><span class="o">:</span><span class="w"> </span><span class="kt">AuthorSchema</span>
<a id="__codelineno-82-3" name="__codelineno-82-3"></a><span class="p">});</span>
</code></pre></div></td></tr></table></div>
<p>We know that a book must have a non-empty title, so let's add that to our definition. Since it's a string that must have at least one character, we can reuse the <code>NonEmptyStringSchema</code> definition from before.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-83-1">1</a></span>
<span class="normal"><a href="#__codelineno-83-2">2</a></span>
<span class="normal"><a href="#__codelineno-83-3">3</a></span>
<span class="normal"><a href="#__codelineno-83-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-83-1" name="__codelineno-83-1"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">BookSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<a id="__codelineno-83-2" name="__codelineno-83-2"></a><span class="w">    </span><span class="nx">author</span><span class="o">:</span><span class="w"> </span><span class="kt">AuthorSchema</span><span class="p">,</span>
<a id="__codelineno-83-3" name="__codelineno-83-3"></a><span class="w">    </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="kt">NonEmptyStringSchema</span>
<a id="__codelineno-83-4" name="__codelineno-83-4"></a><span class="p">});</span>
</code></pre></div></td></tr></table></div>
<h4 id="putting-a-price-on-knowledge"><a class="toclink" href="../../../../2024/06/13/today-i-learned-validating-data-in-zod/#putting-a-price-on-knowledge">Putting a Price on Knowledge</a></h4>
<p>With title in place, let's leave the string theory alone for a bit and look at numbers. In order for the bookstore to function, we've got sell books for some price. Let's use <code>z.number()</code> and add a <code>price</code> property.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-84-1">1</a></span>
<span class="normal"><a href="#__codelineno-84-2">2</a></span>
<span class="normal"><a href="#__codelineno-84-3">3</a></span>
<span class="normal"><a href="#__codelineno-84-4">4</a></span>
<span class="normal"><a href="#__codelineno-84-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-84-1" name="__codelineno-84-1"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">BookSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<a id="__codelineno-84-2" name="__codelineno-84-2"></a><span class="w">    </span><span class="nx">author</span><span class="o">:</span><span class="w"> </span><span class="kt">AuthorSchema</span><span class="p">,</span>
<a id="__codelineno-84-3" name="__codelineno-84-3"></a><span class="w">    </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="kt">NonEmptyStringSchema</span><span class="p">,</span>
<a id="__codelineno-84-4" name="__codelineno-84-4"></a><span class="w">    </span><span class="nx">price</span><span class="o">:</span><span class="w"> </span><span class="kt">z.number</span><span class="p">()</span>
<a id="__codelineno-84-5" name="__codelineno-84-5"></a><span class="p">});</span>
</code></pre></div></td></tr></table></div>
<p>This works, however, <code>z.number()</code> will accept <em>any</em> number, which includes numbers like <code>0</code> and <code>-5</code>. While those values would be great for the customer, we can't run our business that way. So let's update our price to only include positive numbers, which can be accomplished by leveraging the <code>positive</code> function.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-85-1">1</a></span>
<span class="normal"><a href="#__codelineno-85-2">2</a></span>
<span class="normal"><a href="#__codelineno-85-3">3</a></span>
<span class="normal"><a href="#__codelineno-85-4">4</a></span>
<span class="normal"><a href="#__codelineno-85-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-85-1" name="__codelineno-85-1"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">BookSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<a id="__codelineno-85-2" name="__codelineno-85-2"></a><span class="w">    </span><span class="nx">author</span><span class="o">:</span><span class="w"> </span><span class="kt">AuthorSchema</span><span class="p">,</span>
<a id="__codelineno-85-3" name="__codelineno-85-3"></a><span class="w">    </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="kt">NonEmptyStringSchema</span><span class="p">,</span>
<a id="__codelineno-85-4" name="__codelineno-85-4"></a><span class="w">    </span><span class="nx">price</span><span class="o">:</span><span class="w"> </span><span class="kt">z.number</span><span class="p">().</span><span class="nx">positive</span><span class="p">()</span>
<a id="__codelineno-85-5" name="__codelineno-85-5"></a><span class="p">});</span>
</code></pre></div></td></tr></table></div>
<p>With price done, let's look at validating the genre.</p>
<h4 id="would-you-say-its-a-mystery-or-history"><a class="toclink" href="../../../../2024/06/13/today-i-learned-validating-data-in-zod/#would-you-say-its-a-mystery-or-history">Would You Say It's a Mystery or History?</a></h4>
<p>Up to this point, all of our properties have been straightforward (simple strings and numbers). However, with <code>genre</code>, things get more complicated because it can only be one of a particular set of values. Thankfully, we can define a <code>GenreSchema</code> by using <code>z.enum()</code> like so. </p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-86-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-86-1" name="__codelineno-86-1"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">GenreSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="kd">enum</span><span class="p">([</span><span class="s2">&quot;Fantasy&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;History&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Mystery&quot;</span><span class="p">]);</span>
</code></pre></div></td></tr></table></div>
<p>With this definition, a valid genre can <em>only be</em> fantasy, history, or mystery. Let's update our book definition to use this new schema.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-87-1">1</a></span>
<span class="normal"><a href="#__codelineno-87-2">2</a></span>
<span class="normal"><a href="#__codelineno-87-3">3</a></span>
<span class="normal"><a href="#__codelineno-87-4">4</a></span>
<span class="normal"><a href="#__codelineno-87-5">5</a></span>
<span class="normal"><a href="#__codelineno-87-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-87-1" name="__codelineno-87-1"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">BookSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<a id="__codelineno-87-2" name="__codelineno-87-2"></a><span class="w">    </span><span class="nx">author</span><span class="o">:</span><span class="w"> </span><span class="kt">AuthorSchema</span><span class="p">,</span>
<a id="__codelineno-87-3" name="__codelineno-87-3"></a><span class="w">    </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="kt">NonEmptyStringSchema</span><span class="p">,</span>
<a id="__codelineno-87-4" name="__codelineno-87-4"></a><span class="w">    </span><span class="nx">price</span><span class="o">:</span><span class="w"> </span><span class="kt">z.number</span><span class="p">().</span><span class="nx">positive</span><span class="p">(),</span>
<a id="__codelineno-87-5" name="__codelineno-87-5"></a><span class="w">    </span><span class="nx">genre</span><span class="o">:</span><span class="w"> </span><span class="kt">GenreSchema</span>
<a id="__codelineno-87-6" name="__codelineno-87-6"></a><span class="p">});</span>
</code></pre></div></td></tr></table></div>
<p>Now, someone can't POST a book with a genre of "platypus" (though I'd enjoy reading such a book).</p>
<h4 id="id-please"><a class="toclink" href="../../../../2024/06/13/today-i-learned-validating-data-in-zod/#id-please">ID Please</a></h4>
<p>Last, let's take a look at implementing the <code>isbn</code> property. This is interesting because ISBNs can be in one of two shapes: ISBN-10 (for books pre-2007) and ISBN-13 (all other books).</p>
<p>To make this problem easier, let's focus on the ISBN-10 format for now. A valid value will be in the form of <code>#-###-#####-#</code> (where # is a number). Now, you can <a href="https://en.wikipedia.org/wiki/ISBN#ISBN-10_check_digit_calculation">take this a whole lot further</a>, but we'll keep on the format.</p>
<p>Now, even though <code>zod</code> has built-in validators for emails, ips, and urls, there's not a built-in one for ISBNs. In these cases, we can use <code>.refine</code> to add our logic. But this is a good use case for a basic regular expression. Using <a href="https://regex101.com/">regex101</a> as a guide, we end up with the following expression and schema for the ISBN.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-88-1">1</a></span>
<span class="normal"><a href="#__codelineno-88-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-88-1" name="__codelineno-88-1"></a><span class="kd">const</span><span class="w"> </span><span class="nx">isbn10Regex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sr">/^\d-\d{3}-\d{5}-\d/</span><span class="p">;</span>
<a id="__codelineno-88-2" name="__codelineno-88-2"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">Isbn10Schema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="kt">string</span><span class="p">().</span><span class="nx">regex</span><span class="p">(</span><span class="nx">isbn10Regex</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<p>Building onto that, an ISBN-13 is in a similar format, but has the form of <code>###-#-##-######-#</code>. By tweaking our regex, we end up with the following:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-89-1">1</a></span>
<span class="normal"><a href="#__codelineno-89-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-89-1" name="__codelineno-89-1"></a><span class="kd">const</span><span class="w"> </span><span class="nx">isbn13Regex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sr">/^\d{3}-\d-\d{2}-\d{6}-\d/</span><span class="p">;</span>
<a id="__codelineno-89-2" name="__codelineno-89-2"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">Isbn13Schema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="kt">string</span><span class="p">().</span><span class="nx">regex</span><span class="p">(</span><span class="nx">isbn13Regex</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<p>When modeling types in TypeScript, I'd like to be able to do something like the following as this makes it clear that an ISBN can in one of these two shapes.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-90-1">1</a></span>
<span class="normal"><a href="#__codelineno-90-2">2</a></span>
<span class="normal"><a href="#__codelineno-90-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-90-1" name="__codelineno-90-1"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Isbn10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<a id="__codelineno-90-2" name="__codelineno-90-2"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Isbn13</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<a id="__codelineno-90-3" name="__codelineno-90-3"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Isbn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Isbn10</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nx">Isbn13</span><span class="p">;</span>
</code></pre></div></td></tr></table></div>
<p>While we can't use the <code>|</code> operator, we can use the <code>.or</code> function from zod to have the following</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-91-1">1</a></span>
<span class="normal"><a href="#__codelineno-91-2">2</a></span>
<span class="normal"><a href="#__codelineno-91-3">3</a></span>
<span class="normal"><a href="#__codelineno-91-4">4</a></span>
<span class="normal"><a href="#__codelineno-91-5">5</a></span>
<span class="normal"><a href="#__codelineno-91-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-91-1" name="__codelineno-91-1"></a><span class="kd">const</span><span class="w"> </span><span class="nx">isbn10Regex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sr">/^\d-\d{3}-\d{5}-\d/</span><span class="p">;</span>
<a id="__codelineno-91-2" name="__codelineno-91-2"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">Isbn10Schema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="kt">string</span><span class="p">().</span><span class="nx">regex</span><span class="p">(</span><span class="nx">isbn10Regex</span><span class="p">);</span>
<a id="__codelineno-91-3" name="__codelineno-91-3"></a><span class="kd">const</span><span class="w"> </span><span class="nx">isbn13Regex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sr">/^\d{3}-\d-\d{2}-\d{6}-\d/</span><span class="p">;</span>
<a id="__codelineno-91-4" name="__codelineno-91-4"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">Isbn13Schema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="kt">string</span><span class="p">().</span><span class="nx">regex</span><span class="p">(</span><span class="nx">isbn13Regex</span><span class="p">);</span>
<a id="__codelineno-91-5" name="__codelineno-91-5"></a>
<a id="__codelineno-91-6" name="__codelineno-91-6"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">IsbnSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Isbn10Schema</span><span class="p">.</span><span class="nx">or</span><span class="p">(</span><span class="nx">Isbn13Schema</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<p>With the <code>IsbnSchema</code> in place, let's add it to <code>BookSchema</code></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-92-1">1</a></span>
<span class="normal"><a href="#__codelineno-92-2">2</a></span>
<span class="normal"><a href="#__codelineno-92-3">3</a></span>
<span class="normal"><a href="#__codelineno-92-4">4</a></span>
<span class="normal"><a href="#__codelineno-92-5">5</a></span>
<span class="normal"><a href="#__codelineno-92-6">6</a></span>
<span class="normal"><a href="#__codelineno-92-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-92-1" name="__codelineno-92-1"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">BookSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<a id="__codelineno-92-2" name="__codelineno-92-2"></a><span class="w">    </span><span class="nx">author</span><span class="o">:</span><span class="w"> </span><span class="kt">AuthorSchema</span><span class="p">,</span>
<a id="__codelineno-92-3" name="__codelineno-92-3"></a><span class="w">    </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="kt">NonEmptyStringSchema</span><span class="p">,</span>
<a id="__codelineno-92-4" name="__codelineno-92-4"></a><span class="w">    </span><span class="nx">price</span><span class="o">:</span><span class="w"> </span><span class="kt">z.number</span><span class="p">().</span><span class="nx">positive</span><span class="p">(),</span>
<a id="__codelineno-92-5" name="__codelineno-92-5"></a><span class="w">    </span><span class="nx">genre</span><span class="o">:</span><span class="w"> </span><span class="kt">GenreSchema</span>
<a id="__codelineno-92-6" name="__codelineno-92-6"></a><span class="w">    </span><span class="nx">isbn</span><span class="o">:</span><span class="w"> </span><span class="kt">IsbnSchema</span>
<a id="__codelineno-92-7" name="__codelineno-92-7"></a><span class="p">});</span>
</code></pre></div></td></tr></table></div>
<h4 id="getting-models-for-free"><a class="toclink" href="../../../../2024/06/13/today-i-learned-validating-data-in-zod/#getting-models-for-free">Getting Models for Free</a></h4>
<p>Lastly, one of the cooler functions that zod supports is <code>infer</code> where if you pass it a schema, it can build out a type for you to use in your application. </p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-93-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-93-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-93-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-93-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-93-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-93-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-93-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-93-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-93-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-93-10">10</a></span>
<span class="normal"><a href="#__codelineno-93-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-93-1" name="__codelineno-93-1"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">BookSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<a id="__codelineno-93-2" name="__codelineno-93-2"></a><span class="w">    </span><span class="nx">author</span><span class="o">:</span><span class="w"> </span><span class="kt">AuthorSchema</span><span class="p">,</span>
<a id="__codelineno-93-3" name="__codelineno-93-3"></a><span class="w">    </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="kt">NonEmptyStringSchema</span><span class="p">,</span>
<a id="__codelineno-93-4" name="__codelineno-93-4"></a><span class="w">    </span><span class="nx">price</span><span class="o">:</span><span class="w"> </span><span class="kt">z.number</span><span class="p">().</span><span class="nx">positive</span><span class="p">(),</span>
<a id="__codelineno-93-5" name="__codelineno-93-5"></a><span class="w">    </span><span class="nx">genre</span><span class="o">:</span><span class="w"> </span><span class="kt">GenreSchema</span>
<a id="__codelineno-93-6" name="__codelineno-93-6"></a><span class="w">    </span><span class="nx">isbn</span><span class="o">:</span><span class="w"> </span><span class="kt">IsbnSchema</span>
<a id="__codelineno-93-7" name="__codelineno-93-7"></a><span class="p">});</span>
<a id="__codelineno-93-8" name="__codelineno-93-8"></a>
<a id="__codelineno-93-9" name="__codelineno-93-9"></a><span class="c1">// TypeScript knows that Book must have an author (which has a firstName, lastName, and maybe a middleName)</span>
<a id="__codelineno-93-10" name="__codelineno-93-10"></a><span class="c1">// a title (string), a price (number), a genre (string), and an isbn (string).</span>
<a id="__codelineno-93-11" name="__codelineno-93-11"></a><span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">Book</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">infer</span><span class="o">&lt;</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">BookSchema</span><span class="o">&gt;</span><span class="p">;</span><span class="w"> </span>
</code></pre></div></td></tr></table></div>
<h3 id="full-solution"><a class="toclink" href="../../../../2024/06/13/today-i-learned-validating-data-in-zod/#full-solution">Full Solution</a></h3>
<p>Here's what the full solution looks like</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-94-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-94-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-94-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-94-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-94-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-94-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-94-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-94-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-94-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-94-10">10</a></span>
<span class="normal"><a href="#__codelineno-94-11">11</a></span>
<span class="normal"><a href="#__codelineno-94-12">12</a></span>
<span class="normal"><a href="#__codelineno-94-13">13</a></span>
<span class="normal"><a href="#__codelineno-94-14">14</a></span>
<span class="normal"><a href="#__codelineno-94-15">15</a></span>
<span class="normal"><a href="#__codelineno-94-16">16</a></span>
<span class="normal"><a href="#__codelineno-94-17">17</a></span>
<span class="normal"><a href="#__codelineno-94-18">18</a></span>
<span class="normal"><a href="#__codelineno-94-19">19</a></span>
<span class="normal"><a href="#__codelineno-94-20">20</a></span>
<span class="normal"><a href="#__codelineno-94-21">21</a></span>
<span class="normal"><a href="#__codelineno-94-22">22</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-94-1" name="__codelineno-94-1"></a><span class="kd">const</span><span class="w"> </span><span class="nx">NonEmptyStringSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="kt">string</span><span class="p">().</span><span class="nx">min</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>
<a id="__codelineno-94-2" name="__codelineno-94-2"></a><span class="kd">const</span><span class="w"> </span><span class="nx">GenreSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="kd">enum</span><span class="p">([</span><span class="s2">&quot;Fantasy&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;History&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Mystery&quot;</span><span class="p">]);</span>
<a id="__codelineno-94-3" name="__codelineno-94-3"></a>
<a id="__codelineno-94-4" name="__codelineno-94-4"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">AuthorSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<a id="__codelineno-94-5" name="__codelineno-94-5"></a><span class="w">  </span><span class="nx">firstName</span><span class="o">:</span><span class="w"> </span><span class="kt">NonEmptyString</span><span class="p">,</span>
<a id="__codelineno-94-6" name="__codelineno-94-6"></a><span class="w">  </span><span class="nx">lastName</span><span class="o">:</span><span class="w"> </span><span class="kt">NonEmptyString</span><span class="p">,</span>
<a id="__codelineno-94-7" name="__codelineno-94-7"></a><span class="w">  </span><span class="nx">middleName</span><span class="o">:</span><span class="w"> </span><span class="kt">z.string</span><span class="p">().</span><span class="nx">optional</span><span class="p">(),</span>
<a id="__codelineno-94-8" name="__codelineno-94-8"></a><span class="p">});</span>
<a id="__codelineno-94-9" name="__codelineno-94-9"></a>
<a id="__codelineno-94-10" name="__codelineno-94-10"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">Isbn10Schema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="kt">string</span><span class="p">().</span><span class="nx">regex</span><span class="p">(</span><span class="sr">/^\d-\d{2}-\d{6}-\d/</span><span class="p">);</span>
<a id="__codelineno-94-11" name="__codelineno-94-11"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">Isbn13Schema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="kt">string</span><span class="p">().</span><span class="nx">regex</span><span class="p">(</span><span class="sr">/^\d{3}-\d-\d{2}-\d{6}-\d/</span><span class="p">);</span>
<a id="__codelineno-94-12" name="__codelineno-94-12"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">IsbnSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Isbn10Schema</span><span class="p">.</span><span class="nx">or</span><span class="p">(</span><span class="nx">Isbn13Schema</span><span class="p">);</span>
<a id="__codelineno-94-13" name="__codelineno-94-13"></a>
<a id="__codelineno-94-14" name="__codelineno-94-14"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">BookSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<a id="__codelineno-94-15" name="__codelineno-94-15"></a><span class="w">  </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="kt">NonEmptyString</span><span class="p">,</span>
<a id="__codelineno-94-16" name="__codelineno-94-16"></a><span class="w">  </span><span class="nx">author</span><span class="o">:</span><span class="w"> </span><span class="kt">AuthorSchema</span><span class="p">,</span>
<a id="__codelineno-94-17" name="__codelineno-94-17"></a><span class="w">  </span><span class="nx">price</span><span class="o">:</span><span class="w"> </span><span class="kt">z.number</span><span class="p">().</span><span class="nx">positive</span><span class="p">(),</span>
<a id="__codelineno-94-18" name="__codelineno-94-18"></a><span class="w">  </span><span class="nx">genre</span><span class="o">:</span><span class="w"> </span><span class="kt">GenreSchema</span><span class="p">,</span>
<a id="__codelineno-94-19" name="__codelineno-94-19"></a><span class="w">  </span><span class="nx">isbn</span><span class="o">:</span><span class="w"> </span><span class="kt">IsbnSchema</span><span class="p">,</span>
<a id="__codelineno-94-20" name="__codelineno-94-20"></a><span class="p">});</span>
<a id="__codelineno-94-21" name="__codelineno-94-21"></a>
<a id="__codelineno-94-22" name="__codelineno-94-22"></a><span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">Book</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">infer</span><span class="o">&lt;</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">BookSchema</span><span class="o">&gt;</span><span class="p">;</span>
</code></pre></div></td></tr></table></div>
<p>With these schemas and models defined, we can leverage the <code>safeParse</code> function to see if our input is valid.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-95-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-95-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-95-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-95-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-95-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-95-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-95-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-95-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-95-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-95-10">10</a></span>
<span class="normal"><a href="#__codelineno-95-11">11</a></span>
<span class="normal"><a href="#__codelineno-95-12">12</a></span>
<span class="normal"><a href="#__codelineno-95-13">13</a></span>
<span class="normal"><a href="#__codelineno-95-14">14</a></span>
<span class="normal"><a href="#__codelineno-95-15">15</a></span>
<span class="normal"><a href="#__codelineno-95-16">16</a></span>
<span class="normal"><a href="#__codelineno-95-17">17</a></span>
<span class="normal"><a href="#__codelineno-95-18">18</a></span>
<span class="normal"><a href="#__codelineno-95-19">19</a></span>
<span class="normal"><a href="#__codelineno-95-20">20</a></span>
<span class="normal"><a href="#__codelineno-95-21">21</a></span>
<span class="normal"><a href="#__codelineno-95-22">22</a></span>
<span class="normal"><a href="#__codelineno-95-23">23</a></span>
<span class="normal"><a href="#__codelineno-95-24">24</a></span>
<span class="normal"><a href="#__codelineno-95-25">25</a></span>
<span class="normal"><a href="#__codelineno-95-26">26</a></span>
<span class="normal"><a href="#__codelineno-95-27">27</a></span>
<span class="normal"><a href="#__codelineno-95-28">28</a></span>
<span class="normal"><a href="#__codelineno-95-29">29</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-95-1" name="__codelineno-95-1"></a><span class="nx">describe</span><span class="p">(</span><span class="s1">&#39;when validating a book&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-95-2" name="__codelineno-95-2"></a><span class="w">    </span><span class="nx">it</span><span class="p">(</span><span class="s2">&quot;and the author is missing, then it&#39;s not valid&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-95-3" name="__codelineno-95-3"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">input</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="nx">title</span><span class="o">:</span><span class="s2">&quot;best book&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">price</span><span class="o">:</span><span class="kt">200</span><span class="p">,</span><span class="w"> </span><span class="nx">genre</span><span class="o">:</span><span class="s2">&quot;History&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">isbn</span><span class="o">:</span><span class="s2">&quot;1-23-456789-0&quot;</span><span class="p">}</span>
<a id="__codelineno-95-4" name="__codelineno-95-4"></a>
<a id="__codelineno-95-5" name="__codelineno-95-5"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">BookSchema</span><span class="p">.</span><span class="nx">safeParse</span><span class="p">(</span><span class="nx">input</span><span class="p">);</span>
<a id="__codelineno-95-6" name="__codelineno-95-6"></a>
<a id="__codelineno-95-7" name="__codelineno-95-7"></a><span class="w">        </span><span class="nx">expect</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">success</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<a id="__codelineno-95-8" name="__codelineno-95-8"></a><span class="w">    </span><span class="p">});</span>
<a id="__codelineno-95-9" name="__codelineno-95-9"></a><span class="w">    </span><span class="nx">it</span><span class="p">(</span><span class="s2">&quot;and all the fields are valid, then the book is valid&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-95-10" name="__codelineno-95-10"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">input</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-95-11" name="__codelineno-95-11"></a><span class="w">            </span><span class="nx">title</span><span class="o">:</span><span class="s2">&quot;best book&quot;</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-95-12" name="__codelineno-95-12"></a><span class="w">            </span><span class="nx">price</span><span class="o">:</span><span class="kt">200</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-95-13" name="__codelineno-95-13"></a><span class="w">            </span><span class="nx">genre</span><span class="o">:</span><span class="s2">&quot;History&quot;</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-95-14" name="__codelineno-95-14"></a><span class="w">            </span><span class="nx">isbn</span><span class="o">:</span><span class="s2">&quot;1-23-456789-0&quot;</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-95-15" name="__codelineno-95-15"></a><span class="w">            </span><span class="nx">author</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-95-16" name="__codelineno-95-16"></a><span class="w">                </span><span class="nx">firstName</span><span class="o">:</span><span class="s2">&quot;Super&quot;</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-95-17" name="__codelineno-95-17"></a><span class="w">                </span><span class="nx">middleName</span><span class="o">:</span><span class="s2">&quot;Cool&quot;</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-95-18" name="__codelineno-95-18"></a><span class="w">                </span><span class="nx">lastName</span><span class="o">:</span><span class="s2">&quot;Author&quot;</span>
<a id="__codelineno-95-19" name="__codelineno-95-19"></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-95-20" name="__codelineno-95-20"></a><span class="w">        </span><span class="p">};</span>
<a id="__codelineno-95-21" name="__codelineno-95-21"></a>
<a id="__codelineno-95-22" name="__codelineno-95-22"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">BookSchema</span><span class="p">.</span><span class="nx">safeParse</span><span class="p">(</span><span class="nx">input</span><span class="p">);</span>
<a id="__codelineno-95-23" name="__codelineno-95-23"></a>
<a id="__codelineno-95-24" name="__codelineno-95-24"></a><span class="w">        </span><span class="nx">expect</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">success</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
<a id="__codelineno-95-25" name="__codelineno-95-25"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">book</span><span class="o">:</span><span class="kt">Book</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">Book</span><span class="p">;</span>
<a id="__codelineno-95-26" name="__codelineno-95-26"></a><span class="w">        </span><span class="c1">// now we can start using properties from book</span>
<a id="__codelineno-95-27" name="__codelineno-95-27"></a><span class="w">        </span><span class="nx">expect</span><span class="p">(</span><span class="nx">book</span><span class="p">.</span><span class="nx">title</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="s2">&quot;best book&quot;</span><span class="p">);</span>
<a id="__codelineno-95-28" name="__codelineno-95-28"></a><span class="w">    </span><span class="p">});</span>
<a id="__codelineno-95-29" name="__codelineno-95-29"></a><span class="p">});</span>
</code></pre></div></td></tr></table></div>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/cameronpresley.png" alt="Cameron Presley">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2024-05-30 00:00:00+00:00">May 30, 2024</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../../../functional-programming/" class="md-meta__link">Functional Programming</a>, 
              <a href="../../" class="md-meta__link">TypeScript</a></li>
        
        
          
          <li class="md-meta__item">
            
              6 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="functional-foundations-functions"><a class="toclink" href="../../../../2024/05/30/functional-foundations---functions/">Functional Foundations - Functions</a></h2>
<p>When leveraging functional programming, you're not going to go far without functions. It's literally in the name.</p>
<p>In this post, let's take a deeper look at what functions are and some of the benefits we gain.</p>
<h3 id="what-is-a-function"><a class="toclink" href="../../../../2024/05/30/functional-foundations---functions/#what-is-a-function">What is a Function?</a></h3>
<p>When we talk about <em>functions</em>, we're not talking about a programming construct (like the <code>function</code> keyword), but instead we're talking about functions from mathematics.</p>
<blockquote>
<p>As such, a <em>function</em> is a mapping from two sets such that for every element of the first set, it maps to a single element in the second set.</p>
</blockquote>
<p>Words are cool, but pictures are better. So let's look at the mapping for the <code>square</code> function.</p>
<p><img alt="Mapping for the Square Function" src="https://softwarementorblog.blob.core.windows.net/images/functional-functions/squaredFunction.png" width="800px" /></p>
<p>In this example, we have an arrow coming from an element on the left where it <em>maps</em> to an element on the right. To read this image, we have a mapping called <em>Square</em> that maps all possible numbers to the set of positive numbers. So -3 maps to 9 (-3<em>-3), 2 maps to 4 (2</em>2), so on and so forth.</p>
<p>To check if our mapping is a function, we need to check that every element on the left is mapped to a single element on the right. If so, then we've got a function!</p>
<p>Sounds easy, right? Let's take a look at a mapping that isn't a function.</p>
<h3 id="love-in-the-air"><a class="toclink" href="../../../../2024/05/30/functional-foundations---functions/#love-in-the-air">Love in the Air?</a></h3>
<p>When working with dates, it's common to figure out how many days are in the month. Not only does this help with billable days, but it also makes sure that we don't try to send invoices on May 32nd.</p>
<p>So let's take a look at a mapping from month to the number of days it has.</p>
<p><img alt="Broken Mapping for the Days In Month Function" src="https://softwarementorblog.blob.core.windows.net/images/functional-functions/daysInMonthBusted.png" width="800px" /></p>
<p>Looking at the mapping, we can tell that January, March, May map to 31, April and June both map to 30. But take a look at February. It's got <em>two</em> arrows coming out of it, one to 28 and the other to 29. Because there are two arrows coming out, this mapping isn't a function. Let's try to implement this mapping in TypeScript.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-18-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-18-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-18-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-18-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-18-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-18-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-18-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-18-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-18-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-18-10">10</a></span>
<span class="normal"><a href="#__codelineno-18-11">11</a></span>
<span class="normal"><a href="#__codelineno-18-12">12</a></span>
<span class="normal"><a href="#__codelineno-18-13">13</a></span>
<span class="normal"><a href="#__codelineno-18-14">14</a></span>
<span class="normal"><a href="#__codelineno-18-15">15</a></span>
<span class="normal"><a href="#__codelineno-18-16">16</a></span>
<span class="normal"><a href="#__codelineno-18-17">17</a></span>
<span class="normal"><a href="#__codelineno-18-18">18</a></span>
<span class="normal"><a href="#__codelineno-18-19">19</a></span>
<span class="normal"><a href="#__codelineno-18-20">20</a></span>
<span class="normal"><a href="#__codelineno-18-21">21</a></span>
<span class="normal"><a href="#__codelineno-18-22">22</a></span>
<span class="normal"><a href="#__codelineno-18-23">23</a></span>
<span class="normal"><a href="#__codelineno-18-24">24</a></span>
<span class="normal"><a href="#__codelineno-18-25">25</a></span>
<span class="normal"><a href="#__codelineno-18-26">26</a></span>
<span class="normal"><a href="#__codelineno-18-27">27</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Month</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Jan&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;Feb&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;Mar&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;Apr&quot;</span>
<a id="__codelineno-18-2" name="__codelineno-18-2"></a><span class="w">           </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;May&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;Jun&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;Jul&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;Aug&quot;</span>
<a id="__codelineno-18-3" name="__codelineno-18-3"></a><span class="w">           </span><span class="o">|</span><span class="s2">&quot;Sept&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;Oct&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;Nov&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;Dec&quot;</span><span class="p">;</span>
<a id="__codelineno-18-4" name="__codelineno-18-4"></a>
<a id="__codelineno-18-5" name="__codelineno-18-5"></a><span class="kr">type</span><span class="w"> </span><span class="nx">DaysInMonth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">28</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mf">29</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mf">30</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mf">31</span><span class="p">;</span>
<a id="__codelineno-18-6" name="__codelineno-18-6"></a>
<a id="__codelineno-18-7" name="__codelineno-18-7"></a><span class="kd">function</span><span class="w"> </span><span class="nx">getDaysInMonth</span><span class="p">(</span><span class="nx">month</span><span class="o">:</span><span class="w"> </span><span class="kt">Month</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">DaysInMonth</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-18-8" name="__codelineno-18-8"></a><span class="w">  </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">month</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-18-9" name="__codelineno-18-9"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;Jan&quot;</span><span class="o">:</span>
<a id="__codelineno-18-10" name="__codelineno-18-10"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;Mar&quot;</span><span class="o">:</span>
<a id="__codelineno-18-11" name="__codelineno-18-11"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;May&quot;</span><span class="o">:</span>
<a id="__codelineno-18-12" name="__codelineno-18-12"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;Jul&quot;</span><span class="o">:</span>
<a id="__codelineno-18-13" name="__codelineno-18-13"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;Oct&quot;</span><span class="o">:</span>
<a id="__codelineno-18-14" name="__codelineno-18-14"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;Dec&quot;</span><span class="o">:</span>
<a id="__codelineno-18-15" name="__codelineno-18-15"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="mf">31</span><span class="p">;</span>
<a id="__codelineno-18-16" name="__codelineno-18-16"></a>
<a id="__codelineno-18-17" name="__codelineno-18-17"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;Feb&quot;</span><span class="o">:</span>
<a id="__codelineno-18-18" name="__codelineno-18-18"></a><span class="w">      </span><span class="c1">// what should this be?</span>
<a id="__codelineno-18-19" name="__codelineno-18-19"></a>
<a id="__codelineno-18-20" name="__codelineno-18-20"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;Apr&quot;</span><span class="o">:</span>
<a id="__codelineno-18-21" name="__codelineno-18-21"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;Jun&quot;</span><span class="o">:</span>
<a id="__codelineno-18-22" name="__codelineno-18-22"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;Aug&quot;</span><span class="o">:</span>
<a id="__codelineno-18-23" name="__codelineno-18-23"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;Sept&quot;</span><span class="o">:</span>
<a id="__codelineno-18-24" name="__codelineno-18-24"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;Nov&quot;</span><span class="o">:</span>
<a id="__codelineno-18-25" name="__codelineno-18-25"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="mf">30</span><span class="p">;</span>
<a id="__codelineno-18-26" name="__codelineno-18-26"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-18-27" name="__codelineno-18-27"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>We can't return 28 all the time (we'd be wrong 25% of the time) and we can't return 29 all the time (as we'd be wrong 75% of the time). So how do we know? We need to know something about the year. One approach would be to check if the current year is a leap year (<a href="https://learn.microsoft.com/en-us/office/troubleshoot/excel/determine-a-leap-year">algorithm</a>).</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-19-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-19-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-19-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-19-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-19-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-19-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-19-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-19-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-19-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-19-10">10</a></span>
<span class="normal"><a href="#__codelineno-19-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1"></a><span class="kd">function</span><span class="w"> </span><span class="nx">isLeapYear</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-19-2" name="__codelineno-19-2"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">year</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">().</span><span class="nx">getFullYear</span><span class="p">();</span>
<a id="__codelineno-19-3" name="__codelineno-19-3"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">year</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mf">400</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<a id="__codelineno-19-4" name="__codelineno-19-4"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">year</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mf">100</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<a id="__codelineno-19-5" name="__codelineno-19-5"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">year</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mf">4</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<a id="__codelineno-19-6" name="__codelineno-19-6"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<a id="__codelineno-19-7" name="__codelineno-19-7"></a><span class="p">}</span>
<a id="__codelineno-19-8" name="__codelineno-19-8"></a>
<a id="__codelineno-19-9" name="__codelineno-19-9"></a><span class="c1">// Updated switch</span>
<a id="__codelineno-19-10" name="__codelineno-19-10"></a><span class="k">case</span><span class="w"> </span><span class="s1">&#39;Feb&#39;</span><span class="o">:</span>
<a id="__codelineno-19-11" name="__codelineno-19-11"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">isLeapYear</span><span class="p">()</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">29</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">28</span><span class="p">;</span>
</code></pre></div></td></tr></table></div>
<p>The problem with this approach is that the determination of what to return isn't from the function's inputs, but outside state (in this case, time). So while this "works", you can get bit when you have tests that start failing when the calendar flips over because it assumed that February always had 28 days.</p>
<p>If we look at the type signature of <code>isLeapYear</code>, we can see that it takes in no inputs, but returns a boolean. How can that be possible except if it always returned a constant value? This is a clue that <code>isLeapYear</code> is not a function.</p>
<p>The better approach is to change our mapping to instead of taking just a month name, it takes two arguments, a <code>monthName</code> and <code>year</code>.</p>
<p><img alt="Fixed Mapping For Days In Month" src="https://softwarementorblog.blob.core.windows.net/images/functional-functions/daysInMonthFixed.png" width="800px" /></p>
<p>With this new mapping, our implementation would look like the following:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-20-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-20-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-20-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-20-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-20-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-20-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-20-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-20-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-20-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-20-10">10</a></span>
<span class="normal"><a href="#__codelineno-20-11">11</a></span>
<span class="normal"><a href="#__codelineno-20-12">12</a></span>
<span class="normal"><a href="#__codelineno-20-13">13</a></span>
<span class="normal"><a href="#__codelineno-20-14">14</a></span>
<span class="normal"><a href="#__codelineno-20-15">15</a></span>
<span class="normal"><a href="#__codelineno-20-16">16</a></span>
<span class="normal"><a href="#__codelineno-20-17">17</a></span>
<span class="normal"><a href="#__codelineno-20-18">18</a></span>
<span class="normal"><a href="#__codelineno-20-19">19</a></span>
<span class="normal"><a href="#__codelineno-20-20">20</a></span>
<span class="normal"><a href="#__codelineno-20-21">21</a></span>
<span class="normal"><a href="#__codelineno-20-22">22</a></span>
<span class="normal"><a href="#__codelineno-20-23">23</a></span>
<span class="normal"><a href="#__codelineno-20-24">24</a></span>
<span class="normal"><a href="#__codelineno-20-25">25</a></span>
<span class="normal"><a href="#__codelineno-20-26">26</a></span>
<span class="normal"><a href="#__codelineno-20-27">27</a></span>
<span class="normal"><a href="#__codelineno-20-28">28</a></span>
<span class="normal"><a href="#__codelineno-20-29">29</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1"></a><span class="kd">function</span><span class="w"> </span><span class="nx">isLeapYear</span><span class="p">(</span><span class="nx">year</span><span class="o">:</span><span class="kt">number</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-20-2" name="__codelineno-20-2"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">year</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mf">400</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<a id="__codelineno-20-3" name="__codelineno-20-3"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">year</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mf">100</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<a id="__codelineno-20-4" name="__codelineno-20-4"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">year</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mf">4</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<a id="__codelineno-20-5" name="__codelineno-20-5"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<a id="__codelineno-20-6" name="__codelineno-20-6"></a><span class="p">}</span>
<a id="__codelineno-20-7" name="__codelineno-20-7"></a>
<a id="__codelineno-20-8" name="__codelineno-20-8"></a><span class="kd">function</span><span class="w"> </span><span class="nx">getDaysInMonth</span><span class="p">(</span><span class="nx">month</span><span class="o">:</span><span class="w"> </span><span class="kt">Month</span><span class="p">,</span><span class="w"> </span><span class="nx">year</span><span class="o">:</span><span class="kt">number</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">DaysInMonth</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-20-9" name="__codelineno-20-9"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">isLeap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">isLeapYear</span><span class="p">(</span><span class="nx">year</span><span class="p">);</span>
<a id="__codelineno-20-10" name="__codelineno-20-10"></a><span class="w">  </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">month</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-20-11" name="__codelineno-20-11"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;Jan&quot;</span><span class="o">:</span>
<a id="__codelineno-20-12" name="__codelineno-20-12"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;Mar&quot;</span><span class="o">:</span>
<a id="__codelineno-20-13" name="__codelineno-20-13"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;May&quot;</span><span class="o">:</span>
<a id="__codelineno-20-14" name="__codelineno-20-14"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;Jul&quot;</span><span class="o">:</span>
<a id="__codelineno-20-15" name="__codelineno-20-15"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;Oct&quot;</span><span class="o">:</span>
<a id="__codelineno-20-16" name="__codelineno-20-16"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;Dec&quot;</span><span class="o">:</span>
<a id="__codelineno-20-17" name="__codelineno-20-17"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="mf">31</span><span class="p">;</span>
<a id="__codelineno-20-18" name="__codelineno-20-18"></a>
<a id="__codelineno-20-19" name="__codelineno-20-19"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;Feb&quot;</span><span class="o">:</span>
<a id="__codelineno-20-20" name="__codelineno-20-20"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">isLeap</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">29</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">28</span>
<a id="__codelineno-20-21" name="__codelineno-20-21"></a>
<a id="__codelineno-20-22" name="__codelineno-20-22"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;Apr&quot;</span><span class="o">:</span>
<a id="__codelineno-20-23" name="__codelineno-20-23"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;Jun&quot;</span><span class="o">:</span>
<a id="__codelineno-20-24" name="__codelineno-20-24"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;Aug&quot;</span><span class="o">:</span>
<a id="__codelineno-20-25" name="__codelineno-20-25"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;Sept&quot;</span><span class="o">:</span>
<a id="__codelineno-20-26" name="__codelineno-20-26"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;Nov&quot;</span><span class="o">:</span>
<a id="__codelineno-20-27" name="__codelineno-20-27"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="mf">30</span><span class="p">;</span>
<a id="__codelineno-20-28" name="__codelineno-20-28"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-20-29" name="__codelineno-20-29"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h3 id="benefits-of-functions"><a class="toclink" href="../../../../2024/05/30/functional-foundations---functions/#benefits-of-functions">Benefits of Functions</a></h3>
<p>Now that we've covered what functions are and aren't, let's cover some of the reasons why we prefer functions for our logic.</p>
<p>First, mappings help us make sure that we've covered all our bases. We saw in the <code>getDaysInMonth</code> function we found a bug for when the month was February. Mappings can also be great conversation tools with non-engineers as they're intuitive to understand and to explain.</p>
<p>Second, functions are simple to test. Since the result is based solely on inputs, they are great candidates for unit testing and require little to no mocking to write them. I don't know about you, but I like simple test cases that help us build confidence that our application is working as intended.</p>
<p>Third, we can combine functions to make bigger functions using <em>composition</em>. At a high level, composition says that if we have two functions <code>f</code> and <code>g</code>, we can write a new function, <code>h</code> which takes the output of <code>f</code> and feeds it as the input for <code>g</code>.</p>
<p>Sounds theoretical, but let's take a look at a real example.</p>
<p>In the <a href="../../../../2020/05/20/learning-through-example--mars-rover-kata/">Mars Rover kata</a>, we end up building a basic console application that takes the input from the user (a string) and will need to convert it to the action that the rover takes.</p>
<p>In code, the logic looks like the following:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-21-1">1</a></span>
<span class="normal"><a href="#__codelineno-21-2">2</a></span>
<span class="normal"><a href="#__codelineno-21-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1"></a><span class="kd">let</span><span class="w"> </span><span class="nx">rover</span><span class="o">:</span><span class="kt">Rover</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="nx">x</span><span class="o">:</span><span class="kt">0</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="o">:</span><span class="kt">0</span><span class="p">,</span><span class="w"> </span><span class="nx">direction</span><span class="o">:</span><span class="s1">&#39;North&#39;</span><span class="p">};</span>
<a id="__codelineno-21-2" name="__codelineno-21-2"></a><span class="kd">const</span><span class="w"> </span><span class="nx">action</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="nx">convertStringToCommand</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="nx">convertCommandToAction</span><span class="p">);</span>
<a id="__codelineno-21-3" name="__codelineno-21-3"></a><span class="nx">rover</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">action</span><span class="p">(</span><span class="nx">rover</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<p>The annoying part is that we're iterating the list twice (once for each <code>map</code> call), and it'd be nice to get it down to a single iteration. This is where composition helps.</p>
<p>When we're running the <code>map</code>s back-to-back, we're accomplish the following workflow</p>
<p><img alt="Input to Command to Action Mapping" src="https://softwarementorblog.blob.core.windows.net/images/functional-functions/commandToActionMapping.png" width="1000px" /></p>
<p>Because each mapping is a function, we can compose the two into a new function, <code>stringToActionConverter</code>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-22-1">1</a></span>
<span class="normal"><a href="#__codelineno-22-2">2</a></span>
<span class="normal"><a href="#__codelineno-22-3">3</a></span>
<span class="normal"><a href="#__codelineno-22-4">4</a></span>
<span class="normal"><a href="#__codelineno-22-5">5</a></span>
<span class="normal"><a href="#__codelineno-22-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1"></a><span class="c1">// using our f and g naming from earlier, convertString is f, convertCommand is g</span>
<a id="__codelineno-22-2" name="__codelineno-22-2"></a><span class="kd">const</span><span class="w"> </span><span class="nx">stringToActionConverter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">s</span><span class="o">:</span><span class="kt">string</span><span class="p">)=&gt;</span><span class="nx">convertCommandToAction</span><span class="p">(</span><span class="nx">convertStringToCommand</span><span class="p">(</span><span class="nx">s</span><span class="p">));</span>
<a id="__codelineno-22-3" name="__codelineno-22-3"></a>
<a id="__codelineno-22-4" name="__codelineno-22-4"></a><span class="kd">let</span><span class="w"> </span><span class="nx">rover</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="nx">x</span><span class="o">:</span><span class="kt">0</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="o">:</span><span class="kt">0</span><span class="p">,</span><span class="w"> </span><span class="nx">direction</span><span class="o">:</span><span class="s1">&#39;North&#39;</span><span class="p">}</span>
<a id="__codelineno-22-5" name="__codelineno-22-5"></a><span class="kd">const</span><span class="w"> </span><span class="nx">action</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">input</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="nx">stringToActionConverter</span><span class="p">);</span>
<a id="__codelineno-22-6" name="__codelineno-22-6"></a><span class="nx">rover</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">action</span><span class="p">(</span><span class="nx">rover</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<h3 id="why-not-function-all-the-things"><a class="toclink" href="../../../../2024/05/30/functional-foundations---functions/#why-not-function-all-the-things">Why Not Function All the Things?</a></h3>
<p>Functions can greatly simplify our mental model as we don't have to keep track of state or other side effects. However, our applications typically deal with side affects (getting input from users, reading from files, interacting with databases) in order to do something useful. Because of this limitation, we strive to put all of our business rules into functions and keep the parts that interact with state as dumb as possible (that way we don't have to troubleshoot as much).</p>
<p>What I've found is that when working with applications, you end up with a <em>workflow</em> where you have input come in, gets processed, and then the result gets outputted.</p>
<p>Here's what an example workflow would look like</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-23-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-23-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-23-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-23-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-23-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-23-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-23-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-23-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-23-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-23-10">10</a></span>
<span class="normal"><a href="#__codelineno-23-11">11</a></span>
<span class="normal"><a href="#__codelineno-23-12">12</a></span>
<span class="normal"><a href="#__codelineno-23-13">13</a></span>
<span class="normal"><a href="#__codelineno-23-14">14</a></span>
<span class="normal"><a href="#__codelineno-23-15">15</a></span>
<span class="normal"><a href="#__codelineno-23-16">16</a></span>
<span class="normal"><a href="#__codelineno-23-17">17</a></span>
<span class="normal"><a href="#__codelineno-23-18">18</a></span>
<span class="normal"><a href="#__codelineno-23-19">19</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1"></a><span class="c1">// Logic to determine the &#39;FizzBuzziness&#39; of a number</span>
<a id="__codelineno-23-2" name="__codelineno-23-2"></a><span class="kd">function</span><span class="w"> </span><span class="nx">determineFizzBuzz</span><span class="p">(</span><span class="nx">input</span><span class="o">:</span><span class="kt">number</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-23-3" name="__codelineno-23-3"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">input</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mf">15</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;FizzBuzz&#39;</span><span class="p">;</span>
<a id="__codelineno-23-4" name="__codelineno-23-4"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">input</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mf">3</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;Fizz&#39;</span><span class="p">;</span>
<a id="__codelineno-23-5" name="__codelineno-23-5"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">input</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mf">5</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;Buzz&#39;</span><span class="p">;</span>
<a id="__codelineno-23-6" name="__codelineno-23-6"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="sb">`</span><span class="si">${</span><span class="nx">input</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
<a id="__codelineno-23-7" name="__codelineno-23-7"></a><span class="p">}</span>
<a id="__codelineno-23-8" name="__codelineno-23-8"></a>
<a id="__codelineno-23-9" name="__codelineno-23-9"></a><span class="kd">function</span><span class="w"> </span><span class="nx">workflow</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-23-10" name="__codelineno-23-10"></a><span class="w">  </span><span class="c1">// Input Boundary</span>
<a id="__codelineno-23-11" name="__codelineno-23-11"></a><span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">prompt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;prompt-sync&#39;</span><span class="p">)();</span>
<a id="__codelineno-23-12" name="__codelineno-23-12"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">input</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">prompt</span><span class="p">();</span>
<a id="__codelineno-23-13" name="__codelineno-23-13"></a>
<a id="__codelineno-23-14" name="__codelineno-23-14"></a><span class="w">  </span><span class="c1">// Business Rules</span>
<a id="__codelineno-23-15" name="__codelineno-23-15"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">+</span><span class="nx">input</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="sb">`</span><span class="si">${</span><span class="nx">input</span><span class="si">}</span><span class="sb"> FizzBuzz value is </span><span class="si">${</span><span class="nx">determineFizzBuzz</span><span class="p">(</span><span class="o">+</span><span class="nx">input</span><span class="p">)</span><span class="si">}</span><span class="sb">`</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="sb">`Invalid input`</span><span class="p">;</span>
<a id="__codelineno-23-16" name="__codelineno-23-16"></a>
<a id="__codelineno-23-17" name="__codelineno-23-17"></a><span class="w">  </span><span class="c1">// Output boundary</span>
<a id="__codelineno-23-18" name="__codelineno-23-18"></a><span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
<a id="__codelineno-23-19" name="__codelineno-23-19"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h3 id="whats-next"><a class="toclink" href="../../../../2024/05/30/functional-foundations---functions/#whats-next">What's Next?</a></h3>
<p>Now that we have a rough understanding of functions, we can start exploring what happens when things go wrong. For example, could there have been a cleaner way of implementing the business rules of our workflow?</p>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/cameronpresley.png" alt="Cameron Presley">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2024-05-10 00:00:00+00:00">May 10, 2024</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../../" class="md-meta__link">TypeScript</a>, 
              <a href="../../../today-i-learned/" class="md-meta__link">Today I Learned</a></li>
        
        
          
          <li class="md-meta__item">
            
              3 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="today-i-learned-destructure-objects-in-function-signatures"><a class="toclink" href="../../../../2024/05/10/today-i-learned-destructure-objects-in-function-signatures/">Today I Learned: Destructure Objects in Function Signatures</a></h2>
<p>When modeling types, one thing to keep in mind is to not leverage <a href="https://refactoring.guru/smells/primitive-obsession">primitive types</a> for your domain. This comes up when we use a primitive type (like a string) to represent core domain concepts (like a Social Security Number or a Phone Number).</p>
<p>Here's an example where it can become problematic:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-18-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-18-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-18-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-18-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-18-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-18-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-18-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-18-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-18-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-18-10">10</a></span>
<span class="normal"><a href="#__codelineno-18-11">11</a></span>
<span class="normal"><a href="#__codelineno-18-12">12</a></span>
<span class="normal"><a href="#__codelineno-18-13">13</a></span>
<span class="normal"><a href="#__codelineno-18-14">14</a></span>
<span class="normal"><a href="#__codelineno-18-15">15</a></span>
<span class="normal"><a href="#__codelineno-18-16">16</a></span>
<span class="normal"><a href="#__codelineno-18-17">17</a></span>
<span class="normal"><a href="#__codelineno-18-18">18</a></span>
<span class="normal"><a href="#__codelineno-18-19">19</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1"></a><span class="c1">// Definition for Customer</span>
<a id="__codelineno-18-2" name="__codelineno-18-2"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Customer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-18-3" name="__codelineno-18-3"></a><span class="w">  </span><span class="nx">firstName</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span>
<a id="__codelineno-18-4" name="__codelineno-18-4"></a><span class="w">  </span><span class="nx">lastName</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span>
<a id="__codelineno-18-5" name="__codelineno-18-5"></a><span class="w">  </span><span class="nx">email</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span>
<a id="__codelineno-18-6" name="__codelineno-18-6"></a><span class="w">  </span><span class="nx">phoneNumber</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span>
<a id="__codelineno-18-7" name="__codelineno-18-7"></a><span class="p">}</span>
<a id="__codelineno-18-8" name="__codelineno-18-8"></a>
<a id="__codelineno-18-9" name="__codelineno-18-9"></a><span class="c1">// Function to send an email to customer about a new sale</span>
<a id="__codelineno-18-10" name="__codelineno-18-10"></a><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">sendEmailToCustomer</span><span class="p">(</span><span class="nx">c</span><span class="o">:</span><span class="kt">Customer</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-18-11" name="__codelineno-18-11"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">content</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Look at these deals!&quot;</span><span class="p">;</span>
<a id="__codelineno-18-12" name="__codelineno-18-12"></a>
<a id="__codelineno-18-13" name="__codelineno-18-13"></a><span class="w">  </span><span class="c1">// Uh oh, we&#39;re trying to send an email to a phone number...</span>
<a id="__codelineno-18-14" name="__codelineno-18-14"></a><span class="w">  </span><span class="k">await</span><span class="w"> </span><span class="nx">sendEmail</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">phoneNumber</span><span class="p">,</span><span class="w"> </span><span class="nx">content</span><span class="p">);</span>
<a id="__codelineno-18-15" name="__codelineno-18-15"></a><span class="p">}</span>
<a id="__codelineno-18-16" name="__codelineno-18-16"></a>
<a id="__codelineno-18-17" name="__codelineno-18-17"></a><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">sendEmail</span><span class="p">(</span><span class="nx">email</span><span class="o">:</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">content</span><span class="o">:</span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-18-18" name="__codelineno-18-18"></a><span class="w">  </span><span class="c1">// logic to send email</span>
<a id="__codelineno-18-19" name="__codelineno-18-19"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>There's a bug in this code, where we're trying to send an email to a phone number. Unfortunately, this code type checks and compiles, so we have to lean on other techniques (automated testing or code reviews) to discover the bug.</p>
<p>Since it's better to find issues earlier in the process, we can make this a compilation error by introducing a new type for <code>Email</code> since not all strings should be treated equally.</p>
<p>One approach we can do is to create a <a href="https://stackoverflow.com/questions/61646400/difference-union-types-and-discriminated-unions-typescript-f/61649726#61649726">tagged union</a> like the following:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-19-1">1</a></span>
<span class="normal"><a href="#__codelineno-19-2">2</a></span>
<span class="normal"><a href="#__codelineno-19-3">3</a></span>
<span class="normal"><a href="#__codelineno-19-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-19-2" name="__codelineno-19-2"></a><span class="w">  </span><span class="nx">label</span><span class="o">:</span><span class="s2">&quot;Email&quot;</span><span class="p">,</span>
<a id="__codelineno-19-3" name="__codelineno-19-3"></a><span class="w">  </span><span class="nx">value</span><span class="o">:</span><span class="kt">string</span>
<a id="__codelineno-19-4" name="__codelineno-19-4"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>With this in place, we can change our <code>sendEmail</code> function to leverage the new <code>Email</code> type.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-20-1">1</a></span>
<span class="normal"><a href="#__codelineno-20-2">2</a></span>
<span class="normal"><a href="#__codelineno-20-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1"></a><span class="kd">function</span><span class="w"> </span><span class="nx">sendEmail</span><span class="p">(</span><span class="nx">email</span><span class="o">:</span><span class="kt">Email</span><span class="p">,</span><span class="w"> </span><span class="nx">content</span><span class="o">:</span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-20-2" name="__codelineno-20-2"></a><span class="w">  </span><span class="c1">// logic to send email</span>
<a id="__codelineno-20-3" name="__codelineno-20-3"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Now, when we get a compilation error when we try passing in a phoneNumber.</p>
<p><img alt="Compilation error that we can't pass a string to an email" src="https://softwarementorblog.blob.core.windows.net/images/til-destructure-error.png" /></p>
<p>One downside to this approach is that if you want to get the value from the <code>Email</code> type, you need to access it's <code>value</code> property. This can be a bit hard to read and keep track of.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-21-1">1</a></span>
<span class="normal"><a href="#__codelineno-21-2">2</a></span>
<span class="normal"><a href="#__codelineno-21-3">3</a></span>
<span class="normal"><a href="#__codelineno-21-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1"></a><span class="kd">function</span><span class="w"> </span><span class="nx">sendEmail</span><span class="p">(</span><span class="nx">email</span><span class="o">:</span><span class="kt">Email</span><span class="p">,</span><span class="w"> </span><span class="nx">content</span><span class="o">:</span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-21-2" name="__codelineno-21-2"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">address</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">email</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
<a id="__codelineno-21-3" name="__codelineno-21-3"></a><span class="w">  </span><span class="c1">// logic to send email</span>
<a id="__codelineno-21-4" name="__codelineno-21-4"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h3 id="leveraging-object-destructuring-in-functions"><a class="toclink" href="../../../../2024/05/10/today-i-learned-destructure-objects-in-function-signatures/#leveraging-object-destructuring-in-functions">Leveraging Object Destructuring in Functions</a></h3>
<p>One technique to avoid this is to use destructuring to get the individual properties. This allows us to "throw away" some properties and hold onto the ones we care about. For example, let's say that we wanted only the <code>phoneNumber</code> from a <code>Customer</code>. We could get that with an assignment like the following:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-22-1">1</a></span>
<span class="normal"><a href="#__codelineno-22-2">2</a></span>
<span class="normal"><a href="#__codelineno-22-3">3</a></span>
<span class="normal"><a href="#__codelineno-22-4">4</a></span>
<span class="normal"><a href="#__codelineno-22-5">5</a></span>
<span class="normal"><a href="#__codelineno-22-6">6</a></span>
<span class="normal"><a href="#__codelineno-22-7">7</a></span>
<span class="normal"><a href="#__codelineno-22-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1"></a><span class="kd">const</span><span class="w"> </span><span class="nx">customer</span><span class="o">:</span><span class="w"> </span><span class="kt">Customer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-22-2" name="__codelineno-22-2"></a><span class="w">  </span><span class="nx">firstName</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Cameron&quot;</span><span class="p">,</span>
<a id="__codelineno-22-3" name="__codelineno-22-3"></a><span class="w">  </span><span class="nx">lastName</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Presley&quot;</span><span class="p">,</span>
<a id="__codelineno-22-4" name="__codelineno-22-4"></a><span class="w">  </span><span class="nx">phoneNumber</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;555-5555&quot;</span><span class="p">,</span>
<a id="__codelineno-22-5" name="__codelineno-22-5"></a><span class="w">  </span><span class="nx">email</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">label</span><span class="o">:</span><span class="s2">&quot;Email&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="o">:</span><span class="s2">&quot;Cameron@domain.com&quot;</span><span class="p">}</span>
<a id="__codelineno-22-6" name="__codelineno-22-6"></a><span class="p">}</span>
<a id="__codelineno-22-7" name="__codelineno-22-7"></a>
<a id="__codelineno-22-8" name="__codelineno-22-8"></a><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="nx">phoneNumber</span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">customer</span><span class="p">;</span><span class="w"> </span><span class="c1">// phoneNumber will be &quot;555-555&quot;</span>
</code></pre></div></td></tr></table></div>
<p>This works fine for assignments, but it'd be nice to have this at a function level. Thankfully, we can do that like so:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-23-1">1</a></span>
<span class="normal"><a href="#__codelineno-23-2">2</a></span>
<span class="normal"><a href="#__codelineno-23-3">3</a></span>
<span class="normal"><a href="#__codelineno-23-4">4</a></span>
<span class="normal"><a href="#__codelineno-23-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1"></a><span class="c1">// value is the property from Email, we don&#39;t have the label to deal with</span>
<a id="__codelineno-23-2" name="__codelineno-23-2"></a><span class="kd">function</span><span class="w"> </span><span class="nx">sendEmail</span><span class="p">({</span><span class="nx">value</span><span class="p">}</span><span class="o">:</span><span class="nx">Email</span><span class="p">,</span><span class="w"> </span><span class="nx">content</span><span class="o">:</span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-23-3" name="__codelineno-23-3"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">address</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">value</span><span class="p">;</span><span class="w"> </span><span class="c1">// note that we don&#39;t have to do .value here</span>
<a id="__codelineno-23-4" name="__codelineno-23-4"></a><span class="w">  </span><span class="c1">// logic to send email</span>
<a id="__codelineno-23-5" name="__codelineno-23-5"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>If you find yourself using domain types like this, then this is a handy tool to have in your toolbox.</p>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/cameronpresley.png" alt="Cameron Presley">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2024-04-22 00:00:00+00:00">Apr 22, 2024</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../../" class="md-meta__link">TypeScript</a>, 
              <a href="../../../today-i-learned/" class="md-meta__link">Today I Learned</a>, 
              <a href="../../../process/" class="md-meta__link">Process</a></li>
        
        
          
          <li class="md-meta__item">
            
              3 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="today-i-learned-libyear"><a class="toclink" href="../../../../2024/04/22/today-i-learned-libyear/">Today I Learned: LibYear</a></h2>
<p>When writing software, it's difficult (if not impossible) to write everything from scratch. We're either using a framework or various third-party libraries to make our code work.</p>
<p>On one hand, this is a major win for the community because we're not all having to solve the same problem over and over again. Could you imagine having to implement your own authentication framework (<a href="https://www.reddit.com/r/learnprogramming/comments/q8ppcs/never_roll_your_own_authenticationauthorization/">on second thought...</a>)</p>
<p>However, this power comes at a cost. These libraries aren't free as in beer, but more like puppies. So if we're going to take in the library, then we need to make sure that our dependencies are up-to-date with the latest and greatest. There are new features, bug fixes, and security patches occurring all the time and the longer we let a library drift, the more painful it can be to upgrade.</p>
<p>If the library is leveraging <a href="https://semver.org/">semantic versioning</a>, then we can take a guess on the likelihood of a breaking change base on which number (Major.Minor.Maintenance) has changed.</p>
<ul>
<li>Major - We've made a breaking change that's not backward compatible. Your code may not work anymore.</li>
<li>Minor - We've added added new features that you might be interested in or made other changes that  are backwards compatible.</li>
<li>Maintenance - We've fixed some bugs, sorry about that!</li>
</ul>
<h3 id="keeping-up-with-dependencies"><a class="toclink" href="../../../../2024/04/22/today-i-learned-libyear/#keeping-up-with-dependencies">Keeping Up With Dependencies</a></h3>
<p>For libraries that have known vulnerabilities, you can leverage tools like GitHub's <a href="https://docs.github.com/en/code-security/getting-started/dependabot-quickstart-guide">Dependabot</a> to auto-create pull requests that will upgrade those dependencies for you. Even though the tool might be "noisy", this is a great way to take an active role in keeping libraries up to date.</p>
<p>However, this approach only works for vulnerabilities, what about libraries that are just out-of-date? There's a cost/benefit of upgrading where the longer you go between the upgrades, the riskier the upgrade will be.</p>
<p>In the JavaScript world, we know that dependencies are listed in the <code>package.json</code> file with minimum versions and the <code>package-lock.json</code> file states the <em>exact</em> versions to use.</p>
<h3 id="using-libyear"><a class="toclink" href="../../../../2024/04/22/today-i-learned-libyear/#using-libyear">Using LibYear</a></h3>
<p>I was working with <a href="https://www.linkedin.com/in/joshuaangolano/">one of my colleagues</a> the other day and he referred me to a library called <a href="https://github.com/jdanil/libyear">LibYear</a> that will check your package.json and lock file to determine how much "drift" that you have between your dependencies.</p>
<p>Under the hood, it's combining the <code>npm outdated</code> and <code>npm view &lt;package&gt;</code> commands to determine the drift.</p>
<p>What I like about this tool is that you can use this as a part of a "software health" report for your codebase.</p>
<p>As engineers, we get pressure to ship features and hit delivery dates, but it's our responsibility to make sure that our codebase is in good shape (however we defined that term). I think this library is a good way for us to capture <em>a</em> data point about software health which then allows the team to make a decision on whether we should update our libraries now (or defer).</p>
<p>The nice thing about the <code>LibYear</code> package is that it lends itself to be ran in a pipeline and then you could take those results and post them somewhere. For example, maybe you could <a href="../../../../2023/06/26/having-coffee-with-deno---inspiration/">write your own automation bot</a> that could post the stats in your Slack or Teams chat.</p>
<p>It looks like <a href="https://github.com/marketplace/actions/node-js-dependency-freshness-via-libyear">there's already a GitHub Action</a> for running this tool today, so you could start there as a basis.</p>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/cameronpresley.png" alt="Cameron Presley">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2024-04-13 00:00:00+00:00">Apr 13, 2024</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../../../functional-programming/" class="md-meta__link">Functional Programming</a>, 
              <a href="../../" class="md-meta__link">TypeScript</a>, 
              <a href="../../../today-i-learned/" class="md-meta__link">Today I Learned</a></li>
        
        
          
          <li class="md-meta__item">
            
              2 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="today-i-learned-iterating-through-union-types"><a class="toclink" href="../../../../2024/04/13/today-i-learned---iterating-through-union-types/">Today I Learned - Iterating Through Union Types</a></h2>
<p>In a <a href="../../../../2023/04/30/better-domain-modeling-with-discriminated-unions/">previous post</a>, we cover on how using union types in TypeScript is a great approach for domain modeling because it limits the possible values that a type can have.</p>
<p>For example, let's say that we're modeling a card game with a standard deck of playing cards. We could model the domain as such.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-16-1">1</a></span>
<span class="normal"><a href="#__codelineno-16-2">2</a></span>
<span class="normal"><a href="#__codelineno-16-3">3</a></span>
<span class="normal"><a href="#__codelineno-16-4">4</a></span>
<span class="normal"><a href="#__codelineno-16-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Rank</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Ace&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;Two&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;Three&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;Four&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;Five&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;Six&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;Seven&quot;</span>
<a id="__codelineno-16-2" name="__codelineno-16-2"></a><span class="w">           </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;Eight&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;Nine&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;Ten&quot;</span><span class="w"> </span><span class="o">|</span><span class="s2">&quot;Jack&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;Queen&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;King&quot;</span>
<a id="__codelineno-16-3" name="__codelineno-16-3"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Suite</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Hearts&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;Clubs&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;Spades&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;Diamonds&quot;</span>
<a id="__codelineno-16-4" name="__codelineno-16-4"></a>
<a id="__codelineno-16-5" name="__codelineno-16-5"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Card</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="nx">rank</span><span class="o">:</span><span class="kt">Rank</span><span class="p">;</span><span class="w"> </span><span class="nx">suite</span><span class="o">:</span><span class="kt">Suit</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>With this modeling, there's no way to create a <code>Card</code> such that it has an invalid <code>Rank</code> or <code>Suite</code>.</p>
<p>With this definition, let's create a function to build the deck.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-17-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-17-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-17-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-17-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-17-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-17-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-17-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-17-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-17-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-17-10">10</a></span>
<span class="normal"><a href="#__codelineno-17-11">11</a></span>
<span class="normal"><a href="#__codelineno-17-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1"></a><span class="kd">function</span><span class="w"> </span><span class="nx">createDeck</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nx">Card</span><span class="p">[]</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-17-2" name="__codelineno-17-2"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">ranks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;Ace&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Two&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Three&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Four&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Five&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Six&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Seven&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Eight&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Nine&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Ten&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Jack&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Queen&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;King&quot;</span><span class="p">];</span>
<a id="__codelineno-17-3" name="__codelineno-17-3"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">suites</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;Hearts&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Clubs&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Spades&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Diamonds&quot;</span><span class="p">];</span>
<a id="__codelineno-17-4" name="__codelineno-17-4"></a>
<a id="__codelineno-17-5" name="__codelineno-17-5"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">deck</span><span class="o">:</span><span class="kt">Card</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
<a id="__codelineno-17-6" name="__codelineno-17-6"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">rank</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">ranks</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-17-7" name="__codelineno-17-7"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">suite</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">suites</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-17-8" name="__codelineno-17-8"></a><span class="w">      </span><span class="nx">deck</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span><span class="nx">rank</span><span class="p">,</span><span class="w"> </span><span class="nx">suite</span><span class="p">});</span>
<a id="__codelineno-17-9" name="__codelineno-17-9"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-17-10" name="__codelineno-17-10"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-17-11" name="__codelineno-17-11"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">deck</span><span class="p">;</span>
<a id="__codelineno-17-12" name="__codelineno-17-12"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>This code works, however, I don't like the fact that I had to formally list the option for both <code>Rank</code> and <code>Suite</code> as this means that I have two different representtions for <code>Rank</code> and <code>Suite</code>, which implies tthat if we needed to add a new <code>Rank</code> or <code>Suite</code>, then we'd need to add it in two places (a violation of DRY).</p>
<p>Doing some digging, I found <a href="https://stackoverflow.com/questions/43067354/how-to-iterate-a-string-literal-type-in-typescript">this StackOverflow post</a> that gave a different way of defining our <code>Rank</code> and <code>Suite</code> types. Let's try that new definition.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-18-1">1</a></span>
<span class="normal"><a href="#__codelineno-18-2">2</a></span>
<span class="normal"><a href="#__codelineno-18-3">3</a></span>
<span class="normal"><a href="#__codelineno-18-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1"></a><span class="kd">const</span><span class="w"> </span><span class="nx">ranks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;Ace&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Two&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Three&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Four&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Five&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Six&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Seven&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Eight&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Nine&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Ten&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Jack&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Queen&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;King&quot;</span><span class="p">]</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kd">const</span><span class="p">;</span>
<a id="__codelineno-18-2" name="__codelineno-18-2"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Rank</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">typeof</span><span class="w"> </span><span class="nx">ranks</span><span class="p">[</span><span class="kt">number</span><span class="p">];</span>
<a id="__codelineno-18-3" name="__codelineno-18-3"></a><span class="kd">const</span><span class="w"> </span><span class="nx">suites</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;Hearts&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Clubs&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Spades&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Diamonds&quot;</span><span class="p">]</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kd">const</span><span class="p">;</span>
<a id="__codelineno-18-4" name="__codelineno-18-4"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Suite</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">typeof</span><span class="w"> </span><span class="nx">suites</span><span class="p">[</span><span class="kt">number</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
<p>In this above code, we're saying that <code>ranks</code> cannot change (either by assignment or by operations like <code>push</code>). With that definition, we can say that <code>Rank</code> is some entry in the <code>ranks</code> array. Similar approach for our <code>suites</code> array and <code>Suite</code> type.</p>
<p>I prefer this approach much more because we have our ranks and suites defined in one place and our code reads cleaner as this says <em>Here are the possible ranks and Rank can only be one of those choices</em>.</p>
<h3 id="limitations"><a class="toclink" href="../../../../2024/04/13/today-i-learned---iterating-through-union-types/#limitations">Limitations</a></h3>
<p>The main limitation is that it only works for "enum" style unions. Let's change example and say that we want to model a series of shapes with the following.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-19-1">1</a></span>
<span class="normal"><a href="#__codelineno-19-2">2</a></span>
<span class="normal"><a href="#__codelineno-19-3">3</a></span>
<span class="normal"><a href="#__codelineno-19-4">4</a></span>
<span class="normal"><a href="#__codelineno-19-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Circle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="nx">radius</span><span class="o">:</span><span class="kt">number</span><span class="p">};</span>
<a id="__codelineno-19-2" name="__codelineno-19-2"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Square</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="nx">length</span><span class="o">:</span><span class="kt">number</span><span class="p">};</span>
<a id="__codelineno-19-3" name="__codelineno-19-3"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Rectangle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="nx">height</span><span class="o">:</span><span class="kt">number</span><span class="p">,</span><span class="w"> </span><span class="nx">width</span><span class="o">:</span><span class="kt">number</span><span class="p">}</span>
<a id="__codelineno-19-4" name="__codelineno-19-4"></a>
<a id="__codelineno-19-5" name="__codelineno-19-5"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Circle</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nx">Square</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nx">Rectangle</span>
</code></pre></div></td></tr></table></div>
<p>To use the same trick, we would need to have an array of constant values. However, we can't have a constant value for any of the <code>Shape</code>s because there are an infinite number of valid <code>Circle</code>s, <code>Square</code>s, and <code>Rectangle</code>s.</p>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/cameronpresley.png" alt="Cameron Presley">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2024-04-09 00:00:00+00:00">Apr 9, 2024</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../../" class="md-meta__link">TypeScript</a>, 
              <a href="../../../functional-programming/" class="md-meta__link">Functional Programming</a></li>
        
        
          
          <li class="md-meta__item">
            
              5 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="exploring-map-with-property-based-thinking"><a class="toclink" href="../../../../2024/04/09/exploring-map-with-property-based-thinking/">Exploring Map with Property Based Thinking</a></h2>
<p>When thinking about software, it's natural to think about the things that it can do (its features like generating reports or adding an item to a cart).</p>
<p>But what about the <em>properties</em> that those actions have? Those things that are always true?</p>
<p>In this post, let's take a look at a fundamental tool of functional programming, the <code>map</code> function.</p>
<p>All the code examples in this post will be using TypeScript, but the lessons hold for other languages with <code>Map</code> (or <code>Select</code> if you're coming from .NET).</p>
<h3 id="examining-map"><a class="toclink" href="../../../../2024/04/09/exploring-map-with-property-based-thinking/#examining-map">Examining Map</a></h3>
<p>In JavaScript/TypeScript, <code>map</code> is a function for arrays that allow us to transform an array of values into an array of different values.</p>
<p>For example, let's say that we have an array of names and we want to ensure that each name is capitalized, we can write the following:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-18-1">1</a></span>
<span class="normal"><a href="#__codelineno-18-2">2</a></span>
<span class="normal"><a href="#__codelineno-18-3">3</a></span>
<span class="normal"><a href="#__codelineno-18-4">4</a></span>
<span class="normal"><a href="#__codelineno-18-5">5</a></span>
<span class="normal"><a href="#__codelineno-18-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1"></a><span class="kd">const</span><span class="w"> </span><span class="nx">capitalize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">name</span><span class="o">:</span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-18-2" name="__codelineno-18-2"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">n</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="nx">toUpperCase</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">n</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>
<a id="__codelineno-18-3" name="__codelineno-18-3"></a><span class="p">}</span>
<a id="__codelineno-18-4" name="__codelineno-18-4"></a><span class="kd">const</span><span class="w"> </span><span class="nx">names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;alice&quot;</span><span class="p">,</span><span class="s2">&quot;bob&quot;</span><span class="p">,</span><span class="s2">&quot;charlotte&quot;</span><span class="p">];</span>
<a id="__codelineno-18-5" name="__codelineno-18-5"></a>
<a id="__codelineno-18-6" name="__codelineno-18-6"></a><span class="kd">const</span><span class="w"> </span><span class="nx">properNames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">names</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">capitalize</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<p>In our example, as long as we have a <a href="https://blog.thesoftwarementor.com/articles/2023/05/29/the-humble-function---foundation-to-functional-programming/#pure-functions">pure function</a> that takes a string and returns a new type, then <code>map</code> will work.</p>
<h3 id="what-does-map-guarantee"><a class="toclink" href="../../../../2024/04/09/exploring-map-with-property-based-thinking/#what-does-map-guarantee">What Does Map Guarantee?</a></h3>
<p>Map is a cool function because it has a lot of properties that we get for free.</p>
<ol>
<li>
<p>Maintains Length - If you call <code>map</code> on an array of 3 elements, then you'll get a new array with 3 elements. If you call <code>map</code> on an empty array, you'll get an empty array.</p>
</li>
<li>
<p>Maintains Type - If you call <code>map</code> on array of type <code>T</code> with a function that goes from <code>T</code> to <code>U</code>, then <em>every</em> element in the new array is of type <code>U</code>.</p>
</li>
<li>
<p>Maintains Order - If you call <code>map</code> on array with one function, then call <code>map</code> with a function that "undoes" the original map, then you end up with the original array.</p>
</li>
</ol>
<h3 id="writing-property-based-tests"><a class="toclink" href="../../../../2024/04/09/exploring-map-with-property-based-thinking/#writing-property-based-tests">Writing Property Based Tests</a></h3>
<p>To prove these properties, we can write a set of unit tests. However, it would be hard to write a single test that that covers a single property.</p>
<p>Most tests are <em>example based</em> in the sense that for a specific input, we get a specific output. <em>Property based</em> tests, on the other hand, uses random data and ensures that a property holds for all inputs. If it finds an input where the property fails, the test fails and you know which input caused the issue.</p>
<p>Most languages have a tool for writing property-based tests, so we'll be using <a href="https://fast-check.dev/">fast-check</a> for writing property based tests and <a href="https://jestjs.io/">jest</a> for our test runner</p>
<h4 id="checking-length-property"><a class="toclink" href="../../../../2024/04/09/exploring-map-with-property-based-thinking/#checking-length-property">Checking Length Property</a></h4>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-19-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-19-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-19-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-19-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-19-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-19-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-19-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-19-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-19-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-19-10">10</a></span>
<span class="normal"><a href="#__codelineno-19-11">11</a></span>
<span class="normal"><a href="#__codelineno-19-12">12</a></span>
<span class="normal"><a href="#__codelineno-19-13">13</a></span>
<span class="normal"><a href="#__codelineno-19-14">14</a></span>
<span class="normal"><a href="#__codelineno-19-15">15</a></span>
<span class="normal"><a href="#__codelineno-19-16">16</a></span>
<span class="normal"><a href="#__codelineno-19-17">17</a></span>
<span class="normal"><a href="#__codelineno-19-18">18</a></span>
<span class="normal"><a href="#__codelineno-19-19">19</a></span>
<span class="normal"><a href="#__codelineno-19-20">20</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1"></a><span class="k">import</span><span class="w"> </span><span class="nx">fc</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;fast-check&quot;</span><span class="p">;</span>
<a id="__codelineno-19-2" name="__codelineno-19-2"></a>
<a id="__codelineno-19-3" name="__codelineno-19-3"></a><span class="nx">describe</span><span class="p">(</span><span class="s2">&quot;map&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-19-4" name="__codelineno-19-4"></a><span class="w">  </span><span class="nx">it</span><span class="p">(</span><span class="s2">&quot;maintains length&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-19-5" name="__codelineno-19-5"></a><span class="w">    </span><span class="c1">// This is known as the identify function</span>
<a id="__codelineno-19-6" name="__codelineno-19-6"></a><span class="w">    </span><span class="c1">// as it returns whatever input it received</span>
<a id="__codelineno-19-7" name="__codelineno-19-7"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">identity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">a</span><span class="o">:</span><span class="w"> </span><span class="kt">T</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nx">T</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">a</span><span class="p">;</span>
<a id="__codelineno-19-8" name="__codelineno-19-8"></a>
<a id="__codelineno-19-9" name="__codelineno-19-9"></a><span class="w">    </span><span class="c1">// Fast Check assert that the following holds for all arrays of integers</span>
<a id="__codelineno-19-10" name="__codelineno-19-10"></a><span class="w">    </span><span class="nx">fc</span><span class="p">.</span><span class="nx">assert</span><span class="p">(</span>
<a id="__codelineno-19-11" name="__codelineno-19-11"></a><span class="w">      </span><span class="c1">// data is the array of numbers</span>
<a id="__codelineno-19-12" name="__codelineno-19-12"></a><span class="w">      </span><span class="nx">fc</span><span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="nx">fc</span><span class="p">.</span><span class="nx">array</span><span class="p">(</span><span class="nx">fc</span><span class="p">.</span><span class="nx">integer</span><span class="p">()),</span><span class="w"> </span><span class="p">(</span><span class="nx">data</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-19-13" name="__codelineno-19-13"></a><span class="w">        </span><span class="c1">// We call the map function with the identify function</span>
<a id="__codelineno-19-14" name="__codelineno-19-14"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">identity</span><span class="p">);</span>
<a id="__codelineno-19-15" name="__codelineno-19-15"></a>
<a id="__codelineno-19-16" name="__codelineno-19-16"></a><span class="w">        </span><span class="c1">// We make sure that our result has the same length</span>
<a id="__codelineno-19-17" name="__codelineno-19-17"></a><span class="w">        </span><span class="nx">expect</span><span class="p">(</span><span class="nx">result</span><span class="p">).</span><span class="nx">toHaveLength</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
<a id="__codelineno-19-18" name="__codelineno-19-18"></a><span class="w">      </span><span class="p">})</span>
<a id="__codelineno-19-19" name="__codelineno-19-19"></a><span class="w">    </span><span class="p">);</span>
<a id="__codelineno-19-20" name="__codelineno-19-20"></a><span class="w">  </span><span class="p">});</span>
</code></pre></div></td></tr></table></div>
<p>If we run this test, we'll end up passing. But what is the value of <code>data</code>?</p>
<p>By adding a <code>console.log</code> in the test, we'll see the following values printed when we run the test (there are quite a few, so we'll examine the first few).</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-20-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-20-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-20-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-20-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-20-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-20-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-20-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-20-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-20-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-20-10">10</a></span>
<span class="normal"><a href="#__codelineno-20-11">11</a></span>
<span class="normal"><a href="#__codelineno-20-12">12</a></span>
<span class="normal"><a href="#__codelineno-20-13">13</a></span>
<span class="normal"><a href="#__codelineno-20-14">14</a></span>
<span class="normal"><a href="#__codelineno-20-15">15</a></span>
<span class="normal"><a href="#__codelineno-20-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1"></a>console.log
<a id="__codelineno-20-2" name="__codelineno-20-2"></a><span class="w">    </span><span class="o">[</span>
<a id="__codelineno-20-3" name="__codelineno-20-3"></a><span class="w">       </span><span class="m">2125251991</span>,<span class="w">  </span><span class="m">1334674146</span>,
<a id="__codelineno-20-4" name="__codelineno-20-4"></a><span class="w">      </span>-1531633149,<span class="w">   </span><span class="m">332890473</span>,
<a id="__codelineno-20-5" name="__codelineno-20-5"></a><span class="w">       </span><span class="m">1313556939</span>,<span class="w">   </span><span class="m">907640912</span>,
<a id="__codelineno-20-6" name="__codelineno-20-6"></a><span class="w">        </span><span class="m">887735692</span>,<span class="w"> </span>-1979633703,
<a id="__codelineno-20-7" name="__codelineno-20-7"></a><span class="w">       </span>-259341001,<span class="w">  </span><span class="m">2015321027</span>
<a id="__codelineno-20-8" name="__codelineno-20-8"></a><span class="w">    </span><span class="o">]</span>
<a id="__codelineno-20-9" name="__codelineno-20-9"></a>
<a id="__codelineno-20-10" name="__codelineno-20-10"></a><span class="w">  </span>console.log
<a id="__codelineno-20-11" name="__codelineno-20-11"></a><span class="w">    </span><span class="o">[</span><span class="w"> </span><span class="m">1307879257</span><span class="w"> </span><span class="o">]</span>
<a id="__codelineno-20-12" name="__codelineno-20-12"></a>
<a id="__codelineno-20-13" name="__codelineno-20-13"></a><span class="w">  </span>console.log
<a id="__codelineno-20-14" name="__codelineno-20-14"></a><span class="w">    </span><span class="o">[]</span>
<a id="__codelineno-20-15" name="__codelineno-20-15"></a>
<a id="__codelineno-20-16" name="__codelineno-20-16"></a><span class="w">  </span><span class="c1"># quite a few more...</span>
</code></pre></div></td></tr></table></div>
<h4 id="checking-type-property"><a class="toclink" href="../../../../2024/04/09/exploring-map-with-property-based-thinking/#checking-type-property">Checking Type Property</a></h4>
<p>We've proven that the length property is being followed, so let's look at how we can ensure that <code>result</code> has the right type.</p>
<p>To keep things simple, we're going to start with a <code>string[]</code> and map them to their lengths, yielding <code>number[]</code>.</p>
<p>If <code>map</code> is working, then the result should be all <code>number</code>s.</p>
<p>We can leverage <a href="https://www.typescriptlang.org/docs/handbook/2/typeof-types.html"><code>typeof</code></a> to check the type of each element in the array.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-21-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-21-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-21-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-21-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-21-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-21-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-21-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-21-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-21-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-21-10">10</a></span>
<span class="normal"><a href="#__codelineno-21-11">11</a></span>
<span class="normal"><a href="#__codelineno-21-12">12</a></span>
<span class="normal"><a href="#__codelineno-21-13">13</a></span>
<span class="normal"><a href="#__codelineno-21-14">14</a></span>
<span class="normal"><a href="#__codelineno-21-15">15</a></span>
<span class="normal"><a href="#__codelineno-21-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1"></a><span class="c1">// An additional test in the describe block</span>
<a id="__codelineno-21-2" name="__codelineno-21-2"></a>
<a id="__codelineno-21-3" name="__codelineno-21-3"></a><span class="nx">it</span><span class="p">(</span><span class="s2">&quot;maintains type&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-21-4" name="__codelineno-21-4"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">getLength</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">s</span><span class="o">:</span><span class="kt">string</span><span class="p">)=&gt;</span><span class="nx">s</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
<a id="__codelineno-21-5" name="__codelineno-21-5"></a><span class="w">  </span><span class="nx">fc</span><span class="p">.</span><span class="nx">assert</span><span class="p">(</span>
<a id="__codelineno-21-6" name="__codelineno-21-6"></a><span class="w">    </span><span class="c1">// asserting with an array of strings</span>
<a id="__codelineno-21-7" name="__codelineno-21-7"></a><span class="w">    </span><span class="nx">fc</span><span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="nx">fc</span><span class="p">.</span><span class="nx">array</span><span class="p">(</span><span class="nx">fc</span><span class="p">.</span><span class="kt">string</span><span class="p">()),</span><span class="w"> </span><span class="p">(</span><span class="nx">data</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-21-8" name="__codelineno-21-8"></a><span class="w">      </span><span class="c1">// mapping to lengths of strings</span>
<a id="__codelineno-21-9" name="__codelineno-21-9"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">getLength</span><span class="p">);</span>
<a id="__codelineno-21-10" name="__codelineno-21-10"></a>
<a id="__codelineno-21-11" name="__codelineno-21-11"></a><span class="w">      </span><span class="c1">// checking that all values are numbers</span>
<a id="__codelineno-21-12" name="__codelineno-21-12"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">isAllValid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">result</span><span class="p">.</span><span class="nx">every</span><span class="p">((</span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">typeof</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;number&quot;</span><span class="p">);</span>
<a id="__codelineno-21-13" name="__codelineno-21-13"></a><span class="w">      </span><span class="nx">expect</span><span class="p">(</span><span class="nx">isAllValid</span><span class="p">).</span><span class="nx">toBeTruthy</span><span class="p">();</span>
<a id="__codelineno-21-14" name="__codelineno-21-14"></a><span class="w">    </span><span class="p">})</span>
<a id="__codelineno-21-15" name="__codelineno-21-15"></a><span class="w">  </span><span class="p">);</span>
<a id="__codelineno-21-16" name="__codelineno-21-16"></a><span class="p">});</span>
</code></pre></div></td></tr></table></div>
<p>Like before, we can add a <code>console.log</code> to the test to see what strings are being generated</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-22-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-22-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-22-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-22-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-22-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-22-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-22-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-22-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-22-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-22-10">10</a></span>
<span class="normal"><a href="#__codelineno-22-11">11</a></span>
<span class="normal"><a href="#__codelineno-22-12">12</a></span>
<span class="normal"><a href="#__codelineno-22-13">13</a></span>
<span class="normal"><a href="#__codelineno-22-14">14</a></span>
<span class="normal"><a href="#__codelineno-22-15">15</a></span>
<span class="normal"><a href="#__codelineno-22-16">16</a></span>
<span class="normal"><a href="#__codelineno-22-17">17</a></span>
<span class="normal"><a href="#__codelineno-22-18">18</a></span>
<span class="normal"><a href="#__codelineno-22-19">19</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1"></a>console.log
<a id="__codelineno-22-2" name="__codelineno-22-2"></a><span class="w">  </span><span class="o">[</span><span class="w"> </span><span class="s1">&#39;ptpJTR`G4&#39;</span>,<span class="w"> </span><span class="s1">&#39;s &gt;xmpXI&#39;</span>,<span class="w"> </span><span class="s1">&#39;H++%;a3Y&#39;</span>,<span class="w"> </span><span class="s1">&#39;OFD|+X8&#39;</span>,<span class="w"> </span><span class="s1">&#39;gp&#39;</span><span class="w"> </span><span class="o">]</span>
<a id="__codelineno-22-3" name="__codelineno-22-3"></a>
<a id="__codelineno-22-4" name="__codelineno-22-4"></a>console.log
<a id="__codelineno-22-5" name="__codelineno-22-5"></a><span class="w">  </span><span class="o">[</span><span class="w"> </span><span class="s1">&#39;Rq&#39;</span>,<span class="w"> </span><span class="s1">&#39;&#39;</span>,<span class="w"> </span><span class="s1">&#39;V&amp;+)Zy2VD8&#39;</span><span class="w"> </span><span class="o">]</span>
<a id="__codelineno-22-6" name="__codelineno-22-6"></a>
<a id="__codelineno-22-7" name="__codelineno-22-7"></a>
<a id="__codelineno-22-8" name="__codelineno-22-8"></a>console.log
<a id="__codelineno-22-9" name="__codelineno-22-9"></a><span class="w">  </span><span class="o">[</span><span class="w"> </span><span class="s1">&#39;o%}&#39;</span>,<span class="w"> </span><span class="s1">&#39;$o&#39;</span>,<span class="w"> </span><span class="s1">&#39;w7C&#39;</span>,<span class="w"> </span><span class="s1">&#39;O+!e&#39;</span>,<span class="w"> </span><span class="s1">&#39;NS$:4\\9aq&#39;</span>,<span class="w"> </span><span class="s1">&#39;xPbb}=F7h&#39;</span>,<span class="w"> </span><span class="s1">&#39;z&#39;</span><span class="w"> </span><span class="o">]</span>
<a id="__codelineno-22-10" name="__codelineno-22-10"></a>
<a id="__codelineno-22-11" name="__codelineno-22-11"></a>console.log
<a id="__codelineno-22-12" name="__codelineno-22-12"></a><span class="w">  </span><span class="o">[</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w"> </span><span class="o">]</span>
<a id="__codelineno-22-13" name="__codelineno-22-13"></a>
<a id="__codelineno-22-14" name="__codelineno-22-14"></a>console.log
<a id="__codelineno-22-15" name="__codelineno-22-15"></a><span class="w">  </span><span class="o">[</span><span class="w"> </span><span class="s1">&#39;apply&#39;</span>,<span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w"> </span><span class="o">]</span>
<a id="__codelineno-22-16" name="__codelineno-22-16"></a>
<a id="__codelineno-22-17" name="__codelineno-22-17"></a>console.log
<a id="__codelineno-22-18" name="__codelineno-22-18"></a><span class="w">  </span><span class="o">[]</span>
<a id="__codelineno-22-19" name="__codelineno-22-19"></a><span class="c1">## And many more entries...</span>
</code></pre></div></td></tr></table></div>
<h4 id="checking-order-property"><a class="toclink" href="../../../../2024/04/09/exploring-map-with-property-based-thinking/#checking-order-property">Checking Order Property</a></h4>
<p>For our third property, we need to ensure that the order of the array is being maintained.</p>
<p>To make this happen, we can use our <code>identity</code> function from before and check that our result is the same as the input. If so, then we know that the order is being maintained.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-23-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-23-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-23-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-23-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-23-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-23-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-23-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-23-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-23-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-23-10">10</a></span>
<span class="normal"><a href="#__codelineno-23-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1"></a><span class="nx">it</span><span class="p">(</span><span class="s2">&quot;maintains order&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-23-2" name="__codelineno-23-2"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">identity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">a</span><span class="o">:</span><span class="w"> </span><span class="kt">T</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">a</span><span class="p">;</span>
<a id="__codelineno-23-3" name="__codelineno-23-3"></a>
<a id="__codelineno-23-4" name="__codelineno-23-4"></a><span class="w">  </span><span class="nx">fc</span><span class="p">.</span><span class="nx">assert</span><span class="p">(</span>
<a id="__codelineno-23-5" name="__codelineno-23-5"></a><span class="w">    </span><span class="nx">fc</span><span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="nx">fc</span><span class="p">.</span><span class="nx">array</span><span class="p">(</span><span class="nx">fc</span><span class="p">.</span><span class="kt">string</span><span class="p">()),</span><span class="w"> </span><span class="p">(</span><span class="nx">data</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="ow">void</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-23-6" name="__codelineno-23-6"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">identity</span><span class="p">);</span>
<a id="__codelineno-23-7" name="__codelineno-23-7"></a>
<a id="__codelineno-23-8" name="__codelineno-23-8"></a><span class="w">      </span><span class="nx">expect</span><span class="p">(</span><span class="nx">result</span><span class="p">).</span><span class="nx">toEqual</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
<a id="__codelineno-23-9" name="__codelineno-23-9"></a><span class="w">    </span><span class="p">})</span>
<a id="__codelineno-23-10" name="__codelineno-23-10"></a><span class="w">  </span><span class="p">);</span>
<a id="__codelineno-23-11" name="__codelineno-23-11"></a><span class="p">});</span>
</code></pre></div></td></tr></table></div>
<p>And with that, we've verified that our third property holds!</p>
<h3 id="so-what-why-properties"><a class="toclink" href="../../../../2024/04/09/exploring-map-with-property-based-thinking/#so-what-why-properties">So What, Why Properties?</a></h3>
<p>When I think about the code I write, I'm thinking about the way it works, the way it <em>should</em> work, and the ways it <em>shouldn't</em> work. I find example based tests to help understand a business flow because of it's concrete values while property based tests help me understand the general guarantees of the code.</p>
<p>I find that once I start thinking in properties, my code became cleaner because there's logic that I no longer had to write. In our <code>map</code> example, we don't have to write checks for if we have null or undefined because <code>map</code> <em>always</em> returns an array (empty in the worse case). There's also no need to write error handling because as long as the mapping function is pure, <code>map</code> will <em>always</em> return an array.</p>
<p>For those looking to learn more about functional programming, you'll find that properties help describe the higher level constructs (functors, monoids, and monads) and what to look for.</p>
<p>Finding properties can be a challenge, however, Scott Wlaschin (of FSharpForFunAndProfit) has a <a href="https://fsharpforfunandprofit.com/posts/property-based-testing-2/">great post talking about design patterns</a> that I've found to be immensely helpful.</p>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/cameronpresley.png" alt="Cameron Presley">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2023-10-23 00:00:00+00:00">Oct 23, 2023</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../../../process/" class="md-meta__link">Process</a>, 
              <a href="../../" class="md-meta__link">TypeScript</a></li>
        
        
          
          <li class="md-meta__item">
            
              6 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="scaling-effectiveness-with-docs-finding-stale-docs"><a class="toclink" href="../../../../2023/10/23/scaling-effectiveness-with-docs---finding-stale-docs/">Scaling Effectiveness with Docs - Finding Stale Docs</a></h2>
<p>In a <a href="../../../../2023/07/18/scaling-effectiveness-with-docs/">previous post</a>, I argued that to help your team be effective, you need to have up-to-date docs, and to have this happen, you need some way of flagging stale documentation.</p>
<p>In this series, I show you how you can automate this process by creating a <em>seed</em> script, a <em>check</em> script, and then automating the <em>check</em> script. In today's post, let's develop the <em>check</em> script.</p>
<h3 id="breaking-down-the-check-script"><a class="toclink" href="../../../../2023/10/23/scaling-effectiveness-with-docs---finding-stale-docs/#breaking-down-the-check-script">Breaking Down the Check Script</a></h3>
<p>At a high level, our script will need to perform the following steps:</p>
<ol>
<li>Specify the location to search.</li>
<li>Find all the markdown files in directory.</li>
<li>Get the "Last Reviewed" line of text.</li>
<li>Check if the date is more than 90 days in the past.</li>
<li>If so, print the file to the screen.</li>
</ol>
<h3 id="specifying-location"><a class="toclink" href="../../../../2023/10/23/scaling-effectiveness-with-docs---finding-stale-docs/#specifying-location">Specifying Location</a></h3>
<p>Our script is going to search over our repository, however, I don't want our script to be responsible for cloning and cleaning up those files. Since the long term plan is for our script to run through GitHub Actions, we can have the pipeline be responsible for cloning the repo.</p>
<p>This means that our script will have to be told where to search and since it can't take in manual input, we're going to use an <em>environment variable</em> to tell the script where to search.</p>
<p>First, let's create a <code>.env</code> file that will store the path of the repository:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">.env</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-24-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1"></a><span class="nv">REPO_DIRECTORY</span><span class="o">=</span><span class="s2">&quot;ABSOLUTE PATH GOES HERE&quot;</span>
</code></pre></div></td></tr></table></div>
<p>From there, we can start working on our script to have it use this environment variable.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">index.ts</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-25-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-25-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-25-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-25-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-25-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-25-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-25-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-25-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-25-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-25-10">10</a></span>
<span class="normal"><a href="#__codelineno-25-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">load</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;https://deno.land/std@0.195.0/dotenv/mod.ts&quot;</span><span class="p">;</span>
<a id="__codelineno-25-2" name="__codelineno-25-2"></a>
<a id="__codelineno-25-3" name="__codelineno-25-3"></a><span class="k">await</span><span class="w"> </span><span class="nx">load</span><span class="p">({</span><span class="w"> </span><span class="nx">export</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="w"> </span><span class="p">});</span><span class="w"> </span><span class="c1">// this loads the env file into our environment</span>
<a id="__codelineno-25-4" name="__codelineno-25-4"></a>
<a id="__codelineno-25-5" name="__codelineno-25-5"></a><span class="kd">const</span><span class="w"> </span><span class="nx">directory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Deno</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;REPO_DIRECTORY&quot;</span><span class="p">);</span>
<a id="__codelineno-25-6" name="__codelineno-25-6"></a>
<a id="__codelineno-25-7" name="__codelineno-25-7"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">directory</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-25-8" name="__codelineno-25-8"></a><span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Couldn&#39;t retrieve the REPO_DIRECTORY value from environment.&quot;</span><span class="p">);</span>
<a id="__codelineno-25-9" name="__codelineno-25-9"></a><span class="w">  </span><span class="nx">Deno</span><span class="p">.</span><span class="nx">exit</span><span class="p">();</span>
<a id="__codelineno-25-10" name="__codelineno-25-10"></a><span class="p">}</span>
<a id="__codelineno-25-11" name="__codelineno-25-11"></a><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">directory</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<p>If we were to run our Deno script with the following command <code>deno run --allow-read --allow-env ./index.ts</code>, we should see the environment variable getting logged.</p>
<h3 id="finding-all-the-markdown-files"><a class="toclink" href="../../../../2023/10/23/scaling-effectiveness-with-docs---finding-stale-docs/#finding-all-the-markdown-files">Finding all the Markdown Files</a></h3>
<p>Now that we have a directory, we need a way to get all the markdown files from that location.</p>
<p>Doing some digging, I didn't find a built-in library for doing this, but building our own isn't too terrible.</p>
<p>By using <a href="https://deno.land/api@v1.36.1?s=Deno.readDirSync"><code>Deno.readDir/Sync</code></a>, we can get all the entries in the specified directory.</p>
<p>From here, we can then <a href="https://en.wikipedia.org/wiki/Recursion_%28computer_science%29#Recursive_functions_and_algorithms">recurse</a> into the other folders and get their markdown files as well.</p>
<p>Let's create a new file, <code>utility.ts</code> and add a new function, <code>getMarkdownFilesFromDirectory</code></p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">utility.ts</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-26-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-26-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-26-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-26-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-26-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-26-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-26-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-26-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-26-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-26-10">10</a></span>
<span class="normal"><a href="#__codelineno-26-11">11</a></span>
<span class="normal"><a href="#__codelineno-26-12">12</a></span>
<span class="normal"><a href="#__codelineno-26-13">13</a></span>
<span class="normal"><a href="#__codelineno-26-14">14</a></span>
<span class="normal"><a href="#__codelineno-26-15">15</a></span>
<span class="normal"><a href="#__codelineno-26-16">16</a></span>
<span class="normal"><a href="#__codelineno-26-17">17</a></span>
<span class="normal"><a href="#__codelineno-26-18">18</a></span>
<span class="normal"><a href="#__codelineno-26-19">19</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1"></a><span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">getMarkdownFilesFromDirectory</span><span class="p">(</span><span class="nx">directory</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[]</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-26-2" name="__codelineno-26-2"></a><span class="w">  </span><span class="c1">// let&#39;s get all the files from the directory</span>
<a id="__codelineno-26-3" name="__codelineno-26-3"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">allEntries</span><span class="o">:</span><span class="w"> </span><span class="kt">Deno.DirEntry</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Array</span><span class="p">.</span><span class="kr">from</span><span class="p">(</span><span class="nx">Deno</span><span class="p">.</span><span class="nx">readDirSync</span><span class="p">(</span><span class="nx">directory</span><span class="p">));</span>
<a id="__codelineno-26-4" name="__codelineno-26-4"></a>
<a id="__codelineno-26-5" name="__codelineno-26-5"></a><span class="w">  </span><span class="c1">// Get all the markdown files in the current directory</span>
<a id="__codelineno-26-6" name="__codelineno-26-6"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">markdownFiles</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">allEntries</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span>
<a id="__codelineno-26-7" name="__codelineno-26-7"></a><span class="w">    </span><span class="p">(</span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">x</span><span class="p">.</span><span class="nx">isFile</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">x</span><span class="p">.</span><span class="nx">name</span><span class="p">.</span><span class="nx">endsWith</span><span class="p">(</span><span class="s2">&quot;.md&quot;</span><span class="p">)</span>
<a id="__codelineno-26-8" name="__codelineno-26-8"></a><span class="w">  </span><span class="p">);</span>
<a id="__codelineno-26-9" name="__codelineno-26-9"></a><span class="w">  </span><span class="c1">// Find all the folders in the directory</span>
<a id="__codelineno-26-10" name="__codelineno-26-10"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">folders</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">allEntries</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span>
<a id="__codelineno-26-11" name="__codelineno-26-11"></a><span class="w">    </span><span class="p">(</span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">x</span><span class="p">.</span><span class="nx">isDirectory</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="nx">x</span><span class="p">.</span><span class="nx">name</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
<a id="__codelineno-26-12" name="__codelineno-26-12"></a><span class="w">  </span><span class="p">);</span>
<a id="__codelineno-26-13" name="__codelineno-26-13"></a><span class="w">  </span><span class="c1">// Recurse into each folder and get their markdown files</span>
<a id="__codelineno-26-14" name="__codelineno-26-14"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">subFiles</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">folders</span><span class="p">.</span><span class="nx">flatMap</span><span class="p">((</span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span>
<a id="__codelineno-26-15" name="__codelineno-26-15"></a><span class="w">    </span><span class="nx">getMarkdownFilesFromDirectory</span><span class="p">(</span><span class="sb">`</span><span class="si">${</span><span class="nx">directory</span><span class="si">}</span><span class="sb">/</span><span class="si">${</span><span class="nx">x</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="sb">`</span><span class="p">)</span>
<a id="__codelineno-26-16" name="__codelineno-26-16"></a><span class="w">  </span><span class="p">);</span>
<a id="__codelineno-26-17" name="__codelineno-26-17"></a><span class="w">  </span><span class="c1">// Return the markdown files in the current directory and the markdown files in the children directories</span>
<a id="__codelineno-26-18" name="__codelineno-26-18"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">markdownFiles</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="sb">`</span><span class="si">${</span><span class="nx">directory</span><span class="si">}</span><span class="sb">/</span><span class="si">${</span><span class="nx">x</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="sb">`</span><span class="p">).</span><span class="nx">concat</span><span class="p">(</span><span class="nx">subFiles</span><span class="p">);</span>
<a id="__codelineno-26-19" name="__codelineno-26-19"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>With this function in place, we can update our <code>index.ts</code> script to be the following:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">index.ts</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-27-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-27-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-27-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-27-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-27-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-27-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-27-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-27-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-27-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-27-10">10</a></span>
<span class="normal"><a href="#__codelineno-27-11">11</a></span>
<span class="normal"><a href="#__codelineno-27-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">load</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;https://deno.land/std@0.195.0/dotenv/mod.ts&quot;</span><span class="p">;</span>
<a id="__codelineno-27-2" name="__codelineno-27-2"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">getMarkdownFilesFromDirectory</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;./utility.ts&quot;</span><span class="p">;</span>
<a id="__codelineno-27-3" name="__codelineno-27-3"></a>
<a id="__codelineno-27-4" name="__codelineno-27-4"></a><span class="kd">const</span><span class="w"> </span><span class="nx">directory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Deno</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;REPO_DIRECTORY&quot;</span><span class="p">);</span>
<a id="__codelineno-27-5" name="__codelineno-27-5"></a>
<a id="__codelineno-27-6" name="__codelineno-27-6"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">directory</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-27-7" name="__codelineno-27-7"></a><span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Couldn&#39;t retrieve the REPO_DIRECTORY value from environment.&quot;</span><span class="p">);</span>
<a id="__codelineno-27-8" name="__codelineno-27-8"></a><span class="w">  </span><span class="nx">Deno</span><span class="p">.</span><span class="nx">exit</span><span class="p">();</span>
<a id="__codelineno-27-9" name="__codelineno-27-9"></a><span class="p">}</span>
<a id="__codelineno-27-10" name="__codelineno-27-10"></a>
<a id="__codelineno-27-11" name="__codelineno-27-11"></a><span class="kd">const</span><span class="w"> </span><span class="nx">files</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">getMarkdownFilesFromDirectory</span><span class="p">(</span><span class="nx">directory</span><span class="p">);</span>
<a id="__codelineno-27-12" name="__codelineno-27-12"></a><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">files</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<p>Running the script with <code>deno run --allow-read --allow-env ./index.ts</code>, should get a list of all the markdown files being printed to the screen.</p>
<h3 id="getting-the-last-reviewed-text"><a class="toclink" href="../../../../2023/10/23/scaling-effectiveness-with-docs---finding-stale-docs/#getting-the-last-reviewed-text">Getting the Last Reviewed Text</a></h3>
<p>Now that we have each file, we need a way to get their last line of text.</p>
<p>Using <a href="">Deno.readTextFile/Sync</a>, we can get the file contents. From there, we can convert them to lines and then find the latest occurrence of <em>Last Reviewed</em></p>
<p>Let's add a new function, <code>getLastReviewedLine</code> to the <code>utility.ts</code> file.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">utility.ts</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-28-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-28-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-28-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-28-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-28-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-28-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-28-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-28-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-28-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-28-10">10</a></span>
<span class="normal"><a href="#__codelineno-28-11">11</a></span>
<span class="normal"><a href="#__codelineno-28-12">12</a></span>
<span class="normal"><a href="#__codelineno-28-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1"></a><span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">getLastReviewedLine</span><span class="p">(</span><span class="nx">fullPath</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-28-2" name="__codelineno-28-2"></a><span class="w">  </span><span class="c1">// Get the contents of the file, removing extra whitespace and blank lines</span>
<a id="__codelineno-28-3" name="__codelineno-28-3"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">fileContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Deno</span><span class="p">.</span><span class="nx">readTextFileSync</span><span class="p">(</span><span class="nx">fullPath</span><span class="p">).</span><span class="nx">trim</span><span class="p">();</span>
<a id="__codelineno-28-4" name="__codelineno-28-4"></a>
<a id="__codelineno-28-5" name="__codelineno-28-5"></a><span class="w">  </span><span class="c1">// Convert block of text to a array of strings</span>
<a id="__codelineno-28-6" name="__codelineno-28-6"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">lines</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fileContent</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;\n&quot;</span><span class="p">);</span>
<a id="__codelineno-28-7" name="__codelineno-28-7"></a>
<a id="__codelineno-28-8" name="__codelineno-28-8"></a><span class="w">  </span><span class="c1">// Find the last line that starts with Last Reviewed On</span>
<a id="__codelineno-28-9" name="__codelineno-28-9"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">lastReviewed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">lines</span><span class="p">.</span><span class="nx">findLast</span><span class="p">((</span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">x</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="s2">&quot;Last Reviewed On&quot;</span><span class="p">));</span>
<a id="__codelineno-28-10" name="__codelineno-28-10"></a>
<a id="__codelineno-28-11" name="__codelineno-28-11"></a><span class="w">  </span><span class="c1">// If we found it, return the line, otherwise, return an empty string</span>
<a id="__codelineno-28-12" name="__codelineno-28-12"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">lastReviewed</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">;</span>
<a id="__codelineno-28-13" name="__codelineno-28-13"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Let's try this function out by modifying our <code>index.ts</code> file to display files that don't have a Last Reviewed On line.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">index.ts</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-29-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-29-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-29-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-29-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-29-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-29-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-29-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-29-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-29-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-29-10">10</a></span>
<span class="normal"><a href="#__codelineno-29-11">11</a></span>
<span class="normal"><a href="#__codelineno-29-12">12</a></span>
<span class="normal"><a href="#__codelineno-29-13">13</a></span>
<span class="normal"><a href="#__codelineno-29-14">14</a></span>
<span class="normal"><a href="#__codelineno-29-15">15</a></span>
<span class="normal"><a href="#__codelineno-29-16">16</a></span>
<span class="normal"><a href="#__codelineno-29-17">17</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">load</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;https://deno.land/std@0.195.0/dotenv/mod.ts&quot;</span><span class="p">;</span>
<a id="__codelineno-29-2" name="__codelineno-29-2"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-29-3" name="__codelineno-29-3"></a><span class="w">  </span><span class="nx">getMarkdownFilesFromDirectory</span><span class="p">,</span>
<a id="__codelineno-29-4" name="__codelineno-29-4"></a><span class="w">  </span><span class="nx">getLastReviewedLine</span><span class="p">,</span>
<a id="__codelineno-29-5" name="__codelineno-29-5"></a><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;./utility.ts&quot;</span><span class="p">;</span>
<a id="__codelineno-29-6" name="__codelineno-29-6"></a>
<a id="__codelineno-29-7" name="__codelineno-29-7"></a><span class="kd">const</span><span class="w"> </span><span class="nx">directory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Deno</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;REPO_DIRECTORY&quot;</span><span class="p">);</span>
<a id="__codelineno-29-8" name="__codelineno-29-8"></a>
<a id="__codelineno-29-9" name="__codelineno-29-9"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">directory</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-29-10" name="__codelineno-29-10"></a><span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Couldn&#39;t retrieve the REPO_DIRECTORY value from environment.&quot;</span><span class="p">);</span>
<a id="__codelineno-29-11" name="__codelineno-29-11"></a><span class="w">  </span><span class="nx">Deno</span><span class="p">.</span><span class="nx">exit</span><span class="p">();</span>
<a id="__codelineno-29-12" name="__codelineno-29-12"></a><span class="p">}</span>
<a id="__codelineno-29-13" name="__codelineno-29-13"></a>
<a id="__codelineno-29-14" name="__codelineno-29-14"></a><span class="kd">const</span><span class="w"> </span><span class="nx">files</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">getMarkdownFilesFromDirectory</span><span class="p">(</span><span class="nx">directory</span><span class="p">);</span>
<a id="__codelineno-29-15" name="__codelineno-29-15"></a><span class="nx">files</span>
<a id="__codelineno-29-16" name="__codelineno-29-16"></a><span class="w">  </span><span class="p">.</span><span class="nx">filter</span><span class="p">((</span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">getLastReviewedLine</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-29-17" name="__codelineno-29-17"></a><span class="w">  </span><span class="p">.</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">s</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">s</span><span class="p">));</span><span class="w"> </span><span class="c1">// print them to the screen</span>
</code></pre></div></td></tr></table></div>
<h4 id="determining-if-a-page-is-stale"><a class="toclink" href="../../../../2023/10/23/scaling-effectiveness-with-docs---finding-stale-docs/#determining-if-a-page-is-stale">Determining If A Page Is Stale</a></h4>
<p>At this point, we can get the "Last Reviewed On" line from a file, but we've got some more business rules to implement.</p>
<ul>
<li>If there's a <em>Last Reviewed On</em> line, but there's no date, then the files needs to be reviewed</li>
<li>If there's a <em>Last Reviewed On</em> line, but the date is invalid, then the file needs to be reviewed</li>
<li>If there's a <em>Last Reviewed On</em> line, and the date is more than 90 days old, then the file needs to be reviewed.</li>
<li>Otherwise, the file doesn't need review.</li>
</ul>
<p>We know from our filter logic that we're only going to be looking at lines that start with "Last Reviewed On", so now we need to extract the date.</p>
<p>Since we assume our format is <em>Last Reviewed On</em>, we can use substring to get the rest of the line. We're also going to assume that the date will be in YYYY/MM/DD format.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">utility.ts</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-30-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-30-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-30-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-30-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-30-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-30-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-30-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-30-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-30-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-30-10">10</a></span>
<span class="normal"><a href="#__codelineno-30-11">11</a></span>
<span class="normal"><a href="#__codelineno-30-12">12</a></span>
<span class="normal"><a href="#__codelineno-30-13">13</a></span>
<span class="normal"><a href="#__codelineno-30-14">14</a></span>
<span class="normal"><a href="#__codelineno-30-15">15</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1"></a><span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">doesFileNeedReview</span><span class="p">(</span><span class="nx">line</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-30-2" name="__codelineno-30-2"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">line</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="s2">&quot;Last Reviewed On: &quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-30-3" name="__codelineno-30-3"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<a id="__codelineno-30-4" name="__codelineno-30-4"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-30-5" name="__codelineno-30-5"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">line</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s2">&quot;Last Reviewed On: &quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">).</span><span class="nx">trim</span><span class="p">();</span>
<a id="__codelineno-30-6" name="__codelineno-30-6"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">parsedDate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">date</span><span class="p">));</span>
<a id="__codelineno-30-7" name="__codelineno-30-7"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">parsedDate</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-30-8" name="__codelineno-30-8"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<a id="__codelineno-30-9" name="__codelineno-30-9"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-30-10" name="__codelineno-30-10"></a>
<a id="__codelineno-30-11" name="__codelineno-30-11"></a><span class="w">  </span><span class="c1">// We could something like DayJS, but trying to keep libraries to a minimum, we can do the following</span>
<a id="__codelineno-30-12" name="__codelineno-30-12"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">cutOffDate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">().</span><span class="nx">setDate</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">().</span><span class="nx">getDate</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">90</span><span class="p">));</span>
<a id="__codelineno-30-13" name="__codelineno-30-13"></a>
<a id="__codelineno-30-14" name="__codelineno-30-14"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">parsedDate</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">cutOffDate</span><span class="p">;</span>
<a id="__codelineno-30-15" name="__codelineno-30-15"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Let's update our <code>index.ts</code> file to use the new function.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">index.ts</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-31-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-31-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-31-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-31-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-31-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-31-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-31-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-31-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-31-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-31-10">10</a></span>
<span class="normal"><a href="#__codelineno-31-11">11</a></span>
<span class="normal"><a href="#__codelineno-31-12">12</a></span>
<span class="normal"><a href="#__codelineno-31-13">13</a></span>
<span class="normal"><a href="#__codelineno-31-14">14</a></span>
<span class="normal"><a href="#__codelineno-31-15">15</a></span>
<span class="normal"><a href="#__codelineno-31-16">16</a></span>
<span class="normal"><a href="#__codelineno-31-17">17</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">load</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;https://deno.land/std@0.195.0/dotenv/mod.ts&quot;</span><span class="p">;</span>
<a id="__codelineno-31-2" name="__codelineno-31-2"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-31-3" name="__codelineno-31-3"></a><span class="w">  </span><span class="nx">getMarkdownFilesFromDirectory</span><span class="p">,</span>
<a id="__codelineno-31-4" name="__codelineno-31-4"></a><span class="w">  </span><span class="nx">getLastReviewedLine</span><span class="p">,</span>
<a id="__codelineno-31-5" name="__codelineno-31-5"></a><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;./utility.ts&quot;</span><span class="p">;</span>
<a id="__codelineno-31-6" name="__codelineno-31-6"></a>
<a id="__codelineno-31-7" name="__codelineno-31-7"></a><span class="kd">const</span><span class="w"> </span><span class="nx">directory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Deno</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;REPO_DIRECTORY&quot;</span><span class="p">);</span>
<a id="__codelineno-31-8" name="__codelineno-31-8"></a>
<a id="__codelineno-31-9" name="__codelineno-31-9"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">directory</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-31-10" name="__codelineno-31-10"></a><span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Couldn&#39;t retrieve the REPO_DIRECTORY value from environment.&quot;</span><span class="p">);</span>
<a id="__codelineno-31-11" name="__codelineno-31-11"></a><span class="w">  </span><span class="nx">Deno</span><span class="p">.</span><span class="nx">exit</span><span class="p">();</span>
<a id="__codelineno-31-12" name="__codelineno-31-12"></a><span class="p">}</span>
<a id="__codelineno-31-13" name="__codelineno-31-13"></a>
<a id="__codelineno-31-14" name="__codelineno-31-14"></a><span class="nx">getMarkdownFilesFromDirectory</span><span class="p">(</span><span class="nx">directory</span><span class="p">)</span>
<a id="__codelineno-31-15" name="__codelineno-31-15"></a><span class="w">  </span><span class="p">.</span><span class="nx">filter</span><span class="p">((</span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">getLastReviewedLine</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-31-16" name="__codelineno-31-16"></a><span class="w">  </span><span class="p">.</span><span class="nx">filter</span><span class="p">((</span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">doesFileNeedReview</span><span class="p">(</span><span class="nx">x</span><span class="p">))</span>
<a id="__codelineno-31-17" name="__codelineno-31-17"></a><span class="w">  </span><span class="p">.</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">s</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">s</span><span class="p">));</span><span class="w"> </span><span class="c1">// print them to the screen</span>
</code></pre></div></td></tr></table></div>
<p>And just like that, we're able to print stale docs to the screen. At this point, you could create a scheduled batch job and start using this script.</p>
<p>However, if you wanted to share this with others (and have this run not on your box), then stay tuned for the final post in this series where we put this into a GitHub Action and post a message to Slack!</p>
<h3 id="other-posts-in-the-series"><a class="toclink" href="../../../../2023/10/23/scaling-effectiveness-with-docs---finding-stale-docs/#other-posts-in-the-series">Other Posts In The Series</a></h3>
<ul>
<li><a href="../../../../2023/06/26/having-coffee-with-deno---inspiration/">Having Coffee with Deno - Inspiration</a></li>
<li><a href="../../../../2023/07/10/having-coffee-with-deno---dynamic-names/">Having Coffee with Deno - Dynamic Names</a></li>
<li><a href="../../../../2023/07/24/having-coffee-with-deno---sharing-the-news/">Having Coffee with Deno - Sharing the News</a></li>
<li><a href="../../../../2023/07/28/having-coffee-with-deno---automating-all-the-things/">Having Coffee with Deno - Automating All the Things</a></li>
</ul>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/cameronpresley.png" alt="Cameron Presley">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2023-07-28 00:00:00+00:00">Jul 28, 2023</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../../" class="md-meta__link">TypeScript</a></li>
        
        
          
          <li class="md-meta__item">
            
              5 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="having-coffee-with-deno-automating-all-the-things"><a class="toclink" href="../../../../2023/07/28/having-coffee-with-deno---automating-all-the-things/">Having Coffee with Deno - Automating All the Things</a></h2>
<p>Welcome to the final installment of our Deno series, where we build a script that pairs up people for coffee.</p>
<p>In the <a href="../../../../2023/07/24/having-coffee-with-deno---sharing-the-news/">last post</a>, we added the ability to post messages into a Slack channel instead of copying from a console window.</p>
<p>The current major problem is that <em>we</em> have to remember to run the script. We could always set up a <a href="https://phoenixnap.com/kb/set-up-cron-job-linux">cron job</a> or <a href="https://www.tomsguide.com/how-to/how-to-use-task-scheduler-on-windows">scheduled task</a>, however, what happens when we change machines? What if our computer stops working? What if someone else changes the script, how will we remember to get the latest and run it?</p>

    
      <nav class="md-post__action">
        <a href="../../../../2023/07/28/having-coffee-with-deno---automating-all-the-things/">
          Continue reading
        </a>
      </nav>
    
    
  </div>
</article>
      
      
        
          



<nav class="md-pagination">
  <a class="md-pagination__link" href="../../">1</a> <span class="md-pagination__current">2</span> <a class="md-pagination__link" href="../3/">3</a>
</nav>
        
      
    </div>
  </div>

          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../../../tooling/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Tooling">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Tooling
              </div>
            </div>
          </a>
        
        
          
          <a href="../../../../archive/2025/" class="md-footer__link md-footer__link--next" aria-label="Next: 2025">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                2025
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs Insiders
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.footer", "content.code.copy"], "search": "../../../../../assets/javascripts/workers/search.ad38c271.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.b66b2b78.min.js"></script>
      
    
  </body>
</html>