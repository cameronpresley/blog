
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Cameron Presley">
      
      
      
        <link rel="prev" href="../../../solid/">
      
      
        <link rel="next" href="../../../tooling/">
      
      
        
      
      
      <link rel="icon" href="../../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16+insiders-4.53.16">
    
    
      
        <title>Today I Learned - The Software Mentor</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.1caf78d2.min.css">
      
        
        <link rel="stylesheet" href="../../../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../stylesheets/page.css">
    
    <script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-ZE0MGVG7RJ"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-ZE0MGVG7RJ",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-ZE0MGVG7RJ",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#today-i-learned" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../.." title="The Software Mentor" class="md-header__button md-logo" aria-label="The Software Mentor" data-md-component="logo">
      
  <img src="../../../../../assets/images/favicon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            The Software Mentor
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Today I Learned
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="deep-purple"  aria-hidden="true"  type="radio" name="__palette" id="__palette_1">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../.." class="md-tabs__link">
        
  
  
    
  
  About Me

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../../" class="md-tabs__link">
          
  
  
  Articles

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../courses/" class="md-tabs__link">
        
  
  
    
  
  Training Course

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../level-up/" class="md-tabs__link">
        
  
  
    
  
  Level Up Resources

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../presentations/" class="md-tabs__link">
        
  
  
    
  
  Presentations

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../speaking-schedule/" class="md-tabs__link">
        
  
  
    
  
  Speaking Schedule

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../story/" class="md-tabs__link">
        
  
  
    
  
  Story

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../resume/" class="md-tabs__link">
        
  
  
    
  
  Resume

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../.." title="The Software Mentor" class="md-nav__button md-logo" aria-label="The Software Mentor" data-md-component="logo">
      
  <img src="../../../../../assets/images/favicon.png" alt="logo">

    </a>
    The Software Mentor
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    About Me
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Articles
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Articles
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Index
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Archive
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Archive
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../archive/2025/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2025
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../archive/2024/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2024
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../archive/2023/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2023
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../archive/2020/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2020
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../archive/2018/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2018
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../archive/2015/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2015
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../archive/2014/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2014
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../archive/2013/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2013
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" checked>
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Categories
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Categories
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../net/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    .NET
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../aws/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AWS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../basics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Basics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../c/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    C#
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../career/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Career
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../coaching-corner/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Coaching Corner
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../debugging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Debugging
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../functional-programming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Functional Programming
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../interviewing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Interviewing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../leadership/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Leadership
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../learning-through-example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Learning Through Example
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Process
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../solid/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SOLID
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
      
    
  
  
    <li class="md-nav__item">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="../../" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Today I Learned
  

    
  </span>
  
  

      </a>
      
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../tooling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tooling
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../typescript/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    TypeScript
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../courses/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Training Course
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../level-up/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Level Up Resources
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../presentations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Presentations
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../speaking-schedule/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Speaking Schedule
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../story/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Story
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../resume/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Resume
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
  <div class="md-content" data-md-component="content">
    <div class="md-content__inner">
      <header class="md-typeset">
        <h1 id="today-i-learned">Today I Learned</h1>
      </header>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/cameronpresley.png" alt="Cameron Presley">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2024-07-18 00:00:00+00:00">Jul 18, 2024</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../../" class="md-meta__link">Today I Learned</a>, 
              <a href="../../../tooling/" class="md-meta__link">Tooling</a></li>
        
        
          
          <li class="md-meta__item">
            
              3 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="my-experience-preparing-for-the-azure-administrator-associate-az-104-exam"><a class="toclink" href="../../../../2024/07/18/my-experience-preparing-for-the-azure-administrator-associate-az-104-exam/">My Experience Preparing for the Azure Administrator Associate (AZ-104) Exam</a></h2>
<p>There's been a bit of a lull the past couple of weeks on the blog as I've been focusing my time on studying and preparing for the AZ-104 exam. This was a particularly challenging certificate for me as I don't have a traditional IT Admin background so I had to not only shore up the gaps in that knowledge, but then also had to learn how to model similar concepts in Azure.</p>
<p>That being said, I was able to pass the exam on my first take and wanted to share some advice for those who are looking to take this or other Azure exams.</p>
<h3 id="expand-your-studying-outside-of-the-microsoft-learn-documentation"><a class="toclink" href="../../../../2024/07/18/my-experience-preparing-for-the-azure-administrator-associate-az-104-exam/#expand-your-studying-outside-of-the-microsoft-learn-documentation">Expand your studying outside of the Microsoft Learn documentation</a></h3>
<p>The Microsoft Learn docs are fine for doing a deep dive into a subject, but if it's the first time learning a concept, then they can be a bit rough as they assume you have knowledge that you might not. To help round out your learning, I recommend finding other resources like videos, books, or articles.</p>
<h3 id="build-and-experiment-in-azure"><a class="toclink" href="../../../../2024/07/18/my-experience-preparing-for-the-azure-administrator-associate-az-104-exam/#build-and-experiment-in-azure">Build and Experiment in Azure</a></h3>
<p>Given that most of these concepts are pretty abstract, I found that they stuck with me much more when I build out the resources. For example, when working with a Virtual Machine, all of its components need to be in the same region. You can either remember that text OR you know that has to be true because if you try building out the VM in Azure and try to change components, it's going to fail.</p>
<h3 id="dont-rely-solely-on-practice-exams"><a class="toclink" href="../../../../2024/07/18/my-experience-preparing-for-the-azure-administrator-associate-az-104-exam/#dont-rely-solely-on-practice-exams">Don't Rely Solely on Practice Exams</a></h3>
<p>Back in 2019, I was studying/preparing for the 483 (exam on C#) and the advice at the time was to go over the practice exams over and over again until things stuck. Following the same advice, I took tons of practice exams (through MS Learn and MeasureUp) and though they might have had the same format as the exam (multiple choice, drag-and-drop, etc...), none of them were a good stand-in for the real exam.</p>
<p>The reason being is that the exam questions likely won't ask you to define a term, but are more likely to be along the lines of how you'd solve a problem (which expects you to know the terminology inherently). So if you don't have the underlying knowledge, you're going to have a bad time trying to answer the questions.</p>
<p>Where the practice exams shone was helping me identify areas that I needed to focus more on. For example, if I struggled in the Networking section, then I know I needed to revisit concepts there. This helped me make the most of my studying time.</p>
<h3 id="using-generative-ai-to-help-understand-concepts"><a class="toclink" href="../../../../2024/07/18/my-experience-preparing-for-the-azure-administrator-associate-az-104-exam/#using-generative-ai-to-help-understand-concepts">Using Generative AI To Help Understand Concepts</a></h3>
<p>Given that I don't come from a networking/IT background, there were some concepts that were quite confusing to me. For example, I was trying to understand why I would need System routes if we already had Network Security Groups and Copilot was able to give me the following:</p>
<p><img alt="Asking Copilot why I would need system routes" src="https://softwarementorblog.blob.core.windows.net/images/az-104/image-1.png" /></p>
<p>To help make sure I didn't fall victim to <a href="https://en.wikipedia.org/wiki/Hallucination_(artificial_intelligence)">hallucinations</a>, I followed up on the links that Copilot provided to make sure that I understood the concepts, but given that I learn best by asking questions, this was a major win for me since you can't ask questions to books/videos.</p>
<h3 id="resources-that-helped-me"><a class="toclink" href="../../../../2024/07/18/my-experience-preparing-for-the-azure-administrator-associate-az-104-exam/#resources-that-helped-me">Resources That Helped Me</a></h3>
<p>For those looking to study up on this exam, I had success using these resources. <em>Note: I do not receive compensation for these recommendations.</em></p>
<ul>
<li><a href="https://www.udemy.com/course/70533-azure/">(Paid) AZ-104 Microsoft Azure Administrator Exam Prep by Scott Duffy</a> - I found this to be a great introduction to concepts and a good companion before going through the MS Learn or other resources</li>
<li><a href="https://www.youtube.com/watch?v=0Knf9nub4-k">(Free) AZ-104 Administrator Associate Study Cram v2 by John Savill</a> - This resource is a good refresher and it helped me see concepts from a different perspective. </li>
</ul>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/cameronpresley.png" alt="Cameron Presley">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2024-07-02 00:00:00+00:00">Jul 2, 2024</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../../" class="md-meta__link">Today I Learned</a>, 
              <a href="../../../tooling/" class="md-meta__link">Tooling</a></li>
        
        
          
          <li class="md-meta__item">
            
              5 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="today-i-learned-using-typespec-to-generate-openapi-specs"><a class="toclink" href="../../../../2024/07/02/today-i-learned---using-typespec-to-generate-openapi-specs/">Today I Learned - Using TypeSpec to Generate OpenAPI Specs</a></h2>
<p>Recently, I was doing analysis for a project where we needed to build out a set of APIs for consumers to use. Even though <a href="">I'm a big believer of iterative design</a>, we wanted to have a solid idea of what the routes and data models were going to look like. </p>
<p>In the past, I most likely would have generated a .NET Web API project, created the controllers/models, finally leveraging NSwag to generate Swagger documentation for the api. Even though this approach works, it does take more time on the implementation side (spinning up controllers, configuring ASP.NET, creating the models, adding attributes). In addition, if the actual API isn't being written in with .NET, then this code becomes throwaway pretty quickly.</p>
<p>Since tooling is always evolving, I stumbled across another tool, <a href="https://typespec.io/">TypeSpec</a>. Heavily influenced by TypeScript, this allows you to write your contracts and models that, when compiled, produces an OpenAPI compliant spec.</p>
<p>As a bonus, it's not restricted to just API spec as it has support for <a href="https://typespec.io/docs/emitters/json-schema/reference">generating JSON schemas</a> and <a href="https://typespec.io/docs/emitters/protobuf/reference">gRPC's Protocol Buffers (protobuf)</a></p>
<h3 id="getting-started"><a class="toclink" href="../../../../2024/07/02/today-i-learned---using-typespec-to-generate-openapi-specs/#getting-started">Getting Started</a></h3>
<p>All code for this post can be found on <a href="https://github.com/cameronpresley/typespec-examples">my GitHub</a>.</p>
<p>Given that it's inspired by TypeScript, the tooling requires having Node installed (at least 20, but I'd recommend the long-term-supported (LTS) version).</p>
<p>From there, we can install the TypeSpec tooling with.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-27-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1"></a>npm<span class="w"> </span>install<span class="w"> </span>@typespec/compiler
</code></pre></div></td></tr></table></div>
<p>Even though this is all the tooling that's required, I'd recommend installing an extension for either Visual Studio or Visual Studio Code so that you can get Intellisense and other visual cues while you're writing the code.</p>
<h3 id="bootstrapping-the-project"><a class="toclink" href="../../../../2024/07/02/today-i-learned---using-typespec-to-generate-openapi-specs/#bootstrapping-the-project">Bootstrapping the project</a></h3>
<p>Now that we've got the tooling squared away, let's create our project. </p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-28-1">1</a></span>
<span class="normal"><a href="#__codelineno-28-2">2</a></span>
<span class="normal"><a href="#__codelineno-28-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1"></a>mkdir<span class="w"> </span>bookstore-api<span class="w"> </span><span class="c1"># let&#39;s make a directory to hold everything</span>
<a id="__codelineno-28-2" name="__codelineno-28-2"></a><span class="nb">cd</span><span class="w"> </span>bookstore-api
<a id="__codelineno-28-3" name="__codelineno-28-3"></a>tsp<span class="w"> </span>init<span class="w"> </span>--template<span class="w"> </span>rest
</code></pre></div></td></tr></table></div>
<p>Enter a project name and choose the defaults. Once it's finished bootstrapping, you can install necessary dependencies using <code>tsp install</code>.</p>
<h3 id="building-our-first-api"><a class="toclink" href="../../../../2024/07/02/today-i-learned---using-typespec-to-generate-openapi-specs/#building-our-first-api">Building Our First API</a></h3>
<p>For our bookstore application, let's say that we want to have an <code>inventory</code> route where someone can retrieve information about a book. </p>
<p>For this work, I'm picturing the following</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-29-1">1</a></span>
<span class="normal"><a href="#__codelineno-29-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1"></a><span class="gh"># Route -&gt; GET api/inventory/{id}</span>
<a id="__codelineno-29-2" name="__codelineno-29-2"></a><span class="gh"># Returns 200 or 404</span>
</code></pre></div></td></tr></table></div>
<p>In the project, locate the <code>main.tsp</code> file and add the following</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-30-1">1</a></span>
<span class="normal"><a href="#__codelineno-30-2">2</a></span>
<span class="normal"><a href="#__codelineno-30-3">3</a></span>
<span class="normal"><a href="#__codelineno-30-4">4</a></span>
<span class="normal"><a href="#__codelineno-30-5">5</a></span>
<span class="normal"><a href="#__codelineno-30-6">6</a></span>
<span class="normal"><a href="#__codelineno-30-7">7</a></span>
<span class="normal"><a href="#__codelineno-30-8">8</a></span>
<span class="normal"><a href="#__codelineno-30-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1"></a>using TypeSpec.Http;
<a id="__codelineno-30-2" name="__codelineno-30-2"></a>using TypeSpec.Rest;
<a id="__codelineno-30-3" name="__codelineno-30-3"></a>
<a id="__codelineno-30-4" name="__codelineno-30-4"></a>@service({
<a id="__codelineno-30-5" name="__codelineno-30-5"></a>    title: &quot;Bookstore Service&quot;
<a id="__codelineno-30-6" name="__codelineno-30-6"></a>})
<a id="__codelineno-30-7" name="__codelineno-30-7"></a>namespace Bookstore {
<a id="__codelineno-30-8" name="__codelineno-30-8"></a>
<a id="__codelineno-30-9" name="__codelineno-30-9"></a>}
</code></pre></div></td></tr></table></div>
<p>After adding this code, run <code>tsp compile .</code> (note the period). This will create a file in the <code>tsp-output/@typespec/openapi3</code> folder, <code>openapi.yaml</code>.</p>
<p>We can open that file and see what our OpenAPI spec looks like </p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-31-1">1</a></span>
<span class="normal"><a href="#__codelineno-31-2">2</a></span>
<span class="normal"><a href="#__codelineno-31-3">3</a></span>
<span class="normal"><a href="#__codelineno-31-4">4</a></span>
<span class="normal"><a href="#__codelineno-31-5">5</a></span>
<span class="normal"><a href="#__codelineno-31-6">6</a></span>
<span class="normal"><a href="#__codelineno-31-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1"></a>openapi: 3.0.0
<a id="__codelineno-31-2" name="__codelineno-31-2"></a>info:
<a id="__codelineno-31-3" name="__codelineno-31-3"></a>  title: Bookstore Service
<a id="__codelineno-31-4" name="__codelineno-31-4"></a>  version: 0.0.0
<a id="__codelineno-31-5" name="__codelineno-31-5"></a>tags: []
<a id="__codelineno-31-6" name="__codelineno-31-6"></a>paths: {}
<a id="__codelineno-31-7" name="__codelineno-31-7"></a>components: {}
</code></pre></div></td></tr></table></div>
<p>So far, not much to look at. However, if we copy this code and render feed it to an online render (like <a href="https://editor.swagger.io/">https://editor.swagger.io/</a>), we'll get a message about no operations.</p>
<p><img alt="Swagger.io saying there are no operations" src="https://softwarementorblog.blob.core.windows.net/images/til-typespec/image-1.png" /></p>
<!-- <img src= "../images/til-typespec/image-1.png" alt="Swagger.io saying there are no operations"> -->

<p>Let's change that by building out our GET endpoint.</p>
<p>Back in <code>main.tsp</code>, let's add more code to our <code>Bookstore</code> namespace.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-32-1">1</a></span>
<span class="normal"><a href="#__codelineno-32-2">2</a></span>
<span class="normal"><a href="#__codelineno-32-3">3</a></span>
<span class="normal"><a href="#__codelineno-32-4">4</a></span>
<span class="normal"><a href="#__codelineno-32-5">5</a></span>
<span class="normal"><a href="#__codelineno-32-6">6</a></span>
<span class="normal"><a href="#__codelineno-32-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1"></a>namespace Bookstore {
<a id="__codelineno-32-2" name="__codelineno-32-2"></a>    @tag(&quot;Inventory&quot;)
<a id="__codelineno-32-3" name="__codelineno-32-3"></a>    @route(&quot;inventory&quot;)
<a id="__codelineno-32-4" name="__codelineno-32-4"></a>    namespace Inventory {
<a id="__codelineno-32-5" name="__codelineno-32-5"></a>        @get op getBook(@path bookId:string): string
<a id="__codelineno-32-6" name="__codelineno-32-6"></a>    }
<a id="__codelineno-32-7" name="__codelineno-32-7"></a>}
</code></pre></div></td></tr></table></div>
<p>After running <code>tsp compile .</code>, we'll see that our yaml has been updated and if we render it again, we'll have our first endpoint</p>
<p><img alt="Swagger.io rendering inventory by ID route" src="https://softwarementorblog.blob.core.windows.net/images/til-typespec/image-2.png" /></p>
<p>This is closer to what we want, however, we know that we're returning back a <code>string</code>, but a <code>Book</code>.</p>
<p>For this exercise, we'll say that a <code>Book</code> has the following:</p>
<ul>
<li>an id (of number)</li>
<li>a title (of string)</li>
<li>a price (of number, minimum 1)</li>
<li>author name (of string)</li>
</ul>
<p>Let's add this model to <code>main.tsp</code></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-33-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-33-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-33-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-33-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-33-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-33-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-33-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-33-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-33-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-33-10">10</a></span>
<span class="normal"><a href="#__codelineno-33-11">11</a></span>
<span class="normal"><a href="#__codelineno-33-12">12</a></span>
<span class="normal"><a href="#__codelineno-33-13">13</a></span>
<span class="normal"><a href="#__codelineno-33-14">14</a></span>
<span class="normal"><a href="#__codelineno-33-15">15</a></span>
<span class="normal"><a href="#__codelineno-33-16">16</a></span>
<span class="normal"><a href="#__codelineno-33-17">17</a></span>
<span class="normal"><a href="#__codelineno-33-18">18</a></span>
<span class="normal"><a href="#__codelineno-33-19">19</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1"></a>namespace Bookstore {
<a id="__codelineno-33-2" name="__codelineno-33-2"></a>    // Note that we&#39;ve added this to the Bookstore namespace
<a id="__codelineno-33-3" name="__codelineno-33-3"></a>    model Book {
<a id="__codelineno-33-4" name="__codelineno-33-4"></a>        id: string;
<a id="__codelineno-33-5" name="__codelineno-33-5"></a>        title: string;
<a id="__codelineno-33-6" name="__codelineno-33-6"></a>
<a id="__codelineno-33-7" name="__codelineno-33-7"></a>        @minValue(1)
<a id="__codelineno-33-8" name="__codelineno-33-8"></a>        price: decimal;
<a id="__codelineno-33-9" name="__codelineno-33-9"></a>
<a id="__codelineno-33-10" name="__codelineno-33-10"></a>        authorName: string;
<a id="__codelineno-33-11" name="__codelineno-33-11"></a>    }
<a id="__codelineno-33-12" name="__codelineno-33-12"></a>    @tag(&quot;Inventory&quot;)
<a id="__codelineno-33-13" name="__codelineno-33-13"></a>    @route(&quot;inventory&quot;)
<a id="__codelineno-33-14" name="__codelineno-33-14"></a>    namespace Inventory {
<a id="__codelineno-33-15" name="__codelineno-33-15"></a>
<a id="__codelineno-33-16" name="__codelineno-33-16"></a>        // For our get, we&#39;re now returning a Book, instead of a string.
<a id="__codelineno-33-17" name="__codelineno-33-17"></a>        @get op getBook(@path bookId: string): Book; 
<a id="__codelineno-33-18" name="__codelineno-33-18"></a>    }
<a id="__codelineno-33-19" name="__codelineno-33-19"></a>} 
</code></pre></div></td></tr></table></div>
<p>After another run of <code>tsp compile</code> and rendering the yaml file, we see that we have a schema for our get method now.</p>
<p><img alt="Swagger showing the updated model" src="https://softwarementorblog.blob.core.windows.net/images/til-typespec/image-3.png" /></p>
<h3 id="refactoring-a-model"><a class="toclink" href="../../../../2024/07/02/today-i-learned---using-typespec-to-generate-openapi-specs/#refactoring-a-model">Refactoring a Model</a></h3>
<p>Even though this works, the <code>Book</code> model is a bit lazy as it has the <code>authorName</code> as a property instead of an <code>Author</code> model which would have name (and a bit more information). Let's update <code>Book</code> to have an <code>Author</code> property.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-34-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-34-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-34-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-34-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-34-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-34-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-34-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-34-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-34-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-34-10">10</a></span>
<span class="normal"><a href="#__codelineno-34-11">11</a></span>
<span class="normal"><a href="#__codelineno-34-12">12</a></span>
<span class="normal"><a href="#__codelineno-34-13">13</a></span>
<span class="normal"><a href="#__codelineno-34-14">14</a></span>
<span class="normal"><a href="#__codelineno-34-15">15</a></span>
<span class="normal"><a href="#__codelineno-34-16">16</a></span>
<span class="normal"><a href="#__codelineno-34-17">17</a></span>
<span class="normal"><a href="#__codelineno-34-18">18</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1"></a>model Author {
<a id="__codelineno-34-2" name="__codelineno-34-2"></a>    id: string;
<a id="__codelineno-34-3" name="__codelineno-34-3"></a>
<a id="__codelineno-34-4" name="__codelineno-34-4"></a>    @minLength(1)
<a id="__codelineno-34-5" name="__codelineno-34-5"></a>    surname: string;
<a id="__codelineno-34-6" name="__codelineno-34-6"></a>
<a id="__codelineno-34-7" name="__codelineno-34-7"></a>    @minLength(1)
<a id="__codelineno-34-8" name="__codelineno-34-8"></a>    givenName: string;
<a id="__codelineno-34-9" name="__codelineno-34-9"></a>}
<a id="__codelineno-34-10" name="__codelineno-34-10"></a>model Book {
<a id="__codelineno-34-11" name="__codelineno-34-11"></a>    id: string;
<a id="__codelineno-34-12" name="__codelineno-34-12"></a>    title: string;
<a id="__codelineno-34-13" name="__codelineno-34-13"></a>
<a id="__codelineno-34-14" name="__codelineno-34-14"></a>    @minValue(1)
<a id="__codelineno-34-15" name="__codelineno-34-15"></a>    price: decimal;
<a id="__codelineno-34-16" name="__codelineno-34-16"></a>
<a id="__codelineno-34-17" name="__codelineno-34-17"></a>    author: Author;
<a id="__codelineno-34-18" name="__codelineno-34-18"></a>}
</code></pre></div></td></tr></table></div>
<p>After making this change, we can see that we now have a nested model for <code>Book</code>.</p>
<p><img alt="Swagger showing both Book and Author model" src="https://softwarementorblog.blob.core.windows.net/images/til-typespec/image-4.png" /></p>
<h3 id="handling-failures"><a class="toclink" href="../../../../2024/07/02/today-i-learned---using-typespec-to-generate-openapi-specs/#handling-failures">Handling Failures</a></h3>
<p>We're definitely a step in the right direction, however, our API definition isn't quite done. Right now, it says that we'll always return a 200 status code.</p>
<p>I don't know about you, but our bookstore isn't good enough to generate books with fictitious IDs, so we need to update our contract to say that it can also return 404s.</p>
<p>Back in <code>main.tsp</code>, we're going to change our return type of the <code>@get</code> operation to instead of being a <code>Book</code>, it's actually a <a href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#union-types">union type</a>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-35-1">1</a></span>
<span class="normal"><a href="#__codelineno-35-2">2</a></span>
<span class="normal"><a href="#__codelineno-35-3">3</a></span>
<span class="normal"><a href="#__codelineno-35-4">4</a></span>
<span class="normal"><a href="#__codelineno-35-5">5</a></span>
<span class="normal"><a href="#__codelineno-35-6">6</a></span>
<span class="normal"><a href="#__codelineno-35-7">7</a></span>
<span class="normal"><a href="#__codelineno-35-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1"></a>@get op getBook(@path bookId: string): 
<a id="__codelineno-35-2" name="__codelineno-35-2"></a>// Either it returns a 200 with a body of Book
<a id="__codelineno-35-3" name="__codelineno-35-3"></a>{
<a id="__codelineno-35-4" name="__codelineno-35-4"></a>    @statusCode statusCode: 200;
<a id="__codelineno-35-5" name="__codelineno-35-5"></a>    @body book: Book;
<a id="__codelineno-35-6" name="__codelineno-35-6"></a>} | { // Or it will return a 404 with an empty body
<a id="__codelineno-35-7" name="__codelineno-35-7"></a>    @statusCode statusCode: 404;
<a id="__codelineno-35-8" name="__codelineno-35-8"></a>};
</code></pre></div></td></tr></table></div>
<p>With this final change, we can compile and render the yaml and see that route can return a 404 as well.</p>
<p><img alt="Swagger showing that the route can return a 404 as well" src="https://softwarementorblog.blob.core.windows.net/images/til-typespec/image-5.png" /></p>
<h3 id="next-steps"><a class="toclink" href="../../../../2024/07/02/today-i-learned---using-typespec-to-generate-openapi-specs/#next-steps">Next Steps</a></h3>
<p>When I first started with TypeSpec, my first thought was that you could put this code under continuous integration (CI) and have it produce the OpenAPI format as an artifact for other teams to pull in and auto-generate clients from.</p>
<p>If you're interested in learning more about that approach, <a href="mailto:CoachingCorner@TheSoftwareMentor.com?subject=I'd like to learn more about TypeSpec">drop me a line at the Coaching Corner</a> and I may write up my results in a future post.</p>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/cameronpresley.png" alt="Cameron Presley">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2024-06-13 00:00:00+00:00">Jun 13, 2024</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../../../typescript/" class="md-meta__link">TypeScript</a>, 
              <a href="../../" class="md-meta__link">Today I Learned</a></li>
        
        
          
          <li class="md-meta__item">
            
              7 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="today-i-learned-validating-data-in-zod"><a class="toclink" href="../../../../2024/06/13/today-i-learned-validating-data-in-zod/">Today I Learned: Validating Data in Zod</a></h2>
<p>Validating input. You've got to do it, otherwise, you're going to be processing garbage, and that never goes well, right?</p>
<p>Whether it's through the front-end (via a form) or through the back-end (via an API call), it's important to make sure that the data we're processing is valid.</p>
<p>Coming from a C# background, I was used to ASP.NET Web Api's ability to create a class and then use the <a href="https://learn.microsoft.com/en-us/aspnet/core/mvc/models/model-binding?view=aspnetcore-8.0#frombody-attribute"><code>FromBody attribute</code></a> for the appropriate route to ensure the data is good. By using this approach, ASP.NET will reject requests automatically that don't fit the data contract.</p>
<p>However, picking up JavaScript and TypeScript, that's not the case. At first, this surprised me because I figured that this would automatically happen when using libraries like Express or Nest.js. Thinking more about it, though, it shouldn't have surprised me. ASP.NET can catch those issues because it's a statically typed/ran language. JavaScript isn't and since TypeScript types are removed during the compilation phase, neither is statically typed at <em>runtime</em>.</p>
<p>When writing validations, I find <a href="https://github.com/colinhacks/zod">zod</a> to be a delightful library to leverage. There are a ton of useful built-in options, you can create your own validators (which you can then compose!) and you can infer models based off of your validations.</p>
<h3 id="building-the-amazin-bookstore"><a class="toclink" href="../../../../2024/06/13/today-i-learned-validating-data-in-zod/#building-the-amazin-bookstore">Building the Amazin' Bookstore</a></h3>
<p>To demonstrate some of the cool things that you can do with Zod, let's pretend that we're building out a new POST endpoint for creating a new book. After talking to the business, we determine that the payload for a new book should look like this:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-48-1">1</a></span>
<span class="normal"><a href="#__codelineno-48-2">2</a></span>
<span class="normal"><a href="#__codelineno-48-3">3</a></span>
<span class="normal"><a href="#__codelineno-48-4">4</a></span>
<span class="normal"><a href="#__codelineno-48-5">5</a></span>
<span class="normal"><a href="#__codelineno-48-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-48-1" name="__codelineno-48-1"></a><span class="c1">// A valid book will have the following</span>
<a id="__codelineno-48-2" name="__codelineno-48-2"></a><span class="c1">// - A non-empty title</span>
<a id="__codelineno-48-3" name="__codelineno-48-3"></a><span class="c1">// - A numeric price (can&#39;t be negative or zero)</span>
<a id="__codelineno-48-4" name="__codelineno-48-4"></a><span class="c1">// - A genre from a list of possibilities (mystery, fantasy, history are examples, platypus would not be valid)</span>
<a id="__codelineno-48-5" name="__codelineno-48-5"></a><span class="c1">// - An ISBN which must be in a particular format</span>
<a id="__codelineno-48-6" name="__codelineno-48-6"></a><span class="c1">// - A valid author which must have a first name, a last name, and an optional middle name</span>
</code></pre></div></td></tr></table></div>
<h4 id="whats-in-a-name"><a class="toclink" href="../../../../2024/06/13/today-i-learned-validating-data-in-zod/#whats-in-a-name">What's in a Name?</a></h4>
<p>Since the <code>Book</code> type needs a valid <code>Author</code>, let's build that out first:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-49-1">1</a></span>
<span class="normal"><a href="#__codelineno-49-2">2</a></span>
<span class="normal"><a href="#__codelineno-49-3">3</a></span>
<span class="normal"><a href="#__codelineno-49-4">4</a></span>
<span class="normal"><a href="#__codelineno-49-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-49-1" name="__codelineno-49-1"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="nx">z</span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;zod&quot;</span><span class="p">;</span>
<a id="__codelineno-49-2" name="__codelineno-49-2"></a>
<a id="__codelineno-49-3" name="__codelineno-49-3"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">AuthorSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<a id="__codelineno-49-4" name="__codelineno-49-4"></a>
<a id="__codelineno-49-5" name="__codelineno-49-5"></a><span class="p">});</span>
</code></pre></div></td></tr></table></div>
<p>Since <code>Author</code> will need to be an object, we'll use <code>z.object</code> to signify that. Right off the bat, this prevents a string, number, or other primitive types from being accepted.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-50-1">1</a></span>
<span class="normal"><a href="#__codelineno-50-2">2</a></span>
<span class="normal"><a href="#__codelineno-50-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-50-1" name="__codelineno-50-1"></a><span class="nx">AuthorSchema</span><span class="p">.</span><span class="nx">safeParse</span><span class="p">(</span><span class="s2">&quot;someString&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// will result in a failure</span>
<a id="__codelineno-50-2" name="__codelineno-50-2"></a><span class="nx">AuthorSchema</span><span class="p">.</span><span class="nx">safeParse</span><span class="p">(</span><span class="mf">42</span><span class="p">);</span><span class="w"> </span><span class="c1">// will result in a failure</span>
<a id="__codelineno-50-3" name="__codelineno-50-3"></a><span class="nx">AuthorSchema</span><span class="p">.</span><span class="nx">safeParse</span><span class="p">({});</span><span class="w"> </span><span class="c1">// will result in success!</span>
</code></pre></div></td></tr></table></div>
<p>This is a great start, but we know that Author has some required properties (like a first name), so let's implement that by using <code>z.string()</code></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-51-1">1</a></span>
<span class="normal"><a href="#__codelineno-51-2">2</a></span>
<span class="normal"><a href="#__codelineno-51-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-51-1" name="__codelineno-51-1"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">AuthorSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<a id="__codelineno-51-2" name="__codelineno-51-2"></a><span class="w">    </span><span class="nx">firstName</span><span class="o">:</span><span class="w"> </span><span class="kt">z.string</span><span class="p">()</span>
<a id="__codelineno-51-3" name="__codelineno-51-3"></a><span class="p">});</span>
</code></pre></div></td></tr></table></div>
<p>With this change, let's take a look at our schema validation</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-52-1">1</a></span>
<span class="normal"><a href="#__codelineno-52-2">2</a></span>
<span class="normal"><a href="#__codelineno-52-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-52-1" name="__codelineno-52-1"></a><span class="nx">AuthorSchema</span><span class="p">.</span><span class="nx">safeParse</span><span class="p">({});</span><span class="w"> </span><span class="c1">// fails because no firstName property</span>
<a id="__codelineno-52-2" name="__codelineno-52-2"></a><span class="nx">AuthorSchema</span><span class="p">.</span><span class="nx">safeParse</span><span class="p">({</span><span class="nx">firstName</span><span class="o">:</span><span class="kt">42</span><span class="p">});</span><span class="w"> </span><span class="c1">// fails because firstName is not a string</span>
<a id="__codelineno-52-3" name="__codelineno-52-3"></a><span class="nx">AuthorSchema</span><span class="p">.</span><span class="nx">safeParse</span><span class="p">({</span><span class="nx">firstName</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Cameron&quot;</span><span class="p">});</span><span class="w"> </span><span class="c1">// succeeds because firstName is present and a string</span>
</code></pre></div></td></tr></table></div>
<p>However, there's one problem with our validation. We would allow an empty <code>firstName</code></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-53-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-53-1" name="__codelineno-53-1"></a><span class="nx">AuthorSchema</span><span class="p">.</span><span class="nx">safeParse</span><span class="p">({</span><span class="nx">firstName</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">});</span><span class="w"> </span><span class="c1">// succeeds, but should have failed :(</span>
</code></pre></div></td></tr></table></div>
<p>To make our validation stronger, we can update our <code>firstName</code> property to have a minimum length of 1 like so.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-54-1">1</a></span>
<span class="normal"><a href="#__codelineno-54-2">2</a></span>
<span class="normal"><a href="#__codelineno-54-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-54-1" name="__codelineno-54-1"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">AuthorSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<a id="__codelineno-54-2" name="__codelineno-54-2"></a><span class="w">    </span><span class="nx">firstName</span><span class="o">:</span><span class="w"> </span><span class="kt">z.string</span><span class="p">().</span><span class="nx">min</span><span class="p">(</span><span class="mf">1</span><span class="p">)</span>
<a id="__codelineno-54-3" name="__codelineno-54-3"></a><span class="p">});</span>
</code></pre></div></td></tr></table></div>
<p>Finally, we have a way to enforce that an author has a non-empty firstName!. Looking at the requirements, it seems like <code>lastName</code> is going to be similar, so let's update our <code>AuthorSchema</code> to include lastName.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-55-1">1</a></span>
<span class="normal"><a href="#__codelineno-55-2">2</a></span>
<span class="normal"><a href="#__codelineno-55-3">3</a></span>
<span class="normal"><a href="#__codelineno-55-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-55-1" name="__codelineno-55-1"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">AuthorSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<a id="__codelineno-55-2" name="__codelineno-55-2"></a><span class="w">    </span><span class="nx">firstName</span><span class="o">:</span><span class="w"> </span><span class="kt">z.string</span><span class="p">().</span><span class="nx">min</span><span class="p">(</span><span class="mf">1</span><span class="p">),</span>
<a id="__codelineno-55-3" name="__codelineno-55-3"></a><span class="w">    </span><span class="nx">lastName</span><span class="o">:</span><span class="w"> </span><span class="kt">z.string</span><span class="p">().</span><span class="nx">min</span><span class="p">(</span><span class="mf">1</span><span class="p">)</span>
<a id="__codelineno-55-4" name="__codelineno-55-4"></a><span class="p">});</span>
</code></pre></div></td></tr></table></div>
<p>Hmmm, it looks like we have the same concept in multiple places, the idea of a non empty string. Let's refactor that to its own schema.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-56-1">1</a></span>
<span class="normal"><a href="#__codelineno-56-2">2</a></span>
<span class="normal"><a href="#__codelineno-56-3">3</a></span>
<span class="normal"><a href="#__codelineno-56-4">4</a></span>
<span class="normal"><a href="#__codelineno-56-5">5</a></span>
<span class="normal"><a href="#__codelineno-56-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-56-1" name="__codelineno-56-1"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">NonEmptyStringSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="kt">string</span><span class="p">().</span><span class="nx">min</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>
<a id="__codelineno-56-2" name="__codelineno-56-2"></a>
<a id="__codelineno-56-3" name="__codelineno-56-3"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">AuthorSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<a id="__codelineno-56-4" name="__codelineno-56-4"></a><span class="w">    </span><span class="nx">firstName</span><span class="o">:</span><span class="w"> </span><span class="kt">NonEmptyStringSchema</span><span class="p">,</span>
<a id="__codelineno-56-5" name="__codelineno-56-5"></a><span class="w">    </span><span class="nx">lastName</span><span class="o">:</span><span class="w"> </span><span class="kt">NonEmptyStringSchema</span>
<a id="__codelineno-56-6" name="__codelineno-56-6"></a><span class="p">});</span>
</code></pre></div></td></tr></table></div>
<p>Nice! We're almost done with <code>Author</code>, we need to implement <code>middleName</code>. Unlike the other properties, an author may not have a middle name. In this case, we're going to leverage the <code>optional</code> function from zod to signify that as so.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-57-1">1</a></span>
<span class="normal"><a href="#__codelineno-57-2">2</a></span>
<span class="normal"><a href="#__codelineno-57-3">3</a></span>
<span class="normal"><a href="#__codelineno-57-4">4</a></span>
<span class="normal"><a href="#__codelineno-57-5">5</a></span>
<span class="normal"><a href="#__codelineno-57-6">6</a></span>
<span class="normal"><a href="#__codelineno-57-7">7</a></span>
<span class="normal"><a href="#__codelineno-57-8">8</a></span>
<span class="normal"><a href="#__codelineno-57-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-57-1" name="__codelineno-57-1"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">NonEmptyStringSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="kt">string</span><span class="p">().</span><span class="nx">min</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>
<a id="__codelineno-57-2" name="__codelineno-57-2"></a>
<a id="__codelineno-57-3" name="__codelineno-57-3"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">AuthorSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<a id="__codelineno-57-4" name="__codelineno-57-4"></a><span class="w">    </span><span class="nx">firstName</span><span class="o">:</span><span class="w"> </span><span class="kt">NonEmptyStringSchema</span><span class="p">,</span>
<a id="__codelineno-57-5" name="__codelineno-57-5"></a><span class="w">    </span><span class="nx">lastName</span><span class="o">:</span><span class="w"> </span><span class="kt">NonEmptyStringSchema</span><span class="p">,</span>
<a id="__codelineno-57-6" name="__codelineno-57-6"></a><span class="w">    </span><span class="c1">// This would read that middleName may or not may be present. </span>
<a id="__codelineno-57-7" name="__codelineno-57-7"></a><span class="w">    </span><span class="c1">// If it is, then it must be a string (could be empty)</span>
<a id="__codelineno-57-8" name="__codelineno-57-8"></a><span class="w">    </span><span class="nx">middleName</span><span class="o">:</span><span class="w"> </span><span class="kt">z.string</span><span class="p">().</span><span class="nx">optional</span><span class="p">(),</span><span class="w"> </span>
<a id="__codelineno-57-9" name="__codelineno-57-9"></a><span class="p">});</span>
</code></pre></div></td></tr></table></div>
<p>With the implementation of <code>AuthorSchema</code>, we can start working on the <code>BookSchema</code>.</p>
<h4 id="judging-a-book-by-its-cover"><a class="toclink" href="../../../../2024/06/13/today-i-learned-validating-data-in-zod/#judging-a-book-by-its-cover">Judging a Book By It's Cover</a></h4>
<p>Since we have <code>AuthorSchema</code>, we can use that as our start as so:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-58-1">1</a></span>
<span class="normal"><a href="#__codelineno-58-2">2</a></span>
<span class="normal"><a href="#__codelineno-58-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-58-1" name="__codelineno-58-1"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">BookSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<a id="__codelineno-58-2" name="__codelineno-58-2"></a><span class="w">    </span><span class="nx">author</span><span class="o">:</span><span class="w"> </span><span class="kt">AuthorSchema</span>
<a id="__codelineno-58-3" name="__codelineno-58-3"></a><span class="p">});</span>
</code></pre></div></td></tr></table></div>
<p>We know that a book must have a non-empty title, so let's add that to our definition. Since it's a string that must have at least one character, we can reuse the <code>NonEmptyStringSchema</code> definition from before.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-59-1">1</a></span>
<span class="normal"><a href="#__codelineno-59-2">2</a></span>
<span class="normal"><a href="#__codelineno-59-3">3</a></span>
<span class="normal"><a href="#__codelineno-59-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-59-1" name="__codelineno-59-1"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">BookSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<a id="__codelineno-59-2" name="__codelineno-59-2"></a><span class="w">    </span><span class="nx">author</span><span class="o">:</span><span class="w"> </span><span class="kt">AuthorSchema</span><span class="p">,</span>
<a id="__codelineno-59-3" name="__codelineno-59-3"></a><span class="w">    </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="kt">NonEmptyStringSchema</span>
<a id="__codelineno-59-4" name="__codelineno-59-4"></a><span class="p">});</span>
</code></pre></div></td></tr></table></div>
<h4 id="putting-a-price-on-knowledge"><a class="toclink" href="../../../../2024/06/13/today-i-learned-validating-data-in-zod/#putting-a-price-on-knowledge">Putting a Price on Knowledge</a></h4>
<p>With title in place, let's leave the string theory alone for a bit and look at numbers. In order for the bookstore to function, we've got sell books for some price. Let's use <code>z.number()</code> and add a <code>price</code> property.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-60-1">1</a></span>
<span class="normal"><a href="#__codelineno-60-2">2</a></span>
<span class="normal"><a href="#__codelineno-60-3">3</a></span>
<span class="normal"><a href="#__codelineno-60-4">4</a></span>
<span class="normal"><a href="#__codelineno-60-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-60-1" name="__codelineno-60-1"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">BookSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<a id="__codelineno-60-2" name="__codelineno-60-2"></a><span class="w">    </span><span class="nx">author</span><span class="o">:</span><span class="w"> </span><span class="kt">AuthorSchema</span><span class="p">,</span>
<a id="__codelineno-60-3" name="__codelineno-60-3"></a><span class="w">    </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="kt">NonEmptyStringSchema</span><span class="p">,</span>
<a id="__codelineno-60-4" name="__codelineno-60-4"></a><span class="w">    </span><span class="nx">price</span><span class="o">:</span><span class="w"> </span><span class="kt">z.number</span><span class="p">()</span>
<a id="__codelineno-60-5" name="__codelineno-60-5"></a><span class="p">});</span>
</code></pre></div></td></tr></table></div>
<p>This works, however, <code>z.number()</code> will accept <em>any</em> number, which includes numbers like <code>0</code> and <code>-5</code>. While those values would be great for the customer, we can't run our business that way. So let's update our price to only include positive numbers, which can be accomplished by leveraging the <code>positive</code> function.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-61-1">1</a></span>
<span class="normal"><a href="#__codelineno-61-2">2</a></span>
<span class="normal"><a href="#__codelineno-61-3">3</a></span>
<span class="normal"><a href="#__codelineno-61-4">4</a></span>
<span class="normal"><a href="#__codelineno-61-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-61-1" name="__codelineno-61-1"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">BookSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<a id="__codelineno-61-2" name="__codelineno-61-2"></a><span class="w">    </span><span class="nx">author</span><span class="o">:</span><span class="w"> </span><span class="kt">AuthorSchema</span><span class="p">,</span>
<a id="__codelineno-61-3" name="__codelineno-61-3"></a><span class="w">    </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="kt">NonEmptyStringSchema</span><span class="p">,</span>
<a id="__codelineno-61-4" name="__codelineno-61-4"></a><span class="w">    </span><span class="nx">price</span><span class="o">:</span><span class="w"> </span><span class="kt">z.number</span><span class="p">().</span><span class="nx">positive</span><span class="p">()</span>
<a id="__codelineno-61-5" name="__codelineno-61-5"></a><span class="p">});</span>
</code></pre></div></td></tr></table></div>
<p>With price done, let's look at validating the genre.</p>
<h4 id="would-you-say-its-a-mystery-or-history"><a class="toclink" href="../../../../2024/06/13/today-i-learned-validating-data-in-zod/#would-you-say-its-a-mystery-or-history">Would You Say It's a Mystery or History?</a></h4>
<p>Up to this point, all of our properties have been straightforward (simple strings and numbers). However, with <code>genre</code>, things get more complicated because it can only be one of a particular set of values. Thankfully, we can define a <code>GenreSchema</code> by using <code>z.enum()</code> like so. </p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-62-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-62-1" name="__codelineno-62-1"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">GenreSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="kd">enum</span><span class="p">([</span><span class="s2">&quot;Fantasy&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;History&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Mystery&quot;</span><span class="p">]);</span>
</code></pre></div></td></tr></table></div>
<p>With this definition, a valid genre can <em>only be</em> fantasy, history, or mystery. Let's update our book definition to use this new schema.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-63-1">1</a></span>
<span class="normal"><a href="#__codelineno-63-2">2</a></span>
<span class="normal"><a href="#__codelineno-63-3">3</a></span>
<span class="normal"><a href="#__codelineno-63-4">4</a></span>
<span class="normal"><a href="#__codelineno-63-5">5</a></span>
<span class="normal"><a href="#__codelineno-63-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-63-1" name="__codelineno-63-1"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">BookSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<a id="__codelineno-63-2" name="__codelineno-63-2"></a><span class="w">    </span><span class="nx">author</span><span class="o">:</span><span class="w"> </span><span class="kt">AuthorSchema</span><span class="p">,</span>
<a id="__codelineno-63-3" name="__codelineno-63-3"></a><span class="w">    </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="kt">NonEmptyStringSchema</span><span class="p">,</span>
<a id="__codelineno-63-4" name="__codelineno-63-4"></a><span class="w">    </span><span class="nx">price</span><span class="o">:</span><span class="w"> </span><span class="kt">z.number</span><span class="p">().</span><span class="nx">positive</span><span class="p">(),</span>
<a id="__codelineno-63-5" name="__codelineno-63-5"></a><span class="w">    </span><span class="nx">genre</span><span class="o">:</span><span class="w"> </span><span class="kt">GenreSchema</span>
<a id="__codelineno-63-6" name="__codelineno-63-6"></a><span class="p">});</span>
</code></pre></div></td></tr></table></div>
<p>Now, someone can't POST a book with a genre of "platypus" (though I'd enjoy reading such a book).</p>
<h4 id="id-please"><a class="toclink" href="../../../../2024/06/13/today-i-learned-validating-data-in-zod/#id-please">ID Please</a></h4>
<p>Last, let's take a look at implementing the <code>isbn</code> property. This is interesting because ISBNs can be in one of two shapes: ISBN-10 (for books pre-2007) and ISBN-13 (all other books).</p>
<p>To make this problem easier, let's focus on the ISBN-10 format for now. A valid value will be in the form of <code>#-###-#####-#</code> (where # is a number). Now, you can <a href="https://en.wikipedia.org/wiki/ISBN#ISBN-10_check_digit_calculation">take this a whole lot further</a>, but we'll keep on the format.</p>
<p>Now, even though <code>zod</code> has built-in validators for emails, ips, and urls, there's not a built-in one for ISBNs. In these cases, we can use <code>.refine</code> to add our logic. But this is a good use case for a basic regular expression. Using <a href="https://regex101.com/">regex101</a> as a guide, we end up with the following expression and schema for the ISBN.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-64-1">1</a></span>
<span class="normal"><a href="#__codelineno-64-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-64-1" name="__codelineno-64-1"></a><span class="kd">const</span><span class="w"> </span><span class="nx">isbn10Regex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sr">/^\d-\d{3}-\d{5}-\d/</span><span class="p">;</span>
<a id="__codelineno-64-2" name="__codelineno-64-2"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">Isbn10Schema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="kt">string</span><span class="p">().</span><span class="nx">regex</span><span class="p">(</span><span class="nx">isbn10Regex</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<p>Building onto that, an ISBN-13 is in a similar format, but has the form of <code>###-#-##-######-#</code>. By tweaking our regex, we end up with the following:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-65-1">1</a></span>
<span class="normal"><a href="#__codelineno-65-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-65-1" name="__codelineno-65-1"></a><span class="kd">const</span><span class="w"> </span><span class="nx">isbn13Regex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sr">/^\d{3}-\d-\d{2}-\d{6}-\d/</span><span class="p">;</span>
<a id="__codelineno-65-2" name="__codelineno-65-2"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">Isbn13Schema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="kt">string</span><span class="p">().</span><span class="nx">regex</span><span class="p">(</span><span class="nx">isbn13Regex</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<p>When modeling types in TypeScript, I'd like to be able to do something like the following as this makes it clear that an ISBN can in one of these two shapes.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-66-1">1</a></span>
<span class="normal"><a href="#__codelineno-66-2">2</a></span>
<span class="normal"><a href="#__codelineno-66-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-66-1" name="__codelineno-66-1"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Isbn10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<a id="__codelineno-66-2" name="__codelineno-66-2"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Isbn13</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<a id="__codelineno-66-3" name="__codelineno-66-3"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Isbn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Isbn10</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nx">Isbn13</span><span class="p">;</span>
</code></pre></div></td></tr></table></div>
<p>While we can't use the <code>|</code> operator, we can use the <code>.or</code> function from zod to have the following</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-67-1">1</a></span>
<span class="normal"><a href="#__codelineno-67-2">2</a></span>
<span class="normal"><a href="#__codelineno-67-3">3</a></span>
<span class="normal"><a href="#__codelineno-67-4">4</a></span>
<span class="normal"><a href="#__codelineno-67-5">5</a></span>
<span class="normal"><a href="#__codelineno-67-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-67-1" name="__codelineno-67-1"></a><span class="kd">const</span><span class="w"> </span><span class="nx">isbn10Regex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sr">/^\d-\d{3}-\d{5}-\d/</span><span class="p">;</span>
<a id="__codelineno-67-2" name="__codelineno-67-2"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">Isbn10Schema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="kt">string</span><span class="p">().</span><span class="nx">regex</span><span class="p">(</span><span class="nx">isbn10Regex</span><span class="p">);</span>
<a id="__codelineno-67-3" name="__codelineno-67-3"></a><span class="kd">const</span><span class="w"> </span><span class="nx">isbn13Regex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sr">/^\d{3}-\d-\d{2}-\d{6}-\d/</span><span class="p">;</span>
<a id="__codelineno-67-4" name="__codelineno-67-4"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">Isbn13Schema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="kt">string</span><span class="p">().</span><span class="nx">regex</span><span class="p">(</span><span class="nx">isbn13Regex</span><span class="p">);</span>
<a id="__codelineno-67-5" name="__codelineno-67-5"></a>
<a id="__codelineno-67-6" name="__codelineno-67-6"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">IsbnSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Isbn10Schema</span><span class="p">.</span><span class="nx">or</span><span class="p">(</span><span class="nx">Isbn13Schema</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<p>With the <code>IsbnSchema</code> in place, let's add it to <code>BookSchema</code></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-68-1">1</a></span>
<span class="normal"><a href="#__codelineno-68-2">2</a></span>
<span class="normal"><a href="#__codelineno-68-3">3</a></span>
<span class="normal"><a href="#__codelineno-68-4">4</a></span>
<span class="normal"><a href="#__codelineno-68-5">5</a></span>
<span class="normal"><a href="#__codelineno-68-6">6</a></span>
<span class="normal"><a href="#__codelineno-68-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-68-1" name="__codelineno-68-1"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">BookSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<a id="__codelineno-68-2" name="__codelineno-68-2"></a><span class="w">    </span><span class="nx">author</span><span class="o">:</span><span class="w"> </span><span class="kt">AuthorSchema</span><span class="p">,</span>
<a id="__codelineno-68-3" name="__codelineno-68-3"></a><span class="w">    </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="kt">NonEmptyStringSchema</span><span class="p">,</span>
<a id="__codelineno-68-4" name="__codelineno-68-4"></a><span class="w">    </span><span class="nx">price</span><span class="o">:</span><span class="w"> </span><span class="kt">z.number</span><span class="p">().</span><span class="nx">positive</span><span class="p">(),</span>
<a id="__codelineno-68-5" name="__codelineno-68-5"></a><span class="w">    </span><span class="nx">genre</span><span class="o">:</span><span class="w"> </span><span class="kt">GenreSchema</span>
<a id="__codelineno-68-6" name="__codelineno-68-6"></a><span class="w">    </span><span class="nx">isbn</span><span class="o">:</span><span class="w"> </span><span class="kt">IsbnSchema</span>
<a id="__codelineno-68-7" name="__codelineno-68-7"></a><span class="p">});</span>
</code></pre></div></td></tr></table></div>
<h4 id="getting-models-for-free"><a class="toclink" href="../../../../2024/06/13/today-i-learned-validating-data-in-zod/#getting-models-for-free">Getting Models for Free</a></h4>
<p>Lastly, one of the cooler functions that zod supports is <code>infer</code> where if you pass it a schema, it can build out a type for you to use in your application. </p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-69-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-69-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-69-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-69-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-69-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-69-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-69-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-69-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-69-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-69-10">10</a></span>
<span class="normal"><a href="#__codelineno-69-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-69-1" name="__codelineno-69-1"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">BookSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<a id="__codelineno-69-2" name="__codelineno-69-2"></a><span class="w">    </span><span class="nx">author</span><span class="o">:</span><span class="w"> </span><span class="kt">AuthorSchema</span><span class="p">,</span>
<a id="__codelineno-69-3" name="__codelineno-69-3"></a><span class="w">    </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="kt">NonEmptyStringSchema</span><span class="p">,</span>
<a id="__codelineno-69-4" name="__codelineno-69-4"></a><span class="w">    </span><span class="nx">price</span><span class="o">:</span><span class="w"> </span><span class="kt">z.number</span><span class="p">().</span><span class="nx">positive</span><span class="p">(),</span>
<a id="__codelineno-69-5" name="__codelineno-69-5"></a><span class="w">    </span><span class="nx">genre</span><span class="o">:</span><span class="w"> </span><span class="kt">GenreSchema</span>
<a id="__codelineno-69-6" name="__codelineno-69-6"></a><span class="w">    </span><span class="nx">isbn</span><span class="o">:</span><span class="w"> </span><span class="kt">IsbnSchema</span>
<a id="__codelineno-69-7" name="__codelineno-69-7"></a><span class="p">});</span>
<a id="__codelineno-69-8" name="__codelineno-69-8"></a>
<a id="__codelineno-69-9" name="__codelineno-69-9"></a><span class="c1">// TypeScript knows that Book must have an author (which has a firstName, lastName, and maybe a middleName)</span>
<a id="__codelineno-69-10" name="__codelineno-69-10"></a><span class="c1">// a title (string), a price (number), a genre (string), and an isbn (string).</span>
<a id="__codelineno-69-11" name="__codelineno-69-11"></a><span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">Book</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">infer</span><span class="o">&lt;</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">BookSchema</span><span class="o">&gt;</span><span class="p">;</span><span class="w"> </span>
</code></pre></div></td></tr></table></div>
<h3 id="full-solution"><a class="toclink" href="../../../../2024/06/13/today-i-learned-validating-data-in-zod/#full-solution">Full Solution</a></h3>
<p>Here's what the full solution looks like</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-70-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-70-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-70-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-70-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-70-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-70-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-70-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-70-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-70-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-70-10">10</a></span>
<span class="normal"><a href="#__codelineno-70-11">11</a></span>
<span class="normal"><a href="#__codelineno-70-12">12</a></span>
<span class="normal"><a href="#__codelineno-70-13">13</a></span>
<span class="normal"><a href="#__codelineno-70-14">14</a></span>
<span class="normal"><a href="#__codelineno-70-15">15</a></span>
<span class="normal"><a href="#__codelineno-70-16">16</a></span>
<span class="normal"><a href="#__codelineno-70-17">17</a></span>
<span class="normal"><a href="#__codelineno-70-18">18</a></span>
<span class="normal"><a href="#__codelineno-70-19">19</a></span>
<span class="normal"><a href="#__codelineno-70-20">20</a></span>
<span class="normal"><a href="#__codelineno-70-21">21</a></span>
<span class="normal"><a href="#__codelineno-70-22">22</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-70-1" name="__codelineno-70-1"></a><span class="kd">const</span><span class="w"> </span><span class="nx">NonEmptyStringSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="kt">string</span><span class="p">().</span><span class="nx">min</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>
<a id="__codelineno-70-2" name="__codelineno-70-2"></a><span class="kd">const</span><span class="w"> </span><span class="nx">GenreSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="kd">enum</span><span class="p">([</span><span class="s2">&quot;Fantasy&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;History&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Mystery&quot;</span><span class="p">]);</span>
<a id="__codelineno-70-3" name="__codelineno-70-3"></a>
<a id="__codelineno-70-4" name="__codelineno-70-4"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">AuthorSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<a id="__codelineno-70-5" name="__codelineno-70-5"></a><span class="w">  </span><span class="nx">firstName</span><span class="o">:</span><span class="w"> </span><span class="kt">NonEmptyString</span><span class="p">,</span>
<a id="__codelineno-70-6" name="__codelineno-70-6"></a><span class="w">  </span><span class="nx">lastName</span><span class="o">:</span><span class="w"> </span><span class="kt">NonEmptyString</span><span class="p">,</span>
<a id="__codelineno-70-7" name="__codelineno-70-7"></a><span class="w">  </span><span class="nx">middleName</span><span class="o">:</span><span class="w"> </span><span class="kt">z.string</span><span class="p">().</span><span class="nx">optional</span><span class="p">(),</span>
<a id="__codelineno-70-8" name="__codelineno-70-8"></a><span class="p">});</span>
<a id="__codelineno-70-9" name="__codelineno-70-9"></a>
<a id="__codelineno-70-10" name="__codelineno-70-10"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">Isbn10Schema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="kt">string</span><span class="p">().</span><span class="nx">regex</span><span class="p">(</span><span class="sr">/^\d-\d{2}-\d{6}-\d/</span><span class="p">);</span>
<a id="__codelineno-70-11" name="__codelineno-70-11"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">Isbn13Schema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="kt">string</span><span class="p">().</span><span class="nx">regex</span><span class="p">(</span><span class="sr">/^\d{3}-\d-\d{2}-\d{6}-\d/</span><span class="p">);</span>
<a id="__codelineno-70-12" name="__codelineno-70-12"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">IsbnSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Isbn10Schema</span><span class="p">.</span><span class="nx">or</span><span class="p">(</span><span class="nx">Isbn13Schema</span><span class="p">);</span>
<a id="__codelineno-70-13" name="__codelineno-70-13"></a>
<a id="__codelineno-70-14" name="__codelineno-70-14"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">BookSchema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">object</span><span class="p">({</span>
<a id="__codelineno-70-15" name="__codelineno-70-15"></a><span class="w">  </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="kt">NonEmptyString</span><span class="p">,</span>
<a id="__codelineno-70-16" name="__codelineno-70-16"></a><span class="w">  </span><span class="nx">author</span><span class="o">:</span><span class="w"> </span><span class="kt">AuthorSchema</span><span class="p">,</span>
<a id="__codelineno-70-17" name="__codelineno-70-17"></a><span class="w">  </span><span class="nx">price</span><span class="o">:</span><span class="w"> </span><span class="kt">z.number</span><span class="p">().</span><span class="nx">positive</span><span class="p">(),</span>
<a id="__codelineno-70-18" name="__codelineno-70-18"></a><span class="w">  </span><span class="nx">genre</span><span class="o">:</span><span class="w"> </span><span class="kt">GenreSchema</span><span class="p">,</span>
<a id="__codelineno-70-19" name="__codelineno-70-19"></a><span class="w">  </span><span class="nx">isbn</span><span class="o">:</span><span class="w"> </span><span class="kt">IsbnSchema</span><span class="p">,</span>
<a id="__codelineno-70-20" name="__codelineno-70-20"></a><span class="p">});</span>
<a id="__codelineno-70-21" name="__codelineno-70-21"></a>
<a id="__codelineno-70-22" name="__codelineno-70-22"></a><span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">Book</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">z</span><span class="p">.</span><span class="nx">infer</span><span class="o">&lt;</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">BookSchema</span><span class="o">&gt;</span><span class="p">;</span>
</code></pre></div></td></tr></table></div>
<p>With these schemas and models defined, we can leverage the <code>safeParse</code> function to see if our input is valid.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-71-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-71-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-71-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-71-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-71-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-71-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-71-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-71-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-71-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-71-10">10</a></span>
<span class="normal"><a href="#__codelineno-71-11">11</a></span>
<span class="normal"><a href="#__codelineno-71-12">12</a></span>
<span class="normal"><a href="#__codelineno-71-13">13</a></span>
<span class="normal"><a href="#__codelineno-71-14">14</a></span>
<span class="normal"><a href="#__codelineno-71-15">15</a></span>
<span class="normal"><a href="#__codelineno-71-16">16</a></span>
<span class="normal"><a href="#__codelineno-71-17">17</a></span>
<span class="normal"><a href="#__codelineno-71-18">18</a></span>
<span class="normal"><a href="#__codelineno-71-19">19</a></span>
<span class="normal"><a href="#__codelineno-71-20">20</a></span>
<span class="normal"><a href="#__codelineno-71-21">21</a></span>
<span class="normal"><a href="#__codelineno-71-22">22</a></span>
<span class="normal"><a href="#__codelineno-71-23">23</a></span>
<span class="normal"><a href="#__codelineno-71-24">24</a></span>
<span class="normal"><a href="#__codelineno-71-25">25</a></span>
<span class="normal"><a href="#__codelineno-71-26">26</a></span>
<span class="normal"><a href="#__codelineno-71-27">27</a></span>
<span class="normal"><a href="#__codelineno-71-28">28</a></span>
<span class="normal"><a href="#__codelineno-71-29">29</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-71-1" name="__codelineno-71-1"></a><span class="nx">describe</span><span class="p">(</span><span class="s1">&#39;when validating a book&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-71-2" name="__codelineno-71-2"></a><span class="w">    </span><span class="nx">it</span><span class="p">(</span><span class="s2">&quot;and the author is missing, then it&#39;s not valid&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-71-3" name="__codelineno-71-3"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">input</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="nx">title</span><span class="o">:</span><span class="s2">&quot;best book&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">price</span><span class="o">:</span><span class="kt">200</span><span class="p">,</span><span class="w"> </span><span class="nx">genre</span><span class="o">:</span><span class="s2">&quot;History&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">isbn</span><span class="o">:</span><span class="s2">&quot;1-23-456789-0&quot;</span><span class="p">}</span>
<a id="__codelineno-71-4" name="__codelineno-71-4"></a>
<a id="__codelineno-71-5" name="__codelineno-71-5"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">BookSchema</span><span class="p">.</span><span class="nx">safeParse</span><span class="p">(</span><span class="nx">input</span><span class="p">);</span>
<a id="__codelineno-71-6" name="__codelineno-71-6"></a>
<a id="__codelineno-71-7" name="__codelineno-71-7"></a><span class="w">        </span><span class="nx">expect</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">success</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<a id="__codelineno-71-8" name="__codelineno-71-8"></a><span class="w">    </span><span class="p">});</span>
<a id="__codelineno-71-9" name="__codelineno-71-9"></a><span class="w">    </span><span class="nx">it</span><span class="p">(</span><span class="s2">&quot;and all the fields are valid, then the book is valid&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-71-10" name="__codelineno-71-10"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">input</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-71-11" name="__codelineno-71-11"></a><span class="w">            </span><span class="nx">title</span><span class="o">:</span><span class="s2">&quot;best book&quot;</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-71-12" name="__codelineno-71-12"></a><span class="w">            </span><span class="nx">price</span><span class="o">:</span><span class="kt">200</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-71-13" name="__codelineno-71-13"></a><span class="w">            </span><span class="nx">genre</span><span class="o">:</span><span class="s2">&quot;History&quot;</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-71-14" name="__codelineno-71-14"></a><span class="w">            </span><span class="nx">isbn</span><span class="o">:</span><span class="s2">&quot;1-23-456789-0&quot;</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-71-15" name="__codelineno-71-15"></a><span class="w">            </span><span class="nx">author</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-71-16" name="__codelineno-71-16"></a><span class="w">                </span><span class="nx">firstName</span><span class="o">:</span><span class="s2">&quot;Super&quot;</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-71-17" name="__codelineno-71-17"></a><span class="w">                </span><span class="nx">middleName</span><span class="o">:</span><span class="s2">&quot;Cool&quot;</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-71-18" name="__codelineno-71-18"></a><span class="w">                </span><span class="nx">lastName</span><span class="o">:</span><span class="s2">&quot;Author&quot;</span>
<a id="__codelineno-71-19" name="__codelineno-71-19"></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-71-20" name="__codelineno-71-20"></a><span class="w">        </span><span class="p">};</span>
<a id="__codelineno-71-21" name="__codelineno-71-21"></a>
<a id="__codelineno-71-22" name="__codelineno-71-22"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">BookSchema</span><span class="p">.</span><span class="nx">safeParse</span><span class="p">(</span><span class="nx">input</span><span class="p">);</span>
<a id="__codelineno-71-23" name="__codelineno-71-23"></a>
<a id="__codelineno-71-24" name="__codelineno-71-24"></a><span class="w">        </span><span class="nx">expect</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">success</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
<a id="__codelineno-71-25" name="__codelineno-71-25"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">book</span><span class="o">:</span><span class="kt">Book</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">Book</span><span class="p">;</span>
<a id="__codelineno-71-26" name="__codelineno-71-26"></a><span class="w">        </span><span class="c1">// now we can start using properties from book</span>
<a id="__codelineno-71-27" name="__codelineno-71-27"></a><span class="w">        </span><span class="nx">expect</span><span class="p">(</span><span class="nx">book</span><span class="p">.</span><span class="nx">title</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="s2">&quot;best book&quot;</span><span class="p">);</span>
<a id="__codelineno-71-28" name="__codelineno-71-28"></a><span class="w">    </span><span class="p">});</span>
<a id="__codelineno-71-29" name="__codelineno-71-29"></a><span class="p">});</span>
</code></pre></div></td></tr></table></div>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/cameronpresley.png" alt="Cameron Presley">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2024-05-26 00:00:00+00:00">May 26, 2024</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../../" class="md-meta__link">Today I Learned</a>, 
              <a href="../../../c/" class="md-meta__link">C#</a></li>
        
        
          
          <li class="md-meta__item">
            
              2 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="today-i-learned-primary-constructors"><a class="toclink" href="../../../../2024/05/26/today-i-learned---primary-constructors/">Today I Learned - Primary Constructors</a></h2>
<p>I've recently found myself picking up C# again for a project and even though much of my knowledge applies, I recently found the following and it took me a minute to figure out what's up.</p>
<p>Let's say that we're working on the <a href="../../../../2020/05/20/learning-through-example--mars-rover-kata/">Mars Rover kata</a> and we've decided to model the <em>Rover</em> type as a class with three fields: <em>x, y, and direction</em>.</p>
<p>My normal approach to this problem would have been the following:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-12-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-12-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-12-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-12-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-12-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-12-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-12-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-12-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-12-10">10</a></span>
<span class="normal"><a href="#__codelineno-12-11">11</a></span>
<span class="normal"><a href="#__codelineno-12-12">12</a></span>
<span class="normal"><a href="#__codelineno-12-13">13</a></span>
<span class="normal"><a href="#__codelineno-12-14">14</a></span>
<span class="normal"><a href="#__codelineno-12-15">15</a></span>
<span class="normal"><a href="#__codelineno-12-16">16</a></span>
<span class="normal"><a href="#__codelineno-12-17">17</a></span>
<span class="normal"><a href="#__codelineno-12-18">18</a></span>
<span class="normal"><a href="#__codelineno-12-19">19</a></span>
<span class="normal"><a href="#__codelineno-12-20">20</a></span>
<span class="normal"><a href="#__codelineno-12-21">21</a></span>
<span class="normal"><a href="#__codelineno-12-22">22</a></span>
<span class="normal"><a href="#__codelineno-12-23">23</a></span>
<span class="normal"><a href="#__codelineno-12-24">24</a></span>
<span class="normal"><a href="#__codelineno-12-25">25</a></span>
<span class="normal"><a href="#__codelineno-12-26">26</a></span>
<span class="normal"><a href="#__codelineno-12-27">27</a></span>
<span class="normal"><a href="#__codelineno-12-28">28</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="k">public</span><span class="w"> </span><span class="k">enum</span><span class="w"> </span><span class="n">Direction</span>
<a id="__codelineno-12-2" name="__codelineno-12-2"></a><span class="p">{</span>
<a id="__codelineno-12-3" name="__codelineno-12-3"></a><span class="w">  </span><span class="n">North</span><span class="p">,</span><span class="w"> </span><span class="n">South</span><span class="p">,</span><span class="w"> </span><span class="n">East</span><span class="p">,</span><span class="w"> </span><span class="n">West</span>
<a id="__codelineno-12-4" name="__codelineno-12-4"></a><span class="p">}</span>
<a id="__codelineno-12-5" name="__codelineno-12-5"></a>
<a id="__codelineno-12-6" name="__codelineno-12-6"></a><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">Rover</span>
<a id="__codelineno-12-7" name="__codelineno-12-7"></a><span class="p">{</span>
<a id="__codelineno-12-8" name="__codelineno-12-8"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">_x</span><span class="p">;</span>
<a id="__codelineno-12-9" name="__codelineno-12-9"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">_y</span><span class="p">;</span>
<a id="__codelineno-12-10" name="__codelineno-12-10"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="n">Direction</span><span class="w"> </span><span class="n">_direction</span><span class="p">;</span>
<a id="__codelineno-12-11" name="__codelineno-12-11"></a>
<a id="__codelineno-12-12" name="__codelineno-12-12"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="nf">Rover</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">Direction</span><span class="w"> </span><span class="n">direction</span><span class="p">)</span>
<a id="__codelineno-12-13" name="__codelineno-12-13"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-12-14" name="__codelineno-12-14"></a><span class="w">    </span><span class="n">_x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<a id="__codelineno-12-15" name="__codelineno-12-15"></a><span class="w">    </span><span class="n">_y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="p">;</span>
<a id="__codelineno-12-16" name="__codelineno-12-16"></a><span class="w">    </span><span class="n">_direction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Direction</span><span class="p">;</span>
<a id="__codelineno-12-17" name="__codelineno-12-17"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-12-18" name="__codelineno-12-18"></a>
<a id="__codelineno-12-19" name="__codelineno-12-19"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">Print</span><span class="p">()</span>
<a id="__codelineno-12-20" name="__codelineno-12-20"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-12-21" name="__codelineno-12-21"></a><span class="w">    </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">$&quot;Rover is at ({_x}, {_y}) facing {_direction}&quot;</span><span class="p">);</span>
<a id="__codelineno-12-22" name="__codelineno-12-22"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-12-23" name="__codelineno-12-23"></a><span class="p">}</span>
<a id="__codelineno-12-24" name="__codelineno-12-24"></a>
<a id="__codelineno-12-25" name="__codelineno-12-25"></a><span class="c1">// Example usage</span>
<a id="__codelineno-12-26" name="__codelineno-12-26"></a>
<a id="__codelineno-12-27" name="__codelineno-12-27"></a><span class="kt">var</span><span class="w"> </span><span class="n">rover</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Rover</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="n">Direction</span><span class="p">.</span><span class="n">North</span><span class="p">);</span>
<a id="__codelineno-12-28" name="__codelineno-12-28"></a><span class="n">rover</span><span class="p">.</span><span class="n">Print</span><span class="p">();</span><span class="w"> </span><span class="c1">// Rover is at (10, 20) facing North</span>
</code></pre></div></td></tr></table></div>
<p>However, in the code I was working with, I saw the <code>Rover</code> definition as this</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-13-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-13-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-13-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-13-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-13-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-13-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-13-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-13-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-13-10">10</a></span>
<span class="normal"><a href="#__codelineno-13-11">11</a></span>
<span class="normal"><a href="#__codelineno-13-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="c1">// note the params at the class line here</span>
<a id="__codelineno-13-2" name="__codelineno-13-2"></a><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nf">Rover</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">Direction</span><span class="w"> </span><span class="n">direction</span><span class="p">)</span>
<a id="__codelineno-13-3" name="__codelineno-13-3"></a><span class="p">{</span>
<a id="__codelineno-13-4" name="__codelineno-13-4"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">Print</span><span class="p">()</span>
<a id="__codelineno-13-5" name="__codelineno-13-5"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-13-6" name="__codelineno-13-6"></a><span class="w">    </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">$&quot;Rover is at ({x}, {y}) facing {direction}&quot;</span><span class="p">);</span>
<a id="__codelineno-13-7" name="__codelineno-13-7"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-13-8" name="__codelineno-13-8"></a><span class="p">}</span>
<a id="__codelineno-13-9" name="__codelineno-13-9"></a>
<a id="__codelineno-13-10" name="__codelineno-13-10"></a><span class="c1">// Example Usage</span>
<a id="__codelineno-13-11" name="__codelineno-13-11"></a><span class="kt">var</span><span class="w"> </span><span class="n">rover</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Rover</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="n">Direction</span><span class="p">.</span><span class="n">North</span><span class="p">);</span>
<a id="__codelineno-13-12" name="__codelineno-13-12"></a><span class="n">rover</span><span class="p">.</span><span class="n">Print</span><span class="p">();</span><span class="w"> </span><span class="c1">// Rover is at (10, 20) facing North</span>
</code></pre></div></td></tr></table></div>
<p>At first, I thought this was similar to the <a href="https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/record">record</a> syntax for holding onto data</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="k">public</span><span class="w"> </span><span class="k">record</span><span class="w"> </span><span class="nf">Rover</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">Y</span><span class="p">,</span><span class="w"> </span><span class="n">Direction</span><span class="w"> </span><span class="n">Direction</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<p>And it turns out, that it is! This feature is known as a <a href="https://learn.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/instance-constructors#primary-constructors">primary constructor</a> and when used with classes, it gives you some flexibility on how you want to access those inputs.</p>
<p>For example, in our second implementation of Rover, we're directly using <code>x</code>, <code>y</code>, and <code>direction</code> in  the <code>Print</code> method.</p>
<p>However, let's say that we didn't want to use those properties directly (or if we need to set some state based on those inputs), then we could do the following.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-15-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-15-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-15-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-15-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-15-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-15-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-15-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-15-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-15-10">10</a></span>
<span class="normal"><a href="#__codelineno-15-11">11</a></span>
<span class="normal"><a href="#__codelineno-15-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nf">Rover</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">Direction</span><span class="w"> </span><span class="n">direction</span><span class="p">)</span>
<a id="__codelineno-15-2" name="__codelineno-15-2"></a><span class="p">{</span>
<a id="__codelineno-15-3" name="__codelineno-15-3"></a><span class="w">    </span><span class="k">private</span><span class="w"> </span><span class="k">readonly</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">_isFacingRightDirection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">direction</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Direction</span><span class="p">.</span><span class="n">North</span><span class="p">;</span>
<a id="__codelineno-15-4" name="__codelineno-15-4"></a><span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">Print</span><span class="p">()</span>
<a id="__codelineno-15-5" name="__codelineno-15-5"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-15-6" name="__codelineno-15-6"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">_isFacingRightDirection</span><span class="p">)</span>
<a id="__codelineno-15-7" name="__codelineno-15-7"></a><span class="w">        </span><span class="p">{</span>
<a id="__codelineno-15-8" name="__codelineno-15-8"></a><span class="w">            </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;Rover is facing the correct direction!&quot;</span><span class="p">);</span>
<a id="__codelineno-15-9" name="__codelineno-15-9"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-15-10" name="__codelineno-15-10"></a><span class="w">        </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">$&quot;Rover is at ({x}, {y}) facing {direction}&quot;</span><span class="p">);</span>
<a id="__codelineno-15-11" name="__codelineno-15-11"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-15-12" name="__codelineno-15-12"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>After playing around this for a bit, I can see how this feature would be beneficial for classes that only store their constructor arguments for later usage.</p>
<p>Even though Records accomplish that better, you can't attach functionality to Records, but you can with classes, so it does provide better organization from that front.</p>
<p>That being said, I'm not 100% sure why we needed to add the primary constructor feature to the language as this now opens up multiple ways of setting up constructors. I'm all for giving developers choices, but this seems ripe for <a href="https://en.wiktionary.org/wiki/bikeshedding">bike shedding</a> where teams have to decide which approach to stick with.</p>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/cameronpresley.png" alt="Cameron Presley">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2024-05-10 00:00:00+00:00">May 10, 2024</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../../../typescript/" class="md-meta__link">TypeScript</a>, 
              <a href="../../" class="md-meta__link">Today I Learned</a></li>
        
        
          
          <li class="md-meta__item">
            
              3 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="today-i-learned-destructure-objects-in-function-signatures"><a class="toclink" href="../../../../2024/05/10/today-i-learned-destructure-objects-in-function-signatures/">Today I Learned: Destructure Objects in Function Signatures</a></h2>
<p>When modeling types, one thing to keep in mind is to not leverage <a href="https://refactoring.guru/smells/primitive-obsession">primitive types</a> for your domain. This comes up when we use a primitive type (like a string) to represent core domain concepts (like a Social Security Number or a Phone Number).</p>
<p>Here's an example where it can become problematic:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-12-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-12-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-12-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-12-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-12-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-12-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-12-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-12-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-12-10">10</a></span>
<span class="normal"><a href="#__codelineno-12-11">11</a></span>
<span class="normal"><a href="#__codelineno-12-12">12</a></span>
<span class="normal"><a href="#__codelineno-12-13">13</a></span>
<span class="normal"><a href="#__codelineno-12-14">14</a></span>
<span class="normal"><a href="#__codelineno-12-15">15</a></span>
<span class="normal"><a href="#__codelineno-12-16">16</a></span>
<span class="normal"><a href="#__codelineno-12-17">17</a></span>
<span class="normal"><a href="#__codelineno-12-18">18</a></span>
<span class="normal"><a href="#__codelineno-12-19">19</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="c1">// Definition for Customer</span>
<a id="__codelineno-12-2" name="__codelineno-12-2"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Customer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-12-3" name="__codelineno-12-3"></a><span class="w">  </span><span class="nx">firstName</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span>
<a id="__codelineno-12-4" name="__codelineno-12-4"></a><span class="w">  </span><span class="nx">lastName</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span>
<a id="__codelineno-12-5" name="__codelineno-12-5"></a><span class="w">  </span><span class="nx">email</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span>
<a id="__codelineno-12-6" name="__codelineno-12-6"></a><span class="w">  </span><span class="nx">phoneNumber</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span>
<a id="__codelineno-12-7" name="__codelineno-12-7"></a><span class="p">}</span>
<a id="__codelineno-12-8" name="__codelineno-12-8"></a>
<a id="__codelineno-12-9" name="__codelineno-12-9"></a><span class="c1">// Function to send an email to customer about a new sale</span>
<a id="__codelineno-12-10" name="__codelineno-12-10"></a><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">sendEmailToCustomer</span><span class="p">(</span><span class="nx">c</span><span class="o">:</span><span class="kt">Customer</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-12-11" name="__codelineno-12-11"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">content</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Look at these deals!&quot;</span><span class="p">;</span>
<a id="__codelineno-12-12" name="__codelineno-12-12"></a>
<a id="__codelineno-12-13" name="__codelineno-12-13"></a><span class="w">  </span><span class="c1">// Uh oh, we&#39;re trying to send an email to a phone number...</span>
<a id="__codelineno-12-14" name="__codelineno-12-14"></a><span class="w">  </span><span class="k">await</span><span class="w"> </span><span class="nx">sendEmail</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">phoneNumber</span><span class="p">,</span><span class="w"> </span><span class="nx">content</span><span class="p">);</span>
<a id="__codelineno-12-15" name="__codelineno-12-15"></a><span class="p">}</span>
<a id="__codelineno-12-16" name="__codelineno-12-16"></a>
<a id="__codelineno-12-17" name="__codelineno-12-17"></a><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">sendEmail</span><span class="p">(</span><span class="nx">email</span><span class="o">:</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">content</span><span class="o">:</span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-12-18" name="__codelineno-12-18"></a><span class="w">  </span><span class="c1">// logic to send email</span>
<a id="__codelineno-12-19" name="__codelineno-12-19"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>There's a bug in this code, where we're trying to send an email to a phone number. Unfortunately, this code type checks and compiles, so we have to lean on other techniques (automated testing or code reviews) to discover the bug.</p>
<p>Since it's better to find issues earlier in the process, we can make this a compilation error by introducing a new type for <code>Email</code> since not all strings should be treated equally.</p>
<p>One approach we can do is to create a <a href="https://stackoverflow.com/questions/61646400/difference-union-types-and-discriminated-unions-typescript-f/61649726#61649726">tagged union</a> like the following:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1">1</a></span>
<span class="normal"><a href="#__codelineno-13-2">2</a></span>
<span class="normal"><a href="#__codelineno-13-3">3</a></span>
<span class="normal"><a href="#__codelineno-13-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-2" name="__codelineno-13-2"></a><span class="w">  </span><span class="nx">label</span><span class="o">:</span><span class="s2">&quot;Email&quot;</span><span class="p">,</span>
<a id="__codelineno-13-3" name="__codelineno-13-3"></a><span class="w">  </span><span class="nx">value</span><span class="o">:</span><span class="kt">string</span>
<a id="__codelineno-13-4" name="__codelineno-13-4"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>With this in place, we can change our <code>sendEmail</code> function to leverage the new <code>Email</code> type.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1">1</a></span>
<span class="normal"><a href="#__codelineno-14-2">2</a></span>
<span class="normal"><a href="#__codelineno-14-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="kd">function</span><span class="w"> </span><span class="nx">sendEmail</span><span class="p">(</span><span class="nx">email</span><span class="o">:</span><span class="kt">Email</span><span class="p">,</span><span class="w"> </span><span class="nx">content</span><span class="o">:</span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-14-2" name="__codelineno-14-2"></a><span class="w">  </span><span class="c1">// logic to send email</span>
<a id="__codelineno-14-3" name="__codelineno-14-3"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Now, when we get a compilation error when we try passing in a phoneNumber.</p>
<p><img alt="Compilation error that we can't pass a string to an email" src="https://softwarementorblog.blob.core.windows.net/images/til-destructure-error.png" /></p>
<p>One downside to this approach is that if you want to get the value from the <code>Email</code> type, you need to access it's <code>value</code> property. This can be a bit hard to read and keep track of.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1">1</a></span>
<span class="normal"><a href="#__codelineno-15-2">2</a></span>
<span class="normal"><a href="#__codelineno-15-3">3</a></span>
<span class="normal"><a href="#__codelineno-15-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="kd">function</span><span class="w"> </span><span class="nx">sendEmail</span><span class="p">(</span><span class="nx">email</span><span class="o">:</span><span class="kt">Email</span><span class="p">,</span><span class="w"> </span><span class="nx">content</span><span class="o">:</span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-15-2" name="__codelineno-15-2"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">address</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">email</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
<a id="__codelineno-15-3" name="__codelineno-15-3"></a><span class="w">  </span><span class="c1">// logic to send email</span>
<a id="__codelineno-15-4" name="__codelineno-15-4"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h3 id="leveraging-object-destructuring-in-functions"><a class="toclink" href="../../../../2024/05/10/today-i-learned-destructure-objects-in-function-signatures/#leveraging-object-destructuring-in-functions">Leveraging Object Destructuring in Functions</a></h3>
<p>One technique to avoid this is to use destructuring to get the individual properties. This allows us to "throw away" some properties and hold onto the ones we care about. For example, let's say that we wanted only the <code>phoneNumber</code> from a <code>Customer</code>. We could get that with an assignment like the following:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-16-1">1</a></span>
<span class="normal"><a href="#__codelineno-16-2">2</a></span>
<span class="normal"><a href="#__codelineno-16-3">3</a></span>
<span class="normal"><a href="#__codelineno-16-4">4</a></span>
<span class="normal"><a href="#__codelineno-16-5">5</a></span>
<span class="normal"><a href="#__codelineno-16-6">6</a></span>
<span class="normal"><a href="#__codelineno-16-7">7</a></span>
<span class="normal"><a href="#__codelineno-16-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1"></a><span class="kd">const</span><span class="w"> </span><span class="nx">customer</span><span class="o">:</span><span class="w"> </span><span class="kt">Customer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-16-2" name="__codelineno-16-2"></a><span class="w">  </span><span class="nx">firstName</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Cameron&quot;</span><span class="p">,</span>
<a id="__codelineno-16-3" name="__codelineno-16-3"></a><span class="w">  </span><span class="nx">lastName</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Presley&quot;</span><span class="p">,</span>
<a id="__codelineno-16-4" name="__codelineno-16-4"></a><span class="w">  </span><span class="nx">phoneNumber</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;555-5555&quot;</span><span class="p">,</span>
<a id="__codelineno-16-5" name="__codelineno-16-5"></a><span class="w">  </span><span class="nx">email</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">label</span><span class="o">:</span><span class="s2">&quot;Email&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="o">:</span><span class="s2">&quot;Cameron@domain.com&quot;</span><span class="p">}</span>
<a id="__codelineno-16-6" name="__codelineno-16-6"></a><span class="p">}</span>
<a id="__codelineno-16-7" name="__codelineno-16-7"></a>
<a id="__codelineno-16-8" name="__codelineno-16-8"></a><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="nx">phoneNumber</span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">customer</span><span class="p">;</span><span class="w"> </span><span class="c1">// phoneNumber will be &quot;555-555&quot;</span>
</code></pre></div></td></tr></table></div>
<p>This works fine for assignments, but it'd be nice to have this at a function level. Thankfully, we can do that like so:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-17-1">1</a></span>
<span class="normal"><a href="#__codelineno-17-2">2</a></span>
<span class="normal"><a href="#__codelineno-17-3">3</a></span>
<span class="normal"><a href="#__codelineno-17-4">4</a></span>
<span class="normal"><a href="#__codelineno-17-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1"></a><span class="c1">// value is the property from Email, we don&#39;t have the label to deal with</span>
<a id="__codelineno-17-2" name="__codelineno-17-2"></a><span class="kd">function</span><span class="w"> </span><span class="nx">sendEmail</span><span class="p">({</span><span class="nx">value</span><span class="p">}</span><span class="o">:</span><span class="nx">Email</span><span class="p">,</span><span class="w"> </span><span class="nx">content</span><span class="o">:</span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="ow">void</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-17-3" name="__codelineno-17-3"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">address</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">value</span><span class="p">;</span><span class="w"> </span><span class="c1">// note that we don&#39;t have to do .value here</span>
<a id="__codelineno-17-4" name="__codelineno-17-4"></a><span class="w">  </span><span class="c1">// logic to send email</span>
<a id="__codelineno-17-5" name="__codelineno-17-5"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>If you find yourself using domain types like this, then this is a handy tool to have in your toolbox.</p>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/cameronpresley.png" alt="Cameron Presley">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2024-05-06 00:00:00+00:00">May 6, 2024</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../../" class="md-meta__link">Today I Learned</a>, 
              <a href="../../../tooling/" class="md-meta__link">Tooling</a></li>
        
        
          
          <li class="md-meta__item">
            
              4 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="today-i-learned-effective-pairing-with-mobsh"><a class="toclink" href="../../../../2024/05/06/today-i-learned---effective-pairing-with-mobsh/">Today I Learned - Effective Pairing with Mob.sh</a></h2>
<p>As someone who enjoys leveraging technology and teaching, I'm always interested in ways to simplify the teaching process.</p>
<p>For example, when I'm teaching someone a new skill, I follow the "show one, do one, lead one" approach and my tool of choice for the longest time was <a href="https://visualstudio.microsoft.com/services/live-share/">LiveShare</a> by Microsoft.</p>
<h3 id="using-vs-liveshare"><a class="toclink" href="../../../../2024/05/06/today-i-learned---effective-pairing-with-mobsh/#using-vs-liveshare">Using VS LiveShare</a></h3>
<p>I think this extension is pretty slick as it allows you to have multiple collaborators, the latency is quite low, and it's built into both Visual Studio Code (VS Code) and Visual Studio.</p>
<h3 id="drawbacks-to-liveshare"><a class="toclink" href="../../../../2024/05/06/today-i-learned---effective-pairing-with-mobsh/#drawbacks-to-liveshare">Drawbacks to LiveShare</a></h3>
<h4 id="editor-lock-in"><a class="toclink" href="../../../../2024/05/06/today-i-learned---effective-pairing-with-mobsh/#editor-lock-in">Editor Lock-In</a></h4>
<p>First, participants have to be using Visual Studio or VS Code. Since there's support for VS Code, this isn't quite a blocker as it could be. However, let's say that I'm wanting to work with a team on a Java application. They're more likely to be using IntelliJ or Eclipse as their editor and I don't want someone to have to change their editor just to collaborate.</p>
<h4 id="security-concerns"><a class="toclink" href="../../../../2024/05/06/today-i-learned---effective-pairing-with-mobsh/#security-concerns">Security Concerns</a></h4>
<p>Second, there are some security considerations to be aware of.</p>
<p>Given the nature of LiveShare, collaborators either connect to your machine (peer-to-peer) or they go through a relay in Azure. Companies that are sensitive to where traffic is routed to won't allow the Azure relay option and given the issues with the URL creation (see next section), the peer-to-peer connection isn't much better.</p>
<p>To start a session, LiveShare generates a URL that the owner would share with their collaborators. As of today, there's no way to limit <em>who</em> can access that link. The owner has some moderator tools to block people, but there's not a way to stop anyone from joining who doesn't have the right kind of email address for example.</p>
<h3 id="introducing-mobsh"><a class="toclink" href="../../../../2024/05/06/today-i-learned---effective-pairing-with-mobsh/#introducing-mobsh">Introducing Mob.sh</a></h3>
<p>While pairing with a <a href="https://www.linkedin.com/in/jefflangr/">colleague</a>, he introduced me to an alternative tool, <a href="https://mob.sh/">mob.sh</a></p>
<p>At first, I was a bit skeptical of this tooling as I enjoyed the ease of use that I got with LiveShare. However, after a few sessions, I find that this tool solves the problems that I was using LiveShare for just as good, if not better.</p>
<h4 id="how-it-works"><a class="toclink" href="../../../../2024/05/06/today-i-learned---effective-pairing-with-mobsh/#how-it-works">How It Works</a></h4>
<p>At a high level, <em>mob.sh</em> is a command line tool that is a wrapper around basic <code>git</code> commands.</p>
<p>Because of this design choice, it doesn't matter what editor that a participant has, as long as the code under question is under <code>git</code> source control, the tooling works.</p>
<p>Let's explore how a pair, Adam and Brittany, would use this tool for work.</p>
<h4 id="adam-and-brittany-start-pairing"><a class="toclink" href="../../../../2024/05/06/today-i-learned---effective-pairing-with-mobsh/#adam-and-brittany-start-pairing">Adam and Brittany Start Pairing</a></h4>
<p>Adam is looking to solve a logic issue in an AWS lambda could use Brittany's guidance since he's new to that domain.</p>
<p>Adam creates a new feature branch, <code>fixing-logic-issue</code> and starts a new mobbing session.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1">1</a></span>
<span class="normal"><a href="#__codelineno-12-2">2</a></span>
<span class="normal"><a href="#__codelineno-12-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1"></a>git<span class="w"> </span>switch<span class="w"> </span>-c<span class="w"> </span>fixing-logic-issue
<a id="__codelineno-12-2" name="__codelineno-12-2"></a>mob<span class="w"> </span>start<span class="w"> </span>--create
<a id="__codelineno-12-3" name="__codelineno-12-3"></a><span class="c1"># --create is needed because fixing-logic issue is not on the server yet</span>
</code></pre></div></td></tr></table></div>
<p>Under the hood, <code>mob.sh</code> has created a new branch off of <code>fixing-logic-issue</code> called <code>mob/fixing-logic-issue</code>. While Adam is making changes, they're going to occur on the <code>mob/fixing-logic-issue</code>.</p>
<p>Because the pair is working remotely, Adam shares his screen so that they're on the same page.</p>
<p>While on this branch, Adam writes a failing unit test that exposes the logic issue that he's running into. From here he signals that Brittany is up by running <code>mob next</code></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1"></a>mob<span class="w"> </span>next
</code></pre></div></td></tr></table></div>
<p>By running this command, <code>mob.sh</code> adds and commits all the changes made on this branch and pushes them up to the server. Once this command completes, it's Brittany's turn to lead.</p>
<p>Once Brittany see's the <code>mob next</code> command complete, she checks out the <code>fixing-logic-issue</code> branch and picks up the next portion of the work by running <code>mob start</code></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1">1</a></span>
<span class="normal"><a href="#__codelineno-14-2">2</a></span>
<span class="normal"><a href="#__codelineno-14-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1"></a>git<span class="w"> </span>pull<span class="w"> </span><span class="c1"># To get fixing-logic-issue branch</span>
<a id="__codelineno-14-2" name="__codelineno-14-2"></a>git<span class="w"> </span>switch<span class="w"> </span>fixing-logic-issue
<a id="__codelineno-14-3" name="__codelineno-14-3"></a>mob<span class="w"> </span>start
</code></pre></div></td></tr></table></div>
<p>Because she was on the <code>fixing-logic-issue</code> branch, <code>mob.sh</code> was able to see that there was a <code>mob/fixing-logic-issue</code> branch already, so that branch is checked out.</p>
<p>Based on the test, Brittany shows Adam where the failure is occurring and they write up a fix that passes the failing test.</p>
<p>Though there are more changes to be done, Brittany has a meeting to attend, so she ends the session by running <code>mob done</code>, committing, and then pushing the changes.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1">1</a></span>
<span class="normal"><a href="#__codelineno-15-2">2</a></span>
<span class="normal"><a href="#__codelineno-15-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1"></a>mob<span class="w"> </span><span class="k">done</span>
<a id="__codelineno-15-2" name="__codelineno-15-2"></a>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;Fixed first logic bug&quot;</span>
<a id="__codelineno-15-3" name="__codelineno-15-3"></a>git<span class="w"> </span>push
</code></pre></div></td></tr></table></div>
<p>By running <code>mob done</code> command, all the changes that were on the <code>mob/fixing-logic-issue</code> are applied to the <code>fixing-logic-issue</code> branch. From here, Brittany can commit the changes and push them back to the server.</p>
<h3 id="wrapping-up"><a class="toclink" href="../../../../2024/05/06/today-i-learned---effective-pairing-with-mobsh/#wrapping-up">Wrapping Up</a></h3>
<p>If you're looking to expand your pairing/mobbing toolkit, I recommend giving <code>mob.sh</code> a try. Not only is the initial investment small, but I find the tooling natural to pick up after a few tries and since it's a wrapper around Git, it reduces the amount of learning needed before getting started.</p>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/cameronpresley.png" alt="Cameron Presley">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2024-04-22 00:00:00+00:00">Apr 22, 2024</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../../../typescript/" class="md-meta__link">TypeScript</a>, 
              <a href="../../" class="md-meta__link">Today I Learned</a>, 
              <a href="../../../process/" class="md-meta__link">Process</a></li>
        
        
          
          <li class="md-meta__item">
            
              3 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="today-i-learned-libyear"><a class="toclink" href="../../../../2024/04/22/today-i-learned-libyear/">Today I Learned: LibYear</a></h2>
<p>When writing software, it's difficult (if not impossible) to write everything from scratch. We're either using a framework or various third-party libraries to make our code work.</p>
<p>On one hand, this is a major win for the community because we're not all having to solve the same problem over and over again. Could you imagine having to implement your own authentication framework (<a href="https://www.reddit.com/r/learnprogramming/comments/q8ppcs/never_roll_your_own_authenticationauthorization/">on second thought...</a>)</p>
<p>However, this power comes at a cost. These libraries aren't free as in beer, but more like puppies. So if we're going to take in the library, then we need to make sure that our dependencies are up-to-date with the latest and greatest. There are new features, bug fixes, and security patches occurring all the time and the longer we let a library drift, the more painful it can be to upgrade.</p>
<p>If the library is leveraging <a href="https://semver.org/">semantic versioning</a>, then we can take a guess on the likelihood of a breaking change base on which number (Major.Minor.Maintenance) has changed.</p>
<ul>
<li>Major - We've made a breaking change that's not backward compatible. Your code may not work anymore.</li>
<li>Minor - We've added added new features that you might be interested in or made other changes that  are backwards compatible.</li>
<li>Maintenance - We've fixed some bugs, sorry about that!</li>
</ul>
<h3 id="keeping-up-with-dependencies"><a class="toclink" href="../../../../2024/04/22/today-i-learned-libyear/#keeping-up-with-dependencies">Keeping Up With Dependencies</a></h3>
<p>For libraries that have known vulnerabilities, you can leverage tools like GitHub's <a href="https://docs.github.com/en/code-security/getting-started/dependabot-quickstart-guide">Dependabot</a> to auto-create pull requests that will upgrade those dependencies for you. Even though the tool might be "noisy", this is a great way to take an active role in keeping libraries up to date.</p>
<p>However, this approach only works for vulnerabilities, what about libraries that are just out-of-date? There's a cost/benefit of upgrading where the longer you go between the upgrades, the riskier the upgrade will be.</p>
<p>In the JavaScript world, we know that dependencies are listed in the <code>package.json</code> file with minimum versions and the <code>package-lock.json</code> file states the <em>exact</em> versions to use.</p>
<h3 id="using-libyear"><a class="toclink" href="../../../../2024/04/22/today-i-learned-libyear/#using-libyear">Using LibYear</a></h3>
<p>I was working with <a href="https://www.linkedin.com/in/joshuaangolano/">one of my colleagues</a> the other day and he referred me to a library called <a href="https://github.com/jdanil/libyear">LibYear</a> that will check your package.json and lock file to determine how much "drift" that you have between your dependencies.</p>
<p>Under the hood, it's combining the <code>npm outdated</code> and <code>npm view &lt;package&gt;</code> commands to determine the drift.</p>
<p>What I like about this tool is that you can use this as a part of a "software health" report for your codebase.</p>
<p>As engineers, we get pressure to ship features and hit delivery dates, but it's our responsibility to make sure that our codebase is in good shape (however we defined that term). I think this library is a good way for us to capture <em>a</em> data point about software health which then allows the team to make a decision on whether we should update our libraries now (or defer).</p>
<p>The nice thing about the <code>LibYear</code> package is that it lends itself to be ran in a pipeline and then you could take those results and post them somewhere. For example, maybe you could <a href="../../../../2023/06/26/having-coffee-with-deno---inspiration/">write your own automation bot</a> that could post the stats in your Slack or Teams chat.</p>
<p>It looks like <a href="https://github.com/marketplace/actions/node-js-dependency-freshness-via-libyear">there's already a GitHub Action</a> for running this tool today, so you could start there as a basis.</p>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/cameronpresley.png" alt="Cameron Presley">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2024-04-13 00:00:00+00:00">Apr 13, 2024</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../../../functional-programming/" class="md-meta__link">Functional Programming</a>, 
              <a href="../../../typescript/" class="md-meta__link">TypeScript</a>, 
              <a href="../../" class="md-meta__link">Today I Learned</a></li>
        
        
          
          <li class="md-meta__item">
            
              2 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="today-i-learned-iterating-through-union-types"><a class="toclink" href="../../../../2024/04/13/today-i-learned---iterating-through-union-types/">Today I Learned - Iterating Through Union Types</a></h2>
<p>In a <a href="../../../../2023/04/30/better-domain-modeling-with-discriminated-unions/">previous post</a>, we cover on how using union types in TypeScript is a great approach for domain modeling because it limits the possible values that a type can have.</p>
<p>For example, let's say that we're modeling a card game with a standard deck of playing cards. We could model the domain as such.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1">1</a></span>
<span class="normal"><a href="#__codelineno-12-2">2</a></span>
<span class="normal"><a href="#__codelineno-12-3">3</a></span>
<span class="normal"><a href="#__codelineno-12-4">4</a></span>
<span class="normal"><a href="#__codelineno-12-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Rank</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Ace&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;Two&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;Three&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;Four&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;Five&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;Six&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;Seven&quot;</span>
<a id="__codelineno-12-2" name="__codelineno-12-2"></a><span class="w">           </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;Eight&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;Nine&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;Ten&quot;</span><span class="w"> </span><span class="o">|</span><span class="s2">&quot;Jack&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;Queen&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;King&quot;</span>
<a id="__codelineno-12-3" name="__codelineno-12-3"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Suite</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Hearts&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;Clubs&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;Spades&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s2">&quot;Diamonds&quot;</span>
<a id="__codelineno-12-4" name="__codelineno-12-4"></a>
<a id="__codelineno-12-5" name="__codelineno-12-5"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Card</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="nx">rank</span><span class="o">:</span><span class="kt">Rank</span><span class="p">;</span><span class="w"> </span><span class="nx">suite</span><span class="o">:</span><span class="kt">Suit</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>With this modeling, there's no way to create a <code>Card</code> such that it has an invalid <code>Rank</code> or <code>Suite</code>.</p>
<p>With this definition, let's create a function to build the deck.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-13-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-13-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-13-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-13-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-13-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-13-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-13-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-13-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-13-10">10</a></span>
<span class="normal"><a href="#__codelineno-13-11">11</a></span>
<span class="normal"><a href="#__codelineno-13-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="kd">function</span><span class="w"> </span><span class="nx">createDeck</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nx">Card</span><span class="p">[]</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-2" name="__codelineno-13-2"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">ranks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;Ace&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Two&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Three&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Four&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Five&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Six&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Seven&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Eight&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Nine&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Ten&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Jack&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Queen&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;King&quot;</span><span class="p">];</span>
<a id="__codelineno-13-3" name="__codelineno-13-3"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">suites</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;Hearts&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Clubs&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Spades&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Diamonds&quot;</span><span class="p">];</span>
<a id="__codelineno-13-4" name="__codelineno-13-4"></a>
<a id="__codelineno-13-5" name="__codelineno-13-5"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">deck</span><span class="o">:</span><span class="kt">Card</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
<a id="__codelineno-13-6" name="__codelineno-13-6"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">rank</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">ranks</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-7" name="__codelineno-13-7"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">suite</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">suites</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-13-8" name="__codelineno-13-8"></a><span class="w">      </span><span class="nx">deck</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span><span class="nx">rank</span><span class="p">,</span><span class="w"> </span><span class="nx">suite</span><span class="p">});</span>
<a id="__codelineno-13-9" name="__codelineno-13-9"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-13-10" name="__codelineno-13-10"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-13-11" name="__codelineno-13-11"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">deck</span><span class="p">;</span>
<a id="__codelineno-13-12" name="__codelineno-13-12"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>This code works, however, I don't like the fact that I had to formally list the option for both <code>Rank</code> and <code>Suite</code> as this means that I have two different representtions for <code>Rank</code> and <code>Suite</code>, which implies tthat if we needed to add a new <code>Rank</code> or <code>Suite</code>, then we'd need to add it in two places (a violation of DRY).</p>
<p>Doing some digging, I found <a href="https://stackoverflow.com/questions/43067354/how-to-iterate-a-string-literal-type-in-typescript">this StackOverflow post</a> that gave a different way of defining our <code>Rank</code> and <code>Suite</code> types. Let's try that new definition.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1">1</a></span>
<span class="normal"><a href="#__codelineno-14-2">2</a></span>
<span class="normal"><a href="#__codelineno-14-3">3</a></span>
<span class="normal"><a href="#__codelineno-14-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="kd">const</span><span class="w"> </span><span class="nx">ranks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;Ace&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Two&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Three&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Four&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Five&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Six&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Seven&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Eight&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Nine&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Ten&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Jack&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Queen&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;King&quot;</span><span class="p">]</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kd">const</span><span class="p">;</span>
<a id="__codelineno-14-2" name="__codelineno-14-2"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Rank</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">typeof</span><span class="w"> </span><span class="nx">ranks</span><span class="p">[</span><span class="kt">number</span><span class="p">];</span>
<a id="__codelineno-14-3" name="__codelineno-14-3"></a><span class="kd">const</span><span class="w"> </span><span class="nx">suites</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;Hearts&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Clubs&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Spades&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Diamonds&quot;</span><span class="p">]</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kd">const</span><span class="p">;</span>
<a id="__codelineno-14-4" name="__codelineno-14-4"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Suite</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">typeof</span><span class="w"> </span><span class="nx">suites</span><span class="p">[</span><span class="kt">number</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
<p>In this above code, we're saying that <code>ranks</code> cannot change (either by assignment or by operations like <code>push</code>). With that definition, we can say that <code>Rank</code> is some entry in the <code>ranks</code> array. Similar approach for our <code>suites</code> array and <code>Suite</code> type.</p>
<p>I prefer this approach much more because we have our ranks and suites defined in one place and our code reads cleaner as this says <em>Here are the possible ranks and Rank can only be one of those choices</em>.</p>
<h3 id="limitations"><a class="toclink" href="../../../../2024/04/13/today-i-learned---iterating-through-union-types/#limitations">Limitations</a></h3>
<p>The main limitation is that it only works for "enum" style unions. Let's change example and say that we want to model a series of shapes with the following.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1">1</a></span>
<span class="normal"><a href="#__codelineno-15-2">2</a></span>
<span class="normal"><a href="#__codelineno-15-3">3</a></span>
<span class="normal"><a href="#__codelineno-15-4">4</a></span>
<span class="normal"><a href="#__codelineno-15-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Circle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="nx">radius</span><span class="o">:</span><span class="kt">number</span><span class="p">};</span>
<a id="__codelineno-15-2" name="__codelineno-15-2"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Square</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="nx">length</span><span class="o">:</span><span class="kt">number</span><span class="p">};</span>
<a id="__codelineno-15-3" name="__codelineno-15-3"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Rectangle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="nx">height</span><span class="o">:</span><span class="kt">number</span><span class="p">,</span><span class="w"> </span><span class="nx">width</span><span class="o">:</span><span class="kt">number</span><span class="p">}</span>
<a id="__codelineno-15-4" name="__codelineno-15-4"></a>
<a id="__codelineno-15-5" name="__codelineno-15-5"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Circle</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nx">Square</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nx">Rectangle</span>
</code></pre></div></td></tr></table></div>
<p>To use the same trick, we would need to have an array of constant values. However, we can't have a constant value for any of the <code>Shape</code>s because there are an infinite number of valid <code>Circle</code>s, <code>Square</code>s, and <code>Rectangle</code>s.</p>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/cameronpresley.png" alt="Cameron Presley">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2024-03-19 00:00:00+00:00">Mar 19, 2024</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../../" class="md-meta__link">Today I Learned</a></li>
        
        
          
          <li class="md-meta__item">
            
              4 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="today-i-learned-the-difference-between-bubble-and-capture-for-events"><a class="toclink" href="../../../../2024/03/19/today-i-learned--the-difference-between-bubble-and-capture-for-events/">Today I Learned  The Difference Between Bubble and Capture for Events</a></h2>
<p>I've recently been spending some time learning about <a href="https://learn.svelte.dev/tutorial/welcome-to-svelte">Svelte</a> and have been going through the tutorials.</p>
<p>When I made it to the <a href="https://learn.svelte.dev/tutorial/event-modifiers">event modifiers</a> section, I saw that there's a modifier for <code>capture</code> where it mentions firing the handler during the <em>capture</em> phase instead of the <em>bubbling</em> phase.</p>
<p>I'm not an expert on front-end development, but I'm not familiar with either of these concepts. Thankfully, the Svelte docs refer out to <a href="https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Building_blocks/Events#event_capture">MDN</a> for a better explanation of the two.</p>
<h4 id="what-is-event-bubbling"><a class="toclink" href="../../../../2024/03/19/today-i-learned--the-difference-between-bubble-and-capture-for-events/#what-is-event-bubbling">What is Event Bubbling?</a></h4>
<p>Long story short, by default, when an event happens, the element that's been interacted with will fire first and then each parent will receive the event.</p>
<p>So if we have the following HTML structure where there's a <code>body</code> that has a <code>div</code> that has a <code>button</code></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-18-1">1</a></span>
<span class="normal"><a href="#__codelineno-18-2">2</a></span>
<span class="normal"><a href="#__codelineno-18-3">3</a></span>
<span class="normal"><a href="#__codelineno-18-4">4</a></span>
<span class="normal"><a href="#__codelineno-18-5">5</a></span>
<span class="normal"><a href="#__codelineno-18-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1"></a><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
<a id="__codelineno-18-2" name="__codelineno-18-2"></a>  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;container&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-18-3" name="__codelineno-18-3"></a>    <span class="p">&lt;</span><span class="nt">button</span><span class="p">&gt;</span>Click me!<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<a id="__codelineno-18-4" name="__codelineno-18-4"></a>  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-18-5" name="__codelineno-18-5"></a>  <span class="p">&lt;</span><span class="nt">pre</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;output&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">pre</span><span class="p">&gt;</span>
<a id="__codelineno-18-6" name="__codelineno-18-6"></a><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</code></pre></div></td></tr></table></div>
<p>With the an event listener at each level:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-19-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-19-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-19-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-19-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-19-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-19-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-19-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-19-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-19-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-19-10">10</a></span>
<span class="normal"><a href="#__codelineno-19-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1"></a><span class="c1">// Setting up adding string to the pre element</span>
<a id="__codelineno-19-2" name="__codelineno-19-2"></a><span class="kd">const</span><span class="w"> </span><span class="nx">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;#output&quot;</span><span class="p">);</span>
<a id="__codelineno-19-3" name="__codelineno-19-3"></a><span class="kd">const</span><span class="w"> </span><span class="nx">handleClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)=&gt;</span><span class="w"> </span><span class="nx">output</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="sb">`You clicked on a </span><span class="si">${</span><span class="nx">e</span><span class="p">.</span><span class="nx">currentTarget</span><span class="p">.</span><span class="nx">tagName</span><span class="si">}</span><span class="sb"> element\n`</span><span class="p">;</span>
<a id="__codelineno-19-4" name="__codelineno-19-4"></a>
<a id="__codelineno-19-5" name="__codelineno-19-5"></a><span class="kd">const</span><span class="w"> </span><span class="nx">container</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;#container&quot;</span><span class="p">);</span>
<a id="__codelineno-19-6" name="__codelineno-19-6"></a><span class="kd">const</span><span class="w"> </span><span class="nx">button</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;button&quot;</span><span class="p">);</span>
<a id="__codelineno-19-7" name="__codelineno-19-7"></a>
<a id="__codelineno-19-8" name="__codelineno-19-8"></a><span class="c1">// Wiring up the event listeners</span>
<a id="__codelineno-19-9" name="__codelineno-19-9"></a><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;click&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">handleClick</span><span class="p">);</span>
<a id="__codelineno-19-10" name="__codelineno-19-10"></a><span class="nx">container</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;click&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">handleClick</span><span class="p">);</span>
<a id="__codelineno-19-11" name="__codelineno-19-11"></a><span class="nx">button</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;click&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">handleClick</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<p>And we click the button, our <code>&lt;pre&gt;</code> element will have:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-20-1">1</a></span>
<span class="normal"><a href="#__codelineno-20-2">2</a></span>
<span class="normal"><a href="#__codelineno-20-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1"></a>You clicked on a BUTTON element
<a id="__codelineno-20-2" name="__codelineno-20-2"></a>You clicked on a DIV element
<a id="__codelineno-20-3" name="__codelineno-20-3"></a>You clicked on a BODY element
</code></pre></div></td></tr></table></div>
<h4 id="what-is-event-capturing"><a class="toclink" href="../../../../2024/03/19/today-i-learned--the-difference-between-bubble-and-capture-for-events/#what-is-event-capturing">What is Event Capturing?</a></h4>
<p>Event Capturing is the opposite of Event Bubbling where the root parent receives the event and then each inner parent will receive the event, finally making it to the innermost child of the element that started the event.</p>
<p>Let's see what happens with our example when we use the capture approach.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-21-1">1</a></span>
<span class="normal"><a href="#__codelineno-21-2">2</a></span>
<span class="normal"><a href="#__codelineno-21-3">3</a></span>
<span class="normal"><a href="#__codelineno-21-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1"></a><span class="c1">// Wiring up the event listeners</span>
<a id="__codelineno-21-2" name="__codelineno-21-2"></a><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;click&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">handleClick</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="nx">capture</span><span class="o">:</span><span class="kc">true</span><span class="p">});</span>
<a id="__codelineno-21-3" name="__codelineno-21-3"></a><span class="nx">container</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;click&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">handleClick</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="nx">capture</span><span class="o">:</span><span class="kc">true</span><span class="p">});</span>
<a id="__codelineno-21-4" name="__codelineno-21-4"></a><span class="nx">button</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;click&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">handleClick</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="nx">capture</span><span class="o">:</span><span class="kc">true</span><span class="p">});</span>
</code></pre></div></td></tr></table></div>
<p>After clicking the button, we'll see the following messages:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-22-1">1</a></span>
<span class="normal"><a href="#__codelineno-22-2">2</a></span>
<span class="normal"><a href="#__codelineno-22-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1"></a>You clicked on a BODY element
<a id="__codelineno-22-2" name="__codelineno-22-2"></a>You clicked on a DIV element
<a id="__codelineno-22-3" name="__codelineno-22-3"></a>You clicked on a BUTTON element
</code></pre></div></td></tr></table></div>
<h4 id="why-would-you-use-capture"><a class="toclink" href="../../../../2024/03/19/today-i-learned--the-difference-between-bubble-and-capture-for-events/#why-would-you-use-capture">Why Would You Use Capture?</a></h4>
<p>By default, events will work in a <em>bubbling</em> fashion and this intuitively makes sense to me since the element that was interacted with is most likely the right element to handle the event.</p>
<p>One case that comes to mind is if you finding yourself attaching the same event listener to every child element. Instead, we could move that up.</p>
<p>For example, let's say that we had the following layout</p>
<p><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-23-1">1</a></span>
<span class="normal"><a href="#__codelineno-23-2">2</a></span>
<span class="normal"><a href="#__codelineno-23-3">3</a></span>
<span class="normal"><a href="#__codelineno-23-4">4</a></span>
<span class="normal"><a href="#__codelineno-23-5">5</a></span>
<span class="normal"><a href="#__codelineno-23-6">6</a></span>
<span class="normal"><a href="#__codelineno-23-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1"></a><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-23-2" name="__codelineno-23-2"></a>    <span class="p">&lt;</span><span class="nt">ul</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;list-style-type: none; padding: 0px; margin:0px; float:left&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-23-3" name="__codelineno-23-3"></a>      <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;one&quot;</span><span class="p">&gt;</span>Click on 1<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<a id="__codelineno-23-4" name="__codelineno-23-4"></a>      <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;two&quot;</span><span class="p">&gt;</span>Click on 2<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<a id="__codelineno-23-5" name="__codelineno-23-5"></a>      <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;three&quot;</span><span class="p">&gt;</span>Click on 3<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<a id="__codelineno-23-6" name="__codelineno-23-6"></a>    <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
<a id="__codelineno-23-7" name="__codelineno-23-7"></a>  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-24-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-24-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-24-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-24-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-24-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-24-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-24-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-24-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-24-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-24-10">10</a></span>
<span class="normal"><a href="#__codelineno-24-11">11</a></span>
<span class="normal"><a href="#__codelineno-24-12">12</a></span>
<span class="normal"><a href="#__codelineno-24-13">13</a></span>
<span class="normal"><a href="#__codelineno-24-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1"></a><span class="nt">li</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-24-2" name="__codelineno-24-2"></a><span class="w">  </span><span class="k">list-style-type</span><span class="p">:</span><span class="w"> </span><span class="kc">none</span><span class="p">;</span>
<a id="__codelineno-24-3" name="__codelineno-24-3"></a><span class="w">  </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="kt">px</span><span class="p">;</span>
<a id="__codelineno-24-4" name="__codelineno-24-4"></a><span class="w">  </span><span class="k">margin</span><span class="p">:</span><span class="mi">0</span><span class="kt">px</span><span class="p">;</span>
<a id="__codelineno-24-5" name="__codelineno-24-5"></a><span class="w">  </span><span class="k">float</span><span class="p">:</span><span class="kc">left</span>
<a id="__codelineno-24-6" name="__codelineno-24-6"></a><span class="p">}</span>
<a id="__codelineno-24-7" name="__codelineno-24-7"></a>
<a id="__codelineno-24-8" name="__codelineno-24-8"></a><span class="nt">li</span><span class="w"> </span><span class="nt">a</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-24-9" name="__codelineno-24-9"></a><span class="w">  </span><span class="k">color</span><span class="p">:</span><span class="kc">black</span><span class="p">;</span>
<a id="__codelineno-24-10" name="__codelineno-24-10"></a><span class="w">  </span><span class="k">background</span><span class="p">:</span><span class="mh">#eee</span><span class="p">;</span>
<a id="__codelineno-24-11" name="__codelineno-24-11"></a><span class="w">  </span><span class="k">border</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="kt">px</span><span class="w"> </span><span class="kc">solid</span><span class="w"> </span><span class="mh">#ccc</span><span class="p">;</span>
<a id="__codelineno-24-12" name="__codelineno-24-12"></a><span class="w">  </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="w"> </span><span class="mi">15</span><span class="kt">px</span><span class="p">;</span>
<a id="__codelineno-24-13" name="__codelineno-24-13"></a><span class="w">  </span><span class="k">display</span><span class="p">:</span><span class="kc">block</span>
<a id="__codelineno-24-14" name="__codelineno-24-14"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
Which gives us the following layout</p>
<!-- <body> -->
<div>
    <ul>
      <li style="list-style-type: none; padding: 0px; margin:0px; float:left"><a style="color:black; background:#eee; border: 1px solid #ccc; padding: 10px 15px; display:block" id="one">Click on 1</a></li>
      <li style="list-style-type: none; padding: 0px; margin:0px; float:left"><a style="color:black; background:#eee; border: 1px solid #ccc; padding: 10px 15px; display:block" id="two">Click on 2</a></li>
      <li style="list-style-type: none; padding: 0px; margin:0px; float:left"><a style="color:black; background:#eee; border: 1px solid #ccc; padding: 10px 15px; display:block" id="three">Click on 3</a></li>
    </ul>
  </div>

<p>With this layout, let's say that we need to do some business rules for when any of those buttons are clicked. If we used the bubble down approach, we would have the following code:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-25-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-25-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-25-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-25-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-25-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-25-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-25-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-25-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-25-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-25-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1"></a><span class="c1">// Stand-in for real business rules</span>
<a id="__codelineno-25-2" name="__codelineno-25-2"></a><span class="kd">function</span><span class="w"> </span><span class="nx">handleClick</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-25-3" name="__codelineno-25-3"></a><span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`You clicked on </span><span class="si">${</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">id</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<a id="__codelineno-25-4" name="__codelineno-25-4"></a><span class="p">}</span>
<a id="__codelineno-25-5" name="__codelineno-25-5"></a><span class="c1">// Get all the a elements</span>
<a id="__codelineno-25-6" name="__codelineno-25-6"></a><span class="kd">const</span><span class="w"> </span><span class="nx">elements</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">);</span>
<a id="__codelineno-25-7" name="__codelineno-25-7"></a><span class="c1">// Wire up the click handler</span>
<a id="__codelineno-25-8" name="__codelineno-25-8"></a><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">e</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">elements</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-25-9" name="__codelineno-25-9"></a><span class="w">  </span><span class="nx">e</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;click&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">handleClick</span><span class="p">);</span>
<a id="__codelineno-25-10" name="__codelineno-25-10"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>This isn't a big deal with three elements, but let's pretend that you had a list with tens of items, or a hundred items. You may run into a performance hit because of the overhead of wiring up that many event listeners.</p>
<p>Instead, we can use one event listener, bound to the common parent. This can accomplish the same affect, without as much complexity.</p>
<p>Let's revisit our JavaScript and make the necessary changes.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-26-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-26-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-26-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-26-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-26-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-26-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-26-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-26-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-26-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-26-10">10</a></span>
<span class="normal"><a href="#__codelineno-26-11">11</a></span>
<span class="normal"><a href="#__codelineno-26-12">12</a></span>
<span class="normal"><a href="#__codelineno-26-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1"></a><span class="c1">// Stand-in for real business rules</span>
<a id="__codelineno-26-2" name="__codelineno-26-2"></a><span class="kd">function</span><span class="w"> </span><span class="nx">handleClick</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-26-3" name="__codelineno-26-3"></a><span class="w">  </span><span class="c1">// NEW: To handle the space of the unordered list, we&#39;ll return early</span>
<a id="__codelineno-26-4" name="__codelineno-26-4"></a><span class="w">  </span><span class="c1">// if the currentTarget is the same as the original target</span>
<a id="__codelineno-26-5" name="__codelineno-26-5"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">currentTarget</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-26-6" name="__codelineno-26-6"></a><span class="w">    </span><span class="k">return</span><span class="p">;</span>
<a id="__codelineno-26-7" name="__codelineno-26-7"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-26-8" name="__codelineno-26-8"></a><span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`You clicked on </span><span class="si">${</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">id</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<a id="__codelineno-26-9" name="__codelineno-26-9"></a><span class="p">}</span>
<a id="__codelineno-26-10" name="__codelineno-26-10"></a><span class="c1">// NEW: Getting the common parent</span>
<a id="__codelineno-26-11" name="__codelineno-26-11"></a><span class="kd">const</span><span class="w"> </span><span class="nx">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;ul&quot;</span><span class="p">);</span>
<a id="__codelineno-26-12" name="__codelineno-26-12"></a><span class="c1">// NEW setting the eventListener to be capture based</span>
<a id="__codelineno-26-13" name="__codelineno-26-13"></a><span class="nx">parent</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;click&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">handleClick</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="nx">capture</span><span class="o">:</span><span class="kc">true</span><span class="p">});</span>
</code></pre></div></td></tr></table></div>
<p>With this change, we're now only wiring up a single listener instead of having multiple wirings.</p>
<h4 id="wrapping-up"><a class="toclink" href="../../../../2024/03/19/today-i-learned--the-difference-between-bubble-and-capture-for-events/#wrapping-up">Wrapping Up</a></h4>
<p>In this post, we looked at two different event propagation models, <em>bubble</em> and <em>capture</em>, the differences between the two and when you might want to use <em>capture</em>.</p>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/cameronpresley.png" alt="Cameron Presley">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2015-10-28 00:00:00+00:00">Oct 28, 2015</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../../" class="md-meta__link">Today I Learned</a></li>
        
        
          
          <li class="md-meta__item">
            
              4 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="til-how-to-check-if-a-substitute-was-called-zero-times"><a class="toclink" href="../../../../2015/10/28/til--how-to-check-if-a-substitute-was-called-zero-times/">TIL  How To Check If a Substitute Was Called Zero Times</a></h2>
<h3 id="setup"><a class="toclink" href="../../../../2015/10/28/til--how-to-check-if-a-substitute-was-called-zero-times/#setup">Setup</a></h3>
<p>During this past week, Ive been working on a new feature and during development, I ended up with code that looked like this:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-12-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-12-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-12-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-12-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-12-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-12-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-12-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-12-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-12-10">10</a></span>
<span class="normal"><a href="#__codelineno-12-11">11</a></span>
<span class="normal"><a href="#__codelineno-12-12">12</a></span>
<span class="normal"><a href="#__codelineno-12-13">13</a></span>
<span class="normal"><a href="#__codelineno-12-14">14</a></span>
<span class="normal"><a href="#__codelineno-12-15">15</a></span>
<span class="normal"><a href="#__codelineno-12-16">16</a></span>
<span class="normal"><a href="#__codelineno-12-17">17</a></span>
<span class="normal"><a href="#__codelineno-12-18">18</a></span>
<span class="normal"><a href="#__codelineno-12-19">19</a></span>
<span class="normal"><a href="#__codelineno-12-20">20</a></span>
<span class="normal"><a href="#__codelineno-12-21">21</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">PermissionChecker</span>
<a id="__codelineno-12-2" name="__codelineno-12-2"></a><span class="p">{</span>
<a id="__codelineno-12-3" name="__codelineno-12-3"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="nf">PermissionChecker</span><span class="p">(</span><span class="n">IModuleDisabler</span><span class="w"> </span><span class="n">moduleDisabler</span><span class="p">,</span><span class="w"> </span><span class="n">User</span><span class="w"> </span><span class="n">user</span><span class="p">)</span>
<a id="__codelineno-12-4" name="__codelineno-12-4"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-12-5" name="__codelineno-12-5"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">user</span><span class="p">.</span><span class="n">IsAdmin</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="p">;</span>
<a id="__codelineno-12-6" name="__codelineno-12-6"></a><span class="w">      </span><span class="k">else</span><span class="w"> </span><span class="nf">if</span><span class="w"> </span><span class="p">(</span><span class="n">user</span><span class="p">.</span><span class="n">HasFullRights</span><span class="p">)</span><span class="w"> </span><span class="n">ConfigureFullRights</span><span class="p">(</span><span class="n">moduleDisabler</span><span class="p">);</span>
<a id="__codelineno-12-7" name="__codelineno-12-7"></a><span class="w">      </span><span class="k">else</span><span class="w"> </span><span class="nf">if</span><span class="w"> </span><span class="p">(</span><span class="n">user</span><span class="p">.</span><span class="n">HasPartialRights</span><span class="p">)</span><span class="w"> </span><span class="n">ConfigurePartialRights</span><span class="p">(</span><span class="n">moduleDisabler</span><span class="p">);</span>
<a id="__codelineno-12-8" name="__codelineno-12-8"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-12-9" name="__codelineno-12-9"></a>
<a id="__codelineno-12-10" name="__codelineno-12-10"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">ConfigureFullRights</span><span class="p">(</span><span class="n">IModuleDisabler</span><span class="w"> </span><span class="n">disabler</span><span class="p">)</span>
<a id="__codelineno-12-11" name="__codelineno-12-11"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-12-12" name="__codelineno-12-12"></a><span class="w">      </span><span class="n">disabler</span><span class="p">.</span><span class="n">DisableSystemAdminModule</span><span class="p">();</span>
<a id="__codelineno-12-13" name="__codelineno-12-13"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-12-14" name="__codelineno-12-14"></a>
<a id="__codelineno-12-15" name="__codelineno-12-15"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">ConfigurePartialRights</span><span class="p">(</span><span class="n">IModuleDisabler</span><span class="w"> </span><span class="n">disabler</span><span class="p">)</span>
<a id="__codelineno-12-16" name="__codelineno-12-16"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-12-17" name="__codelineno-12-17"></a><span class="w">      </span><span class="n">disabler</span><span class="p">.</span><span class="n">DisableSystemAdminModule</span><span class="p">();</span>
<a id="__codelineno-12-18" name="__codelineno-12-18"></a><span class="w">      </span><span class="n">disabler</span><span class="p">.</span><span class="n">DisableReportModule</span><span class="p">();</span>
<a id="__codelineno-12-19" name="__codelineno-12-19"></a><span class="w">      </span><span class="n">disabler</span><span class="p">.</span><span class="n">DisableUserManagementModule</span><span class="p">();</span>
<a id="__codelineno-12-20" name="__codelineno-12-20"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-12-21" name="__codelineno-12-21"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>So the code is pretty straight forward, I have a <strong>PermissionChecker</strong> whose job is to use the <strong>IModuleDisabler</strong> to turn off certain modules depending upon the user permissions. Pretty straightforward implementation.</p>
<p>Now that the solution is fleshed out, its time to write some tests around this. When it comes to testing classes that have dependencies on non-trivial classes, I use <a href="https://nsubstitute.github.io/">NSubstitute</a>, a mocking tool, to create mock versions of those dependencies. In this case, NSubstitute allows me to test how the <strong>IModuleDisabler</strong> is being used by the <strong>PermissionsChecker</strong>.</p>
<p>For example, lets say that I wanted to test how the <strong>PermissionChecker</strong> interacts with the <strong>IModuleDisabler</strong> when the user has a partial access, Id write a test that looks like the following:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-13-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-13-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-13-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-13-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-13-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-13-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-13-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-13-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-13-10">10</a></span>
<span class="normal"><a href="#__codelineno-13-11">11</a></span>
<span class="normal"><a href="#__codelineno-13-12">12</a></span>
<span class="normal"><a href="#__codelineno-13-13">13</a></span>
<span class="normal"><a href="#__codelineno-13-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="na">[Test]</span>
<a id="__codelineno-13-2" name="__codelineno-13-2"></a><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">And_the_user_has_partial_access_then_the_disabler_disables_the_report_module</span><span class="p">()</span>
<a id="__codelineno-13-3" name="__codelineno-13-3"></a><span class="p">{</span>
<a id="__codelineno-13-4" name="__codelineno-13-4"></a><span class="w">     </span><span class="c1">// Arrange</span>
<a id="__codelineno-13-5" name="__codelineno-13-5"></a><span class="w">     </span><span class="kt">var</span><span class="w"> </span><span class="n">permissionChecker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PermissionChecker</span><span class="p">();</span>
<a id="__codelineno-13-6" name="__codelineno-13-6"></a><span class="w">     </span><span class="kt">var</span><span class="w"> </span><span class="n">mockDisabler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Substitute</span><span class="p">.</span><span class="n">For</span><span class="p">();</span>
<a id="__codelineno-13-7" name="__codelineno-13-7"></a><span class="w">     </span><span class="kt">var</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">User</span><span class="w"> </span><span class="p">{</span><span class="n">HasPartialAccess</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="p">};</span>
<a id="__codelineno-13-8" name="__codelineno-13-8"></a>
<a id="__codelineno-13-9" name="__codelineno-13-9"></a><span class="w">     </span><span class="c1">// Act</span>
<a id="__codelineno-13-10" name="__codelineno-13-10"></a><span class="w">     </span><span class="n">permissionChecker</span><span class="p">.</span><span class="n">CheckPermissions</span><span class="p">(</span><span class="n">mockDisabler</span><span class="p">,</span><span class="w"> </span><span class="n">user</span><span class="p">);</span>
<a id="__codelineno-13-11" name="__codelineno-13-11"></a>
<a id="__codelineno-13-12" name="__codelineno-13-12"></a><span class="w">     </span><span class="c1">// Assert</span>
<a id="__codelineno-13-13" name="__codelineno-13-13"></a><span class="w">     </span><span class="n">mockDisabler</span><span class="p">.</span><span class="n">Received</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">DisableReportModule</span><span class="p">();</span>
<a id="__codelineno-13-14" name="__codelineno-13-14"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>In the above test, our assertion step is to check if the <strong>mockDisabler</strong> received a single call to the <strong>DisableReportModule</strong>. If it didnt receive a call, then the test fails. We can write similar tests for the different modules that should be disabled for the partial rights permission and follow a similar pattern for the full rights permission.</p>
<p>However, things get a bit more interesting when were testing what happens if the user is an admin. If we follow the same pattern, wed end up with a test that looks like this:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-14-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-14-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-14-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-14-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-14-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-14-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-14-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-14-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-14-10">10</a></span>
<span class="normal"><a href="#__codelineno-14-11">11</a></span>
<span class="normal"><a href="#__codelineno-14-12">12</a></span>
<span class="normal"><a href="#__codelineno-14-13">13</a></span>
<span class="normal"><a href="#__codelineno-14-14">14</a></span>
<span class="normal"><a href="#__codelineno-14-15">15</a></span>
<span class="normal"><a href="#__codelineno-14-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="na">[Test]</span>
<a id="__codelineno-14-2" name="__codelineno-14-2"></a><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">And_the_user_has_admin_permissions_then_the_disabler_is_not_used</span><span class="p">()</span>
<a id="__codelineno-14-3" name="__codelineno-14-3"></a><span class="p">{</span>
<a id="__codelineno-14-4" name="__codelineno-14-4"></a><span class="w">     </span><span class="c1">// Arrange</span>
<a id="__codelineno-14-5" name="__codelineno-14-5"></a><span class="w">     </span><span class="kt">var</span><span class="w"> </span><span class="n">permissionChecker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PermissionChecker</span><span class="p">();</span>
<a id="__codelineno-14-6" name="__codelineno-14-6"></a><span class="w">     </span><span class="kt">var</span><span class="w"> </span><span class="n">mockDisabler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Substitute</span><span class="p">.</span><span class="n">For</span><span class="p">();</span>
<a id="__codelineno-14-7" name="__codelineno-14-7"></a><span class="w">     </span><span class="kt">var</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">User</span><span class="w"> </span><span class="p">{</span><span class="n">IsAdmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="p">};</span>
<a id="__codelineno-14-8" name="__codelineno-14-8"></a>
<a id="__codelineno-14-9" name="__codelineno-14-9"></a><span class="w">     </span><span class="c1">// Act</span>
<a id="__codelineno-14-10" name="__codelineno-14-10"></a><span class="w">     </span><span class="n">permissionChecker</span><span class="p">.</span><span class="n">CheckPermissions</span><span class="p">(</span><span class="n">mockDisabler</span><span class="p">,</span><span class="w"> </span><span class="n">user</span><span class="p">);</span>
<a id="__codelineno-14-11" name="__codelineno-14-11"></a>
<a id="__codelineno-14-12" name="__codelineno-14-12"></a><span class="w">     </span><span class="c1">// Assert</span>
<a id="__codelineno-14-13" name="__codelineno-14-13"></a><span class="w">     </span><span class="n">mockDisabler</span><span class="p">.</span><span class="n">DidNotReceive</span><span class="p">().</span><span class="n">DisableSystemAdminModule</span><span class="p">();</span>
<a id="__codelineno-14-14" name="__codelineno-14-14"></a><span class="w">     </span><span class="n">mockDisabler</span><span class="p">.</span><span class="n">DidNotReceive</span><span class="p">().</span><span class="n">DisableReportModule</span><span class="p">();</span>
<a id="__codelineno-14-15" name="__codelineno-14-15"></a><span class="w">     </span><span class="n">mockDisabler</span><span class="p">.</span><span class="n">DidNotReceive</span><span class="p">().</span><span class="n">DisableUserManagementModule</span><span class="p">();</span>
<a id="__codelineno-14-16" name="__codelineno-14-16"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>This solution works for now, however, there is a major maintainability issue, can you spot it?</p>
<h3 id="problem"><a class="toclink" href="../../../../2015/10/28/til--how-to-check-if-a-substitute-was-called-zero-times/#problem">Problem</a></h3>
<p>The issue arises when we add a new module to be disabled which forces the <strong>IModuleDisabler</strong> to implement a new method. In that case, you need to remember to update this test to also check that the new method wasnt being called. If you forget, this test would still pass, but itd pass for the wrong reason.</p>
<p>To help illustrate, lets say that another method, <strong>DisableImportModule</strong>, has been added to the <strong>IModuleDisabler</strong> interface. In addition, we also need to make sure that this is called when users have partial access, but should not be called for users who are admins or users who have full access.</p>
<p>To fulfill those requirements, we modify the <strong>PermissionChecker</strong> as so:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-15-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-15-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-15-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-15-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-15-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-15-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-15-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-15-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-15-10">10</a></span>
<span class="normal"><a href="#__codelineno-15-11">11</a></span>
<span class="normal"><a href="#__codelineno-15-12">12</a></span>
<span class="normal"><a href="#__codelineno-15-13">13</a></span>
<span class="normal"><a href="#__codelineno-15-14">14</a></span>
<span class="normal"><a href="#__codelineno-15-15">15</a></span>
<span class="normal"><a href="#__codelineno-15-16">16</a></span>
<span class="normal"><a href="#__codelineno-15-17">17</a></span>
<span class="normal"><a href="#__codelineno-15-18">18</a></span>
<span class="normal"><a href="#__codelineno-15-19">19</a></span>
<span class="normal"><a href="#__codelineno-15-20">20</a></span>
<span class="normal"><a href="#__codelineno-15-21">21</a></span>
<span class="normal"><a href="#__codelineno-15-22">22</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">PermissionChecker</span>
<a id="__codelineno-15-2" name="__codelineno-15-2"></a><span class="p">{</span>
<a id="__codelineno-15-3" name="__codelineno-15-3"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="nf">PermissionChecker</span><span class="p">(</span><span class="n">IModuleDisabler</span><span class="w"> </span><span class="n">moduleDisabler</span><span class="p">,</span><span class="w"> </span><span class="n">User</span><span class="w"> </span><span class="n">user</span><span class="p">)</span>
<a id="__codelineno-15-4" name="__codelineno-15-4"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-15-5" name="__codelineno-15-5"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">user</span><span class="p">.</span><span class="n">IsAdmin</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="p">;</span>
<a id="__codelineno-15-6" name="__codelineno-15-6"></a><span class="w">      </span><span class="k">else</span><span class="w"> </span><span class="nf">if</span><span class="w"> </span><span class="p">(</span><span class="n">user</span><span class="p">.</span><span class="n">HasFullRights</span><span class="p">)</span><span class="w"> </span><span class="n">ConfigureFullRights</span><span class="p">(</span><span class="n">moduleDisabler</span><span class="p">);</span>
<a id="__codelineno-15-7" name="__codelineno-15-7"></a><span class="w">      </span><span class="k">else</span><span class="w"> </span><span class="nf">if</span><span class="w"> </span><span class="p">(</span><span class="n">user</span><span class="p">.</span><span class="n">HasPartialRights</span><span class="p">)</span><span class="w"> </span><span class="n">ConfigurePartialRights</span><span class="p">(</span><span class="n">moduleDisabler</span><span class="p">);</span>
<a id="__codelineno-15-8" name="__codelineno-15-8"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-15-9" name="__codelineno-15-9"></a>
<a id="__codelineno-15-10" name="__codelineno-15-10"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">ConfigureFullRights</span><span class="p">(</span><span class="n">IModuleDisabler</span><span class="w"> </span><span class="n">disabler</span><span class="p">)</span>
<a id="__codelineno-15-11" name="__codelineno-15-11"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-15-12" name="__codelineno-15-12"></a><span class="w">      </span><span class="n">disabler</span><span class="p">.</span><span class="n">DisableSystemAdminModule</span><span class="p">();</span>
<a id="__codelineno-15-13" name="__codelineno-15-13"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-15-14" name="__codelineno-15-14"></a>
<a id="__codelineno-15-15" name="__codelineno-15-15"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">ConfigurePartialRights</span><span class="p">(</span><span class="n">IModuleDisabler</span><span class="w"> </span><span class="n">disabler</span><span class="p">)</span>
<a id="__codelineno-15-16" name="__codelineno-15-16"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-15-17" name="__codelineno-15-17"></a><span class="w">      </span><span class="n">disabler</span><span class="p">.</span><span class="n">DisableSystemAdminModule</span><span class="p">();</span>
<a id="__codelineno-15-18" name="__codelineno-15-18"></a><span class="w">      </span><span class="n">disabler</span><span class="p">.</span><span class="n">DisableReportModule</span><span class="p">();</span>
<a id="__codelineno-15-19" name="__codelineno-15-19"></a><span class="w">      </span><span class="n">disabler</span><span class="p">.</span><span class="n">DisableUserManagementModule</span><span class="p">();</span>
<a id="__codelineno-15-20" name="__codelineno-15-20"></a><span class="w">      </span><span class="n">disabler</span><span class="p">.</span><span class="n">DisableImportModule</span><span class="p">();</span>
<a id="__codelineno-15-21" name="__codelineno-15-21"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-15-22" name="__codelineno-15-22"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>At this point, wed write another test for when the a user has partial access, the import module should be disabled. However, its very unlikely that wed remember to update the test for the admin. Remember, for the admin, were checking that it received no calls to any disable methods and the way were doing that is by checking each method individually.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-16-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-16-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-16-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-16-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-16-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-16-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-16-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-16-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-16-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-16-10">10</a></span>
<span class="normal"><a href="#__codelineno-16-11">11</a></span>
<span class="normal"><a href="#__codelineno-16-12">12</a></span>
<span class="normal"><a href="#__codelineno-16-13">13</a></span>
<span class="normal"><a href="#__codelineno-16-14">14</a></span>
<span class="normal"><a href="#__codelineno-16-15">15</a></span>
<span class="normal"><a href="#__codelineno-16-16">16</a></span>
<span class="normal"><a href="#__codelineno-16-17">17</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1"></a><span class="na">[Test]</span>
<a id="__codelineno-16-2" name="__codelineno-16-2"></a><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">And_the_user_has_admin_permissions_then_the_disabler_is_not_used</span><span class="p">()</span>
<a id="__codelineno-16-3" name="__codelineno-16-3"></a><span class="p">{</span>
<a id="__codelineno-16-4" name="__codelineno-16-4"></a><span class="w">  </span><span class="c1">// Arrange</span>
<a id="__codelineno-16-5" name="__codelineno-16-5"></a><span class="w">  </span><span class="kt">var</span><span class="w"> </span><span class="n">permissionChecker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PermissionChecker</span><span class="p">();</span>
<a id="__codelineno-16-6" name="__codelineno-16-6"></a><span class="w">  </span><span class="kt">var</span><span class="w"> </span><span class="n">mockDisabler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Substitute</span><span class="p">.</span><span class="n">For</span><span class="p">();</span>
<a id="__codelineno-16-7" name="__codelineno-16-7"></a><span class="w">  </span><span class="kt">var</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">User</span><span class="w"> </span><span class="p">{</span><span class="n">IsAdmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="p">};</span>
<a id="__codelineno-16-8" name="__codelineno-16-8"></a>
<a id="__codelineno-16-9" name="__codelineno-16-9"></a><span class="w">  </span><span class="c1">// Act</span>
<a id="__codelineno-16-10" name="__codelineno-16-10"></a><span class="w">  </span><span class="n">permissionChecker</span><span class="p">.</span><span class="n">CheckPermissions</span><span class="p">(</span><span class="n">mockDisabler</span><span class="p">,</span><span class="w"> </span><span class="n">user</span><span class="p">);</span>
<a id="__codelineno-16-11" name="__codelineno-16-11"></a>
<a id="__codelineno-16-12" name="__codelineno-16-12"></a><span class="w">  </span><span class="c1">// Assert</span>
<a id="__codelineno-16-13" name="__codelineno-16-13"></a><span class="w">  </span><span class="n">mockDisabler</span><span class="p">.</span><span class="n">DidNotReceive</span><span class="p">().</span><span class="n">DisableSystemAdminModule</span><span class="p">();</span>
<a id="__codelineno-16-14" name="__codelineno-16-14"></a><span class="w">  </span><span class="n">mockDisabler</span><span class="p">.</span><span class="n">DidNotReceive</span><span class="p">().</span><span class="n">DisableReportModule</span><span class="p">();</span>
<a id="__codelineno-16-15" name="__codelineno-16-15"></a><span class="w">  </span><span class="n">mockDisabler</span><span class="p">.</span><span class="n">DidNotReceive</span><span class="p">().</span><span class="n">DisableUserManagementModule</span><span class="p">();</span>
<a id="__codelineno-16-16" name="__codelineno-16-16"></a><span class="w">  </span><span class="c1">// Need to add check for DidNotReceive().DisableImportModule();</span>
<a id="__codelineno-16-17" name="__codelineno-16-17"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h3 id="solution"><a class="toclink" href="../../../../2015/10/28/til--how-to-check-if-a-substitute-was-called-zero-times/#solution">Solution</a></h3>
<p>Theres got to be a better way. After some digging around, I found that any NSubstitute mock, has a <strong>ReceivedCalls</strong> method that returns all calls that the mock received. With this new knowledge, we can refactor the previous test with the following:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-17-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-17-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-17-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-17-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-17-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-17-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-17-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-17-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-17-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-17-10">10</a></span>
<span class="normal"><a href="#__codelineno-17-11">11</a></span>
<span class="normal"><a href="#__codelineno-17-12">12</a></span>
<span class="normal"><a href="#__codelineno-17-13">13</a></span>
<span class="normal"><a href="#__codelineno-17-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1"></a><span class="na">[Test]</span>
<a id="__codelineno-17-2" name="__codelineno-17-2"></a><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">And_the_user_has_admin_permissions_then_the_disabler_is_not_used</span><span class="p">()</span>
<a id="__codelineno-17-3" name="__codelineno-17-3"></a><span class="p">{</span>
<a id="__codelineno-17-4" name="__codelineno-17-4"></a><span class="w">  </span><span class="c1">// Arrange</span>
<a id="__codelineno-17-5" name="__codelineno-17-5"></a><span class="w">  </span><span class="kt">var</span><span class="w"> </span><span class="n">permissionChecker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PermissionChecker</span><span class="p">();</span>
<a id="__codelineno-17-6" name="__codelineno-17-6"></a><span class="w">  </span><span class="kt">var</span><span class="w"> </span><span class="n">mockDisabler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Substitute</span><span class="p">.</span><span class="n">For</span><span class="p">();</span>
<a id="__codelineno-17-7" name="__codelineno-17-7"></a><span class="w">  </span><span class="kt">var</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">User</span><span class="w"> </span><span class="p">{</span><span class="n">IsAdmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="p">};</span>
<a id="__codelineno-17-8" name="__codelineno-17-8"></a>
<a id="__codelineno-17-9" name="__codelineno-17-9"></a><span class="w">  </span><span class="c1">// Act</span>
<a id="__codelineno-17-10" name="__codelineno-17-10"></a><span class="w">  </span><span class="n">permissionChecker</span><span class="p">.</span><span class="n">CheckPermissions</span><span class="p">(</span><span class="n">mockDisabler</span><span class="p">,</span><span class="w"> </span><span class="n">user</span><span class="p">);</span>
<a id="__codelineno-17-11" name="__codelineno-17-11"></a>
<a id="__codelineno-17-12" name="__codelineno-17-12"></a><span class="w">  </span><span class="c1">// Assert</span>
<a id="__codelineno-17-13" name="__codelineno-17-13"></a><span class="w">  </span><span class="n">CollectionAssert</span><span class="p">.</span><span class="n">IsEmpty</span><span class="p">(</span><span class="n">mockDisabler</span><span class="p">.</span><span class="n">ReceivedCalls</span><span class="p">());</span>
<a id="__codelineno-17-14" name="__codelineno-17-14"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>This solution is much better because if we add more modules, this test is still checking to make sure that admin users do not have any modules disabled.</p>
<h3 id="summary"><a class="toclink" href="../../../../2015/10/28/til--how-to-check-if-a-substitute-was-called-zero-times/#summary">Summary</a></h3>
<p>When using a NSubstitute mock and you need to make sure that it received no calls to any methods or properties, you can using NSubstitutes <strong>ReceivedCalls</strong> in conjunction with <strong>CollectionAssert.IsEmpty</strong> to ensure that the substitute was not called.</p>
    
    
  </div>
</article>
      
      
        
          



<nav class="md-pagination">
  <a class="md-pagination__link" href="../../">1</a> <span class="md-pagination__current">2</span> <a class="md-pagination__link" href="../3/">3</a>
</nav>
        
      
    </div>
  </div>

          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../../../solid/" class="md-footer__link md-footer__link--prev" aria-label="Previous: SOLID">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                SOLID
              </div>
            </div>
          </a>
        
        
          
          <a href="../../../tooling/" class="md-footer__link md-footer__link--next" aria-label="Next: Tooling">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Tooling
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs Insiders
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.footer", "content.code.copy"], "search": "../../../../../assets/javascripts/workers/search.ad38c271.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.b66b2b78.min.js"></script>
      
    
  </body>
</html>