
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Cameron Presley">
      
      
      
        <link rel="prev" href="../../">
      
      
        <link rel="next" href="../aws/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16+insiders-4.53.16">
    
    
      
        <title>.NET - The Software Mentor</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.1caf78d2.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/page.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-ZE0MGVG7RJ"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-ZE0MGVG7RJ",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-ZE0MGVG7RJ",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#net" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="The Software Mentor" class="md-header__button md-logo" aria-label="The Software Mentor" data-md-component="logo">
      
  <img src="../../../assets/images/favicon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            The Software Mentor
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              .NET
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="deep-purple"  aria-hidden="true"  type="radio" name="__palette" id="__palette_1">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  About Me

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  
  Articles

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../courses/" class="md-tabs__link">
        
  
  
    
  
  Training Course

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../level-up/" class="md-tabs__link">
        
  
  
    
  
  Level Up Resources

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../presentations/" class="md-tabs__link">
        
  
  
    
  
  Presentations

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../speaking-schedule/" class="md-tabs__link">
        
  
  
    
  
  Speaking Schedule

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../story/" class="md-tabs__link">
        
  
  
    
  
  Story

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../resume/" class="md-tabs__link">
        
  
  
    
  
  Resume

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="The Software Mentor" class="md-nav__button md-logo" aria-label="The Software Mentor" data-md-component="logo">
      
  <img src="../../../assets/images/favicon.png" alt="logo">

    </a>
    The Software Mentor
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    About Me
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Articles
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Articles
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Index
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Archive
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Archive
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2025/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2025
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2024/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2024
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2023/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2023
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2020/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2020
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2018/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2018
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2015/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2015
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2014/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2014
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2013/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2013
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" checked>
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Categories
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Categories
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
    
      
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    .NET
  

    
  </span>
  
  

      </a>
      
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../aws/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AWS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../basics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Basics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../c/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    C#
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../career/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Career
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../coaching-corner/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Coaching Corner
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../debugging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Debugging
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../functional-programming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Functional Programming
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../interviewing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Interviewing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../leadership/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Leadership
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../learning-through-example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Learning Through Example
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Process
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../solid/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SOLID
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../today-i-learned/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Today I Learned
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../tooling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tooling
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../typescript/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    TypeScript
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../courses/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Training Course
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../level-up/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Level Up Resources
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../presentations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Presentations
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../speaking-schedule/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Speaking Schedule
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../story/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Story
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../resume/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Resume
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
  <div class="md-content" data-md-component="content">
    <div class="md-content__inner">
      <header class="md-typeset">
        <h1 id="net">.NET</h1>
      </header>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/cameronpresley.png" alt="Cameron Presley">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2025-12-01 00:00:00+00:00">Dec 1, 2025</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="./" class="md-meta__link">.NET</a>, 
              <a href="../functional-programming/" class="md-meta__link">Functional Programming</a></li>
        
        
          
          <li class="md-meta__item">
            
              8 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="reducing-bugs-by-using-the-model-view-update-pattern"><a class="toclink" href="../../2025/12/01/reducing-bugs-by-using-the-model-view-update-pattern/">Reducing Bugs by Using the Model View Update Pattern</a></h2>
<p><em>Note: This article is part of the <a href="https://csadvent.christmas/">2025 C# Advent Calendar</a>, so after you're done reading this, keep an eye out for the other cool articles coming out this month!</em></p>
<p>For those who've followed me for a bit, you know that I'm a big believer that functional programming is a great way of approaching problems.</p>
<p>One thing I've mentioned in my <a href="../../../presentations/#learning-functional-programming-through-construction-first-principles">recent presentations</a> is that we can take introductory concepts (pure functions, immutability, composition) and build <em>real world software</em> with them.</p>
<p>In this post, I'm going to show you a pattern that I've recently ported to C#, the <a href="https://guide.elm-lang.org/architecture/">Model View Update, also known as The Elm Architecture</a>.</p>
<h3 id="inspiration-of-the-pattern"><a class="toclink" href="../../2025/12/01/reducing-bugs-by-using-the-model-view-update-pattern/#inspiration-of-the-pattern">Inspiration of the Pattern</a></h3>
<p>Back in 2017, I came across a new functional language called <a href="https://elm-lang.org/">Elm</a> that took a different approach for web development. At a high level, Elm argues that you can think of an application as four pieces.</p>
<ol>
<li>The <em>Model</em> - What data are we presenting to the user?</li>
<li>The <em>View</em> - How should we format the model?</li>
</ol>
<p>At this point, this seems very similar to other MV* patterns (<a href="https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller">Model View Controller</a>, <a href="https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93presenter">Model View Presenter</a>, or <a href="https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93viewmodel">Model View ViewModel</a>). </p>
<p>The next two parts is what sets this pattern apart from the others.</p>
<ol>
<li>The <em>Command</em> - What things can the user do on the screen (button clicks, entering text, etc...)</li>
<li>The <em>Update</em> function - Given a <em>Model</em> and a <em>Command</em>, what does the new model look like?</li>
</ol>
<p>To me, this is an interesting concept because when the user makes changes, the model is being directly manipulated (generally through two-way binding) and then you had to make sure that you didn't put your business rules directly in the UI code. (For those who come from WinForms, how many times did you find business code in the code-behind?).</p>
<p>With this approach, however, we've narrowed down what the UI can do (it can render a model and return a command, but can't directly manipulate the model). </p>
<p>If you think that this approach isn't solid, you might be surprised to know that Elm inspired the creation of the following libraries in the JavaScript ecosystem:</p>
<ul>
<li><a href="https://ngrx.io/">ngrx</a> (Angular state management system)</li>
<li><a href="https://redux.js.org/">redux</a> (React state management system)</li>
</ul>
<p>I've recently been using this pattern for console applications and have been pleasantly surprised how well it's working out.</p>
<p>In this post, I'll walk you through how we can use this pattern to build out the "Hello World" equivalent application, manipulating a counter.</p>
<h3 id="implementing-the-pattern"><a class="toclink" href="../../2025/12/01/reducing-bugs-by-using-the-model-view-update-pattern/#implementing-the-pattern">Implementing the Pattern</a></h3>
<h4 id="defining-the-command"><a class="toclink" href="../../2025/12/01/reducing-bugs-by-using-the-model-view-update-pattern/#defining-the-command">Defining the Command</a></h4>
<p>Before we can model the <code>Command</code>, we need to think about what commands we want to support. In our example, let's say that we want the user to be able to do the following:</p>
<ul>
<li>Increment the counter by 2</li>
<li>Decrement the counter by 1</li>
<li>Reset the counter to 0</li>
<li>Quit the application</li>
</ul>
<p>In the Elm version (and it's equivalent TypeScript definition), a <code>Command</code> looks something like this:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-22-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1"></a><span class="kr">type</span><span class="w"> </span><span class="nx">Command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="nx">tag</span><span class="o">:</span><span class="s1">&#39;increment&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="o">:</span><span class="kt">2</span><span class="p">}</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="nx">tag</span><span class="o">:</span><span class="s1">&#39;decrement&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="o">:</span><span class="kt">1</span><span class="p">}</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="nx">tag</span><span class="o">:</span><span class="s1">&#39;reset&#39;</span><span class="p">}</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="nx">tag</span><span class="o">:</span><span class="s1">&#39;quit&#39;</span><span class="p">};</span>
</code></pre></div></td></tr></table></div>
<p>This takes advantage of algebraic data type  known as a <a href="../../2023/04/30/better-domain-modeling-with-discriminated-unions/">sum type</a>, where the <code>Command</code> type has one of three different constructors (one called <code>increment</code>, another called <code>decrement</code>, one called <code>reset</code>, and finally, <code>quit</code>). </p>
<p>Even though C# doesn't have sum types (at least <a href="https://github.com/dotnet/csharplang/issues/9662">not yet</a>), we can mimic this behavior using an abstract class.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-23-1">1</a></span>
<span class="normal"><a href="#__codelineno-23-2">2</a></span>
<span class="normal"><a href="#__codelineno-23-3">3</a></span>
<span class="normal"><a href="#__codelineno-23-4">4</a></span>
<span class="normal"><a href="#__codelineno-23-5">5</a></span>
<span class="normal"><a href="#__codelineno-23-6">6</a></span>
<span class="normal"><a href="#__codelineno-23-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1"></a><span class="c1">// Abstract command that uses a string to</span>
<a id="__codelineno-23-2" name="__codelineno-23-2"></a><span class="c1">// denote which command it is</span>
<a id="__codelineno-23-3" name="__codelineno-23-3"></a><span class="c1">// (useful for casting later)</span>
<a id="__codelineno-23-4" name="__codelineno-23-4"></a><span class="k">public</span><span class="w"> </span><span class="k">abstract</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">Command</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">T</span><span class="p">:</span><span class="n">Enum</span>
<a id="__codelineno-23-5" name="__codelineno-23-5"></a><span class="p">{</span>
<a id="__codelineno-23-6" name="__codelineno-23-6"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">abstract</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="n">Tag</span><span class="w"> </span><span class="p">{</span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-23-7" name="__codelineno-23-7"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h4 id="defining-commands-for-counter"><a class="toclink" href="../../2025/12/01/reducing-bugs-by-using-the-model-view-update-pattern/#defining-commands-for-counter">Defining Commands for Counter</a></h4>
<p>With the <code>Command</code> class defined, let's start implementing the various commands our program can have.</p>
<p>First, we'll define an <code>enum</code> to keep track of the types of <code>Commands</code>. We could omit this and just use strings, but the value of the <code>enum</code> is that we can have C# generate the cases (though we still have to have a default case given the nature of enums).</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-24-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-24-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-24-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-24-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-24-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-24-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-24-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-24-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-24-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-24-10">10</a></span>
<span class="normal"><a href="#__codelineno-24-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1"></a><span class="c1">// Enum to help with exhaustive matching later</span>
<a id="__codelineno-24-2" name="__codelineno-24-2"></a><span class="c1">// on</span>
<a id="__codelineno-24-3" name="__codelineno-24-3"></a>
<a id="__codelineno-24-4" name="__codelineno-24-4"></a><span class="k">public</span><span class="w"> </span><span class="k">enum</span><span class="w"> </span><span class="n">CommandType</span>
<a id="__codelineno-24-5" name="__codelineno-24-5"></a><span class="p">{</span>
<a id="__codelineno-24-6" name="__codelineno-24-6"></a><span class="w">  </span><span class="n">Increment</span><span class="p">,</span>
<a id="__codelineno-24-7" name="__codelineno-24-7"></a><span class="w">  </span><span class="n">Decrement</span><span class="p">,</span>
<a id="__codelineno-24-8" name="__codelineno-24-8"></a><span class="w">  </span><span class="n">Reset</span><span class="p">,</span>
<a id="__codelineno-24-9" name="__codelineno-24-9"></a><span class="w">  </span><span class="n">Quit</span><span class="p">,</span>
<a id="__codelineno-24-10" name="__codelineno-24-10"></a><span class="w">  </span><span class="n">Unknown</span>
<a id="__codelineno-24-11" name="__codelineno-24-11"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>With the enum defined, we can start define the commands, some of which will have more information included (see the <em>IncrementCommand</em> and <em>DecrementCommand</em>).</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-25-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-25-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-25-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-25-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-25-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-25-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-25-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-25-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-25-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-25-10">10</a></span>
<span class="normal"><a href="#__codelineno-25-11">11</a></span>
<span class="normal"><a href="#__codelineno-25-12">12</a></span>
<span class="normal"><a href="#__codelineno-25-13">13</a></span>
<span class="normal"><a href="#__codelineno-25-14">14</a></span>
<span class="normal"><a href="#__codelineno-25-15">15</a></span>
<span class="normal"><a href="#__codelineno-25-16">16</a></span>
<span class="normal"><a href="#__codelineno-25-17">17</a></span>
<span class="normal"><a href="#__codelineno-25-18">18</a></span>
<span class="normal"><a href="#__codelineno-25-19">19</a></span>
<span class="normal"><a href="#__codelineno-25-20">20</a></span>
<span class="normal"><a href="#__codelineno-25-21">21</a></span>
<span class="normal"><a href="#__codelineno-25-22">22</a></span>
<span class="normal"><a href="#__codelineno-25-23">23</a></span>
<span class="normal"><a href="#__codelineno-25-24">24</a></span>
<span class="normal"><a href="#__codelineno-25-25">25</a></span>
<span class="normal"><a href="#__codelineno-25-26">26</a></span>
<span class="normal"><a href="#__codelineno-25-27">27</a></span>
<span class="normal"><a href="#__codelineno-25-28">28</a></span>
<span class="normal"><a href="#__codelineno-25-29">29</a></span>
<span class="normal"><a href="#__codelineno-25-30">30</a></span>
<span class="normal"><a href="#__codelineno-25-31">31</a></span>
<span class="normal"><a href="#__codelineno-25-32">32</a></span>
<span class="normal"><a href="#__codelineno-25-33">33</a></span>
<span class="normal"><a href="#__codelineno-25-34">34</a></span>
<span class="normal"><a href="#__codelineno-25-35">35</a></span>
<span class="normal"><a href="#__codelineno-25-36">36</a></span>
<span class="normal"><a href="#__codelineno-25-37">37</a></span>
<span class="normal"><a href="#__codelineno-25-38">38</a></span>
<span class="normal"><a href="#__codelineno-25-39">39</a></span>
<span class="normal"><a href="#__codelineno-25-40">40</a></span>
<span class="normal"><a href="#__codelineno-25-41">41</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1"></a><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">IncrementCommand</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Command</span><span class="o">&lt;</span><span class="n">CommandType</span><span class="o">&gt;</span>
<a id="__codelineno-25-2" name="__codelineno-25-2"></a><span class="p">{</span>
<a id="__codelineno-25-3" name="__codelineno-25-3"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="n">CommandType</span><span class="w"> </span><span class="n">Tag</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">CommandType</span><span class="p">.</span><span class="n">Increment</span><span class="p">;</span>
<a id="__codelineno-25-4" name="__codelineno-25-4"></a>
<a id="__codelineno-25-5" name="__codelineno-25-5"></a><span class="w">  </span><span class="c1">// Since some of the commands will have custom values and others not, </span>
<a id="__codelineno-25-6" name="__codelineno-25-6"></a><span class="w">  </span><span class="c1">// we can inject those values through the constructor</span>
<a id="__codelineno-25-7" name="__codelineno-25-7"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">Value</span><span class="w"> </span><span class="p">{</span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">init</span><span class="p">;}</span>
<a id="__codelineno-25-8" name="__codelineno-25-8"></a>
<a id="__codelineno-25-9" name="__codelineno-25-9"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="nf">IncrementCommand</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="k">value</span><span class="p">)</span>
<a id="__codelineno-25-10" name="__codelineno-25-10"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-25-11" name="__codelineno-25-11"></a><span class="w">    </span><span class="n">Value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">value</span><span class="p">;</span>
<a id="__codelineno-25-12" name="__codelineno-25-12"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-25-13" name="__codelineno-25-13"></a><span class="p">}</span>
<a id="__codelineno-25-14" name="__codelineno-25-14"></a>
<a id="__codelineno-25-15" name="__codelineno-25-15"></a><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">DecrementCommand</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Command</span><span class="o">&lt;</span><span class="n">CommandType</span><span class="o">&gt;</span>
<a id="__codelineno-25-16" name="__codelineno-25-16"></a><span class="p">{</span>
<a id="__codelineno-25-17" name="__codelineno-25-17"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="n">CommandType</span><span class="w"> </span><span class="n">Tag</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">CommandType</span><span class="p">.</span><span class="n">Decrement</span><span class="p">;</span>
<a id="__codelineno-25-18" name="__codelineno-25-18"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">Value</span><span class="w"> </span><span class="p">{</span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">init</span><span class="p">;}</span>
<a id="__codelineno-25-19" name="__codelineno-25-19"></a>
<a id="__codelineno-25-20" name="__codelineno-25-20"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="nf">DecrementCommand</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="k">value</span><span class="p">)</span>
<a id="__codelineno-25-21" name="__codelineno-25-21"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-25-22" name="__codelineno-25-22"></a><span class="w">    </span><span class="n">Value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">value</span><span class="p">;</span>
<a id="__codelineno-25-23" name="__codelineno-25-23"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-25-24" name="__codelineno-25-24"></a><span class="p">}</span>
<a id="__codelineno-25-25" name="__codelineno-25-25"></a>
<a id="__codelineno-25-26" name="__codelineno-25-26"></a><span class="c1">// In other cases, we don&#39;t need</span>
<a id="__codelineno-25-27" name="__codelineno-25-27"></a><span class="c1">// any other info, so we can inherit and implement the Tag property</span>
<a id="__codelineno-25-28" name="__codelineno-25-28"></a><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">ResetCommand</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Command</span><span class="o">&lt;</span><span class="n">CommandType</span><span class="o">&gt;</span>
<a id="__codelineno-25-29" name="__codelineno-25-29"></a><span class="p">{</span>
<a id="__codelineno-25-30" name="__codelineno-25-30"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="n">CommandType</span><span class="w"> </span><span class="n">Tag</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">CommandType</span><span class="p">.</span><span class="n">Reset</span><span class="p">;</span>
<a id="__codelineno-25-31" name="__codelineno-25-31"></a><span class="p">}</span>
<a id="__codelineno-25-32" name="__codelineno-25-32"></a>
<a id="__codelineno-25-33" name="__codelineno-25-33"></a><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">QuitCommand</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Command</span><span class="o">&lt;</span><span class="n">CommandType</span><span class="o">&gt;</span>
<a id="__codelineno-25-34" name="__codelineno-25-34"></a><span class="p">{</span>
<a id="__codelineno-25-35" name="__codelineno-25-35"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="n">CommandType</span><span class="w"> </span><span class="n">Tag</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">CommandType</span><span class="p">.</span><span class="n">Quit</span><span class="p">;</span>
<a id="__codelineno-25-36" name="__codelineno-25-36"></a><span class="p">}</span>
<a id="__codelineno-25-37" name="__codelineno-25-37"></a>
<a id="__codelineno-25-38" name="__codelineno-25-38"></a><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">UnknownCommand</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Command</span><span class="o">&lt;</span><span class="n">CommandType</span><span class="o">&gt;</span>
<a id="__codelineno-25-39" name="__codelineno-25-39"></a><span class="p">{</span>
<a id="__codelineno-25-40" name="__codelineno-25-40"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="n">CommandType</span><span class="w"> </span><span class="n">Tag</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">CommandType</span><span class="p">.</span><span class="n">Unknown</span><span class="p">;</span>
<a id="__codelineno-25-41" name="__codelineno-25-41"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h4 id="implementing-the-update-function"><a class="toclink" href="../../2025/12/01/reducing-bugs-by-using-the-model-view-update-pattern/#implementing-the-update-function">Implementing the Update Function</a></h4>
<p>Now that we have our various commands created, we can start building out the <code>Update</code> function. </p>
<p>From our earlier description, we know that our <code>Update</code> function has to take in our model (a number) and a <code>Command</code> and then has to return a new model (a number).</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-26-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-26-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-26-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-26-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-26-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-26-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-26-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-26-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-26-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-26-10">10</a></span>
<span class="normal"><a href="#__codelineno-26-11">11</a></span>
<span class="normal"><a href="#__codelineno-26-12">12</a></span>
<span class="normal"><a href="#__codelineno-26-13">13</a></span>
<span class="normal"><a href="#__codelineno-26-14">14</a></span>
<span class="normal"><a href="#__codelineno-26-15">15</a></span>
<span class="normal"><a href="#__codelineno-26-16">16</a></span>
<span class="normal"><a href="#__codelineno-26-17">17</a></span>
<span class="normal"><a href="#__codelineno-26-18">18</a></span>
<span class="normal"><a href="#__codelineno-26-19">19</a></span>
<span class="normal"><a href="#__codelineno-26-20">20</a></span>
<span class="normal"><a href="#__codelineno-26-21">21</a></span>
<span class="normal"><a href="#__codelineno-26-22">22</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1"></a><span class="c1">// This example is a static method, but let&#39;s say that the rules were more complicated, </span>
<a id="__codelineno-26-2" name="__codelineno-26-2"></a><span class="c1">// we could inject those into a class and make this method non-static.</span>
<a id="__codelineno-26-3" name="__codelineno-26-3"></a>
<a id="__codelineno-26-4" name="__codelineno-26-4"></a><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">Update</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">number</span><span class="p">,</span><span class="w"> </span><span class="n">Command</span><span class="o">&lt;</span><span class="n">CommandType</span><span class="o">&gt;</span><span class="w"> </span><span class="n">c</span><span class="p">)</span>
<a id="__codelineno-26-5" name="__codelineno-26-5"></a><span class="p">{</span>
<a id="__codelineno-26-6" name="__codelineno-26-6"></a><span class="w">  </span><span class="c1">// I&#39;m leveraging the new switch syntax, </span>
<a id="__codelineno-26-7" name="__codelineno-26-7"></a><span class="w">  </span><span class="c1">// but you can use the original syntax</span>
<a id="__codelineno-26-8" name="__codelineno-26-8"></a><span class="w">  </span><span class="c1">// without issues</span>
<a id="__codelineno-26-9" name="__codelineno-26-9"></a>
<a id="__codelineno-26-10" name="__codelineno-26-10"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">tag</span><span class="w"> </span><span class="k">switch</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-26-11" name="__codelineno-26-11"></a><span class="w">    </span><span class="n">CommandType</span><span class="p">.</span><span class="n">Increment</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">IncrementCommand</span><span class="p">)</span><span class="n">c</span><span class="p">).</span><span class="n">Value</span><span class="p">,</span>
<a id="__codelineno-26-12" name="__codelineno-26-12"></a><span class="w">    </span><span class="n">CommandType</span><span class="p">.</span><span class="n">Decrement</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">((</span><span class="n">DecrementCommand</span><span class="p">)</span><span class="n">c</span><span class="p">).</span><span class="n">Value</span><span class="p">,</span>
<a id="__codelineno-26-13" name="__codelineno-26-13"></a><span class="w">    </span><span class="n">CommandType</span><span class="p">.</span><span class="n">Reset</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-26-14" name="__codelineno-26-14"></a><span class="w">    </span><span class="c1">// In the case we&#39;re told to quit or we</span>
<a id="__codelineno-26-15" name="__codelineno-26-15"></a><span class="w">    </span><span class="c1">// get an unknown command, we&#39;ll return</span>
<a id="__codelineno-26-16" name="__codelineno-26-16"></a><span class="w">    </span><span class="c1">// the model back</span>
<a id="__codelineno-26-17" name="__codelineno-26-17"></a><span class="w">    </span><span class="n">CommandType</span><span class="p">.</span><span class="n">Quit</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">number</span><span class="p">,</span>
<a id="__codelineno-26-18" name="__codelineno-26-18"></a><span class="w">    </span><span class="n">CommandType</span><span class="p">.</span><span class="n">Unknown</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">number</span><span class="p">,</span>
<a id="__codelineno-26-19" name="__codelineno-26-19"></a><span class="w">    </span><span class="c1">// Since C# doesn&#39;t have exhaustive matching, we still require the default case here</span>
<a id="__codelineno-26-20" name="__codelineno-26-20"></a><span class="w">    </span><span class="n">_</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">number</span>
<a id="__codelineno-26-21" name="__codelineno-26-21"></a><span class="w">  </span><span class="p">};</span>
<a id="__codelineno-26-22" name="__codelineno-26-22"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h4 id="implementing-the-view-function"><a class="toclink" href="../../2025/12/01/reducing-bugs-by-using-the-model-view-update-pattern/#implementing-the-view-function">Implementing the View Function</a></h4>
<p>At this point, we could go ahead and start writing tests to verify that our model is being updated given the command, but our users are going to be interacting with the application, so let's build that out next.</p>
<p>From before, we know that the <code>View</code> function takes in the model (a number) and it will return a <code>Command</code>. Given that we need to interact with the user, this is an <a href="https://en.wikipedia.org/wiki/Pure_function#Impure_functions">impure function</a> by design, so we shouldn't put our business rules in here.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-27-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-27-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-27-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-27-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-27-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-27-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-27-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-27-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-27-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-27-10">10</a></span>
<span class="normal"><a href="#__codelineno-27-11">11</a></span>
<span class="normal"><a href="#__codelineno-27-12">12</a></span>
<span class="normal"><a href="#__codelineno-27-13">13</a></span>
<span class="normal"><a href="#__codelineno-27-14">14</a></span>
<span class="normal"><a href="#__codelineno-27-15">15</a></span>
<span class="normal"><a href="#__codelineno-27-16">16</a></span>
<span class="normal"><a href="#__codelineno-27-17">17</a></span>
<span class="normal"><a href="#__codelineno-27-18">18</a></span>
<span class="normal"><a href="#__codelineno-27-19">19</a></span>
<span class="normal"><a href="#__codelineno-27-20">20</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1"></a><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">Command</span><span class="o">&lt;</span><span class="n">CommandType</span><span class="o">&gt;</span><span class="w"> </span><span class="n">View</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">model</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-27-2" name="__codelineno-27-2"></a><span class="w">  </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">$&quot;Counter: {model}&quot;</span><span class="p">);</span>
<a id="__codelineno-27-3" name="__codelineno-27-3"></a><span class="w">  </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;(I)ncrement, (D)ecrement, (R)eset, or (Q)uit&quot;</span><span class="p">);</span>
<a id="__codelineno-27-4" name="__codelineno-27-4"></a>
<a id="__codelineno-27-5" name="__codelineno-27-5"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nf">ConvertStringToCommand</span><span class="p">(</span><span class="n">Console</span><span class="p">.</span><span class="n">ReadLine</span><span class="p">());</span>
<a id="__codelineno-27-6" name="__codelineno-27-6"></a><span class="p">}</span>
<a id="__codelineno-27-7" name="__codelineno-27-7"></a>
<a id="__codelineno-27-8" name="__codelineno-27-8"></a><span class="c1">// Even though this is called by the View</span>
<a id="__codelineno-27-9" name="__codelineno-27-9"></a><span class="c1">// function, this is a Pure function</span>
<a id="__codelineno-27-10" name="__codelineno-27-10"></a><span class="c1">// because it only depends upon a string</span>
<a id="__codelineno-27-11" name="__codelineno-27-11"></a><span class="c1">// for its logic</span>
<a id="__codelineno-27-12" name="__codelineno-27-12"></a><span class="k">private</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">Command</span><span class="o">&lt;</span><span class="n">CommandType</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ConvertStringToCommand</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-27-13" name="__codelineno-27-13"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">s</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">).</span><span class="n">Trim</span><span class="p">().</span><span class="n">ToLower</span><span class="p">()</span><span class="w"> </span><span class="k">switch</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-27-14" name="__codelineno-27-14"></a><span class="w">    </span><span class="s">&quot;i&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IncrementCommand</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="c1">// will increment by 2</span>
<a id="__codelineno-27-15" name="__codelineno-27-15"></a><span class="w">    </span><span class="s">&quot;d&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DecrementCommand</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="c1">// will decrement by 1</span>
<a id="__codelineno-27-16" name="__codelineno-27-16"></a><span class="w">    </span><span class="s">&quot;r&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ResetCommand</span><span class="p">(),</span>
<a id="__codelineno-27-17" name="__codelineno-27-17"></a><span class="w">    </span><span class="s">&quot;q&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">QuitCommand</span><span class="p">(),</span>
<a id="__codelineno-27-18" name="__codelineno-27-18"></a><span class="w">    </span><span class="n">_</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">UnknownCommand</span><span class="p">()</span>
<a id="__codelineno-27-19" name="__codelineno-27-19"></a><span class="w">  </span><span class="p">};</span>
<a id="__codelineno-27-20" name="__codelineno-27-20"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h4 id="wiring-everything-together"><a class="toclink" href="../../2025/12/01/reducing-bugs-by-using-the-model-view-update-pattern/#wiring-everything-together">Wiring Everything Together</a></h4>
<p>Now that we have our Model (a number), the <code>View</code> function, an <code>Update</code> function, and our list of <code>Command</code>s, we can wire everything together.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-28-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-28-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-28-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-28-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-28-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-28-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-28-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-28-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-28-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-28-10">10</a></span>
<span class="normal"><a href="#__codelineno-28-11">11</a></span>
<span class="normal"><a href="#__codelineno-28-12">12</a></span>
<span class="normal"><a href="#__codelineno-28-13">13</a></span>
<span class="normal"><a href="#__codelineno-28-14">14</a></span>
<span class="normal"><a href="#__codelineno-28-15">15</a></span>
<span class="normal"><a href="#__codelineno-28-16">16</a></span>
<span class="normal"><a href="#__codelineno-28-17">17</a></span>
<span class="normal"><a href="#__codelineno-28-18">18</a></span>
<span class="normal"><a href="#__codelineno-28-19">19</a></span>
<span class="normal"><a href="#__codelineno-28-20">20</a></span>
<span class="normal"><a href="#__codelineno-28-21">21</a></span>
<span class="normal"><a href="#__codelineno-28-22">22</a></span>
<span class="normal"><a href="#__codelineno-28-23">23</a></span>
<span class="normal"><a href="#__codelineno-28-24">24</a></span>
<span class="normal"><a href="#__codelineno-28-25">25</a></span>
<span class="normal"><a href="#__codelineno-28-26">26</a></span>
<span class="normal"><a href="#__codelineno-28-27">27</a></span>
<span class="normal"><a href="#__codelineno-28-28">28</a></span>
<span class="normal"><a href="#__codelineno-28-29">29</a></span>
<span class="normal"><a href="#__codelineno-28-30">30</a></span>
<span class="normal"><a href="#__codelineno-28-31">31</a></span>
<span class="normal"><a href="#__codelineno-28-32">32</a></span>
<span class="normal"><a href="#__codelineno-28-33">33</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1"></a><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">Framework</span>
<a id="__codelineno-28-2" name="__codelineno-28-2"></a><span class="p">{</span>
<a id="__codelineno-28-3" name="__codelineno-28-3"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="n">Run</span><span class="o">&lt;</span><span class="n">TModel</span><span class="p">,</span><span class="w"> </span><span class="n">TCommandType</span><span class="o">&gt;</span><span class="p">(</span>
<a id="__codelineno-28-4" name="__codelineno-28-4"></a><span class="w">      </span><span class="n">Func</span><span class="o">&lt;</span><span class="n">TModel</span><span class="p">,</span><span class="w"> </span><span class="n">Command</span><span class="o">&lt;</span><span class="n">TCommandType</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">view</span><span class="p">,</span>
<a id="__codelineno-28-5" name="__codelineno-28-5"></a><span class="w">      </span><span class="n">Func</span><span class="o">&lt;</span><span class="n">TModel</span><span class="p">,</span><span class="w"> </span><span class="n">Command</span><span class="o">&lt;</span><span class="n">TCommandType</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">TModel</span><span class="o">&gt;</span><span class="w"> </span><span class="n">update</span><span class="p">,</span>
<a id="__codelineno-28-6" name="__codelineno-28-6"></a><span class="w">      </span><span class="n">TModel</span><span class="w"> </span><span class="n">model</span><span class="p">)</span>
<a id="__codelineno-28-7" name="__codelineno-28-7"></a><span class="w">  </span><span class="k">where</span><span class="w"> </span><span class="n">TCommandType</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Enum</span>
<a id="__codelineno-28-8" name="__codelineno-28-8"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-28-9" name="__codelineno-28-9"></a><span class="w">    </span><span class="c1">// We need the Enum to have a Quit option</span>
<a id="__codelineno-28-10" name="__codelineno-28-10"></a><span class="w">    </span><span class="c1">// defined, otherwise, we won&#39;t know when</span>
<a id="__codelineno-28-11" name="__codelineno-28-11"></a><span class="w">    </span><span class="c1">// to quit the application.</span>
<a id="__codelineno-28-12" name="__codelineno-28-12"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">Enum</span><span class="p">.</span><span class="n">IsDefined</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">TCommandType</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;Quit&quot;</span><span class="p">))</span>
<a id="__codelineno-28-13" name="__codelineno-28-13"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-28-14" name="__codelineno-28-14"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">InvalidOperationException</span><span class="p">(</span><span class="s">&quot;Command must have a Quit option&quot;</span><span class="p">);</span>
<a id="__codelineno-28-15" name="__codelineno-28-15"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-28-16" name="__codelineno-28-16"></a><span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">quitCommand</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Enum</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">TCommandType</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;Quit&quot;</span><span class="p">);</span>
<a id="__codelineno-28-17" name="__codelineno-28-17"></a>
<a id="__codelineno-28-18" name="__codelineno-28-18"></a><span class="w">    </span><span class="c1">// Getting our initial state</span>
<a id="__codelineno-28-19" name="__codelineno-28-19"></a><span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">currentModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">model</span><span class="p">;</span>
<a id="__codelineno-28-20" name="__codelineno-28-20"></a><span class="w">    </span><span class="n">Command</span><span class="o">&lt;</span><span class="n">TCommandType</span><span class="o">&gt;</span><span class="w"> </span><span class="n">command</span><span class="p">;</span>
<a id="__codelineno-28-21" name="__codelineno-28-21"></a>
<a id="__codelineno-28-22" name="__codelineno-28-22"></a><span class="w">    </span><span class="c1">// While command isn&#39;t Quit</span>
<a id="__codelineno-28-23" name="__codelineno-28-23"></a><span class="w">    </span><span class="k">do</span>
<a id="__codelineno-28-24" name="__codelineno-28-24"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-28-25" name="__codelineno-28-25"></a><span class="w">      </span><span class="c1">// Clear the screen</span>
<a id="__codelineno-28-26" name="__codelineno-28-26"></a><span class="w">      </span><span class="n">Console</span><span class="p">.</span><span class="n">Clear</span><span class="p">();</span>
<a id="__codelineno-28-27" name="__codelineno-28-27"></a><span class="w">      </span><span class="c1">// Get the command from when we render the view</span>
<a id="__codelineno-28-28" name="__codelineno-28-28"></a><span class="w">      </span><span class="n">command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">view</span><span class="p">(</span><span class="n">currentModel</span><span class="p">);</span>
<a id="__codelineno-28-29" name="__codelineno-28-29"></a><span class="w">      </span><span class="c1">// Get the new model from update</span>
<a id="__codelineno-28-30" name="__codelineno-28-30"></a><span class="w">      </span><span class="n">currentModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">update</span><span class="p">(</span><span class="n">currentModel</span><span class="p">,</span><span class="w"> </span><span class="n">command</span><span class="p">);</span>
<a id="__codelineno-28-31" name="__codelineno-28-31"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">command</span><span class="p">.</span><span class="n">Tag</span><span class="p">.</span><span class="n">Equals</span><span class="p">(</span><span class="n">quitCommand</span><span class="p">));</span>
<a id="__codelineno-28-32" name="__codelineno-28-32"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-28-33" name="__codelineno-28-33"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h3 id="final-version"><a class="toclink" href="../../2025/12/01/reducing-bugs-by-using-the-model-view-update-pattern/#final-version">Final Version</a></h3>
<p>With the <code>Framework.Run</code> function defined, we can invoke it via our <code>Program.cs</code> file.</p>
<p>You can find the working version below (or you can <a href="https://github.com/cameronpresley/csharp-elm-example">clone a copy from GitHub</a>)</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Program.cs</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-29-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-29-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-29-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-29-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-29-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-29-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-29-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-29-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-29-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-29-10">10</a></span>
<span class="normal"><a href="#__codelineno-29-11">11</a></span>
<span class="normal"><a href="#__codelineno-29-12">12</a></span>
<span class="normal"><a href="#__codelineno-29-13">13</a></span>
<span class="normal"><a href="#__codelineno-29-14">14</a></span>
<span class="normal"><a href="#__codelineno-29-15">15</a></span>
<span class="normal"><a href="#__codelineno-29-16">16</a></span>
<span class="normal"><a href="#__codelineno-29-17">17</a></span>
<span class="normal"><a href="#__codelineno-29-18">18</a></span>
<span class="normal"><a href="#__codelineno-29-19">19</a></span>
<span class="normal"><a href="#__codelineno-29-20">20</a></span>
<span class="normal"><a href="#__codelineno-29-21">21</a></span>
<span class="normal"><a href="#__codelineno-29-22">22</a></span>
<span class="normal"><a href="#__codelineno-29-23">23</a></span>
<span class="normal"><a href="#__codelineno-29-24">24</a></span>
<span class="normal"><a href="#__codelineno-29-25">25</a></span>
<span class="normal"><a href="#__codelineno-29-26">26</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1"></a><span class="k">internal</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">Program</span>
<a id="__codelineno-29-2" name="__codelineno-29-2"></a><span class="p">{</span>
<a id="__codelineno-29-3" name="__codelineno-29-3"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span>
<a id="__codelineno-29-4" name="__codelineno-29-4"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-29-5" name="__codelineno-29-5"></a><span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">startCounter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="__codelineno-29-6" name="__codelineno-29-6"></a><span class="w">    </span><span class="n">Framework</span><span class="p">.</span><span class="n">Run</span><span class="p">(</span><span class="n">View</span><span class="p">,</span><span class="w"> </span><span class="n">CounterRules</span><span class="p">.</span><span class="n">Update</span><span class="p">,</span><span class="w"> </span><span class="n">startCounter</span><span class="p">);</span>
<a id="__codelineno-29-7" name="__codelineno-29-7"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-29-8" name="__codelineno-29-8"></a>
<a id="__codelineno-29-9" name="__codelineno-29-9"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">Command</span><span class="o">&lt;</span><span class="n">CommandType</span><span class="o">&gt;</span><span class="w"> </span><span class="n">View</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">model</span><span class="p">)</span>
<a id="__codelineno-29-10" name="__codelineno-29-10"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-29-11" name="__codelineno-29-11"></a><span class="w">    </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;Counter: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">model</span><span class="p">);</span>
<a id="__codelineno-29-12" name="__codelineno-29-12"></a><span class="w">    </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;Please enter a command:&quot;</span><span class="p">);</span>
<a id="__codelineno-29-13" name="__codelineno-29-13"></a><span class="w">    </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;(I)ncrement, (D)ecrement, (R)eset, (Q)uit&quot;</span><span class="p">);</span>
<a id="__codelineno-29-14" name="__codelineno-29-14"></a><span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Console</span><span class="p">.</span><span class="n">ReadLine</span><span class="p">()</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
<a id="__codelineno-29-15" name="__codelineno-29-15"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">ConvertStringToCommand</span><span class="p">(</span><span class="n">input</span><span class="p">);</span>
<a id="__codelineno-29-16" name="__codelineno-29-16"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-29-17" name="__codelineno-29-17"></a>
<a id="__codelineno-29-18" name="__codelineno-29-18"></a><span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">Command</span><span class="o">&lt;</span><span class="n">CommandType</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ConvertStringToCommand</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">s</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">).</span><span class="n">ToLower</span><span class="p">().</span><span class="n">Trim</span><span class="p">()</span><span class="w"> </span><span class="k">switch</span>
<a id="__codelineno-29-19" name="__codelineno-29-19"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-29-20" name="__codelineno-29-20"></a><span class="w">    </span><span class="s">&quot;i&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IncrementCommand</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
<a id="__codelineno-29-21" name="__codelineno-29-21"></a><span class="w">    </span><span class="s">&quot;d&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DecrementCommand</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-29-22" name="__codelineno-29-22"></a><span class="w">    </span><span class="s">&quot;r&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ResetCommand</span><span class="p">(),</span>
<a id="__codelineno-29-23" name="__codelineno-29-23"></a><span class="w">    </span><span class="s">&quot;q&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">QuitCommand</span><span class="p">(),</span>
<a id="__codelineno-29-24" name="__codelineno-29-24"></a><span class="w">    </span><span class="n">_</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">UnknownCommand</span><span class="p">(),</span>
<a id="__codelineno-29-25" name="__codelineno-29-25"></a><span class="w">  </span><span class="p">};</span>
<a id="__codelineno-29-26" name="__codelineno-29-26"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">CounterRules.cs</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-30-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-30-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-30-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-30-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-30-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-30-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-30-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-30-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-30-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-30-10">10</a></span>
<span class="normal"><a href="#__codelineno-30-11">11</a></span>
<span class="normal"><a href="#__codelineno-30-12">12</a></span>
<span class="normal"><a href="#__codelineno-30-13">13</a></span>
<span class="normal"><a href="#__codelineno-30-14">14</a></span>
<span class="normal"><a href="#__codelineno-30-15">15</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1"></a><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">CounterRules</span>
<a id="__codelineno-30-2" name="__codelineno-30-2"></a><span class="p">{</span>
<a id="__codelineno-30-3" name="__codelineno-30-3"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">Update</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">model</span><span class="p">,</span><span class="w"> </span><span class="n">Command</span><span class="o">&lt;</span><span class="n">CommandType</span><span class="o">&gt;</span><span class="w"> </span><span class="n">c</span><span class="p">)</span>
<a id="__codelineno-30-4" name="__codelineno-30-4"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-30-5" name="__codelineno-30-5"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">Tag</span><span class="w"> </span><span class="k">switch</span>
<a id="__codelineno-30-6" name="__codelineno-30-6"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-30-7" name="__codelineno-30-7"></a><span class="w">      </span><span class="n">CommandType</span><span class="p">.</span><span class="n">Increment</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">IncrementCommand</span><span class="p">)</span><span class="o">!</span><span class="p">.</span><span class="n">Value</span><span class="p">,</span>
<a id="__codelineno-30-8" name="__codelineno-30-8"></a><span class="w">      </span><span class="n">CommandType</span><span class="p">.</span><span class="n">Decrement</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">DecrementCommand</span><span class="p">)</span><span class="o">!</span><span class="p">.</span><span class="n">Value</span><span class="p">,</span>
<a id="__codelineno-30-9" name="__codelineno-30-9"></a><span class="w">      </span><span class="n">CommandType</span><span class="p">.</span><span class="n">Reset</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-30-10" name="__codelineno-30-10"></a><span class="w">      </span><span class="n">CommandType</span><span class="p">.</span><span class="n">Quit</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">model</span><span class="p">,</span>
<a id="__codelineno-30-11" name="__codelineno-30-11"></a><span class="w">      </span><span class="n">CommandType</span><span class="p">.</span><span class="n">Unknown</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">model</span><span class="p">,</span>
<a id="__codelineno-30-12" name="__codelineno-30-12"></a><span class="w">      </span><span class="n">_</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">model</span>
<a id="__codelineno-30-13" name="__codelineno-30-13"></a><span class="w">    </span><span class="p">};</span>
<a id="__codelineno-30-14" name="__codelineno-30-14"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-30-15" name="__codelineno-30-15"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Commands.cs</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-31-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-31-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-31-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-31-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-31-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-31-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-31-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-31-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-31-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-31-10">10</a></span>
<span class="normal"><a href="#__codelineno-31-11">11</a></span>
<span class="normal"><a href="#__codelineno-31-12">12</a></span>
<span class="normal"><a href="#__codelineno-31-13">13</a></span>
<span class="normal"><a href="#__codelineno-31-14">14</a></span>
<span class="normal"><a href="#__codelineno-31-15">15</a></span>
<span class="normal"><a href="#__codelineno-31-16">16</a></span>
<span class="normal"><a href="#__codelineno-31-17">17</a></span>
<span class="normal"><a href="#__codelineno-31-18">18</a></span>
<span class="normal"><a href="#__codelineno-31-19">19</a></span>
<span class="normal"><a href="#__codelineno-31-20">20</a></span>
<span class="normal"><a href="#__codelineno-31-21">21</a></span>
<span class="normal"><a href="#__codelineno-31-22">22</a></span>
<span class="normal"><a href="#__codelineno-31-23">23</a></span>
<span class="normal"><a href="#__codelineno-31-24">24</a></span>
<span class="normal"><a href="#__codelineno-31-25">25</a></span>
<span class="normal"><a href="#__codelineno-31-26">26</a></span>
<span class="normal"><a href="#__codelineno-31-27">27</a></span>
<span class="normal"><a href="#__codelineno-31-28">28</a></span>
<span class="normal"><a href="#__codelineno-31-29">29</a></span>
<span class="normal"><a href="#__codelineno-31-30">30</a></span>
<span class="normal"><a href="#__codelineno-31-31">31</a></span>
<span class="normal"><a href="#__codelineno-31-32">32</a></span>
<span class="normal"><a href="#__codelineno-31-33">33</a></span>
<span class="normal"><a href="#__codelineno-31-34">34</a></span>
<span class="normal"><a href="#__codelineno-31-35">35</a></span>
<span class="normal"><a href="#__codelineno-31-36">36</a></span>
<span class="normal"><a href="#__codelineno-31-37">37</a></span>
<span class="normal"><a href="#__codelineno-31-38">38</a></span>
<span class="normal"><a href="#__codelineno-31-39">39</a></span>
<span class="normal"><a href="#__codelineno-31-40">40</a></span>
<span class="normal"><a href="#__codelineno-31-41">41</a></span>
<span class="normal"><a href="#__codelineno-31-42">42</a></span>
<span class="normal"><a href="#__codelineno-31-43">43</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1"></a><span class="k">public</span><span class="w"> </span><span class="k">enum</span><span class="w"> </span><span class="n">CommandType</span>
<a id="__codelineno-31-2" name="__codelineno-31-2"></a><span class="p">{</span>
<a id="__codelineno-31-3" name="__codelineno-31-3"></a><span class="w">  </span><span class="n">Increment</span><span class="p">,</span>
<a id="__codelineno-31-4" name="__codelineno-31-4"></a><span class="w">  </span><span class="n">Decrement</span><span class="p">,</span>
<a id="__codelineno-31-5" name="__codelineno-31-5"></a><span class="w">  </span><span class="n">Reset</span><span class="p">,</span>
<a id="__codelineno-31-6" name="__codelineno-31-6"></a><span class="w">  </span><span class="n">Quit</span><span class="p">,</span>
<a id="__codelineno-31-7" name="__codelineno-31-7"></a><span class="w">  </span><span class="n">Unknown</span>
<a id="__codelineno-31-8" name="__codelineno-31-8"></a><span class="p">}</span>
<a id="__codelineno-31-9" name="__codelineno-31-9"></a>
<a id="__codelineno-31-10" name="__codelineno-31-10"></a><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">IncrementCommand</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Command</span><span class="o">&lt;</span><span class="n">CommandType</span><span class="o">&gt;</span>
<a id="__codelineno-31-11" name="__codelineno-31-11"></a><span class="p">{</span>
<a id="__codelineno-31-12" name="__codelineno-31-12"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="n">CommandType</span><span class="w"> </span><span class="n">Tag</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">CommandType</span><span class="p">.</span><span class="n">Increment</span><span class="p">;</span>
<a id="__codelineno-31-13" name="__codelineno-31-13"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">Value</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">init</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-31-14" name="__codelineno-31-14"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="nf">IncrementCommand</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="k">value</span><span class="p">)</span>
<a id="__codelineno-31-15" name="__codelineno-31-15"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-31-16" name="__codelineno-31-16"></a><span class="w">    </span><span class="n">Value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">value</span><span class="p">;</span>
<a id="__codelineno-31-17" name="__codelineno-31-17"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-31-18" name="__codelineno-31-18"></a><span class="p">}</span>
<a id="__codelineno-31-19" name="__codelineno-31-19"></a>
<a id="__codelineno-31-20" name="__codelineno-31-20"></a><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">DecrementCommand</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Command</span><span class="o">&lt;</span><span class="n">CommandType</span><span class="o">&gt;</span>
<a id="__codelineno-31-21" name="__codelineno-31-21"></a><span class="p">{</span>
<a id="__codelineno-31-22" name="__codelineno-31-22"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="n">CommandType</span><span class="w"> </span><span class="n">Tag</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">CommandType</span><span class="p">.</span><span class="n">Decrement</span><span class="p">;</span>
<a id="__codelineno-31-23" name="__codelineno-31-23"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">Value</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">init</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-31-24" name="__codelineno-31-24"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="nf">DecrementCommand</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="k">value</span><span class="p">)</span>
<a id="__codelineno-31-25" name="__codelineno-31-25"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-31-26" name="__codelineno-31-26"></a><span class="w">    </span><span class="n">Value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">value</span><span class="p">;</span>
<a id="__codelineno-31-27" name="__codelineno-31-27"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-31-28" name="__codelineno-31-28"></a><span class="p">}</span>
<a id="__codelineno-31-29" name="__codelineno-31-29"></a>
<a id="__codelineno-31-30" name="__codelineno-31-30"></a><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">ResetCommand</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Command</span><span class="o">&lt;</span><span class="n">CommandType</span><span class="o">&gt;</span>
<a id="__codelineno-31-31" name="__codelineno-31-31"></a><span class="p">{</span>
<a id="__codelineno-31-32" name="__codelineno-31-32"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="n">CommandType</span><span class="w"> </span><span class="n">Tag</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">CommandType</span><span class="p">.</span><span class="n">Reset</span><span class="p">;</span>
<a id="__codelineno-31-33" name="__codelineno-31-33"></a><span class="p">}</span>
<a id="__codelineno-31-34" name="__codelineno-31-34"></a>
<a id="__codelineno-31-35" name="__codelineno-31-35"></a><span class="k">public</span><span class="w"> </span><span class="k">sealed</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">QuitCommand</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Command</span><span class="o">&lt;</span><span class="n">CommandType</span><span class="o">&gt;</span>
<a id="__codelineno-31-36" name="__codelineno-31-36"></a><span class="p">{</span>
<a id="__codelineno-31-37" name="__codelineno-31-37"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="n">CommandType</span><span class="w"> </span><span class="n">Tag</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">CommandType</span><span class="p">.</span><span class="n">Quit</span><span class="p">;</span>
<a id="__codelineno-31-38" name="__codelineno-31-38"></a><span class="p">}</span>
<a id="__codelineno-31-39" name="__codelineno-31-39"></a>
<a id="__codelineno-31-40" name="__codelineno-31-40"></a><span class="k">public</span><span class="w"> </span><span class="k">sealed</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">UnknownCommand</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Command</span><span class="o">&lt;</span><span class="n">CommandType</span><span class="o">&gt;</span>
<a id="__codelineno-31-41" name="__codelineno-31-41"></a><span class="p">{</span>
<a id="__codelineno-31-42" name="__codelineno-31-42"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="n">CommandType</span><span class="w"> </span><span class="n">Tag</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">CommandType</span><span class="p">.</span><span class="n">Unknown</span><span class="p">;</span>
<a id="__codelineno-31-43" name="__codelineno-31-43"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Framework.cs</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-32-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-32-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-32-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-32-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-32-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-32-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-32-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-32-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-32-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-32-10">10</a></span>
<span class="normal"><a href="#__codelineno-32-11">11</a></span>
<span class="normal"><a href="#__codelineno-32-12">12</a></span>
<span class="normal"><a href="#__codelineno-32-13">13</a></span>
<span class="normal"><a href="#__codelineno-32-14">14</a></span>
<span class="normal"><a href="#__codelineno-32-15">15</a></span>
<span class="normal"><a href="#__codelineno-32-16">16</a></span>
<span class="normal"><a href="#__codelineno-32-17">17</a></span>
<span class="normal"><a href="#__codelineno-32-18">18</a></span>
<span class="normal"><a href="#__codelineno-32-19">19</a></span>
<span class="normal"><a href="#__codelineno-32-20">20</a></span>
<span class="normal"><a href="#__codelineno-32-21">21</a></span>
<span class="normal"><a href="#__codelineno-32-22">22</a></span>
<span class="normal"><a href="#__codelineno-32-23">23</a></span>
<span class="normal"><a href="#__codelineno-32-24">24</a></span>
<span class="normal"><a href="#__codelineno-32-25">25</a></span>
<span class="normal"><a href="#__codelineno-32-26">26</a></span>
<span class="normal"><a href="#__codelineno-32-27">27</a></span>
<span class="normal"><a href="#__codelineno-32-28">28</a></span>
<span class="normal"><a href="#__codelineno-32-29">29</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1"></a><span class="k">public</span><span class="w"> </span><span class="k">abstract</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">Command</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Enum</span>
<a id="__codelineno-32-2" name="__codelineno-32-2"></a><span class="p">{</span>
<a id="__codelineno-32-3" name="__codelineno-32-3"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">abstract</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="n">Tag</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-32-4" name="__codelineno-32-4"></a><span class="p">}</span>
<a id="__codelineno-32-5" name="__codelineno-32-5"></a>
<a id="__codelineno-32-6" name="__codelineno-32-6"></a><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">Framework</span>
<a id="__codelineno-32-7" name="__codelineno-32-7"></a><span class="p">{</span>
<a id="__codelineno-32-8" name="__codelineno-32-8"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="n">Run</span><span class="o">&lt;</span><span class="n">TModel</span><span class="p">,</span><span class="w"> </span><span class="n">TCommandType</span><span class="o">&gt;</span><span class="p">(</span>
<a id="__codelineno-32-9" name="__codelineno-32-9"></a><span class="w">      </span><span class="n">Func</span><span class="o">&lt;</span><span class="n">TModel</span><span class="p">,</span><span class="w"> </span><span class="n">Command</span><span class="o">&lt;</span><span class="n">TCommandType</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">view</span><span class="p">,</span>
<a id="__codelineno-32-10" name="__codelineno-32-10"></a><span class="w">      </span><span class="n">Func</span><span class="o">&lt;</span><span class="n">TModel</span><span class="p">,</span><span class="w"> </span><span class="n">Command</span><span class="o">&lt;</span><span class="n">TCommandType</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">TModel</span><span class="o">&gt;</span><span class="w"> </span><span class="n">update</span><span class="p">,</span>
<a id="__codelineno-32-11" name="__codelineno-32-11"></a><span class="w">      </span><span class="n">TModel</span><span class="w"> </span><span class="n">model</span><span class="p">)</span>
<a id="__codelineno-32-12" name="__codelineno-32-12"></a><span class="w">  </span><span class="k">where</span><span class="w"> </span><span class="n">TCommandType</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Enum</span>
<a id="__codelineno-32-13" name="__codelineno-32-13"></a><span class="w">  </span><span class="p">{</span>
<a id="__codelineno-32-14" name="__codelineno-32-14"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">Enum</span><span class="p">.</span><span class="n">IsDefined</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">TCommandType</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;Quit&quot;</span><span class="p">))</span>
<a id="__codelineno-32-15" name="__codelineno-32-15"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-32-16" name="__codelineno-32-16"></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">InvalidOperationException</span><span class="p">(</span><span class="s">&quot;Command must have a Quit option&quot;</span><span class="p">);</span>
<a id="__codelineno-32-17" name="__codelineno-32-17"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-32-18" name="__codelineno-32-18"></a><span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">quitCommand</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Enum</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">TCommandType</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;Quit&quot;</span><span class="p">);</span>
<a id="__codelineno-32-19" name="__codelineno-32-19"></a><span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">currentModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">model</span><span class="p">;</span>
<a id="__codelineno-32-20" name="__codelineno-32-20"></a><span class="w">    </span><span class="n">Console</span><span class="p">.</span><span class="n">Clear</span><span class="p">();</span>
<a id="__codelineno-32-21" name="__codelineno-32-21"></a><span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">view</span><span class="p">(</span><span class="n">currentModel</span><span class="p">);</span>
<a id="__codelineno-32-22" name="__codelineno-32-22"></a><span class="w">    </span><span class="k">do</span>
<a id="__codelineno-32-23" name="__codelineno-32-23"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-32-24" name="__codelineno-32-24"></a><span class="w">      </span><span class="n">currentModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">update</span><span class="p">(</span><span class="n">currentModel</span><span class="p">,</span><span class="w"> </span><span class="n">command</span><span class="p">);</span>
<a id="__codelineno-32-25" name="__codelineno-32-25"></a><span class="w">      </span><span class="n">Console</span><span class="p">.</span><span class="n">Clear</span><span class="p">();</span>
<a id="__codelineno-32-26" name="__codelineno-32-26"></a><span class="w">      </span><span class="n">command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">view</span><span class="p">(</span><span class="n">currentModel</span><span class="p">);</span>
<a id="__codelineno-32-27" name="__codelineno-32-27"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">command</span><span class="p">.</span><span class="n">Tag</span><span class="p">.</span><span class="n">Equals</span><span class="p">(</span><span class="n">quitCommand</span><span class="p">));</span>
<a id="__codelineno-32-28" name="__codelineno-32-28"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-32-29" name="__codelineno-32-29"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h3 id="conclusion"><a class="toclink" href="../../2025/12/01/reducing-bugs-by-using-the-model-view-update-pattern/#conclusion">Conclusion</a></h3>
<p>In this post, we built out a basic application using the Model View Update pattern that was first introduced by the Elm language. We also implemented a basic sum type, <code>Command</code>, using an abstract class that was then constrained to particular <code>CommandTypes</code>.</p>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/cameronpresley.png" alt="Cameron Presley">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2025-03-05 00:00:00+00:00">Mar 5, 2025</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="./" class="md-meta__link">.NET</a>, 
              <a href="../today-i-learned/" class="md-meta__link">Today I Learned</a></li>
        
        
          
          <li class="md-meta__item">
            
              5 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="today-i-learned-configuring-httpclient-via-service-registration"><a class="toclink" href="../../2025/03/05/today-i-learned-configuring-httpclient-via-service-registration/">Today I Learned: Configuring HttpClient via Service Registration</a></h2>
<p>When integrating with an external service via an API call, it's common to create a class the encapsulates dealing with the API. For example, if I was interacting with the GitHub API, I might create a C# class that wraps the <code>HttpClient</code>, like the following:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-0-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-0-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-0-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">public</span><span class="w"> </span><span class="k">interface</span><span class="w"> </span><span class="n">IGitHubService</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="p">{</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="w">    </span><span class="n">Task</span><span class="o">&lt;</span><span class="kt">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">GetCurrentUsername</span><span class="p">();</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="p">}</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">GitHubService</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">IGitHubService</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="p">{</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="w">    </span><span class="k">private</span><span class="w"> </span><span class="k">readonly</span><span class="w"> </span><span class="n">HttpClient</span><span class="w"> </span><span class="n">_client</span><span class="p">;</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="nf">GitHubService</span><span class="p">(</span><span class="n">HttpClient</span><span class="w"> </span><span class="n">client</span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="w">        </span><span class="n">_client</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">client</span><span class="p">;</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="n">Task</span><span class="o">&lt;</span><span class="kt">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">GetCurrentUsername</span><span class="p">()</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="w">        </span><span class="c1">// code implementation</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h3 id="repetition-of-values"><a class="toclink" href="../../2025/03/05/today-i-learned-configuring-httpclient-via-service-registration/#repetition-of-values">Repetition of Values</a></h3>
<p>This is a great start, but over time, your class might end up like the following:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-1-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-1-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-1-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-1-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-1-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-1-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-1-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-1-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-1-10">10</a></span>
<span class="normal"><a href="#__codelineno-1-11">11</a></span>
<span class="normal"><a href="#__codelineno-1-12">12</a></span>
<span class="normal"><a href="#__codelineno-1-13">13</a></span>
<span class="normal"><a href="#__codelineno-1-14">14</a></span>
<span class="normal"><a href="#__codelineno-1-15">15</a></span>
<span class="normal"><a href="#__codelineno-1-16">16</a></span>
<span class="normal"><a href="#__codelineno-1-17">17</a></span>
<span class="normal"><a href="#__codelineno-1-18">18</a></span>
<span class="normal"><a href="#__codelineno-1-19">19</a></span>
<span class="normal"><a href="#__codelineno-1-20">20</a></span>
<span class="normal"><a href="#__codelineno-1-21">21</a></span>
<span class="normal"><a href="#__codelineno-1-22">22</a></span>
<span class="normal"><a href="#__codelineno-1-23">23</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">GitHubService</span>
<a id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="p">{</span>
<a id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="w">    </span><span class="k">private</span><span class="w"> </span><span class="k">readonly</span><span class="w"> </span><span class="n">HttpClient</span><span class="w"> </span><span class="n">_client</span><span class="p">;</span>
<a id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="nf">GitHubService</span><span class="p">(</span><span class="n">HttpClient</span><span class="w"> </span><span class="n">client</span><span class="p">)</span>
<a id="__codelineno-1-5" name="__codelineno-1-5"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-1-6" name="__codelineno-1-6"></a><span class="w">        </span><span class="n">_client</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">client</span><span class="p">;</span>
<a id="__codelineno-1-7" name="__codelineno-1-7"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-1-8" name="__codelineno-1-8"></a><span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="n">Task</span><span class="o">&lt;</span><span class="kt">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">GetCurrentUsername</span><span class="p">()</span>
<a id="__codelineno-1-9" name="__codelineno-1-9"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-1-10" name="__codelineno-1-10"></a><span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_client</span><span class="p">.</span><span class="n">GetFromJsonAsync</span><span class="p">(</span><span class="s">&quot;https://api.github.com/user&quot;</span><span class="p">)</span>
<a id="__codelineno-1-11" name="__codelineno-1-11"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="n">Login</span><span class="p">;</span>
<a id="__codelineno-1-12" name="__codelineno-1-12"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-1-13" name="__codelineno-1-13"></a><span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="n">Task</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="kt">string</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">GetAllUsers</span><span class="p">()</span>
<a id="__codelineno-1-14" name="__codelineno-1-14"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-1-15" name="__codelineno-1-15"></a><span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_client</span><span class="p">.</span><span class="n">GetFromJsonAsync</span><span class="p">(</span><span class="s">&quot;https://api.github.com/users&quot;</span><span class="p">);</span>
<a id="__codelineno-1-16" name="__codelineno-1-16"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="n">Select</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="n">Login</span><span class="p">).</span><span class="n">ToList</span><span class="p">();</span>
<a id="__codelineno-1-17" name="__codelineno-1-17"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-1-18" name="__codelineno-1-18"></a><span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="n">Task</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="kt">string</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">GetTeamNamesForOrg</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">org</span><span class="p">)</span>
<a id="__codelineno-1-19" name="__codelineno-1-19"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-1-20" name="__codelineno-1-20"></a><span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_client</span><span class="p">.</span><span class="n">GetFromJsonAsync</span><span class="p">(</span><span class="s">$&quot;https://api.github.com/orgs/{org}/teams&quot;</span><span class="p">);</span>
<a id="__codelineno-1-21" name="__codelineno-1-21"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="n">Select</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="n">Name</span><span class="p">).</span><span class="n">ToList</span><span class="p">();</span>
<a id="__codelineno-1-22" name="__codelineno-1-22"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-1-23" name="__codelineno-1-23"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Right off the bat, it seems like we're repeating the URL for each method call. To remove the repetition, we could extract to a constant.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-2-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-2-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-2-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-2-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-2-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-2-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-2-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-2-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-2-10">10</a></span>
<span class="normal"><a href="#__codelineno-2-11">11</a></span>
<span class="normal"><a href="#__codelineno-2-12">12</a></span>
<span class="normal"><a href="#__codelineno-2-13">13</a></span>
<span class="normal"><a href="#__codelineno-2-14">14</a></span>
<span class="normal"><a href="#__codelineno-2-15">15</a></span>
<span class="normal"><a href="#__codelineno-2-16">16</a></span>
<span class="normal"><a href="#__codelineno-2-17">17</a></span>
<span class="normal"><a href="#__codelineno-2-18">18</a></span>
<span class="normal"><a href="#__codelineno-2-19">19</a></span>
<span class="normal"><a href="#__codelineno-2-20">20</a></span>
<span class="normal"><a href="#__codelineno-2-21">21</a></span>
<span class="normal"><a href="#__codelineno-2-22">22</a></span>
<span class="normal"><a href="#__codelineno-2-23">23</a></span>
<span class="normal"><a href="#__codelineno-2-24">24</a></span>
<span class="normal"><a href="#__codelineno-2-25">25</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">GitHubService</span>
<a id="__codelineno-2-2" name="__codelineno-2-2"></a><span class="p">{</span>
<a id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="w">    </span><span class="k">private</span><span class="w"> </span><span class="k">readonly</span><span class="w"> </span><span class="n">HttpClient</span><span class="w"> </span><span class="n">_client</span><span class="p">;</span>
<a id="__codelineno-2-4" name="__codelineno-2-4"></a><span class="w">    </span><span class="c1">// Setting the base URL for later usage</span>
<a id="__codelineno-2-5" name="__codelineno-2-5"></a><span class="w">    </span><span class="k">private</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">_baseUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;https://api.github.com&quot;</span><span class="p">;</span>
<a id="__codelineno-2-6" name="__codelineno-2-6"></a><span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="nf">GitHubService</span><span class="p">(</span><span class="n">HttpClient</span><span class="w"> </span><span class="n">client</span><span class="p">)</span>
<a id="__codelineno-2-7" name="__codelineno-2-7"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-2-8" name="__codelineno-2-8"></a><span class="w">        </span><span class="n">_client</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">client</span><span class="p">;</span>
<a id="__codelineno-2-9" name="__codelineno-2-9"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-2-10" name="__codelineno-2-10"></a><span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="n">Task</span><span class="o">&lt;</span><span class="kt">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">GetCurrentUsername</span><span class="p">()</span>
<a id="__codelineno-2-11" name="__codelineno-2-11"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-2-12" name="__codelineno-2-12"></a><span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_client</span><span class="p">.</span><span class="n">GetFromJsonAsync</span><span class="p">(</span><span class="s">$&quot;{_baseUrl}/user&quot;</span><span class="p">)</span>
<a id="__codelineno-2-13" name="__codelineno-2-13"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="n">Login</span><span class="p">;</span>
<a id="__codelineno-2-14" name="__codelineno-2-14"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-2-15" name="__codelineno-2-15"></a><span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="n">Task</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="kt">string</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">GetAllUsers</span><span class="p">()</span>
<a id="__codelineno-2-16" name="__codelineno-2-16"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-2-17" name="__codelineno-2-17"></a><span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_client</span><span class="p">.</span><span class="n">GetFromJsonAsync</span><span class="p">(</span><span class="s">$&quot;{_baseUrl}/users&quot;</span><span class="p">);</span>
<a id="__codelineno-2-18" name="__codelineno-2-18"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="n">Select</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="n">Login</span><span class="p">).</span><span class="n">ToList</span><span class="p">();</span>
<a id="__codelineno-2-19" name="__codelineno-2-19"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-2-20" name="__codelineno-2-20"></a><span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="n">Task</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="kt">string</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">GetTeamNamesForOrg</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">org</span><span class="p">)</span>
<a id="__codelineno-2-21" name="__codelineno-2-21"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-2-22" name="__codelineno-2-22"></a><span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_client</span><span class="p">.</span><span class="n">GetFromJsonAsync</span><span class="p">(</span><span class="s">$&quot;{_baseUrl}/orgs/{org}/teams&quot;</span><span class="p">);</span>
<a id="__codelineno-2-23" name="__codelineno-2-23"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="n">Select</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="n">Name</span><span class="p">).</span><span class="n">ToList</span><span class="p">();</span>
<a id="__codelineno-2-24" name="__codelineno-2-24"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-2-25" name="__codelineno-2-25"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>This helps remove the repetition, however, we're now keeping track of a new field, <code>_baseUrl</code>. Instead of using this, we could leverage the <a href="https://learn.microsoft.com/en-us/dotnet/api/system.net.http.httpclient.baseaddress?view=net-9.0"><code>BaseAddress</code></a> property and set that in the service's constructor.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-3-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-3-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-3-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-3-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-3-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-3-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-3-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-3-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-3-10">10</a></span>
<span class="normal"><a href="#__codelineno-3-11">11</a></span>
<span class="normal"><a href="#__codelineno-3-12">12</a></span>
<span class="normal"><a href="#__codelineno-3-13">13</a></span>
<span class="normal"><a href="#__codelineno-3-14">14</a></span>
<span class="normal"><a href="#__codelineno-3-15">15</a></span>
<span class="normal"><a href="#__codelineno-3-16">16</a></span>
<span class="normal"><a href="#__codelineno-3-17">17</a></span>
<span class="normal"><a href="#__codelineno-3-18">18</a></span>
<span class="normal"><a href="#__codelineno-3-19">19</a></span>
<span class="normal"><a href="#__codelineno-3-20">20</a></span>
<span class="normal"><a href="#__codelineno-3-21">21</a></span>
<span class="normal"><a href="#__codelineno-3-22">22</a></span>
<span class="normal"><a href="#__codelineno-3-23">23</a></span>
<span class="normal"><a href="#__codelineno-3-24">24</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">GitHubService</span>
<a id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="p">{</span>
<a id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="w">    </span><span class="k">private</span><span class="w"> </span><span class="k">readonly</span><span class="w"> </span><span class="n">HttpClient</span><span class="w"> </span><span class="n">_client</span><span class="p">;</span>
<a id="__codelineno-3-4" name="__codelineno-3-4"></a><span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="nf">GitHubService</span><span class="p">(</span><span class="n">HttpClient</span><span class="w"> </span><span class="n">client</span><span class="p">)</span>
<a id="__codelineno-3-5" name="__codelineno-3-5"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-3-6" name="__codelineno-3-6"></a><span class="w">        </span><span class="n">_client</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">client</span><span class="p">;</span>
<a id="__codelineno-3-7" name="__codelineno-3-7"></a><span class="w">        </span><span class="n">_client</span><span class="p">.</span><span class="n">BaseAddress</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;https://api.github.com&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// Setting the base address for the other requests.</span>
<a id="__codelineno-3-8" name="__codelineno-3-8"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-3-9" name="__codelineno-3-9"></a><span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="n">Task</span><span class="o">&lt;</span><span class="kt">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">GetCurrentUsername</span><span class="p">()</span>
<a id="__codelineno-3-10" name="__codelineno-3-10"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-3-11" name="__codelineno-3-11"></a><span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_client</span><span class="p">.</span><span class="n">GetFromJsonAsync</span><span class="p">(</span><span class="s">&quot;/user&quot;</span><span class="p">)</span>
<a id="__codelineno-3-12" name="__codelineno-3-12"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="n">Login</span><span class="p">;</span>
<a id="__codelineno-3-13" name="__codelineno-3-13"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-3-14" name="__codelineno-3-14"></a><span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="n">Task</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="kt">string</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">GetAllUsers</span><span class="p">()</span>
<a id="__codelineno-3-15" name="__codelineno-3-15"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-3-16" name="__codelineno-3-16"></a><span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_client</span><span class="p">.</span><span class="n">GetFromJsonAsync</span><span class="p">(</span><span class="s">&quot;/users&quot;</span><span class="p">);</span>
<a id="__codelineno-3-17" name="__codelineno-3-17"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="n">Select</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="n">Login</span><span class="p">).</span><span class="n">ToList</span><span class="p">();</span>
<a id="__codelineno-3-18" name="__codelineno-3-18"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-3-19" name="__codelineno-3-19"></a><span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="n">Task</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="kt">string</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">GetTeamNamesForOrg</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">org</span><span class="p">)</span>
<a id="__codelineno-3-20" name="__codelineno-3-20"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-3-21" name="__codelineno-3-21"></a><span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_client</span><span class="p">.</span><span class="n">GetFromJsonAsync</span><span class="p">(</span><span class="s">$&quot;/orgs/{org}/teams&quot;</span><span class="p">);</span>
<a id="__codelineno-3-22" name="__codelineno-3-22"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="n">Select</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="n">Name</span><span class="p">).</span><span class="n">ToList</span><span class="p">();</span>
<a id="__codelineno-3-23" name="__codelineno-3-23"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-3-24" name="__codelineno-3-24"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>I like this refactor because we remove the field and we have our configuration in one spot. That being said, interacting with an API typically requires more information than just the URL. For example, setting up the API token or that we're always expecting JSON for the response. We could add the header setup in each method, but that seems quite duplicative.</p>
<h3 id="leveraging-default-request-headers"><a class="toclink" href="../../2025/03/05/today-i-learned-configuring-httpclient-via-service-registration/#leveraging-default-request-headers">Leveraging Default Request Headers</a></h3>
<p>We can centralize our request headers by leveraging the <a href="https://learn.microsoft.com/en-us/dotnet/api/system.net.http.httpclient.defaultrequestheaders?view=net-9.0"><code>DefaultRequestHeaders</code> property</a> and updating our constructor.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-4-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-4-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-4-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-4-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-4-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-4-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-4-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-4-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-4-10">10</a></span>
<span class="normal"><a href="#__codelineno-4-11">11</a></span>
<span class="normal"><a href="#__codelineno-4-12">12</a></span>
<span class="normal"><a href="#__codelineno-4-13">13</a></span>
<span class="normal"><a href="#__codelineno-4-14">14</a></span>
<span class="normal"><a href="#__codelineno-4-15">15</a></span>
<span class="normal"><a href="#__codelineno-4-16">16</a></span>
<span class="normal"><a href="#__codelineno-4-17">17</a></span>
<span class="normal"><a href="#__codelineno-4-18">18</a></span>
<span class="normal"><a href="#__codelineno-4-19">19</a></span>
<span class="normal"><a href="#__codelineno-4-20">20</a></span>
<span class="normal"><a href="#__codelineno-4-21">21</a></span>
<span class="normal"><a href="#__codelineno-4-22">22</a></span>
<span class="normal"><a href="#__codelineno-4-23">23</a></span>
<span class="normal"><a href="#__codelineno-4-24">24</a></span>
<span class="normal"><a href="#__codelineno-4-25">25</a></span>
<span class="normal"><a href="#__codelineno-4-26">26</a></span>
<span class="normal"><a href="#__codelineno-4-27">27</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">GitHubService</span>
<a id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="p">{</span>
<a id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="w">    </span><span class="k">private</span><span class="w"> </span><span class="k">readonly</span><span class="w"> </span><span class="n">HttpClient</span><span class="w"> </span><span class="n">_client</span><span class="p">;</span>
<a id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="nf">GitHubService</span><span class="p">(</span><span class="n">HttpClient</span><span class="w"> </span><span class="n">client</span><span class="p">)</span>
<a id="__codelineno-4-5" name="__codelineno-4-5"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-4-6" name="__codelineno-4-6"></a><span class="w">        </span><span class="n">_client</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">client</span><span class="p">;</span>
<a id="__codelineno-4-7" name="__codelineno-4-7"></a><span class="w">        </span><span class="n">_client</span><span class="p">.</span><span class="n">BaseAddress</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;https://api.github.com&quot;</span><span class="p">;</span>
<a id="__codelineno-4-8" name="__codelineno-4-8"></a><span class="w">        </span><span class="n">_client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s">&quot;Accept&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;application/vnd.github+json&quot;</span><span class="p">);</span>
<a id="__codelineno-4-9" name="__codelineno-4-9"></a><span class="w">        </span><span class="n">_client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s">&quot;Authentication&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">$&quot;Bearer {yourTokenGoesHere}&quot;</span><span class="p">);</span>
<a id="__codelineno-4-10" name="__codelineno-4-10"></a><span class="w">        </span><span class="n">_client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s">&quot;X-GitHub-Api-Version&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;2022-11-28&quot;</span><span class="p">);</span>
<a id="__codelineno-4-11" name="__codelineno-4-11"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-4-12" name="__codelineno-4-12"></a><span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="n">Task</span><span class="o">&lt;</span><span class="kt">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">GetCurrentUsername</span><span class="p">()</span>
<a id="__codelineno-4-13" name="__codelineno-4-13"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-4-14" name="__codelineno-4-14"></a><span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_client</span><span class="p">.</span><span class="n">GetFromJsonAsync</span><span class="p">(</span><span class="s">&quot;/user&quot;</span><span class="p">)</span>
<a id="__codelineno-4-15" name="__codelineno-4-15"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="n">Login</span><span class="p">;</span>
<a id="__codelineno-4-16" name="__codelineno-4-16"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-4-17" name="__codelineno-4-17"></a><span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="n">Task</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="kt">string</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">GetAllUsers</span><span class="p">()</span>
<a id="__codelineno-4-18" name="__codelineno-4-18"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-4-19" name="__codelineno-4-19"></a><span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_client</span><span class="p">.</span><span class="n">GetFromJsonAsync</span><span class="p">(</span><span class="s">&quot;/users&quot;</span><span class="p">);</span>
<a id="__codelineno-4-20" name="__codelineno-4-20"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="n">Select</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="n">Login</span><span class="p">).</span><span class="n">ToList</span><span class="p">();</span>
<a id="__codelineno-4-21" name="__codelineno-4-21"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-4-22" name="__codelineno-4-22"></a><span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="n">Task</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="kt">string</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">GetTeamNamesForOrg</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">org</span><span class="p">)</span>
<a id="__codelineno-4-23" name="__codelineno-4-23"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-4-24" name="__codelineno-4-24"></a><span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_client</span><span class="p">.</span><span class="n">GetFromJsonAsync</span><span class="p">(</span><span class="s">$&quot;/orgs/{org}/teams&quot;</span><span class="p">);</span>
<a id="__codelineno-4-25" name="__codelineno-4-25"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="n">Select</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="n">Name</span><span class="p">).</span><span class="n">ToList</span><span class="p">();</span>
<a id="__codelineno-4-26" name="__codelineno-4-26"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-4-27" name="__codelineno-4-27"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>I like this refactor because all of our configuration of the service is right next to how we're using it, so easy to troubleshoot. At this point, we would need to register our service in the Inversion of Control (IoC) container and then everything would work.</p>
<p>Generally, you'll find this in <code>Startup.cs</code> and would look like:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="n">services</span><span class="p">.</span><span class="n">AddTransient</span><span class="o">&lt;</span><span class="n">IGitHubService</span><span class="p">,</span><span class="w"> </span><span class="n">GitHubService</span><span class="o">&gt;</span><span class="p">();</span>
</code></pre></div></td></tr></table></div>
<h3 id="an-alternative-approach-for-service-registration"><a class="toclink" href="../../2025/03/05/today-i-learned-configuring-httpclient-via-service-registration/#an-alternative-approach-for-service-registration">An Alternative Approach for Service Registration</a></h3>
<p>However, I learned that when you're building a service that's wrapping an <code>HttpClient</code>, there's another service registration method you could use, <code>AddHttpClient</code> with the <a href="https://learn.microsoft.com/en-us/aspnet/core/fundamentals/http-requests?view=aspnetcore-9.0#typed-clients"><em>Typed Client</em> approach</a>.</p>
<p>Let's take a look at what this would look like.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1">1</a></span>
<span class="normal"><a href="#__codelineno-6-2">2</a></span>
<span class="normal"><a href="#__codelineno-6-3">3</a></span>
<span class="normal"><a href="#__codelineno-6-4">4</a></span>
<span class="normal"><a href="#__codelineno-6-5">5</a></span>
<span class="normal"><a href="#__codelineno-6-6">6</a></span>
<span class="normal"><a href="#__codelineno-6-7">7</a></span>
<span class="normal"><a href="#__codelineno-6-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="c1">// In Startup.cs</span>
<a id="__codelineno-6-2" name="__codelineno-6-2"></a>
<a id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="n">services</span><span class="p">.</span><span class="n">AddHttpClient</span><span class="o">&lt;</span><span class="n">IGitHubService</span><span class="p">,</span><span class="w"> </span><span class="n">GitHubService</span><span class="o">&gt;</span><span class="p">(</span><span class="n">client</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-4" name="__codelineno-6-4"></a><span class="w">    </span><span class="n">client</span><span class="p">.</span><span class="n">BaseAddress</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Uri</span><span class="p">(</span><span class="s">&quot;https://api.github.com&quot;</span><span class="p">);</span>
<a id="__codelineno-6-5" name="__codelineno-6-5"></a><span class="w">    </span><span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s">&quot;Accept&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;application/vnd.github+json&quot;</span><span class="p">);</span>
<a id="__codelineno-6-6" name="__codelineno-6-6"></a><span class="w">    </span><span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s">&quot;Authorization&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">$&quot;Bearer {apiTokenGoesHere}&quot;</span><span class="p">);</span>
<a id="__codelineno-6-7" name="__codelineno-6-7"></a><span class="w">    </span><span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s">&quot;X-GitHub-Api-Version&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;2022-11-28&quot;</span><span class="p">);</span>
<a id="__codelineno-6-8" name="__codelineno-6-8"></a><span class="p">});</span>
</code></pre></div></td></tr></table></div>
<p>We've essentially moved our configuration logic from the <code>GitHubService</code> to the IoC container, simplifying the service.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-7-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-7-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-7-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-7-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-7-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-7-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-7-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-7-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-7-10">10</a></span>
<span class="normal"><a href="#__codelineno-7-11">11</a></span>
<span class="normal"><a href="#__codelineno-7-12">12</a></span>
<span class="normal"><a href="#__codelineno-7-13">13</a></span>
<span class="normal"><a href="#__codelineno-7-14">14</a></span>
<span class="normal"><a href="#__codelineno-7-15">15</a></span>
<span class="normal"><a href="#__codelineno-7-16">16</a></span>
<span class="normal"><a href="#__codelineno-7-17">17</a></span>
<span class="normal"><a href="#__codelineno-7-18">18</a></span>
<span class="normal"><a href="#__codelineno-7-19">19</a></span>
<span class="normal"><a href="#__codelineno-7-20">20</a></span>
<span class="normal"><a href="#__codelineno-7-21">21</a></span>
<span class="normal"><a href="#__codelineno-7-22">22</a></span>
<span class="normal"><a href="#__codelineno-7-23">23</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">GitHubService</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">IGitHubService</span>
<a id="__codelineno-7-2" name="__codelineno-7-2"></a><span class="p">{</span>
<a id="__codelineno-7-3" name="__codelineno-7-3"></a><span class="w">    </span><span class="k">private</span><span class="w"> </span><span class="k">readonly</span><span class="w"> </span><span class="n">HttpClient</span><span class="w"> </span><span class="n">_client</span><span class="p">;</span>
<a id="__codelineno-7-4" name="__codelineno-7-4"></a><span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="nf">GitHubService</span><span class="p">(</span><span class="n">HttpClient</span><span class="w"> </span><span class="n">client</span><span class="p">)</span>
<a id="__codelineno-7-5" name="__codelineno-7-5"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-7-6" name="__codelineno-7-6"></a><span class="w">        </span><span class="n">_client</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">client</span><span class="p">;</span>
<a id="__codelineno-7-7" name="__codelineno-7-7"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-7-8" name="__codelineno-7-8"></a><span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="n">Task</span><span class="o">&lt;</span><span class="kt">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">GetCurrentUsername</span><span class="p">()</span>
<a id="__codelineno-7-9" name="__codelineno-7-9"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-7-10" name="__codelineno-7-10"></a><span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_client</span><span class="p">.</span><span class="n">GetFromJsonAsync</span><span class="p">(</span><span class="s">&quot;/user&quot;</span><span class="p">)</span>
<a id="__codelineno-7-11" name="__codelineno-7-11"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="n">Login</span><span class="p">;</span>
<a id="__codelineno-7-12" name="__codelineno-7-12"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-7-13" name="__codelineno-7-13"></a><span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="n">Task</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="kt">string</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">GetAllUsers</span><span class="p">()</span>
<a id="__codelineno-7-14" name="__codelineno-7-14"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-7-15" name="__codelineno-7-15"></a><span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_client</span><span class="p">.</span><span class="n">GetFromJsonAsync</span><span class="p">(</span><span class="s">&quot;/users&quot;</span><span class="p">);</span>
<a id="__codelineno-7-16" name="__codelineno-7-16"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="n">Select</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="n">Login</span><span class="p">).</span><span class="n">ToList</span><span class="p">();</span>
<a id="__codelineno-7-17" name="__codelineno-7-17"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-7-18" name="__codelineno-7-18"></a><span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="n">Task</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="kt">string</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">GetTeamNamesForOrg</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">org</span><span class="p">)</span>
<a id="__codelineno-7-19" name="__codelineno-7-19"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-7-20" name="__codelineno-7-20"></a><span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_client</span><span class="p">.</span><span class="n">GetFromJsonAsync</span><span class="p">(</span><span class="s">$&quot;/orgs/{org}/teams&quot;</span><span class="p">);</span>
<a id="__codelineno-7-21" name="__codelineno-7-21"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="n">Select</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="n">Name</span><span class="p">).</span><span class="n">ToList</span><span class="p">();</span>
<a id="__codelineno-7-22" name="__codelineno-7-22"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-7-23" name="__codelineno-7-23"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h3 id="my-thoughts"><a class="toclink" href="../../2025/03/05/today-i-learned-configuring-httpclient-via-service-registration/#my-thoughts">My Thoughts</a></h3>
<p>Even though this is a new approach, I'm kind of torn if I like it or not. On one hand, I appreciate that we can centralize the logic in one spot so that everything for the <code>GitHubService</code> is one spot. However, if we needed other dependencies to configure the service (for example, we needed to get the bearer token from <code>AppSettings</code>), I could see this getting a bit more complicated, though contained.</p>
<p>On the other hand, we could shift all that config to the IoC and let it deal with that. It definitely streamlines the <code>GitHubService</code> so we can focus on the endpoints and their logic, however, now I've got to look for two spots to see where the client is being configured.</p>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/cameronpresley.png" alt="Cameron Presley">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2020-12-12 00:00:00+00:00">Dec 12, 2020</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="./" class="md-meta__link">.NET</a></li>
        
        
          
          <li class="md-meta__item">
            
              5 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="thinking-with-properties-examining-where"><a class="toclink" href="../../2020/12/12/thinking-with-properties-examining-where/">Thinking With Properties: Examining Where</a></h2>
<p><em>Note: This post is for <a href="https://www.csadvent.christmas/">C# Advent Calendar 2020</a> organized by <a href="https://twitter.com/mgroves">Matthew Groves</a>. Check out some of the other posts that are happening over the month of December!</em></p>
<h3 id="what-do-we-mean-by-properties"><a class="toclink" href="../../2020/12/12/thinking-with-properties-examining-where/#what-do-we-mean-by-properties">What Do We Mean By Properties?</a></h3>
<p>When I think about software, I will generally think about the <em>properties</em> that the solution has to have <code>Where</code> properties are the characteristics that the code has. Sometimes, the property is obvious (for example, if you square a number, the result should always be positive). In this post, were going to look at LINQs <code>Where</code> method, examine some of the properties, and come up with a more efficient way of creating filters.</p>
<h3 id="examining-linqs-where-method"><a class="toclink" href="../../2020/12/12/thinking-with-properties-examining-where/#examining-linqs-where-method">Examining LINQ's <code>Where</code> Method</a></h3>
<p>For those not familiar with <code>Where</code>, its a method that promises that it will return a subset of a list <code>Where</code> each item fulfills some criteria (referred to as a <em>predicate</em>). The type signature for <code>Where</code> is</p>
<p><code>IEnumerable&lt;T&gt; =&gt; Func&lt;T, bool&gt; =&gt; IEnumerable&lt;T&gt;</code></p>
<p>At face value, this sounds pretty straightforward, but there are a few more properties that <code>Where</code> provides that arent obvious at first, but are beneficial</p>
<ul>
<li>The results cant be null (worse case, itll be an empty list because no item fulfilled the criteria)</li>
<li>The results cant be larger than the original list</li>
<li>The results are in the same order that the original list was in (i.e. if were trying to find the even numbers in a list that is 1..10, then youre guaranteed to get 2, 4, 6, 8, and 10. Not, 8, 2, 6, 10, 4)</li>
<li>The results will only contain elements that were in the original list (i.e. it cant create elements out of thin air and it cant copy elements in the original list)</li>
</ul>
<h3 id="common-linq-mistake-with-where"><a class="toclink" href="../../2020/12/12/thinking-with-properties-examining-where/#common-linq-mistake-with-where">Common LINQ Mistake with <code>Where</code></a></h3>
<p>Thats a ton of guarantees that you get from leveraging <code>Where</code> instead of doing your own filtering inside loops. With these properties in mind, lets take a look at a common mistake that developers make when working with <code>Where</code></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1">1</a></span>
<span class="normal"><a href="#__codelineno-9-2">2</a></span>
<span class="normal"><a href="#__codelineno-9-3">3</a></span>
<span class="normal"><a href="#__codelineno-9-4">4</a></span>
<span class="normal"><a href="#__codelineno-9-5">5</a></span>
<span class="normal"><a href="#__codelineno-9-6">6</a></span>
<span class="normal"><a href="#__codelineno-9-7">7</a></span>
<span class="normal"><a href="#__codelineno-9-8">8</a></span>
<span class="normal"><a href="#__codelineno-9-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="c1">// Generate numbers from -10 .. 100</span>
<a id="__codelineno-9-2" name="__codelineno-9-2"></a><span class="kt">var</span><span class="w"> </span><span class="n">numbers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Enumerable</span><span class="p">.</span><span class="n">Range</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">111</span><span class="p">);</span>
<a id="__codelineno-9-3" name="__codelineno-9-3"></a>
<a id="__codelineno-9-4" name="__codelineno-9-4"></a><span class="c1">// Determines all positive numbers that are divisible by 6</span>
<a id="__codelineno-9-5" name="__codelineno-9-5"></a><span class="kt">var</span><span class="w"> </span><span class="n">positiveDivisbleBySix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">numbers</span>
<a id="__codelineno-9-6" name="__codelineno-9-6"></a><span class="w">                            </span><span class="p">.</span><span class="n">Where</span><span class="p">(</span><span class="n">x</span><span class="o">=&gt;</span><span class="n">x</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="c1">// iterates through the whole list (111 comparisons, returning 100 results)</span>
<a id="__codelineno-9-7" name="__codelineno-9-7"></a><span class="w">                            </span><span class="p">.</span><span class="n">Where</span><span class="p">(</span><span class="n">x</span><span class="o">=&gt;</span><span class="n">x</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="c1">// iterates through the new list (100 comparisons, returning 50 results)</span>
<a id="__codelineno-9-8" name="__codelineno-9-8"></a><span class="w">                            </span><span class="p">.</span><span class="n">Where</span><span class="p">(</span><span class="n">x</span><span class="o">=&gt;</span><span class="n">x</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w"> </span><span class="c1">// iterates through the new list (50 comparisons, returning 16 results)</span>
<a id="__codelineno-9-9" name="__codelineno-9-9"></a><span class="c1">// Overall metrics: 261 comparisons over 111 total elements)</span>
</code></pre></div></td></tr></table></div>
<p>By leveraging multiple Where statements, the list will be iterated once per statement. which may not be a big deal for small lists, but for larger lists, this will become a performance hit. In order to help cut down on the iterations, itd be ideal to combine the multiple Where statements into a single one like so</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1">1</a></span>
<span class="normal"><a href="#__codelineno-10-2">2</a></span>
<span class="normal"><a href="#__codelineno-10-3">3</a></span>
<span class="normal"><a href="#__codelineno-10-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="c1">// Generate numbers from -10 .. 100</span>
<a id="__codelineno-10-2" name="__codelineno-10-2"></a><span class="kt">var</span><span class="w"> </span><span class="n">numbers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Enumerable</span><span class="p">.</span><span class="n">Range</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">111</span><span class="p">);</span>
<a id="__codelineno-10-3" name="__codelineno-10-3"></a>
<a id="__codelineno-10-4" name="__codelineno-10-4"></a><span class="kt">var</span><span class="w"> </span><span class="n">positiveDivisibleBySix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">numbers</span><span class="p">.</span><span class="n">Where</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<p>By combining the criteria in a single Where statement, we eliminate the multiple iteration problem, however, we introduce code thats a bit harder to read and if we want to combine a non-fixed number of predicates, then this approach wont work.</p>
<p>Since the goal is to take multiple predicates and combine them to a single predicate, my intuition is to leverage LINQs Aggregate method where we can take a List of items and reduce down to a single item.</p>
<h3 id="refactoring-multiple-where-with-aggregate"><a class="toclink" href="../../2020/12/12/thinking-with-properties-examining-where/#refactoring-multiple-where-with-aggregate">Refactoring Multiple Where with Aggregate</a></h3>
<p>In order to leverage Aggregate, well first need to have a list of item to reduce down. Since all of the predicates are Func<int, bool>, we can easily create a List like so</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1">1</a></span>
<span class="normal"><a href="#__codelineno-11-2">2</a></span>
<span class="normal"><a href="#__codelineno-11-3">3</a></span>
<span class="normal"><a href="#__codelineno-11-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="n">Func</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="n">isPositive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="__codelineno-11-2" name="__codelineno-11-2"></a><span class="n">Func</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="n">isEven</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="__codelineno-11-3" name="__codelineno-11-3"></a><span class="n">Func</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="n">isDivisibleByThree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="__codelineno-11-4" name="__codelineno-11-4"></a><span class="kt">var</span><span class="w"> </span><span class="n">predicates</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Func</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">{</span><span class="n">isPositive</span><span class="p">,</span><span class="w"> </span><span class="n">isEven</span><span class="p">,</span><span class="w"> </span><span class="n">isDivisibleByThree</span><span class="p">};</span>
</code></pre></div></td></tr></table></div>
<p>Now that we have a list of predicates, we can go ahead and start stubbing out the Aggregate call.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="kt">var</span><span class="w"> </span><span class="n">combinedPredicate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">predicates</span><span class="p">.</span><span class="n">Aggregate</span><span class="p">(....,</span><span class="w"> </span><span class="p">....);</span>
</code></pre></div></td></tr></table></div>
<p>In order to use Aggregate, we need to determine two pieces of information. First, what should the predicate be if there are no predicates to combine? Second, how do we we combine two predicates into a single predicate?</p>
<h3 id="defining-the-base-case"><a class="toclink" href="../../2020/12/12/thinking-with-properties-examining-where/#defining-the-base-case">Defining the Base Case</a></h3>
<p>When using Aggregate, the first thing that we need to think about is the base case, or in other words, what should the default value be if there are no elements to reduce down?</p>
<p>Given that the result needs to be a predicate, we know that the type should be <code>Func&lt;int, bool&gt;</code>, but how do we implement that? Weve got one of two choices for the base case, we can either filter every item out (i.e. if no predicates are specified, then no items are kept) or we keep every item.</p>
<p>For our use case, we want to keep every item if there are no predicates, so our base case looks like the following</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="n">Func</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="n">andIdentity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">true</span><span class="p">;</span>
</code></pre></div></td></tr></table></div>
<h3 id="defining-how-to-combine-predicates"><a class="toclink" href="../../2020/12/12/thinking-with-properties-examining-where/#defining-how-to-combine-predicates">Defining How To Combine Predicates</a></h3>
<p>Since were combining predicates, our combine function will need to have the following type</p>
<p><code>Func&lt;int, bool&gt; =&gt; Func&lt;int, bool&gt; =&gt; Func&lt;int, bool&gt;</code></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1">1</a></span>
<span class="normal"><a href="#__codelineno-14-2">2</a></span>
<span class="normal"><a href="#__codelineno-14-3">3</a></span>
<span class="normal"><a href="#__codelineno-14-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="n">Func</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="n">combinedPredicateWithAnd</span><span class="p">(</span><span class="n">Func</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">Func</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="n">b</span><span class="p">)</span>
<a id="__codelineno-14-2" name="__codelineno-14-2"></a><span class="p">{</span>
<a id="__codelineno-14-3" name="__codelineno-14-3"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">...;</span>
<a id="__codelineno-14-4" name="__codelineno-14-4"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>With this in mind, we know that for an item to be valid, it has to match <em>every</em> predicate in the list which implies that well be leveraging the <code>&amp;&amp;</code> operator</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1">1</a></span>
<span class="normal"><a href="#__codelineno-15-2">2</a></span>
<span class="normal"><a href="#__codelineno-15-3">3</a></span>
<span class="normal"><a href="#__codelineno-15-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="n">Func</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="n">combinedPredicateWithAnd</span><span class="p">(</span><span class="n">Func</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">Func</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="n">b</span><span class="p">)</span>
<a id="__codelineno-15-2" name="__codelineno-15-2"></a><span class="p">{</span>
<a id="__codelineno-15-3" name="__codelineno-15-3"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">...;</span>
<a id="__codelineno-15-4" name="__codelineno-15-4"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Now that we know to use <code>&amp;&amp;</code>, we can then use a and b to determine if the item is valid</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-16-1">1</a></span>
<span class="normal"><a href="#__codelineno-16-2">2</a></span>
<span class="normal"><a href="#__codelineno-16-3">3</a></span>
<span class="normal"><a href="#__codelineno-16-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1"></a><span class="n">Func</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="n">combinedPredicateWithAnd</span><span class="p">(</span><span class="n">Func</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">Func</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="n">b</span><span class="p">)</span>
<a id="__codelineno-16-2" name="__codelineno-16-2"></a><span class="p">{</span>
<a id="__codelineno-16-3" name="__codelineno-16-3"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">b</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
<a id="__codelineno-16-4" name="__codelineno-16-4"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h3 id="bringing-it-all-together"><a class="toclink" href="../../2020/12/12/thinking-with-properties-examining-where/#bringing-it-all-together">Bringing It All Together</a></h3>
<p>With the base case established and a way to combine predicates, heres how we can solve the original problem.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-17-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-17-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-17-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-17-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-17-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-17-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-17-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-17-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-17-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-17-10">10</a></span>
<span class="normal"><a href="#__codelineno-17-11">11</a></span>
<span class="normal"><a href="#__codelineno-17-12">12</a></span>
<span class="normal"><a href="#__codelineno-17-13">13</a></span>
<span class="normal"><a href="#__codelineno-17-14">14</a></span>
<span class="normal"><a href="#__codelineno-17-15">15</a></span>
<span class="normal"><a href="#__codelineno-17-16">16</a></span>
<span class="normal"><a href="#__codelineno-17-17">17</a></span>
<span class="normal"><a href="#__codelineno-17-18">18</a></span>
<span class="normal"><a href="#__codelineno-17-19">19</a></span>
<span class="normal"><a href="#__codelineno-17-20">20</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1"></a><span class="c1">// Define the predicates</span>
<a id="__codelineno-17-2" name="__codelineno-17-2"></a><span class="n">Func</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="n">isPositive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="__codelineno-17-3" name="__codelineno-17-3"></a><span class="n">Func</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="n">isEven</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="__codelineno-17-4" name="__codelineno-17-4"></a><span class="n">Func</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="n">isDivisibleByThree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="__codelineno-17-5" name="__codelineno-17-5"></a><span class="kt">var</span><span class="w"> </span><span class="n">predicates</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Func</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">{</span><span class="n">isPositive</span><span class="p">,</span><span class="w"> </span><span class="n">isEven</span><span class="p">,</span><span class="w"> </span><span class="n">isDivisibleByThree</span><span class="p">};</span>
<a id="__codelineno-17-6" name="__codelineno-17-6"></a>
<a id="__codelineno-17-7" name="__codelineno-17-7"></a><span class="c1">// Defining the Aggregate functions</span>
<a id="__codelineno-17-8" name="__codelineno-17-8"></a><span class="n">Func</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="n">andIdentity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">true</span><span class="p">;</span>
<a id="__codelineno-17-9" name="__codelineno-17-9"></a><span class="n">Func</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="n">combinedPredicateWithAnd</span><span class="p">(</span><span class="n">Func</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">Func</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="n">b</span><span class="p">)</span>
<a id="__codelineno-17-10" name="__codelineno-17-10"></a><span class="p">{</span>
<a id="__codelineno-17-11" name="__codelineno-17-11"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">b</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
<a id="__codelineno-17-12" name="__codelineno-17-12"></a><span class="p">}</span>
<a id="__codelineno-17-13" name="__codelineno-17-13"></a>
<a id="__codelineno-17-14" name="__codelineno-17-14"></a><span class="c1">// Combining the predicates</span>
<a id="__codelineno-17-15" name="__codelineno-17-15"></a><span class="n">Func</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="n">combinedAndPredicate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">predicates</span><span class="p">.</span><span class="n">Aggregate</span><span class="p">(</span><span class="n">andIdentity</span><span class="p">,</span><span class="w"> </span><span class="n">combinedPredicateWithAnd</span><span class="p">);</span>
<a id="__codelineno-17-16" name="__codelineno-17-16"></a>
<a id="__codelineno-17-17" name="__codelineno-17-17"></a><span class="c1">// The new solution</span>
<a id="__codelineno-17-18" name="__codelineno-17-18"></a><span class="c1">// Generate numbers from -10 .. 100</span>
<a id="__codelineno-17-19" name="__codelineno-17-19"></a><span class="kt">var</span><span class="w"> </span><span class="n">numbers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Enumerable</span><span class="p">.</span><span class="n">Range</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">111</span><span class="p">);</span>
<a id="__codelineno-17-20" name="__codelineno-17-20"></a><span class="kt">var</span><span class="w"> </span><span class="n">positiveDivisbleBySix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">numbers</span><span class="p">.</span><span class="n">Where</span><span class="p">(</span><span class="n">combinedAndPredicate</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<p>Going forward, if we need to add more predicates, all we need to do is to add it to the <code>List</code> and the rest of the application will work as expected</p>
<h3 id="wrapping-up"><a class="toclink" href="../../2020/12/12/thinking-with-properties-examining-where/#wrapping-up">Wrapping Up</a></h3>
<p>In this post, we explored LINQs <code>Where</code> method by examining its various properties. From there, we took a look at a common mistake developers make with <code>Where</code> and then showed how to resolve that issue by using <code>Aggregate</code>.</p>
<p>Shout out to Matthew Groves for letting me participate in C# Christmas (<a href="https://www.csadvent.christmas/">csadvent.christmas</a>)</p>
    
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/cameronpresley.png" alt="Cameron Presley">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2015-10-13 00:00:00+00:00">Oct 13, 2015</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../functional-programming/" class="md-meta__link">Functional Programming</a>, 
              <a href="./" class="md-meta__link">.NET</a></li>
        
        
          
          <li class="md-meta__item">
            
              3 min read
            
          </li>
        
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="implementing-your-own-version-of-fs-listfilter"><a class="toclink" href="../../2015/10/13/implementing-your-own-version-of-fs-listfilter/">Implementing Your Own Version of F#s List.Filter</a></h2>
<p>As Ive been thinking more about F#, I began to wonder how certain methods in the F# stack work, so I decided to implement F#s List.filter method.</p>
<p>For those of you who arent familiar, List.Filter takes a function that returns true or false and a list of values. The result of the call is all values that fulfill the fuction.</p>
<p>For example, if we wanted to keep just the even numbers in our list, then the following would accomplish that goal.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1">1</a></span>
<span class="normal"><a href="#__codelineno-8-2">2</a></span>
<span class="normal"><a href="#__codelineno-8-3">3</a></span>
<span class="normal"><a href="#__codelineno-8-4">4</a></span>
<span class="normal"><a href="#__codelineno-8-5">5</a></span>
<span class="normal"><a href="#__codelineno-8-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a><span class="k">let</span><span class="w"> </span><span class="nv">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="mi">1</span><span class="o">;</span><span class="mi">2</span><span class="o">;</span><span class="mi">3</span><span class="o">;</span><span class="mi">4</span><span class="o">]</span>
<a id="__codelineno-8-2" name="__codelineno-8-2"></a><span class="k">let</span><span class="w"> </span><span class="nv">isItEven</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<a id="__codelineno-8-3" name="__codelineno-8-3"></a>
<a id="__codelineno-8-4" name="__codelineno-8-4"></a>
<a id="__codelineno-8-5" name="__codelineno-8-5"></a><span class="k">let</span><span class="w"> </span><span class="nv">evenValues</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nn">List</span><span class="p">.</span><span class="n">filter</span><span class="w"> </span><span class="n">isItEven</span><span class="w"> </span><span class="n">values</span>
<a id="__codelineno-8-6" name="__codelineno-8-6"></a><span class="c1">// val it : int list = [2; 4]</span>
</code></pre></div></td></tr></table></div>
<p>Now that we know the problem, how would we begin to implement? First, we need to define a function called filter:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="k">let</span><span class="w"> </span><span class="nv">filter</span><span class="w"> </span><span class="bp">()</span><span class="w"> </span><span class="o">=</span>
</code></pre></div></td></tr></table></div>
<p>However, to match the signature for List.filter, it needs to take a function that maps integers to bools and the list of values to work on</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="k">let</span><span class="w"> </span><span class="nv">filter</span><span class="w"> </span><span class="o">(</span><span class="n">func</span><span class="o">:</span><span class="n">int</span><span class="o">-&gt;</span><span class="kt">bool</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">values</span><span class="o">:</span><span class="n">int</span><span class="w"> </span><span class="n">List</span><span class="o">)</span><span class="w"> </span><span class="o">=</span>
</code></pre></div></td></tr></table></div>
<p>Now that we have the signature, lets add some logic to match on the list of values. When working with lists, there are two possibilities, an empty list and a non-empty list. Lets first explore the empty list option.</p>
<p>In the case of an empty list of values, then it doesnt matter what the func parameter does, there are no possible results, so we should return an empty list for the result.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1">1</a></span>
<span class="normal"><a href="#__codelineno-11-2">2</a></span>
<span class="normal"><a href="#__codelineno-11-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="k">let</span><span class="w"> </span><span class="nv">filter</span><span class="w"> </span><span class="o">(</span><span class="n">func</span><span class="o">:</span><span class="n">int</span><span class="o">-&gt;</span><span class="kt">bool</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">values</span><span class="o">:</span><span class="n">int</span><span class="w"> </span><span class="n">List</span><span class="o">)</span><span class="w"> </span><span class="o">=</span>
<a id="__codelineno-11-2" name="__codelineno-11-2"></a><span class="w">    </span><span class="k">match</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="k">with</span>
<a id="__codelineno-11-3" name="__codelineno-11-3"></a><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="bp">[]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="bp">[]</span>
</code></pre></div></td></tr></table></div>
<p>Now that weve handled the empty list, lets explore the non-empty list scenario. In this branch, the list must have a head and a tail, so we can deconstruct the list to follow that pattern.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1">1</a></span>
<span class="normal"><a href="#__codelineno-12-2">2</a></span>
<span class="normal"><a href="#__codelineno-12-3">3</a></span>
<span class="normal"><a href="#__codelineno-12-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="k">let</span><span class="w"> </span><span class="nv">filter</span><span class="w"> </span><span class="o">(</span><span class="n">func</span><span class="o">:</span><span class="n">int</span><span class="o">-&gt;</span><span class="kt">bool</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">values</span><span class="o">:</span><span class="n">int</span><span class="w"> </span><span class="n">List</span><span class="o">)</span><span class="w"> </span><span class="o">=</span>
<a id="__codelineno-12-2" name="__codelineno-12-2"></a><span class="w">    </span><span class="k">match</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="k">with</span>
<a id="__codelineno-12-3" name="__codelineno-12-3"></a><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="bp">[]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="bp">[]</span>
<a id="__codelineno-12-4" name="__codelineno-12-4"></a><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="n">head</span><span class="o">::</span><span class="n">tail</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="c1">// what goes here?</span>
</code></pre></div></td></tr></table></div>
<p>Now that weve deconstructed the list, we can now use the func parameter with the head element. If the value satisfies the func parameter, then we want to add the head element to the list of results and continue processing the rest of the list. To do that, we can use recursion to call back into filter with the same func parameter and the rest of the list:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1">1</a></span>
<span class="normal"><a href="#__codelineno-13-2">2</a></span>
<span class="normal"><a href="#__codelineno-13-3">3</a></span>
<span class="normal"><a href="#__codelineno-13-4">4</a></span>
<span class="normal"><a href="#__codelineno-13-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="k">let</span><span class="w"> </span><span class="nv">rec</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="o">(</span><span class="n">func</span><span class="o">:</span><span class="n">int</span><span class="o">-&gt;</span><span class="kt">bool</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">values</span><span class="o">:</span><span class="n">int</span><span class="w"> </span><span class="n">List</span><span class="o">)</span><span class="w"> </span><span class="o">=</span>
<a id="__codelineno-13-2" name="__codelineno-13-2"></a><span class="w">    </span><span class="k">match</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="k">with</span>
<a id="__codelineno-13-3" name="__codelineno-13-3"></a><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="bp">[]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="bp">[]</span>
<a id="__codelineno-13-4" name="__codelineno-13-4"></a><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="n">head</span><span class="o">::</span><span class="n">tail</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span>
<a id="__codelineno-13-5" name="__codelineno-13-5"></a><span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="n">func</span><span class="w"> </span><span class="n">head</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">head</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="n">func</span><span class="w"> </span><span class="n">tail</span>
</code></pre></div></td></tr></table></div>
<p>At this point, we need to handle the case where the head element does not satisfy the func parameter. In this case, we should not add the element to the list of results and we should let filter continue the work</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1">1</a></span>
<span class="normal"><a href="#__codelineno-14-2">2</a></span>
<span class="normal"><a href="#__codelineno-14-3">3</a></span>
<span class="normal"><a href="#__codelineno-14-4">4</a></span>
<span class="normal"><a href="#__codelineno-14-5">5</a></span>
<span class="normal"><a href="#__codelineno-14-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="k">let</span><span class="w"> </span><span class="nv">rec</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="o">(</span><span class="n">func</span><span class="o">:</span><span class="n">int</span><span class="o">-&gt;</span><span class="kt">bool</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">values</span><span class="o">:</span><span class="n">int</span><span class="w"> </span><span class="n">List</span><span class="o">)</span><span class="w"> </span><span class="o">=</span>
<a id="__codelineno-14-2" name="__codelineno-14-2"></a><span class="w">    </span><span class="k">match</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="k">with</span>
<a id="__codelineno-14-3" name="__codelineno-14-3"></a><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="bp">[]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="bp">[]</span>
<a id="__codelineno-14-4" name="__codelineno-14-4"></a><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="n">head</span><span class="o">::</span><span class="n">tail</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span>
<a id="__codelineno-14-5" name="__codelineno-14-5"></a><span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="n">func</span><span class="w"> </span><span class="n">head</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">head</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="n">func</span><span class="w"> </span><span class="n">tail</span>
<a id="__codelineno-14-6" name="__codelineno-14-6"></a><span class="w">         </span><span class="k">else</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="n">func</span><span class="w"> </span><span class="n">tail</span>
</code></pre></div></td></tr></table></div>
<p>By handling the base case first (an empty list), filter can focus on the current element in the list (head) and then recurse to process the rest of the list. This solution works, but we can make this better by removing the type annotations. Interestingly enough, we dont care if were working with integers, strings, or whatever. Just as long as the function takes some type and returns bool and the list of values matches the same type as the func parameter, it works. So then we end up with the following:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1">1</a></span>
<span class="normal"><a href="#__codelineno-15-2">2</a></span>
<span class="normal"><a href="#__codelineno-15-3">3</a></span>
<span class="normal"><a href="#__codelineno-15-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="k">let</span><span class="w"> </span><span class="nv">rec</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="n">func</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="o">=</span>
<a id="__codelineno-15-2" name="__codelineno-15-2"></a><span class="w">    </span><span class="k">match</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="k">with</span>
<a id="__codelineno-15-3" name="__codelineno-15-3"></a><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="bp">[]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="bp">[]</span>
<a id="__codelineno-15-4" name="__codelineno-15-4"></a><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="n">head</span><span class="o">::</span><span class="n">tail</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">func</span><span class="w"> </span><span class="n">head</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">head</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="n">func</span><span class="w"> </span><span class="n">tail</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">filter</span><span class="w"> </span><span class="n">func</span><span class="w"> </span><span class="n">tail</span>
</code></pre></div></td></tr></table></div>
<p>In general, when working with lists, I tend to start by matching the list with either an empty list or non-empty. From there, Ive got my base case, so I can focus on the implementation for the first element. After performing the work for the first element, I can then recurse to the next element.</p>
    
    
  </div>
</article>
      
      
        
          



<nav class="md-pagination">
  
</nav>
        
      
    </div>
  </div>

          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../../" class="md-footer__link md-footer__link--prev" aria-label="Previous: Index">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Index
              </div>
            </div>
          </a>
        
        
          
          <a href="../aws/" class="md-footer__link md-footer__link--next" aria-label="Next: AWS">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                AWS
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs Insiders
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.footer", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.ad38c271.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.b66b2b78.min.js"></script>
      
    
  </body>
</html>